{"version":3,"file":"platform.a56500036a35aa00.js","mappings":"gBAAIA,ECAAC,EACAC,EC0CAC,EASAC,E,kCC3CeC,OAAOC,IAAI,iBAAmBD,OAAOC,IAAI,gBAAkBD,OAAOC,IAAI,kBAAoBD,OAAOC,IAAI,qBAAuBD,OAAOC,IAAI,kBAAoBD,OAAOC,IAAI,kBAAoBD,OAAOC,IAAI,iBAAmBD,OAAOC,IAAI,wBAA0BD,OAAOC,IAAI,qBAAuBD,OAAOC,IAAI,kBAAoBD,OAAOC,IAAI,uBAAyBD,OAAOC,IAAI,cAAgBD,OAAOC,IAAI,cAAgBD,OAAOC,IAAI,mBAAuBD,OAAOC,IAAI,yB,oCCNtd,M,qBCHF,OAOC,WACA,aAEA,IAAIC,EAAS,CAAC,EAAEC,eAGhB,SAASC,IAGR,IAFA,IAAIC,EAAU,GAELC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAC1C,IAAIG,EAAMF,UAAUD,GACpB,GAAKG,EAAL,CAEA,IAAIC,SAAiBD,EAErB,GAAgB,WAAZC,GAAoC,WAAZA,EAC3BL,EAAQM,KAAKF,QACP,GAAIG,MAAMC,QAAQJ,IACxB,GAAIA,EAAID,OAAQ,CACf,IAAIM,EAAQV,EAAWW,MAAM,KAAMN,GAC/BK,GACHT,EAAQM,KAAKG,EAEf,OACM,GAAgB,WAAZJ,EAAsB,CAChC,GAAID,EAAIO,WAAaC,OAAOC,UAAUF,WAAaP,EAAIO,SAASA,WAAWG,SAAS,iBAAkB,CACrGd,EAAQM,KAAKF,EAAIO,YACjB,QACD,CAEA,IAAK,IAAII,KAAOX,EACXP,EAAOmB,KAAKZ,EAAKW,IAAQX,EAAIW,IAChCf,EAAQM,KAAKS,EAGhB,CAxBkB,CAyBnB,CAEA,OAAOf,EAAQiB,KAAK,IACrB,CAEqCC,EAAOC,SAC3CpB,EAAWqB,QAAUrB,EACrBmB,EAAOC,QAAUpB,QAKhB,KAFwB,EAAF,WACtB,OAAOA,CACP,UAFoB,OAEpB,YAIH,CApDA,E,oCCLA,IAAIsB,EAAU,EAAQ,MAMlBC,EAAgB,CAClBC,mBAAmB,EACnBC,aAAa,EACbC,cAAc,EACdC,cAAc,EACdC,aAAa,EACbC,iBAAiB,EACjBC,0BAA0B,EAC1BC,0BAA0B,EAC1BC,QAAQ,EACRC,WAAW,EACXC,MAAM,GAEJC,EAAgB,CAClBC,MAAM,EACNhC,QAAQ,EACRU,WAAW,EACXuB,QAAQ,EACRC,QAAQ,EACRnC,WAAW,EACXoC,OAAO,GASLC,EAAe,CACjB,UAAY,EACZC,SAAS,EACTd,cAAc,EACdC,aAAa,EACbK,WAAW,EACXC,MAAM,GAEJQ,EAAe,CAAC,EAIpB,SAASC,EAAWC,GAElB,OAAItB,EAAQuB,OAAOD,GACVJ,EAIFE,EAAaE,EAAoB,WAAMrB,CAChD,CAXAmB,EAAapB,EAAQwB,YAhBK,CACxB,UAAY,EACZC,QAAQ,EACRpB,cAAc,EACdC,aAAa,EACbK,WAAW,GAYbS,EAAapB,EAAQ0B,MAAQR,EAY7B,IAAIS,EAAiBpC,OAAOoC,eACxBC,EAAsBrC,OAAOqC,oBAC7BC,EAAwBtC,OAAOsC,sBAC/BC,EAA2BvC,OAAOuC,yBAClCC,EAAiBxC,OAAOwC,eACxBC,EAAkBzC,OAAOC,UAsC7BK,EAAOC,QArCP,SAASmC,EAAqBC,EAAiBC,EAAiBC,GAC9D,GAA+B,iBAApBD,EAA8B,CAEvC,GAAIH,EAAiB,CACnB,IAAIK,EAAqBN,EAAeI,GAEpCE,GAAsBA,IAAuBL,GAC/CC,EAAqBC,EAAiBG,EAAoBD,EAE9D,CAEA,IAAIE,EAAOV,EAAoBO,GAE3BN,IACFS,EAAOA,EAAKC,OAAOV,EAAsBM,KAM3C,IAHA,IAAIK,EAAgBnB,EAAWa,GAC3BO,EAAgBpB,EAAWc,GAEtBvD,EAAI,EAAGA,EAAI0D,EAAKxD,SAAUF,EAAG,CACpC,IAAIc,EAAM4C,EAAK1D,GAEf,KAAKiC,EAAcnB,IAAU0C,GAAaA,EAAU1C,IAAW+C,GAAiBA,EAAc/C,IAAW8C,GAAiBA,EAAc9C,IAAO,CAC7I,IAAIgD,EAAaZ,EAAyBK,EAAiBzC,GAE3D,IAEEiC,EAAeO,EAAiBxC,EAAKgD,EAC1B,CAAX,MAAOC,GAAI,CACf,CACF,CACF,CAEA,OAAOT,CACT,C,gCCpDArC,EAAOC,QA5BS,SAAS8C,EAAWC,EAAQC,EAAGC,EAAGC,EAAGC,EAAGN,EAAGO,GAOzD,IAAKN,EAAW,CACd,IAAIO,EACJ,QAAeC,IAAXP,EACFM,EAAQ,IAAIE,MACV,qIAGG,CACL,IAAIC,EAAO,CAACR,EAAGC,EAAGC,EAAGC,EAAGN,EAAGO,GACvBK,EAAW,GACfJ,EAAQ,IAAIE,MACVR,EAAOW,QAAQ,OAAO,WAAa,OAAOF,EAAKC,IAAa,MAExDzC,KAAO,qBACf,CAGA,MADAqC,EAAMM,YAAc,EACdN,CACR,CACF,C,mBC7CAtD,EAAOC,QAAU,CAAC,OAAS,U,mBCA3BD,EAAOC,QAAU,CAAC,QAAU,SAAS,KAAO,SAAS,SAAW,SAAS,OAAS,S,kBCAlFD,EAAOC,QAAU,CAAC,OAAS,S,mBCA3BD,EAAOC,QAAU,CAAC,QAAU,U,mBCA5BD,EAAOC,QAAU,CAAC,eAAiB,SAAS,MAAQ,S,mBCApDD,EAAOC,QAAU,CAAC,KAAO,UAAU,OAAS,U,mBCA5CD,EAAOC,QAAU,CAAC,YAAc,S,gCCChC,MAAM4D,EACY,oBAATC,KACHA,KACkB,oBAAXC,OACPA,YACgBR,EAEtB,IAAKM,EACH,MAAM,IAAIL,MACR,6EAIJ,IAAKK,EAAQG,gBACX,MAAM,IAAIR,MACR,uFAIJxD,EAAOC,QAAQ,EAAkB4D,EAAQG,e,kCCZ5B,IAAId,EAAE,mBAAoBzE,QAAQA,OAAOC,IAAIyE,EAAED,EAAEzE,OAAOC,IAAI,iBAAiB,MAAM0E,EAAEF,EAAEzE,OAAOC,IAAI,gBAAgB,MAAMoE,EAAEI,EAAEzE,OAAOC,IAAI,kBAAkB,MAAM2E,EAAEH,EAAEzE,OAAOC,IAAI,qBAAqB,MAAMuF,EAAEf,EAAEzE,OAAOC,IAAI,kBAAkB,MAAMwF,EAAEhB,EAAEzE,OAAOC,IAAI,kBAAkB,MAAMyF,EAAEjB,EAAEzE,OAAOC,IAAI,iBAAiB,MAAM0F,EAAElB,EAAEzE,OAAOC,IAAI,oBAAoB,MAAM2F,EAAEnB,EAAEzE,OAAOC,IAAI,yBAAyB,MAAM4F,EAAEpB,EAAEzE,OAAOC,IAAI,qBAAqB,MAAM6F,EAAErB,EAAEzE,OAAOC,IAAI,kBAAkB,MAAM8F,EAAEtB,EACpfzE,OAAOC,IAAI,uBAAuB,MAAM+F,EAAEvB,EAAEzE,OAAOC,IAAI,cAAc,MAAMgG,EAAExB,EAAEzE,OAAOC,IAAI,cAAc,MAAMiG,EAAEzB,EAAEzE,OAAOC,IAAI,eAAe,MAAMkG,EAAE1B,EAAEzE,OAAOC,IAAI,qBAAqB,MAAMmG,EAAE3B,EAAEzE,OAAOC,IAAI,mBAAmB,MAAMoG,EAAE5B,EAAEzE,OAAOC,IAAI,eAAe,MAClQ,SAASqG,EAAE9B,GAAG,GAAG,iBAAkBA,GAAG,OAAOA,EAAE,CAAC,IAAI+B,EAAE/B,EAAEgC,SAAS,OAAOD,GAAG,KAAK7B,EAAE,OAAOF,EAAEA,EAAElC,MAAQ,KAAKqD,EAAE,KAAKC,EAAE,KAAKvB,EAAE,KAAKmB,EAAE,KAAKZ,EAAE,KAAKkB,EAAE,OAAOtB,EAAE,QAAQ,OAAOA,EAAEA,GAAGA,EAAEgC,UAAY,KAAKd,EAAE,KAAKG,EAAE,KAAKI,EAAE,KAAKD,EAAE,KAAKP,EAAE,OAAOjB,EAAE,QAAQ,OAAO+B,GAAG,KAAK5B,EAAE,OAAO4B,EAAE,CAAC,CAAC,SAASE,EAAEjC,GAAG,OAAO8B,EAAE9B,KAAKoB,CAAC,CAACpE,EAAQkF,UAAUf,EAAEnE,EAAQmF,eAAef,EAAEpE,EAAQoF,gBAAgBlB,EAAElE,EAAQqF,gBAAgBpB,EAAEjE,EAAQsF,QAAQpC,EAAElD,EAAQ0B,WAAW2C,EAAErE,EAAQuF,SAAS1C,EAAE7C,EAAQwF,KAAKf,EAAEzE,EAAQ4B,KAAK4C,EAAExE,EAAQyF,OAAOtC,EAChfnD,EAAQ0F,SAAS1B,EAAEhE,EAAQ2F,WAAWvC,EAAEpD,EAAQ4F,SAAStB,EAAEtE,EAAQ6F,YAAY,SAAS7C,GAAG,OAAOiC,EAAEjC,IAAI8B,EAAE9B,KAAKmB,CAAC,EAAEnE,EAAQ8F,iBAAiBb,EAAEjF,EAAQ+F,kBAAkB,SAAS/C,GAAG,OAAO8B,EAAE9B,KAAKkB,CAAC,EAAElE,EAAQgG,kBAAkB,SAAShD,GAAG,OAAO8B,EAAE9B,KAAKiB,CAAC,EAAEjE,EAAQiG,UAAU,SAASjD,GAAG,MAAM,iBAAkBA,GAAG,OAAOA,GAAGA,EAAEgC,WAAW9B,CAAC,EAAElD,EAAQkG,aAAa,SAASlD,GAAG,OAAO8B,EAAE9B,KAAKqB,CAAC,EAAErE,EAAQmG,WAAW,SAASnD,GAAG,OAAO8B,EAAE9B,KAAKH,CAAC,EAAE7C,EAAQoG,OAAO,SAASpD,GAAG,OAAO8B,EAAE9B,KAAKyB,CAAC,EAC1dzE,EAAQyB,OAAO,SAASuB,GAAG,OAAO8B,EAAE9B,KAAKwB,CAAC,EAAExE,EAAQqG,SAAS,SAASrD,GAAG,OAAO8B,EAAE9B,KAAKG,CAAC,EAAEnD,EAAQsG,WAAW,SAAStD,GAAG,OAAO8B,EAAE9B,KAAKgB,CAAC,EAAEhE,EAAQuG,aAAa,SAASvD,GAAG,OAAO8B,EAAE9B,KAAKI,CAAC,EAAEpD,EAAQwG,WAAW,SAASxD,GAAG,OAAO8B,EAAE9B,KAAKsB,CAAC,EAC1OtE,EAAQyG,mBAAmB,SAASzD,GAAG,MAAM,iBAAkBA,GAAG,mBAAoBA,GAAGA,IAAIH,GAAGG,IAAIoB,GAAGpB,IAAIgB,GAAGhB,IAAII,GAAGJ,IAAIsB,GAAGtB,IAAIuB,GAAG,iBAAkBvB,GAAG,OAAOA,IAAIA,EAAEgC,WAAWP,GAAGzB,EAAEgC,WAAWR,GAAGxB,EAAEgC,WAAWf,GAAGjB,EAAEgC,WAAWd,GAAGlB,EAAEgC,WAAWX,GAAGrB,EAAEgC,WAAWL,GAAG3B,EAAEgC,WAAWJ,GAAG5B,EAAEgC,WAAWH,GAAG7B,EAAEgC,WAAWN,EAAE,EAAE1E,EAAQ0G,OAAO5B,C,oCCXjU/E,EAAOC,QAAU,EAAjB,K,qWCHF,MAAM2G,EAAQ,CACVC,QAAS,UACTC,UAAW,aAETC,EACS,WAOTC,EAAc,CAACC,EAASC,KAC1B,MAAMC,EAAM,IAAI3D,MAAMyD,GACtB,OAAOvH,OAAO0H,OAAOD,EAAK,OAAF,UACjBD,EAAU,CACbG,MAAOH,EAAWG,MAAS,GAAEF,EAAIE,gCAAgCH,EAAWG,QAAUF,EAAIE,QAC5F,EAUN,SAASC,EAAcC,GACnB,OAAOA,EAAM9H,WAAWkE,QAAQ,mBAAoB,KACxD,CAN8C,IAAI6D,IAOlD,MAAMC,EACFC,YAAYzG,EAAM0G,EAAU,CAAC,GACzBC,KAAKC,SAAU,EAEfD,KAAKE,eAAgB,EACrBF,KAAK3G,KAAOA,EAAOxC,OAAOC,IAAIuC,GAAQxC,OAAO,SAC7CmJ,KAAKD,QAAUA,CAWnB,CAIAlI,WACI,OAAO6H,EAAcM,KAAK3G,KAC9B,EAEJ,SAAS8G,EAAY9G,EAAM0G,GACvB,OAAO,IAAIF,EAAWxG,EAAM0G,EAChC,CAIA,SAASK,EAAST,GACd,MAAO,CAAEA,QAAOS,UAAU,EAC9B,CAEA,MAAMC,EAA0BF,EAAY,MAKtCG,EAAU,oBAOVC,EAAW,qBACjB,SAASC,EAAWb,GAChB,OAAOA,EAAMO,cAAgBP,EAAMtG,KAAOxC,OAAOC,IAAI6I,EAAM9H,WAC/D,CAgEA,SAAS4I,EAAWC,EAASC,EAAcC,EAAOC,EAAOpB,GACrD,MAAO,CACHiB,UACAC,eACAC,QACAC,MAAOA,EAAQ,QAAKlF,EACpB8D,QAER,CAgCA,MAAMqB,EACFhB,YAAYiB,EAAqBC,GAI7BhB,KAAKiB,QAAU,IAAIrB,IACnBI,KAAKkB,aAAe,IAAItB,IACpBmB,GACAA,EAAoBI,SAASC,GAAapB,KAAKqB,SAASD,KAE5DpB,KAAKgB,SAAWA,EAChBhB,KAAKqB,SAAS,CAAEC,QAASjB,EAAUkB,SAAUvB,MACjD,CACAwB,IAAIC,GACA,IAAIC,EAAIC,EACR,IAAIhC,EACAS,GAAW,EACXS,GAAQ,EACiB,iBAAlBY,EACP9B,EAAQ8B,EAEH,UAAWA,GAChB9B,EAAQ8B,EAAc9B,MACtBS,EAAWqB,EAAcrB,SACzBS,GAAkC,QAAxBa,EAAK/B,EAAMI,eAA4B,IAAP2B,OAAgB,EAASA,EAAGb,SAAU,GAGhFlB,EAAQ8B,EAEZ9B,EAAQa,EAAWb,GACnB,MAAMiC,EAAS5B,KAAK6B,UAAUlC,GAC9B,OAAKiC,IAAoC,QAAxBD,EAAK3B,KAAKgB,gBAA6B,IAAPW,OAAgB,EAASA,EAAGE,UAAUlC,IAC5EK,KAAKgB,SAASQ,IAAIC,IAExBG,GAAUxB,EAEPS,EACO,GAGJ,MAlGnB,SAAoBe,EAAQjC,GACxB,QAAehE,IAAXiG,EAAsB,CACtB,MAAMvI,EAAOqG,EAAcC,GAC3B,MAAMP,EAAa,oBAAmB/F,KAAS,CAC3CF,KAAMgG,GAEd,CACJ,CA6FQ2C,CAAWF,EAAQjC,GACZK,KAAK+B,QAAQH,EAAQjC,EAAOS,GACvC,CACA4B,UAAUC,GACN,MAAMC,EAAS,CAAC,EAChB,IAAK,MAAMjK,KAAOgK,EACVnK,OAAOC,UAAUf,eAAekB,KAAK+J,EAAMhK,KAC3CiK,EAAOjK,GAAO+H,KAAKwB,IAAIS,EAAKhK,KAGpC,OAAOiK,CACX,CACAL,UAAUlC,GAEN,OADeK,KAAKiB,QAAQO,IAAI7B,EAEpC,CACAwC,IAAIxC,GACA,QAASK,KAAK6B,UAAUrB,EAAWb,GACvC,CACAyC,YAAYC,EAAM1C,GACd,MAAM2C,EAAW9B,EAAWb,GAC5B,IAAKK,KAAK6B,UAAUS,GAAW,CAC3B,MAAMV,EAASS,EAAKR,UAAUS,GAC1BV,IACA5B,KAAKiB,QAAQsB,IAAID,EAAUV,GAC3B5B,KAAKkB,aAAaqB,IAAIX,EAAQtB,GAEtC,CACJ,CACAkC,SAASZ,GACL,OAAO5B,KAAKkB,aAAaM,IAAII,EACjC,CACAP,SAASD,GAKL,OAtKR,SAAmCA,GAC/B,GAAgC,iBAArBA,EAASE,QAChB,OAEJ,MAAMmB,EAAerB,EAASE,QAAQvB,QACtC,IAAKqB,EAASE,QAAQpB,eAAiBuC,GAAgBA,EAAa5B,QAAUO,EAASP,MACnF,MAAMzB,EAAa,SAAQgC,EAASE,QAAQzJ,qCAAsC,CAC9EsB,KAjGO,eAkGPsG,MAAO2B,EAASsB,SAG5B,CA0JQC,CAA0BvB,GACnBpB,KAAK4C,gBAAgBxB,EAChC,CAIAwB,gBAAgBxB,GACZ,IAAIM,EACJ,MAAM/B,EAAQa,EAAWY,EAASE,SAC5BM,EAtHd,SAA0BR,GACtB,IAAIV,EACAC,EACAC,EAAQ5B,EAAMC,QAoBlB,MAnBI,eAAgBmC,GAChBV,EAAWuB,GAASb,EAASyB,WAAWZ,GACpC,SAAUb,IACVT,EAAeS,EAASa,MAExBb,EAASR,QACTA,EAAQQ,EAASR,QAGhB,aAAcQ,IAEnBV,EAAWuB,GAAS,IAAIb,EAAS0B,SAASb,GACtC,SAAUb,IACVT,EAAeS,EAASa,MAExBb,EAASR,QACTA,EAAQQ,EAASR,QAGlBH,EAAWC,EAASC,EAAcC,GAAO,EAAOQ,EAASsB,QACpE,CA8FuBK,CAAiB3B,GAC1B4B,EA9Fd,SAAyB5B,GACrB,MAAI,aAAcA,EACPA,EAASG,SAEbjB,CACX,CAyFsB2C,CAAgB7B,GAC9B,GAAKA,EAASE,QAAQpB,gBAAsD,QAAnCwB,EAAKN,EAASE,QAAQvB,eAA4B,IAAP2B,OAAgB,EAASA,EAAGb,QAAWO,EAASP,MAAO,CAEvI,IAAIqC,EAAclD,KAAK6B,UAAUlC,GACjC,GAAIuD,GAEA,QAA0BvH,IAAtBuH,EAAYrC,MACZ,MAAMzB,EAAa,4BAA2BM,EAAcC,KAAU,CAClExG,KAhRP,aAiROsG,MAAO2B,EAASsB,eAKxBQ,EAAczC,OAAW9E,EAAW,CAAC,EAAGyF,EAASR,OAAS5B,EAAMC,SAAS,EAAMmC,EAASsB,SACxF1C,KAAKiB,QAAQsB,IAAI5C,EAAOuD,GACxBlD,KAAKkB,aAAaqB,IAAIW,EAAa5C,GAEvC4C,EAAYrC,MAAMrJ,KAAKoK,EAC3B,MAEI5B,KAAKiB,QAAQsB,IAAI5C,EAAOiC,GAE5B5B,KAAKkB,aAAaqB,IAAIX,EAAQoB,EAClC,CACAG,YAAYvB,GACR,OAAO5B,KAAKgC,UAAUJ,EAAOjB,aACjC,CACAoB,QAAQH,EAAQjC,EAAOS,GACnB,IAAI4C,EAAQhD,KAAKwC,SAASZ,GAE1B,GAzKR,SAA2BA,EAAQjC,EAAOqD,GACtC,GAAIA,IAAUzC,EAAU,CACpB,MAAMlH,EAAOqG,EAAcC,GAC3B,MAAMP,EAAa,qBAAoB/F,KAAS,CAC5CF,KApIM,cAqINsG,MAAOmC,EAAOnC,OAEtB,CACJ,CAgKQ2D,CAAkBxB,EAAQjC,EAAOqD,GAC7BA,IAAU1C,EACV,OAAO0C,EAEX,GAAIpB,EAAOf,MACPb,KAAKkB,aAAaqB,IAAIX,EAAQrB,GAE9ByC,EAAQpB,EAAOf,MAAMwC,KAAKC,GAAQtD,KAAK+B,QAAQuB,EAAK3D,GAAO,SAE1D,CAEDK,KAAKkB,aAAaqB,IAAIX,EAAQrB,GAC9B,IACIyC,EAAQpB,EAAOlB,QAAQV,KAAKmD,YAAYvB,GAc5C,CAZA,MAAO1G,GAEH,GADA8E,KAAKkB,aAAaqB,IAAIX,EAAQtB,GAC1BF,GAAYlF,EAAE/B,OAASgG,EACvB,OAAO,MA9O3B,SAA6BQ,EAAOzE,GAChC,MAAM7B,EAAOqG,EAAcC,GAW3B,MAVKzE,EAAEqI,oBAKHrI,EAAEmE,SAAY,MAAKhG,KAJnB6B,EAAEqI,qBAAsB,EACxBrI,EAAEmE,QAAW,GAAEnE,EAAEmE,eAAehG,MAKhCvB,OAAOd,eAAekB,KAAKgD,EAAG,UAA+B,iBAAZA,EAAEuE,QACnDvE,EAAEuE,MAAQvE,EAAEuE,MAAM1D,QAAQ,QAAU,GAAEb,EAAE7B,SAAS6B,EAAEmE,cAEjDnE,CACV,CAqOgBsI,CAAoB7D,EAAO7H,OAAO0H,OAAOtE,EAAG,CACxCuE,OAAQmC,EAAOnC,OAAS,wBAAwBgE,KAAKvI,EAAEuE,OACjDvE,EAAEuE,MACD,GAAEvE,EAAEuE,gCAAgCmC,EAAOnC,OAAS,OAEnE,CACJ,CAEA,OADAO,KAAKkB,aAAaqB,IAAIX,EAAQoB,GACvBA,CACX,EAGJ,MAAMU,EACSvD,EAAY,sBAC3B,MAAMwD,UAAuB7C,EACzBhB,YAAY8D,EAAM5C,GACd6C,WAAMlI,EAAWqF,GACjBhB,KAAK4D,KAAOA,EACZ5D,KAAKqB,SAAS,CAAEC,QAASjB,EAAUkB,SAAUvB,OAC7CA,KAAKqB,SAAS,CAAEC,QAASoC,EAA6BnC,UAAU,GACpE,CAMAM,UAAUlC,GAEN,OADekE,MAAMhC,UAAUlC,IAIxBK,KAAK4D,KAAK/B,UAAUlC,EAC/B,CACA6C,SAASZ,GACL,OAAI5B,KAAKkB,aAAaiB,IAAIP,GACf5B,KAAKkB,aAAaM,IAAII,GAE7BA,EAAOhB,QAAU5B,EAAME,WAAc0C,EAAOlB,QAGzCJ,EAFIN,KAAK4D,KAAKpB,SAASZ,EAGlC,CAMAuB,YAAYvB,GACR,OAAIA,EAAOhB,QAAU5B,EAAMC,QAChB4E,MAAMV,YAAYvB,GAEtBiC,MAAMV,YAAYjL,KAAK8H,KAAK4D,KAAMhC,EAC7C,CACAG,QAAQH,EAAQjC,EAAOS,GACnB,OAAIwB,EAAOhB,QAAU5B,EAAMC,QAChB4E,MAAM9B,QAAQH,EAAQjC,EAAOS,GAEjCyD,MAAM9B,QAAQ7J,KAAK8H,KAAK4D,KAAMhC,EAAQjC,EAAOS,EACxD,EAGJ,SAAS0D,EAAgBC,GACrB,OAAO,IAAIjD,EAAUiD,EACzB,CAEA,MAAMC,EAAsB,sBAC5B,SAASC,GAAO,UAAEF,EAAS,QAAEG,EAAO,KAAEjC,EAAO,CAAC,IAC1C,OAAQkC,GACGrM,OAAO0H,OAAO2E,EAAQ,CACzB,CAACH,GAAsB,CACnBD,YACA9B,OACAiC,QAASA,EACT7K,KAAM8K,EAAO9K,KAEb+K,GAAK,GAAED,EAAO9K,QAAQgL,KAAKC,aAI3C,CAEA,MAAMC,EAAoBnM,KACbA,EAAOoM,WAGdC,EAAuBrM,IACzB,IAAIsM,EACJ,GAAIH,EAAiBnM,GAAS,CAC1B,MAAMuM,EAAOvM,EAAOoM,WAAWR,GAC/BU,EAAmB,OAAH,UAAQC,GACxBD,EAAiBX,UAAYW,EAAiBX,UAAUjJ,OAAO1C,EAAO2L,WAAa,IAEnF,MAAMa,EAAeF,EAAiBR,SAAW,GACjDQ,EAAiBR,QAAUU,EAAa9J,OAAO1C,EAAO8L,SAAW,GACrE,MAEIQ,EAAmBtM,EAAO4L,GAE9B,OAAOU,CAAgB,EAGrBG,EAAiBzM,IAEK,IAApB0M,QAAQ1M,KAGR4L,KAAuB5L,GAGvB,eAAgBA,GACTyM,EAAczM,EAAOoM,aAK9BO,EAAiBC,IACnB,MAAM9C,EAAS,GACT+C,EAAuB,IAAIC,IAC3BC,EAAyB,IAAID,IAC7BE,EAAsBhN,IACxB,IAAKyM,EAAczM,GACf,MAAM,IAAIwD,MAPO,uDASrB,MAAM8I,EAAmBD,EAAoBrM,GACxC6M,EAAqB9C,IAAIuC,EAAiBN,MAO3Ca,EAAqBI,IAAIX,EAAiBN,IAC1Ce,EAAuBE,IAAIX,EAAiBrL,MAExCqL,EAAiBR,SACjBQ,EAAiBR,QAAQ/C,SAASmE,IAC9BF,EAAmBE,EAAK,IAGhCpD,EAAO1K,KAAKY,GAChB,EAKJ,OAHA4M,EAAQ7D,SAASoE,IACbH,EAAmBG,EAAI,IAEpBrD,CAAM,EAkCjB,SAASsD,EAAqBC,EAAW1B,GACrC,MAAM2B,EAAiB,IAAI/B,EAAe8B,GAM1C,OALI1B,GACAA,EAAU5C,SAASC,IACfsE,EAAerE,SAASD,EAAS,IAGlCsE,CACX,CAGA,SAASpE,EAAQqE,GACb,OAAOA,CACX,C,mBCpgBA,MAAMC,EAA8B,iBAAhBC,aAA4BA,aACnB,mBAApBA,YAAYC,IAAqBD,YAAcE,KAYlDC,EAAeC,GAAOA,GAAO5B,KAAK6B,IAAI,EAAG,GAAKC,WAClDF,GAAO5B,KAAK6B,IAAI,EAAG,IAAME,YACzBH,GAAO5B,KAAK6B,IAAI,EAAG,IAAMG,YACzBJ,GAAOK,OAAOC,iBAAmBC,EACjC,KAEF,MAAMA,UAAkB/O,MACtBqI,YAAa2G,GACX5C,MAAM4C,GACNzG,KAAK0G,KAAK,EACZ,EAGF,MAAMC,EACJ7G,YAAamG,GACX,GAAY,IAARA,EACF,MAAO,GAET,MAAMW,EAAYZ,EAAaC,GAC/BjG,KAAK6G,KAAO,IAAID,EAAUX,GAC1BjG,KAAK3I,OAAS,CAChB,CACAG,KAAMkF,GACJsD,KAAK6G,KAAK7G,KAAK3I,UAAYqF,CAC7B,CACAoK,MACE,OAAO9G,KAAK6G,OAAO7G,KAAK3I,OAC1B,EA0QFe,EAAOC,QAvQP,MACEyH,YAAaC,EAAU,CAAC,GACtB,MAAM,IACJkG,EAAM,EAAC,IACPc,EAAG,cACHC,EAAgB,EAAC,eACjBC,EAAc,WACdC,EAAU,OACVC,EAAM,MACNC,GACErH,EAEJC,KAAKiG,IAAMA,EAEX,MAAMW,EAAYX,EAAMD,EAAaC,GAAOxO,MAY5CuI,KAAKqH,OAAS,IAAIzH,IAClBI,KAAKsH,QAAU,IAAI7P,MAAMwO,GAAKS,KAAK,MACnC1G,KAAKuH,QAAU,IAAI9P,MAAMwO,GAAKS,KAAK,MACnC1G,KAAKwH,KAAO,IAAIZ,EAAUX,GAC1BjG,KAAKyH,KAAO,IAAIb,EAAUX,GAC1BjG,KAAK0H,KAAO,EACZ1H,KAAK2H,KAAO,EACZ3H,KAAK4H,KAAO,IAAIjB,EAAMV,GACtBjG,KAAK6H,YAAc,EACnB7H,KAAKyG,KAAO,EAEZzG,KAAKkH,aAAeA,KAAgBE,EACpCpH,KAAKiH,iBAAmBA,EACxBjH,KAAKgH,cAAgBA,EACrBhH,KAAK+G,IAAMA,GAAOI,GAAU,EACxBnH,KAAK+G,KAMP/G,KAAK8H,uBAET,CAEAA,wBACE9H,KAAK+H,KAAO,IAAIvB,EAAUxG,KAAKiG,KAC/BjG,KAAKgI,OAAS,IAAIxB,EAAUxG,KAAKiG,KAEjCjG,KAAKiI,WAAa,CAACC,EAAOnB,KACxB/G,KAAKgI,OAAOE,GAAiB,IAARnB,EAAYnB,EAAKE,MAAQ,EAC9C9F,KAAK+H,KAAKG,GAASnB,CAAG,EAGxB/G,KAAKmI,cAAiBD,IACpBlI,KAAKgI,OAAOE,GAA8B,IAArBlI,KAAK+H,KAAKG,GAAetC,EAAKE,MAAQ,CAAC,EAK9D,IAAIsC,EAAY,EAChB,MAAMC,EAAS,KACb,MAAM3L,EAAIkJ,EAAKE,MACf,GAAI9F,KAAKgH,cAAgB,EAAG,CAC1BoB,EAAY1L,EACZ,MAAMI,EAAIwL,YAAW,IAAMF,EAAY,GAAGpI,KAAKgH,eAE3ClK,EAAEyL,OACJzL,EAAEyL,OAEN,CACA,OAAO7L,CAAC,EAGVsD,KAAKwI,QAAWN,GACc,IAArBlI,KAAK+H,KAAKG,IAAuC,IAAvBlI,KAAKgI,OAAOE,KACzCE,GAAaC,KAAYrI,KAAKgI,OAAOE,GAASlI,KAAK+H,KAAKG,EAEhE,CACAC,cAAeD,GAAQ,CACvBD,WAAYC,EAAOnB,GAAM,CACzByB,QAASN,GAAS,OAAO,CAAM,CAE/B3F,IAAKhG,EAAGQ,GAAG,IACTgK,EAAM/G,KAAK+G,KACT,CAAC,GACH,IAAImB,EAAsB,IAAdlI,KAAKyG,UAAa9K,EAAYqE,KAAKqH,OAAO7F,IAAIjF,GAwB1D,YAvBcZ,IAAVuM,GAEFA,EAAQlI,KAAKyI,WACbzI,KAAKsH,QAAQY,GAAS3L,EACtByD,KAAKuH,QAAQW,GAASnL,EACtBiD,KAAKqH,OAAO9E,IAAIhG,EAAG2L,GACnBlI,KAAKwH,KAAKxH,KAAK2H,MAAQO,EACvBlI,KAAKyH,KAAKS,GAASlI,KAAK2H,KACxB3H,KAAK2H,KAAOO,EACZlI,KAAKyG,SAID1J,IADWiD,KAAKuH,QAAQW,KAE1BlI,KAAKuH,QAAQW,GAASnL,GAExBiD,KAAK0I,WAAWR,IAEN,IAARnB,GAA0B,IAAb/G,KAAK+G,KAAc/G,KAAK+H,MACvC/H,KAAK8H,wBAGP9H,KAAKiI,WAAWC,EAAOnB,GAChB/G,IACT,CAEAyI,WACE,OAAkB,IAAdzI,KAAKyG,KACAzG,KAAK2H,KAEV3H,KAAKyG,OAASzG,KAAKiG,KAAoB,IAAbjG,KAAKiG,IAC1BjG,KAAK2I,OAAM,GAEK,IAArB3I,KAAK4H,KAAKvQ,OACL2I,KAAK4H,KAAKd,MAGZ9G,KAAK6H,aACd,CAEAf,MACE,GAAI9G,KAAKyG,KAAM,CACb,MAAMmC,EAAM5I,KAAKuH,QAAQvH,KAAK0H,MAE9B,OADA1H,KAAK2I,OAAM,GACJC,CACT,CACF,CAEAD,MAAOf,GACL,MAAMF,EAAO1H,KAAK0H,KACZnL,EAAIyD,KAAKsH,QAAQI,GAUvB,OARIE,IACF5H,KAAKsH,QAAQI,GAAQ,KACrB1H,KAAKuH,QAAQG,GAAQ,KACrB1H,KAAK4H,KAAKpQ,KAAKkQ,IAEjB1H,KAAK0H,KAAO1H,KAAKwH,KAAKE,GACtB1H,KAAKqH,OAAOwB,OAAOtM,GACnByD,KAAKyG,OACEiB,CACT,CAEAvF,IAAK5F,GACH,MAAM2L,EAAQlI,KAAKqH,OAAO7F,IAAIjF,GAC9B,YAAcZ,IAAVuM,IACGlI,KAAKwI,QAAQN,EAKtB,CAGAY,KAAMvM,GAAG,WAAE2K,EAAalH,KAAKkH,YAAe,CAAC,GAC3C,MAAMgB,EAAQlI,KAAKqH,OAAO7F,IAAIjF,GAC9B,QAAcZ,IAAVuM,IAAwBhB,IAAelH,KAAKwI,QAAQN,IACtD,OAAOlI,KAAKuH,QAAQW,EAExB,CAEA1G,IAAKjF,GAAG,WACN2K,EAAalH,KAAKkH,WAAU,eAC5BD,EAAiBjH,KAAKiH,gBACpB,CAAC,GACH,MAAMiB,EAAQlI,KAAKqH,OAAO7F,IAAIjF,GAC9B,QAAcZ,IAAVuM,EAAqB,CACvB,MAAMlF,EAAQhD,KAAKuH,QAAQW,GAC3B,OAAIlI,KAAKwI,QAAQN,IACflI,KAAK6I,OAAOtM,GACL2K,EAAalE,OAAQrH,IAE5BqE,KAAK0I,WAAWR,GACZjB,GACFjH,KAAKmI,cAAcD,GAEdlF,EAEX,CACF,CAEA+F,QAASpM,EAAGD,GACVsD,KAAKyH,KAAK/K,GAAKC,EACfqD,KAAKwH,KAAK7K,GAAKD,CACjB,CAEAgM,WAAYR,GASNA,IAAUlI,KAAK2H,OACbO,IAAUlI,KAAK0H,KACjB1H,KAAK0H,KAAO1H,KAAKwH,KAAKU,GAEtBlI,KAAK+I,QAAQ/I,KAAKyH,KAAKS,GAAQlI,KAAKwH,KAAKU,IAE3ClI,KAAK+I,QAAQ/I,KAAK2H,KAAMO,GACxBlI,KAAK2H,KAAOO,EAEhB,CAEAW,OAAQtM,GACN,IAAIyM,GAAU,EACd,GAAkB,IAAdhJ,KAAKyG,KAAY,CACnB,MAAMyB,EAAQlI,KAAKqH,OAAO7F,IAAIjF,QAChBZ,IAAVuM,IACFc,GAAU,EACQ,IAAdhJ,KAAKyG,KACPzG,KAAKiJ,SAELjJ,KAAKqH,OAAOwB,OAAOtM,GACnByD,KAAKsH,QAAQY,GAAS,KACtBlI,KAAKuH,QAAQW,GAAS,KAClBA,IAAUlI,KAAK2H,KACjB3H,KAAK2H,KAAO3H,KAAKyH,KAAKS,GACbA,IAAUlI,KAAK0H,KACxB1H,KAAK0H,KAAO1H,KAAKwH,KAAKU,IAEtBlI,KAAKwH,KAAKxH,KAAKyH,KAAKS,IAAUlI,KAAKwH,KAAKU,GACxClI,KAAKyH,KAAKzH,KAAKwH,KAAKU,IAAUlI,KAAKyH,KAAKS,IAE1ClI,KAAKyG,OACLzG,KAAK4H,KAAKpQ,KAAK0Q,IAGrB,CACA,OAAOc,CACT,CAEAC,QACEjJ,KAAKqH,OAAO4B,QACZjJ,KAAKuH,QAAQb,KAAK,MAClB1G,KAAKsH,QAAQZ,KAAK,MACd1G,KAAK+H,OACP/H,KAAK+H,KAAKrB,KAAK,GACf1G,KAAKgI,OAAOtB,KAAK,IAEnB1G,KAAK0H,KAAO,EACZ1H,KAAK2H,KAAO,EACZ3H,KAAK6H,YAAc,EACnB7H,KAAK4H,KAAKvQ,OAAS,EACnB2I,KAAKyG,KAAO,CACd,E,4HC5SF,MAAMyC,EAAmBC,IACrB,MAAMC,GAAMC,EAAAA,EAAAA,QAAOF,GAInB,OAHKG,IAAaF,EAAIG,QAASJ,KAC3BC,EAAIG,QAAUJ,GAEXC,EAAIG,OAAO,EAWhBC,EAA4DC,EAAAA,e,oCCjBlE,IAAIC,EAASC,EAAQ,MAEjBjS,EAAUiS,EAAQ,MAElBC,EAAcD,EAAQ,MAEtBE,EAAQF,EAAQ,MAgBpBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUrO,EAAGC,GAStC,QARU,IAAND,IACFA,EAAI,SAGI,IAANC,IACFA,EAAI,IAGF5D,EAAQ2D,GACV,OAAOA,EAAEP,OAAOQ,GAGlB,GAAIsO,EAAYvO,GAAI,CAGlB,IAFA,IAAIyO,EAAYD,EAAM,EAAGxO,EAAEhE,OAAQgE,GAE1BlE,EAAI,EAAGA,EAAImE,EAAEjE,OAAQF,IAC5B2S,EAAUtS,KAAK8D,EAAEnE,IAGnB,OAAO2S,CACT,CAEA,OAAOzO,EAAIC,CACb,G,oCC9CA,IAAIoO,EAASC,EAAQ,MAEjBI,EAAUJ,EAAQ,MActBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUrO,EAAGC,QAC5B,IAAND,IACFA,EAAI,SAGI,IAANC,IACFA,EAAI,IAKN,IAFA,IAAI4G,EAAS,GAEJ/K,EAAI,EAAGA,EAAIkE,EAAEhE,OAAQF,IACxB4S,EAAQ1O,EAAElE,GAAImE,GAAK,GACrB4G,EAAO1K,KAAK6D,EAAElE,IAIlB,OAAO+K,CACT,G,mCClCA,IAAIwH,EAASC,EAAQ,MAgBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAIC,QAC3B,IAARA,IACFA,EAAM,IAGR,IAAK,IAAI9S,EAAI,EAAGA,EAAI8S,EAAI5S,OAAQF,IAC9B6S,EAAGC,EAAI9S,GAAIA,EAAG8S,EAElB,G,oCCxBA,IAAIP,EAASC,EAAQ,MAgBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAIC,QAC3B,IAARA,IACFA,EAAM,IAGR,IAAK,IAAI9S,EAAI,EAAGA,EAAI8S,EAAI5S,OAAQF,IAC9B,GAAI6S,EAAGC,EAAI9S,GAAIA,EAAG8S,GAChB,OAAOA,EAAI9S,EAGjB,G,oCC1BA,IAAIuS,EAASC,EAAQ,MAgBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAIC,QAC3B,IAARA,IACFA,EAAM,IAGR,IAAK,IAAI9S,EAAI,EAAGA,EAAI8S,EAAI5S,OAAQF,IAC9B,GAAI6S,EAAGC,EAAI9S,GAAIA,EAAG8S,GAChB,OAAO9S,EAIX,OAAQ,CACV,G,oCC5BA,IAAIyS,EAAcD,EAAQ,MAqC1BvR,EAAOC,QAxBO,SAAS6R,EAAQD,QACjB,IAARA,IACFA,EAAM,IAKR,IAFA,IAAI/H,EAAS,GAEJ/K,EAAI,EAAGA,EAAI8S,EAAI5S,OAAQF,IAAK,CACnC,IAAIkE,EAAI4O,EAAI9S,GAEZ,GAAIyS,EAAYvO,GAGd,IAFA,IAAI8O,EAASD,EAAQ7O,GAEZ+O,EAAI,EAAGA,EAAID,EAAO9S,OAAQ+S,IACjClI,EAAO1K,KAAK2S,EAAOC,SAGrBlI,EAAO1K,KAAK6D,EAEhB,CAEA,OAAO6G,CACT,C,oCCnCA,IAAIwH,EAASC,EAAQ,MAEjBU,EAAWV,EAAQ,MAcvBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUvF,EAAQmG,GAK3C,YAJW,IAAPA,IACFA,EAAK,IAGHD,EAASC,GACJA,EAAGP,QAAQ5F,GAGb1M,MAAMM,UAAUgS,QAAQ7R,KAAKoS,EAAInG,EAC1C,G,oCC1BA,IAAIuF,EAASC,EAAQ,MAerBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAIC,QAC3B,IAARA,IACFA,EAAM,IAMR,IAHA,IAAIM,EAAMN,EAAI5S,OACV6K,EAAS,IAAIzK,MAAM8S,GAEdpT,EAAI,EAAGA,EAAIoT,EAAKpT,IACvB+K,EAAO/K,GAAK6S,EAAGC,EAAI9S,GAAIA,EAAG8S,GAG5B,OAAO/H,CACT,G,oCC5BA,IAAIwH,EAASC,EAAQ,MAEjBU,EAAWV,EAAQ,MAiBvBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUc,EAAWC,EAASC,GAKvD,YAJa,IAATA,IACFA,EAAO,IAGFL,EAASK,GAAQA,EAAKb,MAAMW,EAAWC,GAAWhT,MAAMM,UAAU8R,MAAM3R,KAAKwS,EAAMF,EAAWC,EACvG,G,oCCzBA,IAAI/S,EAAUiS,EAAQ,MAElBC,EAAcD,EAAQ,MAY1BvR,EAAOC,QAAU,SAAUuQ,GACzB,OAAIlR,EAAQkR,GACHA,EAGLgB,EAAYhB,GACPnR,MAAMM,UAAU8R,MAAM3R,KAAK0Q,GAG7B,CAACA,EACV,C,gCCdAxQ,EAAOC,QAAU,SAAU4R,QACb,IAARA,IACFA,EAAM,IAKR,IAFA,IAAI/H,EAAS,GAEJ/K,EAAI,EAAGA,EAAI8S,EAAI5S,OAAQF,KACE,IAA5B+K,EAAO6H,QAAQE,EAAI9S,KACrB+K,EAAO1K,KAAKyS,EAAI9S,IAIpB,OAAO+K,CACT,C,oCCxBA,IAAIxK,EAAUiS,EAAQ,MAgBtBvR,EAAOC,QAAU,WACf,IAAK,IAAIsS,EAAOvT,UAAUC,OAAQuT,EAAU,IAAInT,MAAMkT,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAClFD,EAAQC,GAAQzT,UAAUyT,GAG5B,OAAInT,EAAQkT,EAAQ,IACX9S,OAAO0H,OAAO5H,MAAME,OAAQ,CAAC,IAAIgD,OAAO8P,IAG1C9S,OAAO0H,OAAO5H,MAAME,OAAQ,CAAC,CAAC,GAAGgD,OAAO8P,GACjD,C,gCCfAxS,EAAOC,QAAU,SAAU4E,GACzB,OAAO,WACL,OAAOA,CACT,CACF,C,gCCDA7E,EAAOC,QAAU,WACf,IAAK,IAAIsS,EAAOvT,UAAUC,OAAQyT,EAAM,IAAIrT,MAAMkT,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC9EC,EAAID,GAAQzT,UAAUyT,GAGxB,OAAO,WAIL,IAHA,IAAInO,EAAIoO,EAAIzT,OAAS,EACjB6K,EAAS4I,EAAIpO,GAAG9E,MAAMkT,EAAK1T,WAEtBD,EAAIuF,EAAI,EAAGvF,GAAK,EAAGA,IAC1B+K,EAAS4I,EAAI3T,GAAG+K,GAGlB,OAAOA,CACT,CACF,C,gCCPA9J,EAAOC,QAAU,SAAUmB,EAAOwQ,GAChC,OAAO,SAASe,IACd,IAAK,IAAIJ,EAAOvT,UAAUC,OAAQwE,EAAO,IAAIpE,MAAMkT,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC/EhP,EAAKgP,GAAQzT,UAAUyT,GAGzB,OAAIhP,EAAKxE,QAAUmC,EACVwQ,EAAGpS,MAAMoI,KAAMnE,GAGjB,WACL,IAAK,IAAImP,EAAQ5T,UAAUC,OAAQ4T,EAAU,IAAIxT,MAAMuT,GAAQE,EAAQ,EAAGA,EAAQF,EAAOE,IACvFD,EAAQC,GAAS9T,UAAU8T,GAG7B,OAAOH,EAAQnT,MAAMoI,KAAMnE,EAAKf,OAAOmQ,GACzC,CACF,CACF,C,oCCxCA,IAAIvB,EAASC,EAAQ,MAWrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUyB,EAAMnB,GACzC,IAAIoB,EAEJ,SAAS3P,IACP,IAAI4P,EAAQrL,KAERnE,EAAOzE,UACXkU,aAAaF,GACbA,EAAU9C,YAAW,WACnB,OAAO0B,EAAGpS,MAAMyT,EAAOxP,EACzB,GACAsP,EACF,CAMA,OAJA1P,EAAE8P,OAAS,WACT,OAAOD,aAAaF,EACtB,EAEO3P,CACT,G,gCCjBArD,EAAOC,QAAU,SAAU4E,GACzB,OAAOA,CACT,C,oCCfA,IAAIyM,EAASC,EAAQ,MAqBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUvO,EAAWqQ,EAAQC,GACtD,OAAO,WACL,OAAOtQ,EAAUvD,WAAM,EAAQR,WAAaoU,EAAO5T,WAAM,EAAQR,WAAaqU,EAAQ7T,WAAM,EAAQR,UACtG,CACF,G,gCCtBAgB,EAAOC,QAAU,WAAa,C,gCCO9BD,EAAOC,QAAU,SAAUoL,GACzB,QAASA,GAAQhM,MAAMC,QAAQ+L,EACjC,C,oCCZA,IAAI/L,EAAUiS,EAAQ,MAElBU,EAAWV,EAAQ,MAEnBxH,EAAMwH,EAAQ,MAalBvR,EAAOC,QAAU,SAAUoL,GACzB,QAAQ,GACN,KAAK/L,EAAQ+L,GACX,OAAO,EAET,KAAMA,EACN,IAAqB,iBAATA,EACZ,KAAK4G,EAAS5G,GACZ,OAAO,EAET,KAAuB,IAAlBA,EAAKiI,SACR,QAASjI,EAAKpM,OAEhB,KAAqB,IAAhBoM,EAAKpM,OACR,OAAO,EAET,KAAKoM,EAAKpM,OAAS,EACjB,OAAO8K,EAAI,IAAKsB,IAAStB,EAAIwJ,OAAOlI,EAAKpM,OAAS,GAAIoM,GAG1D,OAAO,CACT,C,oCCtCA,IAAImI,EAAQjC,EAAQ,MAEhBjS,EAAUiS,EAAQ,MAElBU,EAAWV,EAAQ,MAEnBkC,EAAWlC,EAAQ,MAiBvBvR,EAAOC,QAAU,SAAUoL,GACzB,QAAQ,GACN,KAAKmI,EAAMnI,GACT,OAAO,EAET,KAAK4G,EAAS5G,GACZ,MAAgB,KAATA,EAET,KAAK/L,EAAQ+L,GACX,OAAuB,IAAhBA,EAAKpM,OAEd,KAAKwU,EAASpI,GACZ,OAAoC,IAA7B3L,OAAO+C,KAAK4I,GAAMpM,OAG7B,OAAO,CACT,C,gCC3BAe,EAAOC,QAAU,SAAUoL,GACzB,OAAe,MAARA,CACT,C,gCCJArL,EAAOC,QAAU,SAAUoL,GACzB,OAAgB,OAATA,GAAiC,iBAATA,CACjC,C,oCCZA,IAAIqI,EAAiBnC,EAAQ,MAEzBoC,EAAmBpC,EAAQ,MAE3BkC,EAAWlC,EAAQ,MAqBvBvR,EAAOC,QAEP,SAAuBoL,GACrB,IAAKoI,EAASpI,GACZ,OAAO,EAGT,IAAI1L,EAAYD,OAAOwC,eAAemJ,GAEtC,OAAkB,OAAd1L,GAKAA,IAAcD,OAAOC,aAMrB+T,EAAerI,KAASsI,EAAiBtI,GAO/C,C,oCCpDA,IAEIuI,EAFA7J,EAAMwH,EAAQ,MAIlB,IACEqC,EAAcrC,EAAAA,MAAAA,kBACH,CAAX,MAAOzO,GAAI,CAER8Q,IACHA,EAAc,SAAqBvI,GACjC,MAAuB,iBAATA,GAAqC,mBAATA,KAAyBA,GAAQtB,EAAI,WAAYsB,EAC7F,GAeFrL,EAAOC,QAAU2T,C,oCC1BjB,IAEI1N,EAFA6D,EAAMwH,EAAQ,MAIlB,IACErL,EAAYqL,EAAAA,MAAAA,SACD,CAAX,MAAOzO,GAAI,CAERoD,IACHA,EAAY,SAAmBmF,GAC7B,QAASA,GAAQtB,EAAI,WAAYsB,EACnC,GAeFrL,EAAOC,QAAUiG,C,oCC1BjB,IAAIuN,EAAWlC,EAAQ,MAEnB3S,EAAiBc,OAAOC,UAAUf,eAetCoB,EAAOC,QAAU,SAAU4T,EAAOC,GAChC,GAAID,IAAUC,EACZ,OAAO,EAGT,IAAKL,EAASI,KAAWJ,EAASK,GAChC,OAAO,EAGT,IAAIrR,EAAO/C,OAAO+C,KAAKoR,GAEvB,GAAIpR,EAAKxD,SAAWS,OAAO+C,KAAKqR,GAAO7U,OACrC,OAAO,EAGT,IAAK,IAAIF,EAAI,EAAGA,EAAI0D,EAAKxD,OAAQF,IAAK,CACpC,IAAIc,EAAM4C,EAAK1D,GAEf,IAAKH,EAAekB,KAAKgU,EAAOjU,IAAQgU,EAAMhU,KAASiU,EAAMjU,GAC3D,OAAO,CAEX,CAEA,OAAO,CACT,C,gCC9BAG,EAAOC,QAAU,SAAUoL,GACzB,MAAuB,iBAATA,GAAqBA,aAAgBkI,MACrD,C,oCCbA,IAAIjC,EAASC,EAAQ,MAgBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAImC,GAKvC,IAAK,IAAIlU,UAJG,IAARkU,IACFA,EAAM,CAAC,GAGOA,EACVrU,OAAOC,UAAUf,eAAekB,KAAKiU,EAAKlU,IAC5C+R,EAAGmC,EAAIlU,GAAMA,EAAKkU,EAGxB,G,oCC1BA,IAAIzC,EAASC,EAAQ,MAerBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAU0C,EAAMD,GACzC,OAAc,MAAPA,GAAerU,OAAOC,UAAUf,eAAekB,KAAKiU,EAAKC,EAClE,G,kCCjBA,IAAIP,EAAWlC,EAAQ,MAcvBvR,EAAOC,QAAU,SAAU8T,GACzB,OAAON,EAASM,GAAOrU,OAAO+C,KAAKsR,GAAO,EAC5C,C,mCChBA,IAAIzC,EAASC,EAAQ,MAcrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAImC,QAC3B,IAARA,IACFA,EAAM,CAAC,GAGT,IAAIjK,EAAS,CAAC,EAEd,IAAK,IAAIjK,KAAOkU,EACVrU,OAAOC,UAAUf,eAAekB,KAAKiU,EAAKlU,KAC5CiK,EAAOjK,GAAO+R,EAAGmC,EAAIlU,GAAMA,EAAKkU,IAIpC,OAAOjK,CACT,G,oCC5BA,IAAIwH,EAASC,EAAQ,MAEjB0C,EAAgB1C,EAAQ,MAExB2C,EAAa3C,EAAQ,IAErBnK,EAASmK,EAAQ,MAyCrBvR,EAAOC,QAAUqR,EAAO,GA5BR,SAAS6C,IAGvB,IAFA,IAAIrK,EAAS1C,GAAQpI,UAAUC,QAAU,OAAIsE,EAAYvE,UAAU,KAAO,CAAC,GAElED,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAIqV,EAAMrV,EAAI,GAAKC,UAAUC,QAAUF,OAAIwE,EAAYvE,UAAUD,GAEjE,GAAKqV,EAML,IAFA,IAAI3R,EAAOyR,EAAWE,GAEbpC,EAAI,EAAGA,EAAIvP,EAAKxD,OAAQ+S,IAAK,CACpC,IAAInS,EAAM4C,EAAKuP,GACXpH,EAAQwJ,EAAIvU,GACZwU,EAAMvK,EAAOjK,GAEboU,EAAcI,IAAQJ,EAAcrJ,GACtCd,EAAOjK,GAAOsU,EAAUE,EAAKzJ,GAE7Bd,EAAOjK,GAAO+K,CAElB,CACF,CAEA,OAAOd,CACT,G,oCC7CA,IAAIwH,EAASC,EAAQ,MAEjB2C,EAAa3C,EAAQ,IAErBnK,EAASmK,EAAQ,MAerBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,GAGnC,IAFA,IAAI9H,EAAS1C,EAAOpI,UAAUC,QAAU,OAAIsE,EAAYvE,UAAU,IAEzDD,EAAI,EAAGA,GAAKC,UAAUC,QAAU,EAAI,EAAID,UAAUC,OAAS,GAAIF,IAItE,IAHA,IAAIuV,EAASvV,EAAI,EAAI,GAAKC,UAAUC,QAAUF,EAAI,OAAIwE,EAAYvE,UAAUD,EAAI,GAC5E0D,EAAOyR,EAAWI,GAEbtC,EAAI,EAAGA,EAAIvP,EAAKxD,OAAQ+S,IAAK,CACpC,IAAInS,EAAM4C,EAAKuP,GAEXtS,OAAOC,UAAUf,eAAekB,KAAKgK,EAAQjK,GAC/CiK,EAAOjK,GAAO+R,EAAG9H,EAAOjK,GAAMyU,EAAOzU,GAAMA,EAAKiK,EAAQwK,GAExDxK,EAAOjK,GAAOyU,EAAOzU,EAEzB,CAGF,OAAOiK,CACT,G,oCCtCA,IAAIwH,EAASC,EAAQ,MAEjB2C,EAAa3C,EAAQ,IAYzBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUiD,EAAOR,QAC5B,IAAVQ,IACFA,EAAQ,SAGE,IAARR,IACFA,EAAM,CAAC,GAKT,IAFA,IAAIS,EAAW9U,OAAO+U,OAAO,MAEpB1V,EAAI,EAAGA,EAAIwV,EAAMtV,OAAQF,IAChCyV,EAASD,EAAMxV,KAAM,EAMvB,IAHA,IAAI+K,EAAS,CAAC,EACVrH,EAAOyR,EAAWH,GAEbW,EAAK,EAAGA,EAAKjS,EAAKxD,OAAQyV,IAAM,CACvC,IAAIV,EAAOvR,EAAKiS,GAEXF,EAASR,KACZlK,EAAOkK,GAAQD,EAAIC,GAEvB,CAEA,OAAOlK,CACT,G,oCCzCA,IAAIwH,EAASC,EAAQ,MA0BrBvR,EAAOC,QAAUqR,EAAO,GAtBZ,SAAeqD,EAAOZ,QAClB,IAAVY,IACFA,EAAQ,SAGE,IAARZ,IACFA,EAAM,CAAC,GAKT,IAFA,IAAIvD,EAAMuD,EAEDhV,EAAI,EAAGA,EAAI4V,EAAM1V,OAAQF,IAAK,CACrC,GAAW,MAAPyR,EACF,OAGFA,EAAMA,EAAImE,EAAM5V,GAClB,CAEA,OAAOyR,CACT,G,oCCxBA,IAAIc,EAASC,EAAQ,MAEjBqD,EAAOrD,EAAQ,MAmBnBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUqD,EAAO/J,EAAOmJ,GASjD,YARc,IAAVY,IACFA,EAAQ,SAGE,IAARZ,IACFA,EAAM,CAAC,GAGFa,EAAKD,EAAOZ,KAASnJ,CAC9B,G,oCC/BA,IAAI0G,EAASC,EAAQ,MAEjBqD,EAAOrD,EAAQ,MAenBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUqD,EAAO/J,EAAOmJ,QACnC,IAAVY,IACFA,EAAQ,SAGE,IAARZ,IACFA,EAAM,CAAC,GAGT,IAAIpP,EAAIiQ,EAAKD,EAAOZ,GACpB,OAAY,MAALpP,EAAYA,EAAIiG,CACzB,G,oCC5BA,IAAI0G,EAASC,EAAQ,MAerBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAU0C,EAAMD,GACzC,OAAc,MAAPA,EAAcA,EAAIC,QAAQzQ,CACnC,G,oCCjBA,IAAI+N,EAASC,EAAQ,MAkBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUM,EAAIiD,EAAKd,GAK5C,IAAK,IAAIlU,UAJG,IAARkU,IACFA,EAAM,CAAC,GAGOA,EACVrU,OAAOC,UAAUf,eAAekB,KAAKiU,EAAKlU,KAC5CgV,EAAMjD,EAAGiD,EAAKd,EAAIlU,GAAMA,EAAKkU,IAIjC,OAAOc,CACT,G,oCC9BA,IAAIX,EAAa3C,EAAQ,IAazBvR,EAAOC,QAAU,SAAU8T,GAKzB,IAJA,IAAItR,EAAOyR,EAAWH,GAClB5B,EAAM1P,EAAKxD,OACX6V,EAAS,IAAIzV,MAAM8S,GAEdpT,EAAI,EAAGA,EAAIoT,EAAKpT,IACvB+V,EAAO/V,GAAKgV,EAAItR,EAAK1D,IAGvB,OAAO+V,CACT,C,gCCvBA,IAAIC,EAAe,WACfC,EAAc,CAChB,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,SAGHC,EAAS,SAAgBC,GAC3B,OAAOF,EAAYE,EACrB,EAaAlV,EAAOC,QAAU,SAAUkV,GAKzB,YAJY,IAARA,IACFA,EAAM,IAGDA,EAAIxR,QAAQoR,EAAcE,EACnC,C,oCC9BA,IAAI3D,EAASC,EAAQ,MAiBrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAU8D,EAASC,EAAaF,GAazD,YAZgB,IAAZC,IACFA,EAAU,SAGQ,IAAhBC,IACFA,EAAc,SAGJ,IAARF,IACFA,EAAM,IAGDA,EAAIxR,QAAQyR,EAASC,EAC9B,G,mCC/BA,IAAI/D,EAASC,EAAQ,MAarBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAUgE,EAAOH,GAS1C,YARc,IAAVG,IACFA,EAAQ,SAGE,IAARH,IACFA,EAAM,IAGDA,EAAII,MAAMD,EACnB,G,oCCvBA,IAAIhE,EAASC,EAAQ,MASrBvR,EAAOC,QAAUqR,EAAO,GAAG,SAAU8D,EAASD,GAS5C,YARgB,IAAZC,IACFA,EAAU,WAGA,IAARD,IACFA,EAAM,IAGDC,EAAQ/J,KAAK8J,EACtB,G,gCCVAnV,EAAOC,QAAU,SAAUkV,GAKzB,YAJY,IAARA,IACFA,EAAM,IAGDA,EAAIK,aACb,C,uOCuBA,MAAMC,EACF/N,aAAY,KAAEzG,EAAI,QAAE2L,EAAU,GAAE,QAAE8I,EAAU,CAAC,EAAC,QAAEC,EAAU,GAAE,UAAEhK,IAC1D/D,KAAKgO,IAAKlK,EAAAA,EAAAA,MACV9D,KAAKiO,iBAAmB,IAAI/I,IAC5BlF,KAAKkO,gBAnCb,SAAsB7U,EAAMyU,EAASC,EAAS/I,GAC1C,MAAO,CACH,CAEI1D,QAAS6M,EAAAA,GACTvN,MAAO5B,EAAAA,GAAAA,UACPuC,SAAU,CACN6M,QAAS/U,IAGjB,CAEIiI,QAAS+M,EAAAA,GACTzN,MAAO5B,EAAAA,GAAAA,UACPuC,SAAUuM,GAEd,CAEIxM,QAASgN,EAAAA,GACT1N,MAAO5B,EAAAA,GAAAA,UACPuC,SAAUwM,EACVlN,OAAO,GAEX,CAEIS,QAASiN,EAAAA,GACT3N,MAAO5B,EAAAA,GAAAA,UACPuC,SAAUyD,GAGtB,CAK6BwJ,CAAanV,EAAMyU,EAASC,EAAS/I,KAC1DD,EAAAA,EAAAA,IAAcC,GAAS7D,SAASoE,IAC5B,MAAMb,GAAmBD,EAAAA,EAAAA,IAAoBc,GAC7CvF,KAAKiO,iBAAiB5I,KAAId,EAAAA,EAAAA,IAAiBgB,GAAOA,EAAIf,WAAae,GACnEvF,KAAKkO,gBAAgBxJ,EAAiBX,UAAU,IAEhDA,GACA/D,KAAKkO,gBAAgBnK,EAE7B,CACA0K,qBAAqBC,EAAKvV,EAAO,QAC7B,MAAMwV,EAAS3O,KAAKgO,GAAGxM,IAAI,CAAE7B,MAAOiP,EAAAA,GAAcxO,UAAU,IACtDyO,EAAMF,aAAuC,EAASA,EAAO,gBAC7DG,EAAoB9O,KAAKgO,GAAGxM,IAAI,CAAE7B,MAAOoP,EAAAA,GAA2B3O,UAAU,IACpF,IAAK0O,EACD,MAAM,IAAIlT,MAAM,gHAEpBiT,SAA0CA,EAAIG,KAAK,CAC/CC,MAAO,mBACP5P,QAAS,yCAEb,MAAM2O,QAAWc,EAAkBI,IAAIR,EAAKvV,GAU5C,OATA0V,SAA0CA,EAAIG,KAAK,CAC/CC,MAAO,mBACP5P,QAAS,gEAEbW,KAAKmP,iBACLN,SAA0CA,EAAIG,KAAK,CAC/CC,MAAO,mBACP5P,QAAS,2DAEN2O,CACX,CACAE,gBAAgBnK,GACZA,EAAU5C,SAASG,IACftB,KAAKgO,GAAG3M,SAASC,EAAQ,GAEjC,CACA6N,iBACInP,KAAKiO,iBAAiB9M,SAASiO,IAE3B,IAAIA,EAAgBpP,KAAKqP,kBAAkBD,GAAiB,GAEpE,CACAC,kBAAkBjX,GACd,MAAM,KAAE6J,GAAS7J,EAAOkX,EAAAA,IACxB,GAAIrN,EACA,OAAOjC,KAAKgO,GAAGhM,UAAUC,EAEjC,EAEJ,SAASsN,EAAUxP,GACf,IAAIyP,EACJ,IACIA,EAAM,IAAI3B,EAAI9N,EAMlB,CAJA,MAAOrE,GAGH,MADAA,EAAM+T,kBAAmB,EACnB/T,CACV,CACA,OAAO8T,EAAIE,eAA0D,UAAUC,MAAK,IAAMH,GAC9F,CAEA,MAAMI,EAAY,CAAC3S,EAAGC,IACdzF,MAAMC,QAAQuF,IAAMxF,MAAMC,QAAQwF,GAC3BpC,IAAOmC,EAAGC,GAEJ,iBAAND,GAA+B,iBAANC,EACzB2S,IAAUD,EAAW3S,EAAGC,GAE5BA,EAEL4S,EAA8BD,IAAUD,GACxCG,EAAgBC,IAClB,IAAKA,IAAYA,EAAQ3Y,OACrB,MAAO,CAAC,EAEZ,MAAM6K,EAAS8N,EAAQ3M,KAAK4M,GAAWH,EAAaC,EAAaE,EAAOD,SAAUE,IAAK,CAAC,WAAYD,MACpG,OAAsB,IAAlB/N,EAAO7K,OACA6K,EAAO,GAEX4N,KAAgB5N,EAAO,EAElC,SAASiO,EAAapQ,GAClB,IAAIiQ,EAAU,CAAC,EAIf,OAHIjQ,EAAQiQ,UACRA,EAAUD,EAAahQ,EAAQiQ,UAE5BF,EAAaE,EAASjQ,EACjC,CAgBA,SAASqQ,EAAcC,GACnB,OAAO,OAAP,UACOA,EAAM,CACTC,qBAAsB,GAE9B,CACA,SAASC,EAAgBF,GACrB,MAAO,yBAA0BA,GAA0C,IAAhCA,EAAOC,oBACtD,C,iNCrJA,MAAME,GAAmBrQ,EAAAA,EAAAA,IAAY,aAG/BsQ,GAAWC,EAAAA,EAAAA,IAAY,YAQvBC,GAAaC,EAAAA,EAAAA,IAAc,QAPZ,CACjBC,OAAQ,EACRC,MAAO,EACPC,SAAS,EACTC,QAAQ,EACRC,cAAc,IAEsCC,GAAGT,GAAU,CAACU,EAAOC,IAClE,OAAP,UACOD,EACAC,KAULL,KAAa,iBAAkB5U,QAChCA,OAAOkV,eAAiBC,oBAAoBnV,OAAOkV,eA2BlDE,GAAeb,EAAAA,EAAAA,IAAY,gBAC3Bc,GAAiBZ,EAAAA,EAAAA,IAAc,YAAa,MAAMM,GAAGK,GAAc,CAACJ,EAAOM,IACtEA,IAGL1N,EAAY,CACd,CAAEzC,QAASoQ,EAAAA,GAAkB7Q,OAAO,EAAMU,SAAU,CAACiQ,EAAgBb,KAazE,SAASgB,IACL,OAAOC,EAAAA,EAAAA,IAAY,SAAS,EAAGR,WAAYA,GAC/C,CAWA,IAAIS,EAA4B,QAEhCA,GAA4BC,EAAAA,EAAAA,IAAW,EACnC7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,CACP,CACIzC,QAASyQ,EAAAA,GACTlR,OAAO,EACPU,SAAU,CAACoP,EAAYa,QAIpCK,GAEH,IAAIG,EAAoB,QAExBA,GAAoBF,EAAAA,EAAAA,IAAW,EAC3B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJA,GACHzC,EAAAA,EAAAA,IAAQ,CACJA,QAASkP,EACT3N,WAAY,EAAGoP,WACJA,EAAMC,SAASV,GAE1BvP,KAAM,CACFgQ,MAAOE,EAAAA,OAGf7Q,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,MACTvR,OAAO,EACPgC,WApFU,EAAGwP,UAASC,mBAC3B,WACH,MAAMC,EAAe,KACjB,MAAMnB,EATS,CACvBN,MAAO3U,OAAOqW,WACd3B,OAAQ1U,OAAOsW,YACf1B,UACAC,OAAQ7U,OAAOuW,WATP,iEAS2CC,SAU3C,OAJAL,EAAc/P,IAAI,CACdlJ,KAnBe,YAoBf2J,MAAO4P,KAAKC,UAAUzB,KAEnBiB,EAAQS,SAASrC,EAAS,OAAD,UACzBW,EAAK,CACR2B,UAAU,KACX,EAEDC,EAAwBC,IAAS,IAAKV,GAG5C,OAFApW,OAAO+W,iBAAiB,oBAAqBF,GAC7C7W,OAAO+W,iBAAiB,SAAUF,GAC3BT,GACX,EAoEYtQ,KAAM,CACFoQ,QAASc,EAAAA,GACTb,cAAec,EAAAA,SAKhCpB,E,8cC/FH,IAAIqB,EAAa,IAAM,IAAO7L,GAAUyH,GAAUzH,EAAKyH,GAKvD,IAAI/G,EAAQ,CACRoL,UAAW,KACPD,iBAAgB,OAAOA,CAAY,GAG3C,MAAME,EAAY,CAACtB,EAAOuB,KAEtBvB,EAAMf,GAAG,SAAUsC,GAEnBA,GAAS,EAGb,MAAMC,EACF3T,cACIE,KAAK0T,UAAY,EACrB,CACAC,KAAKta,GACD2G,KAAK0T,UAAUvS,SAASyS,IACpBA,GAAU,GAElB,CACAC,YAAY5E,EAAOjF,GACfhK,KAAK0T,UAAUlc,KAAKwS,EACxB,CACAkH,GAAGjC,EAAOjF,GACNhK,KAAK6T,YAAY5E,EAAOjF,EAC5B,CACA8J,eAAe7E,EAAOjF,GAClB,MAAM0J,EAAY,GAClB,IAAK,IAAIvc,EAAI,EAAGA,EAAI6I,KAAK0T,UAAUrc,OAAQF,IACnC6I,KAAK0T,UAAUvc,KAAO6S,GACtB0J,EAAUlc,KAAKwI,KAAK0T,UAAUvc,IAGtC6I,KAAK0T,UAAYA,CACrB,CACAK,IAAI9E,EAAOjF,GACPhK,KAAK8T,eAAe7E,EAAOjF,EAC/B,EAGJ,MAYMgK,EAAgB,CAACC,EAAmBC,IACL,iBAAtBD,EACA,CACHC,UACA/a,KAAM8a,EACNvY,OAAO,GAGRuY,EAGX,MAAME,UAA0BV,EAI5B3T,YAAYsU,EAAY/B,EAASgC,EAAcC,GAC3CzQ,QACA7D,KAAKuU,cAAiBtF,IAClB,MAAMuF,EAAgBxU,KAAKoU,WAAWK,SAASxF,EAAM9V,OAAS,GAC9D,OAAKqb,EAAcnd,QASnB2I,KAAK0U,cAAczF,EAAOuF,GACnBvF,EAAMiF,SAHFjF,EAAMiF,OAGG,EAExBlU,KAAKoU,WAAaA,EAClBpU,KAAK2U,eAAiB,CAAC,EACvB3U,KAAK4U,0BAA4B,CAAC,EAClC5U,KAAKqS,QAAUA,EACfrS,KAAK6U,oBAAsB,CACvBC,WAAY,IAAM9U,KAAKqS,QACvB0C,SAAU/U,KAAK+U,SAASC,KAAKhV,OAEjCA,KAAKiV,qBAAuB,CAAC,EAC7BjV,KAAKkV,UAAY,CAAC,EAEdb,GACArU,KAAKmV,UAAUd,IAEfC,aAAiD,EAASA,EAAYjd,UACtE2I,KAAKuU,cAAgBvU,KAAKoV,iBAAiBd,IAG/Cxc,OAAO+C,KAAKmF,KAAKoU,WAAWiB,QAAQlU,SAAS8Q,IACzCjS,KAAK+U,SAAS9C,EAAM,GAE5B,CACAmD,iBAAiBd,GACb,IAAIxB,EAAW,IAAIjX,KACf,MAAM,IAAID,MAAM,yHAAyH,EAE7I,MAAM0Z,EAAM,CACRpD,SAAUlS,KAAKkS,SAAS8C,KAAKhV,MAC7BuT,UAAWvT,KAAKuT,UAAUyB,KAAKhV,MAC/B8S,SAAU,IAAIjX,IAASiX,KAAYjX,IAGvC,OADAiX,EAAWyC,OAAWjB,EAAYjR,KAAKgQ,GAAeA,EAAWiC,KAAtDC,CAA6DvV,KAAKuU,eACtEzB,CACX,CACA0C,eAAeC,EAAWC,GACtB,MAAMC,EAAmB,KACrB,MAAMC,EAAWF,EAAcxD,WAC3B0D,IAAa5V,KAAKkV,UAAUO,KAC5BzV,KAAKkV,UAAY,OAAH,UACPlV,KAAKkV,UAAS,CACjB,CAACO,GAAYG,IAEjB5V,KAAK2T,KAAK,UACd,EAEJJ,EAAUmC,EAAeC,GAIzB3V,KAAK4U,0BAA0Ba,GAHX,KAChBC,EAAc3B,IAAI,SAAU4B,EAAiB,CAGrD,CAEAZ,SAASc,GACL,IAAIC,EACA1V,GAAW,EACW,iBAAfyV,GACPC,EAAqBD,EAAW5D,MAChC7R,EAAWyV,EAAWzV,UAGtB0V,EAAqBD,EAEzB,MAAMJ,EAAYzV,KAAKoU,WAAW2B,aAAaD,GAC/C,IAAK9V,KAAK2U,eAAec,GAAY,CACjC,IAAIO,EAAQhW,KAAKoU,WAAWiB,OAAOI,GACnC,IAAKO,EAAO,CACR,GAAkC,mBAAvBF,EAIN,CACD,GAAI1V,EACA,OAAO,KAEX,MAAM,IAAIxE,MAAO,SAAQ6Z,wBAC7B,CARIzV,KAAKoU,WAAW6B,cAAcH,GAC9BE,EAAQF,CAQhB,CACA,MAAMJ,EAAgB,IAAIM,EAAMhW,KAAK6U,qBAErC,GADA7U,KAAK2U,eAAec,GAAaC,EAC7B1V,KAAKiV,sBAAwBjV,KAAKiV,qBAAqBQ,GAAY,CACnE,MAAMtE,EAAQnR,KAAKiV,qBAAqBQ,GACpCC,EAAcP,WACdO,EAAcP,UAAUhE,GAE5BnR,KAAKiV,qBAAqBQ,GAAa,IAC3C,CACAzV,KAAKwV,eAAeC,EAAWC,GAE3BM,EAAME,cACNF,EAAME,aAAa/U,SAASgV,IACxB,MAAMC,EAAapW,KAAK+U,SAASoB,GACjC5C,EAAU6C,GAAY,KAClBV,EAAc/B,KAAK,SAAS,GAC9B,GAGd,CACA,OAAO3T,KAAK2U,eAAec,EAC/B,CAOA3C,SAASuD,EAAanC,GAClB,IAAKmC,EACD,MAAM,IAAIza,MAAO,yBAAwBya,iBAG7C,MAAMpH,EAAQ+E,EAAcqC,EAAanC,GACzC,OAAOlU,KAAKuU,cAActF,EAC9B,CACAyF,cAAcrE,EAAQoE,GAClB,MAAM6B,EAAa,CAAC,EACdC,EAAoBtE,IACtB,GAAIqE,EAAWrE,EAAM5Y,MAEjB,OAEJ,MAAMqc,EAAgB1V,KAAK+U,SAAS9C,EAAM5Y,MACrCqc,IAGwB,mBAAlBzD,EAAMuB,QACb8C,EAAWrE,EAAM5Y,MAAQ4Y,EAAMuB,QAAQwB,KAAKU,GAQ5CY,EAAWrE,EAAM5Y,MAAQqc,EAAczD,EAAMuB,SAASwB,KAAKU,GAC/D,EAEEc,EAAiB/B,EAASpd,OAChC,IAAK,IAAI6Q,EAAQ,EAAGA,EAAQsO,EAAgBtO,IACxCqO,EAAiB9B,EAASvM,IAE9B,MAvLc,EAAC+G,EAAOqH,KAC1B,MAAMzb,EAAO/C,OAAO+C,KAAKyb,GACzB,IAAK,IAAIpO,EAAQ,EAAGA,EAAQrN,EAAKxD,OAAQ6Q,IAAS,CAC9C,MAAMuN,EAAY5a,EAAKqN,GACjBuO,EAAYH,EAAWb,GAC7B,IAAKgB,EACD,MAAM,IAAI7a,MAAO,GAAE6Z,wCAAgDxG,EAAM9V,QAE7Esd,EAAUxH,EAAMiF,QAASjF,EAAM9V,KACnC,GA8KWud,CAAcrG,EAAQiG,EACjC,CAQAK,YACI,MAAMtB,EAAS,CAAC,EACVxa,EAAO/C,OAAO+C,KAAKmF,KAAK2U,gBAC9B,IAAK,IAAIxd,EAAI,EAAGA,EAAI0D,EAAKxD,OAAQF,IAAK,CAClC,MAAMse,EAAY5a,EAAK1D,GACjB8a,EAAQjS,KAAK2U,eAAec,GAC7BxD,EAAM0E,cAGXtB,EAAOI,GAAaxD,EAAM0E,YAC9B,CACA,MAAO,CACHtB,SAER,CAMAF,UAAUyB,GACN,GAAIA,EAAgBvB,OAAQ,CACxB,MAAMxa,EAAO/C,OAAO+C,KAAK+b,EAAgBvB,QACzC,IAAK,IAAInN,EAAQ,EAAGA,EAAQrN,EAAKxD,OAAQ6Q,IAAS,CAC9C,MAAMuN,EAAY5a,EAAKqN,GACvBlI,KAAKiV,qBAAqBQ,GAAamB,EAAgBvB,OAAOI,EAClE,CACJ,CACJ,CACAlC,aAAa1X,GACT,GAAI,cAAeA,EAAK,GAAI,CACxB,MAAMgb,EAAUhb,EAAK,GACfib,EAAWjb,EAAK,GAChBkb,EAAkB/W,KAAK+U,SAAS8B,GAChCjD,EAAW,KACb,MAAMzC,EAAQnR,KAAKkS,SAAS2E,GAE5BC,EAAS3F,EAAM,EAGnB,OADA4F,EAAgB7F,GAAG,SAAU0C,GACtB,KACHmD,EAAgBhD,IAAI,SAAUH,EAAS,CAE/C,CACA,MAAMkD,EAAWjb,EAAK,GAChB+X,EAAW,KACb,MAAMzC,EAAQnR,KAAKkS,WAEnB4E,EAAS3F,EAAM,EAGnB,OADAnR,KAAKkR,GAAG,SAAU0C,GACX,KACH5T,KAAK+T,IAAI,SAAUH,EAAS,CAEpC,CACA1B,SAAS2E,GACL,OAAIA,EACO7W,KAAKkV,UAAU2B,EAAQpB,WAE3BzV,KAAKkV,SAChB,CAEA8B,WAAW3E,GACPrS,KAAKqS,QAAUA,CACnB,CACA4E,SAAShF,GACL,OAAOA,EAAMwD,aAAazV,KAAK2U,gBAAkB3U,KAAKoU,WAAW6C,SAAShF,EAC9E,CACAgE,cAAchE,GACVjS,KAAKoU,WAAW6B,cAAchE,GAC9BjS,KAAK+U,SAAS9C,EAClB,CACAiF,gBAAgBjF,GACZ,MAAM,UAAEwD,GAAcxD,EACtBjS,KAAKoU,WAAW8C,gBAAgBjF,GAChCjS,KAAK4U,0BAA0Ba,YACxBzV,KAAK4U,0BAA0Ba,UAC/BzV,KAAKiV,qBAAqBQ,UAC1BzV,KAAK2U,eAAec,EAC/B,EAGJ,MAAM0B,EAOFrX,YAAYC,IAERA,EAAUA,GAAW,CAAC,GAEdsV,OAAStV,EAAQsV,QAAU,GACnCrV,KAAKqV,OAAS,CAAC,EACfrV,KAAKyU,SAAW,CAAC,EACjB1U,EAAQsV,OAAOlU,SAAS8Q,IACpBjS,KAAKiW,cAAchE,EAAM,GAEjC,CACAmF,cAAc/E,EAASgC,EAAcC,GACjC,OAAO,IAAIH,EAAkBnU,KAAMqS,EAASgC,EAAcC,EAC9D,CACA2C,SAAShF,GACL,QAASjS,KAAKqV,OAAOpD,EAAMwD,UAC/B,CAQAQ,cAAchE,GACV,MAAM,UAAEwD,GAAcxD,EAClBjS,KAAKqV,OAAOI,IACRzV,KAAKqV,OAAOI,KAAexD,IAWnCjS,KAAKqV,OAAOI,GAAaxD,EACrBA,EAAMwC,UACN3c,OAAO+C,KAAKoX,EAAMwC,UAAUtT,SAASkP,IACjC,MAAMmD,EAAUvB,EAAMwC,SAASpE,GAC/BrQ,KAAKqX,gBAAgBhH,EAAQoF,EAAWjC,EAAQ,IAG5D,CACA0D,gBAAgBjF,GACZ,MAAM,UAAEwD,GAAcxD,EACjBjS,KAAKqV,OAAOI,YAGVzV,KAAKqV,OAAOI,GACfxD,EAAMwC,UACN3c,OAAO+C,KAAKoX,EAAMwC,UAAUtT,SAASkP,IACjC,MAAMmD,EAAUvB,EAAMwC,SAASpE,GAC/BrQ,KAAKsX,kBAAkBjH,EAAQoF,EAAWjC,EAAQ,IAG9D,CAMAuC,aAAa9D,GACT,MAAqB,iBAAVA,EACAA,EAEJA,EAAMwD,SACjB,CAOA4B,gBAAgBhH,EAAQhX,EAAMma,GAC1BxT,KAAKyU,SAASpE,GAAUrQ,KAAKyU,SAASpE,IAAW,GACjDrQ,KAAKyU,SAASpE,GAAQ7Y,KAAK,CACvB6B,OACAma,WAER,CACA8D,kBAAkBjH,EAAQhX,EAAMma,GACxB/b,MAAMC,QAAQsI,KAAKyU,SAASpE,MAC5BrQ,KAAKyU,SAASpE,GAAUrQ,KAAKyU,SAASpE,GAAQkH,QAAQC,KACzCA,EAAene,OAASA,GAAQme,EAAehE,UAAYA,KAGhF,EAEJ,SAASiE,EAAiB1X,GACtB,OAAO,IAAIoX,EAAWpX,EAC1B,CA6CA,SAAS2Q,EAAYgH,EAAWC,EAAiBC,KAM7C,MAAMze,EAAOue,EACPG,EAAe,IAAIhc,KACd,CACH1C,OACA+a,QAASyD,KAAkB9b,KAKnC,OAFAgc,EAAaC,QAAU,IAAM3e,EAC7B0e,EAAahgB,SAAW,IAAMsB,EACvB0e,CACX,CAEA,SAASjH,EAAcvX,EAAMgb,GACzB,IAAI3S,EACJ,MAAMqW,EAAW,CAAC,EAClB,OAAOrW,EAAK,MAAMsW,UAAqBvE,EAC/B3T,cACI+D,QACA7D,KAAKmR,MAAQkD,CACjB,CACA4D,oBAAoBC,GAChB,MAAMC,EAAargB,OAAO+C,KAAKqd,GACzBE,EAAS,CAAC,EAOhB,OANAD,EAAWhX,SAASuW,IAChB,MAAMlE,EAAU0E,EAAMR,GAChBG,EAAenH,EAAa,GAAEgH,KACpCU,EAAOV,GAAaG,EACpBG,EAAa9G,GAAG2G,EAAcrE,EAAQ,IAEnC4E,CACX,CACAH,UAAU5B,EAAaQ,GACnB,GAAIpf,MAAMC,QAAQ2e,GAEd,OADAA,EAAYlV,SAAS8N,GAAU+I,EAAa9G,GAAGjC,EAAO4H,KAC/CmB,EAEX,MAAM7e,EAAOkd,EAAYxe,WAGzB,OAFAmgB,EAAavD,SAAStb,GAAQ,SAC9B4e,EAAS5e,GAAQ0d,EACVmB,CACX,CACA9F,WACI,OAAOlS,KAAKmR,KAChB,CACAkH,SAASlH,GACLnR,KAAKmR,MAAQA,EAEbnR,KAAK2T,KAAK,SACd,CACAgD,YACI,OAAO3W,KAAKmR,KAChB,CACAgE,UAAUhE,GACNnR,KAAKmR,MAAQA,CACjB,CACAmH,OAAOpE,EAASwD,GACZ,MAAMb,EAAUkB,EAASL,GACrBb,IACA7W,KAAKmR,MAAQ0F,EAAQ7W,KAAKmR,MAAO+C,GACjClU,KAAK2T,KAAK,UAElB,IAED8B,UAAYpc,EACfqI,EAAG+S,SAAW,CAAC,EACf/S,CACR,CAsDA,MAAM6W,EACFzY,YAAYuV,GACRrV,KAAKwY,kBAAoB,KACrBxY,KAAKyY,eAAiBzY,KAAKyY,eAAe,EAE9CzY,KAAKqV,OAASA,EACdrV,KAAK0Y,iBAAc/c,CACvB,CACAgd,eACI,OAAO7T,QAAQ9E,KAAK0Y,YACxB,CACAE,iBAAiBH,GACbzY,KAAKyY,cAAgBA,CACzB,CACAI,eACS7Y,KAAK0Y,cACN1Y,KAAK0Y,YAAc1Y,KAAKqV,OAAOkC,OAAOzS,SAASzB,KAAK4O,IAChDA,EAAMf,GAAG,SAAUlR,KAAKwY,mBACjB,KACHvG,EAAM6B,eAAe,SAAU9T,KAAKwY,kBAAkB,KAItE,CACAM,iBACQ9Y,KAAK0Y,cACL1Y,KAAK0Y,YAAYvX,SAAS1F,GAAMA,MAChCuE,KAAK0Y,iBAAc/c,GAEvBqE,KAAKyY,mBAAgB9c,CACzB,EAGJ,MAAMod,GAAgC3B,EAAAA,EAAAA,eAAc,MAC9C4B,GAAoC5B,EAAAA,EAAAA,eAAc,MAElD6B,EAAqB,KACvB,MAAM5G,GAAU6G,EAAAA,EAAAA,YAAWH,GAC3B,IAAK1G,EACD,MAAM,IAAIzW,MAAM,wEAEpB,OAAOyW,CAAO,EAGlB,SAAS8G,EAAWpL,GAChB,MAAMsE,EAAU4G,IACVG,GAAalQ,EAAAA,EAAAA,GAAgB6E,GACnC,OAAOsL,EAAAA,EAAAA,UAAQ,IACP3hB,IAAQ0hB,GACDA,EAAW/V,KAAKgN,GAAWgC,EAAQiH,cAActE,KAAK3C,EAAShC,KAEnEgC,EAAQiH,cAActE,KAAK3C,EAAS+G,IAC5C,CAACA,EAAY/G,GACpB,CAEA,SAASkH,EAAS1C,GACd,MAAMxE,EAAU4G,IACVO,GAAcN,EAAAA,EAAAA,YAAWF,GACzBS,GAAapQ,EAAAA,EAAAA,QAAOwN,GACpB6C,GAAkBrQ,EAAAA,EAAAA,QAAO,MAI1BgJ,EAAQ4E,SAASJ,KAClBxE,EAAQ4D,cAAcY,GACtB6C,EAAgBnQ,QAAUsN,EAAQpB,WAEtC,MAAMlC,GAAYoG,EAAAA,EAAAA,cAAaC,IAC3B,MAAMlB,EAAcrG,EAAQkB,UAAUsD,EAAS+C,GAG/C,OADAH,EAAWlQ,QAAUsN,EACd,KAGH6B,IAGIgB,EAAgBnQ,UAChB8I,EAAQ6E,gBAAgBuC,EAAWlQ,SACnCmQ,EAAgBnQ,QAAU,KAC9B,CACH,GACF,CAACsN,EAASxE,IACb,OAAOwH,EAAAA,EAAAA,sBAAqBtG,GAAW,IAAMlB,EAAQH,SAAS2E,IAAU2C,EAAc,IAAMA,EAAY3C,EAAQpB,WAAa,IAAMpD,EAAQH,SAAS2E,GACxJ,CAEA,MAAMiD,EAAmD3d,OACzD,SAAS4d,IACL,MAAI,0BAA2BD,EACpBE,sBAEP,iBAAkBF,EACXA,EAAiBG,aAErB3R,UACX,CAEA,MAAM4R,EAA0BH,IAChC,SAASnI,EAAYuI,EAAeC,EAAUC,EAAa/Q,KACvDgR,IAAUF,EAAW,4CACrB,MAAM/H,EAAU4G,IACVO,GAAcN,EAAAA,EAAAA,YAAWF,GACzBuB,GAAoBlR,EAAAA,EAAAA,SAAO,GAC3BmR,GAAYtR,EAAAA,EAAAA,GAAgBiR,GAC5BM,GAAepB,EAAAA,EAAAA,UAAQ,IAAM,IAAId,EAAamC,IAAQF,GAAWnX,IAAIgP,EAAQ0C,YAAY,CAACyF,EAAWnI,IACrGsI,GAAkCtR,EAAAA,EAAAA,UAClCkK,GAAYoG,EAAAA,EAAAA,cAAaC,IAC3Ba,EAAa7B,kBAAiB,KACrB2B,EAAkBhR,UACnBgR,EAAkBhR,SAAU,EAC5B2Q,GAAS,KACLN,IACAW,EAAkBhR,SAAU,CAAK,IAEzC,IAEJkR,EAAa5B,eACN,IACI4B,EAAa3B,mBAEzB,CAAC2B,IACJ,IAAIG,EACJ,IACIA,GAAgBC,EAAAA,EAAAA,kCAAiCtH,EAAWlB,EAAQH,SAAUsH,EAAc,IAAMA,EAAcnH,EAAQH,SAAUkI,EAAUC,EAQhJ,CANA,MAAO9a,GACH,IAAIub,EAAgB,qDAAoDvb,EAAIF,WAI5E,MAHIsb,EAAgCpR,UAChCuR,GAAiB,4DAA2DH,EAAgCpR,QAAQ9J,kCAElH,IAAI7D,MAAMkf,EACpB,CAIA,OAHAtR,EAAAA,EAAAA,IAA0B,KACtBmR,EAAgCpR,aAAU5N,CAAS,IAEhDif,CACX,CAqZA,MAAMG,EAAW,EAAG1I,UAAS2I,WAAUxB,kBAC3ByB,EAAAA,EAAAA,KAAIlC,EAAegC,SAAU,CAAE/X,MAAOqP,EAAS2I,UAAUC,EAAAA,EAAAA,KAAIjC,EAAmB+B,SAAU,CAAE/X,MAAOwW,EAAawB,SAAUA,OAyEhI,SAAEE,GAAanC,C,kLC1tCrB,MAAMoC,EAAe,CAAEta,OAAO,GAKxBuR,EAAwB,CAE1BgJ,eAAejb,EAAAA,EAAAA,IAAY,2BAA4Bgb,GACvDE,iBAAiBlb,EAAAA,EAAAA,IAAY,8BAA+Bgb,GAC5DG,iBAAiBnb,EAAAA,EAAAA,IAAY,8BAA+Bgb,GAE5DlS,OAAO9I,EAAAA,EAAAA,IAAY,kBAAmBgb,GAEtCI,eAAepb,EAAAA,EAAAA,IAAY,2BAA4Bgb,GAEvDK,oBAAoBrb,EAAAA,EAAAA,IAAY,iCAAkCgb,IA+BhEM,GAAkCtb,EAAAA,EAAAA,IAAY,4BAgB9C4R,GAAoD5R,EAAAA,EAAAA,IAAY,qCAAsCgb,GAKtGO,GAA0Cvb,EAAAA,EAAAA,IAAY,2BAA4Bgb,GAwClFQ,GAAuCxb,EAAAA,EAAAA,IAAY,4B,mvBCvGzD,MAAMyb,GAAuBzb,EAAAA,EAAAA,IAAY,iBAMnC0b,GAA0B1b,EAAAA,EAAAA,IAAY,oBAAqB,CAC7DU,OAAO,IAOLsS,GAAgBhT,EAAAA,EAAAA,IAAY,WAM5B2b,GAAwB3b,EAAAA,EAAAA,IAAY,kBAKpC4b,GAAyB5b,EAAAA,EAAAA,IAAY,mBAKrC6b,GAA2B7b,EAAAA,EAAAA,IAAY,oBAKvC8b,GAAsB9b,EAAAA,EAAAA,IAAY,qBAAsB,CAC1DU,OAAO,IAOLqb,GAAa/b,EAAAA,EAAAA,IAAY,SAMzBgc,GAAuBhc,EAAAA,EAAAA,IAAY,iBAKnCic,GAAejc,EAAAA,EAAAA,IAAY,UAK3Bkc,GAAoBlc,EAAAA,EAAAA,IAAY,cAQhCmc,GAAqBnc,EAAAA,EAAAA,IAAY,eAKjCoc,GAA6Bpc,EAAAA,EAAAA,IAAY,qBAAsB,CAAEU,OAAO,IAKxE2b,GAAoBrc,EAAAA,EAAAA,IAAY,cAQhCsc,GAA2Btc,EAAAA,EAAAA,IAAY,qBAOvCuc,GAAmBvc,EAAAA,EAAAA,IAAY,cAK/Bwc,GAA2Bxc,EAAAA,EAAAA,IAAY,qBAKvCuR,GAAmBvR,EAAAA,EAAAA,IAAY,kBAAmB,CAAEU,OAAO,IAK3DsR,GAAchS,EAAAA,EAAAA,IAAY,SAK1Byc,GAAmBzc,EAAAA,EAAAA,IAAY,kBAAmB,CAAEU,OAAO,IAK3Dgc,GAA0B1c,EAAAA,EAAAA,IAAY,mBAMtCyO,GAAezO,EAAAA,EAAAA,IAAY,UAK3B2c,GAAmB3c,EAAAA,EAAAA,IAAY,cAO/B4c,GAAwB5c,EAAAA,EAAAA,IAAY,kBAOpC6c,GAAyB7c,EAAAA,EAAAA,IAAY,mBAMrC8c,GAAoB9c,EAAAA,EAAAA,IAAY,sBAGhC+c,GAAkC/c,EAAAA,EAAAA,IAAY,kCAC9Cgd,GAA+Bhd,EAAAA,EAAAA,IAAY,+BAC3Cid,GAAuCjd,EAAAA,EAAAA,IAAY,qC,oEC7JzD,MAAMiT,GAAuBjT,E,QAAAA,IAAY,gB,kOCCzC,MAAMgb,EAAe,CAAEta,OAAO,GACxBkO,GAA4B5O,EAAAA,EAAAA,IAAY,qBACxCkd,GAAsBld,EAAAA,EAAAA,IAAY,gBAClCiS,EAAwB,CAE1BkL,MAAMnd,EAAAA,EAAAA,IAAY,OAAQgb,GAC1BoC,QAAQpd,EAAAA,EAAAA,IAAY,SAAUgb,GAE9BC,eAAejb,EAAAA,EAAAA,IAAY,iBAAkBgb,GAC7CE,iBAAiBlb,EAAAA,EAAAA,IAAY,oBAAqBgb,GAClDG,iBAAiBnb,EAAAA,EAAAA,IAAY,oBAAqBgb,GAClDqC,cAAcrd,EAAAA,EAAAA,IAAY,gBAAiBgb,GAC3ClS,OAAO9I,EAAAA,EAAAA,IAAY,QAASgb,GAE5BI,eAAepb,EAAAA,EAAAA,IAAY,iBAAkBgb,GAC7CK,oBAAoBrb,EAAAA,EAAAA,IAAY,uBAAwBgb,GAExDsC,OAAOtd,EAAAA,EAAAA,IAAY,QAASgb,IAG1B9M,GAAoBlO,EAAAA,EAAAA,IAAY,cAChCmO,GAAqBnO,EAAAA,EAAAA,IAAY,eACjCoO,GAAqBpO,EAAAA,EAAAA,IAAY,eACjCgO,GAAiBhO,EAAAA,EAAAA,IAAY,U,oCC4B5B,SAAS2R,EAAW4L,EAAYvZ,EAAQlM,EAAK0lB,GAChD,IAA2HniB,EAAvHD,EAAInE,UAAUC,OAAQwF,EAAItB,EAAI,EAAI4I,EAAkB,OAATwZ,EAAgBA,EAAO7lB,OAAOuC,yBAAyB8J,EAAQlM,GAAO0lB,EACrH,GAAuB,iBAAZC,SAAoD,mBAArBA,QAAQC,SAAyBhhB,EAAI+gB,QAAQC,SAASH,EAAYvZ,EAAQlM,EAAK0lB,QACpH,IAAK,IAAIxmB,EAAIumB,EAAWrmB,OAAS,EAAGF,GAAK,EAAGA,KAASqE,EAAIkiB,EAAWvmB,MAAI0F,GAAKtB,EAAI,EAAIC,EAAEqB,GAAKtB,EAAI,EAAIC,EAAE2I,EAAQlM,EAAK4E,GAAKrB,EAAE2I,EAAQlM,KAAS4E,GAChJ,OAAOtB,EAAI,GAAKsB,GAAK/E,OAAOoC,eAAeiK,EAAQlM,EAAK4E,GAAIA,CAChE,C,iCA6F6B/E,OAAO+U,OA0GX/U,OAAO+U,M,kDClQjB,SAASiR,EAA8BpR,EAAQqR,GAC5D,GAAc,MAAVrR,EAAgB,MAAO,CAAC,EAC5B,IAEIzU,EAAKd,EAFLgN,EAAS,CAAC,EACV6Z,EAAalmB,OAAO+C,KAAK6R,GAE7B,IAAKvV,EAAI,EAAGA,EAAI6mB,EAAW3mB,OAAQF,IACjCc,EAAM+lB,EAAW7mB,GACb4mB,EAAShU,QAAQ9R,IAAQ,IAC7BkM,EAAOlM,GAAOyU,EAAOzU,IAEvB,OAAOkM,CACT,C,oDCXA,MAAM8Z,EAAoB,wB,wBCM1B,MAAMC,EACFpe,cACIE,KAAKme,WAAa,CAAC,CACvB,CACA3c,IAAInI,GACA,OAAO2G,KAAKme,WAAW9kB,EAC3B,CACA+kB,OAAO/kB,EAAMglB,GACT,MAAMrb,EAAQsD,OAAOjN,KAAQ2G,KAAKme,WAAane,KAAKme,WAAW9kB,GAAQglB,GACvE,OAAO/X,OAAOgY,SAAStb,GAASA,EAAQqb,CAC5C,CACAE,SACI,OAAOve,KAAKme,UAChB,CACAK,OAAOtc,GACHlC,KAAKme,WAAarmB,OAAO0H,OAAOQ,KAAKme,WAAYjc,EACrD,CACAuc,aACI,OAAOze,KAAKue,QAChB,CACAG,iBAAiBxc,GACblC,KAAKwe,OAAOtc,EAChB,EAGJ,MAAMyc,GAAmB/N,EAAAA,EAAAA,IAAc,cAAe,CAAC,GAEvD,IAAIgO,EAAoB,QAExBA,GAAoB9M,EAAAA,EAAAA,IAAW,EAC3B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,CACP,CACIzC,QAAS2b,EAAAA,GACTpa,WAAY,EAAGoP,YACX,MAAMvD,EAAM,IAAIwP,EAEhB,OADAxP,EAAI8P,OAAOvM,EAAMC,SAASyM,IACnBjQ,CAAG,EAEd9N,MAAO5B,EAAAA,GAAAA,UACPiD,KAAM,CACFgQ,MAAOE,EAAAA,KAGf,CACI7Q,QAASoQ,EAAAA,GACTnQ,SAAUod,EACV9d,OAAO,OAIpB+d,G,cCnBH,MAAMC,EACF/e,YAAYgf,EAAW,CAAC,GACpB9e,KAAK8e,SAAWA,CACpB,CAEAtd,IAAInI,GACA,MAAM0lB,EAAUzN,SAAS0N,OAAOrR,MAAM,KAEtC,KAAOoR,EAAQ1nB,QAAQ,CACnB,MAAM2nB,EAASD,EAAQjY,MACvB,IAAKkY,EACD,MAGJ,IAAIC,EAAiBD,EAAOjV,QAAQ,KAEpCkV,EAAiBA,EAAiB,EAAID,EAAO3nB,OAAS4nB,EACtD,MAAMC,EAAaF,EAAOnV,MAAM,EAAGoV,GAAgBljB,QAAQ,OAAQ,IAC7DojB,EAAcH,EAAOnV,MAAMoV,EAAiB,GAClD,IAAIG,EACJ,IACIA,EAAoBC,mBAAmBH,EAK3C,CAHA,MAAOhkB,GAEHokB,QAAQtQ,KAAK,2BAA4B9T,EAC7C,CAEA,GAAIkkB,IAAsB/lB,GAAQ6lB,IAAe7lB,EAC7C,IACI,OAAOgmB,mBAAmBF,EAO9B,CALA,MAAOjkB,GAIH,OAFAokB,QAAQtQ,KAAK,4BAA6B9T,GAEnCikB,CACX,CAER,CAGJ,CACA5c,IAAIlJ,EAAM2J,EAAOjD,GACb,IAAK1G,EACD,OAEJ,MAAM,OAAEkmB,EAAM,KAAEvS,EAAI,QAAEwS,EAAO,OAAEC,EAAM,SAAEC,EAAQ,SAAEC,GAhFzD,SAAuB5f,EAAU,CAAC,EAAG+e,EAAW,CAAC,GAC7C,IAAIpd,EAAIC,EAAIie,EAAIC,EAAIC,EAOpB,MAAO,CACHN,QAPYzf,EAAQyf,SAAWV,EAASU,QAQxCD,OAPWxf,EAAQwf,QAAUT,EAASS,OAQtCvS,KAPuF,QAA7ErL,EAA6B,QAAvBD,EAAK3B,EAAQiN,YAAyB,IAAPtL,EAAgBA,EAAKod,EAAS9R,YAAyB,IAAPrL,EAAgBA,EATlG,IAiBb8d,OAPqC,QAAzBG,EAAK7f,EAAQ0f,cAA2B,IAAPG,EAAgBA,EAAKd,EAASW,OAQ3EC,SAPyC,QAA3BG,EAAK9f,EAAQ2f,gBAA6B,IAAPG,EAAgBA,EAAKf,EAASY,SAQ/EC,SAPyC,QAA3BG,EAAK/f,EAAQ4f,gBAA6B,IAAPG,EAAgBA,EAAKhB,EAASa,SASvF,CAgEsEI,CAAchgB,EAASC,KAAK8e,UACpFkB,EA5Dd,SAAuBR,GASnB,OARmBA,EACb,IAAIzZ,KAEa,iBAAZyZ,GACD,IAAIzZ,MAAOka,UA9BP,MA8BmBT,EAErBA,GACN,IAEV,CAkD2BU,CAAcV,GAE3BN,EAAa7lB,EACd0C,QAAQ,cAAeokB,oBACvBpkB,QAAQ,IAAK,OACbA,QAAQ,IAAK,OAEZojB,GAAgC,iBAAVnc,EAAqBA,EAAQ,IAAIjH,QAE7D,qBAAsBokB,oBAChBC,EAAgBJ,GAAcA,EAAWC,WAAa,EAAK,YAAWD,EAAWK,gBAAkB,GACnGC,EAAef,EAAU,WAAUA,IAAW,GAC9CgB,EAAavT,EAAQ,SAAQA,IAAS,GACtCwT,EAAef,EAAS,UAAY,GACpCgB,EAAiBf,EAAW,YAAc,GAC1CgB,EAAiBf,EAAY,aAAYA,IAAa,GAC5DrO,SAAS0N,OAAU,GAAEE,KAAcC,IAAciB,IAAgBE,IAAeC,IAAaC,IAAeC,IAAiBC,GACjI,CACAC,MAAMtnB,EAAM0G,EAAU,CAAC,GACnBC,KAAKuC,IAAIlJ,EAAM,GAAI,CACfmmB,SAAU,EACVD,OAAQxf,EAAQwf,OAChBvS,KAAMjN,EAAQiN,KACdyS,QAAQ,EACRC,UAAU,GAElB,CAEAkB,MACI,MAAMA,EAAM,CAAC,EACP7B,EAAUzN,SAAS0N,OAAOrR,MAAM,KAEtC,KAAOoR,EAAQ1nB,QAAQ,CACnB,MAAM2nB,EAASD,EAAQjY,MACvB,IAAKkY,EACD,MAGJ,IAAIC,EAAiBD,EAAOjV,QAAQ,KAEpCkV,EAAiBA,EAAiB,EAAID,EAAO3nB,OAAS4nB,EACtD,MAAMC,EAAaF,EAAOnV,MAAM,EAAGoV,GAAgBljB,QAAQ,OAAQ,IAC7DojB,EAAcH,EAAOnV,MAAMoV,EAAiB,GAClD,IAAIG,EACAyB,EACJ,IACIzB,EAAoBC,mBAAmBH,EAK3C,CAHA,MAAOhkB,GAEHokB,QAAQtQ,KAAK,2BAA4B9T,EAC7C,CACA,IACI2lB,EAAqBxB,mBAAmBF,EAK5C,CAHA,MAAOjkB,GAEHokB,QAAQtQ,KAAK,4BAA6B9T,EAC9C,CAEA0lB,EAAIxB,QAA6DA,EAAoBF,GAAc2B,QAA+DA,EAAqB1B,CAC3L,CACA,OAAOyB,CACX,E,qEC7IEE,EAAe,wDACfC,EAAiB,2DACjBC,EAAoBxB,IAEtB,GAAKA,EAGL,OAAO,IAAIzZ,KAAwB,iBAAZyZ,GAAwB,IAAIzZ,KAAmB,IAAVyZ,EAAiBA,EAAQ,EA+BzF,MAAMyB,EACFnhB,cACIE,KAAKkhB,MAAQppB,OAAO+U,OAAO,KAC/B,CACArL,IAAInI,GACA,OAAO2G,KAAKkhB,MAAM7nB,SAASsC,CAC/B,CACA4G,IAAIlJ,EAAM2J,GACNhD,KAAKkhB,MAAM7nB,GAAQ2J,CACvB,CACA2d,MAAMtnB,UACK2G,KAAKkhB,MAAM7nB,EACtB,CACAunB,MACI,OAAO5gB,KAAKkhB,KAChB,EAoCJ,IAAIC,EAAe,QAEnBA,GAAerP,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHC,QAAS,CAAC8N,EAAAA,IACVjO,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CAEJA,QAAS8R,EAAAA,EACTtQ,SA3ChB,MACIhD,aAAY,cAAEshB,EAAgB,CAAC,EAAC,UAAE3P,IAC9B,MAAM4P,EAAwC,WAA7BllB,OAAOmlB,SAASC,SACjCvhB,KAAK+e,QA7Bc,MACvB,MAAMyC,EAAiB,qBAEvB,OADAlQ,SAAS0N,OAASwC,EACdlQ,SAAS0N,OAAOjV,QAAQyX,IAAmB,IAC3ClQ,SAAS0N,OAAU,GAAEwC,6CACd,EAEC,EAsBOC,GACT,IAAI5C,EAAQ,OAAD,QACTc,SAAUlO,EAAUiQ,wBAA0BL,EAAW,OAAS,MAClE5B,OAAQ4B,GACLD,IAEL,IAAIH,EACVjhB,KAAKyR,UAAYA,CACrB,CAEAjQ,IAAInI,GACA,OAAO2G,KAAK+e,QAAQvd,IAAInI,SAASsC,CACrC,CAEA4G,IAAI,GAA6B,IAA7B,KAAElJ,EAAI,MAAE2J,GAAmB,EAATjD,EAAO,OACzBC,KAAK+e,QAAQxc,IAAIlJ,EAAM2J,EApDF,GAAGyO,WAAaiQ,0BAA0BC,cAAaC,kBAAkB,KAAF,IAAE,SAAEjC,EAAQ,aAAEkC,GAA0B,EAAT9hB,EAAO,+BACnIA,EACc,SAAb4f,GAAyB+B,GAA2BE,EAAuB,CAAEjC,YAAP,CAAC,EACvEiC,GAA+B,SAAbjC,GAAuB+B,EAAyB,CAAEjC,QAAQ,GAAS,CAAC,EAAC,CAC3FD,QAASwB,EAAiBjhB,EAAQyf,SAClCD,OAAQsC,GAXYC,EAWkB/hB,EAAQwf,QAAUoC,EAjBtCG,IACXhB,EAAard,KAAKqe,IAASf,EAAetd,KAAKqe,GAMlDC,CAAaD,GACNA,EALGA,IACPA,EAAK/lB,QAAQ,QAAS,IAMtBimB,CAASF,EAAK/X,QAAQ,cAAgB,EAAI+X,EAAQ,IAAGA,EAAKnU,MAAM,KAAK9D,OAAO,GAAG1R,KAAK,SAOpB4H,EAAQwf,SAX3DuC,KAWiE,EA+CnDG,CAAqB,CAC/CxQ,UAAWzR,KAAKyR,UAChBkQ,YAAaxlB,OAAOmlB,SAASY,SAC7BN,eAA6C,WAA7BzlB,OAAOmlB,SAASC,UACjCxhB,GACP,CAEA6gB,MACI,OAAO5gB,KAAK+e,QAAQ6B,KACxB,CAEAuB,OAAO9oB,EAAM0G,GACT,OAAOC,KAAK+e,QAAQ4B,MAAMtnB,EAAM0G,EACpC,GAaYa,MAAO5B,EAAAA,GAAAA,UACPiD,KAAM,CAIFmf,cAAe,CACXzhB,MAAO,0BACPS,UAAU,GAEdqR,UAAWjB,EAAAA,UAK5B2Q,G,yICxEH,MA+BMiB,EAAoB,CAACpf,EAAOqf,EAAUC,KACxC,IACI,OAAO1P,KAAKC,UAAU7P,EAAOqf,EAAUC,EAI3C,CAFA,MAAO/iB,GACH,MAnBc,EAACyD,EAAOqf,EAAUC,KACpC,MAAMC,EAAO,IAAIrd,IACXnJ,EAAUsmB,GAAY,CAAEzZ,GAAQA,GACtC,OAAOgK,KAAKC,UAAU7P,GAAO,CAACwf,EAAG5Z,IACxBA,GAAsB,iBAARA,EAGf2Z,EAAKpgB,IAAIyG,GACF,gBAEX2Z,EAAKld,IAAIuD,GACF7M,EAAQ6M,IANJ7M,EAAQ6M,IAOpB0Z,EAAM,EAOEG,CAAczf,EAAOqf,EAAUC,EAC1C,GC5EEI,EAAS,CACXC,MAAO,GACPC,MAAO,GACPC,KAAM,GACN7T,KAAM,GACNtT,MAAO,GACPonB,MAAO,EACPC,QAAQ,KAENC,EAAc,CAChB,GAAI,QACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,QACJ,EAAG,SAGDC,EAA6BC,GACxB,IAAIC,OAAQ,IAAGD,EAAUnnB,QAAQ,MAAO,WAEnD,MAAMqnB,EAEFtjB,YAAYC,EAAU,CAAE1G,KAAM,KAG1B,GAFA2G,KAAK3G,KAAOgqB,IAAQtjB,EAAQ1G,MAC5B2G,KAAK/H,IAAM8H,EAAQ9H,KAAO+H,KAAK3G,KAC3B+pB,EAAOE,UAAUtjB,KAAK/H,KACtB,OAAOmrB,EAAOE,UAAUtjB,KAAK/H,KAEjC+H,KAAKujB,gBAAkBxjB,EAAQwjB,iBAAmB,GAClDvjB,KAAKwjB,UAAYzjB,EAAQyjB,WAAa,GACtCxjB,KAAKyjB,QAAU1jB,EAAQ0jB,SAAW,GAClCzjB,KAAK0jB,WAAa3jB,EAAQ2jB,YAAc,GACxC1jB,KAAK8e,SAAW/e,EAAQ+e,UAAY,CAAC,EACjC/e,EAAQ4jB,OACR3jB,KAAK4jB,SAASlB,EAAO3iB,EAAQ4jB,QAE7B5jB,EAAQ8jB,SACR7jB,KAAK4jB,SAASlB,EAAOC,OAEzB3iB,KAAK8jB,eACLV,EAAOE,UAAUtjB,KAAK/H,KAAO+H,KAC7B+jB,KAAQ,CAACJ,EAAOK,KACZhkB,KAAKgkB,GAAa,IAAInoB,IACXmE,KAAK6O,IAAI8U,EAAO9nB,EAC1B,GACF6mB,EACP,CACAzK,cACI,IAAIvW,EACuB,QAA1BA,EAAK0hB,EAAOa,gBAA6B,IAAPviB,GAAyBA,EAAGxJ,KAAKkrB,EAAQ,CACxEO,MAAOP,EAAOO,MACdO,YAAalkB,KAAKkkB,YAClBC,aAAcnkB,KAAKmkB,cAE3B,CACAlM,YAAY9G,GACRiS,EAAOO,MAAQxS,EAAMwS,MACrBP,EAAOc,YAAc/S,EAAM+S,YAC3Bd,EAAOe,aAAehT,EAAMgT,YAChC,CACAlM,gBAAgBmM,GACZ,IAAI1iB,EACJ0hB,EAAOO,MAAoC,QAA3BjiB,EAAKghB,EAAO0B,UAA8B,IAAP1iB,EAAgBA,EAAK0hB,EAAOO,MAC/EP,EAAOiB,MACX,CACApM,mBAAmBgM,GACfb,EAAOa,SAAWA,CACtB,CACAhM,cAAc0L,EAAOT,GACjB,MAAOoB,EAAKC,GAAMrB,EAAY,CAACR,EAAOiB,GAAQT,GAAa,CAACR,EAAOC,MAAOgB,GAC1EP,EAAOc,YAAY1sB,KAAK+sB,GACxBnB,EAAOe,aAAa3sB,KAAK8sB,GACzBlB,EAAOiB,OACP,MAAMG,EAASvB,EAA0BsB,GACzCR,KAASU,IACL,MAAM,KAAEprB,GAASorB,EACbD,EAAO/gB,KAAKpK,IACZorB,EAASb,SAASU,EACtB,GACDlB,EAAOE,UACd,CACArL,eAAe0L,EAAOT,GAClB,MAAOoB,EAAKC,GAAMrB,EAAY,CAACR,EAAOiB,GAAQT,GAAa,CAACR,EAAOK,OAAQY,GACrEzb,EAAQkb,EAAOc,YAAYna,QAAQwa,GACrCrc,GAAS,GACTkb,EAAOc,YAAYQ,OAAOxc,EAAO,GACjCkb,EAAOe,aAAaO,OAAOxc,EAAO,KAGlCkb,EAAOc,YAAY1sB,KAAK+sB,GACxBnB,EAAOe,aAAa3sB,KAAK8sB,IAE7BlB,EAAOiB,OACP,MAAMG,EAASvB,EAA0BsB,GACzCR,KAASU,IACL,MAAM,KAAEprB,GAASorB,EACbD,EAAO/gB,KAAKpK,IACZorB,EAASb,SAASU,EACtB,GACDlB,EAAOE,UACd,CACArL,eACImL,EAAOO,MAAQjB,EAAOK,OACtBK,EAAOc,YAAc,GACrBd,EAAOe,aAAe,GACtBf,EAAOiB,OACPN,KAASU,IACLA,EAASb,cAASjoB,EAAU,GAC7BynB,EAAOE,UACd,CACArL,0BAA0BuL,GACtB,MAAMmB,EAAejK,IAAQ8I,GAC7BO,KAASU,IAELA,EAASjB,UAAYmB,CAAY,GAClCvB,EAAOE,UACd,CACAsB,MAAM7kB,GACF,MAAM8kB,EAA0B,iBAAZ9kB,EAAuB,CAAE1G,KAAM0G,GAAYA,EACzD+kB,EAAWD,EAAK5sB,KAAO4sB,EAAKxrB,KAC5BA,EAAO2G,KAAK3G,KAAQ,GAAE2G,KAAK3G,QAAQwrB,EAAKxrB,OAASwrB,EAAKxrB,KACtDpB,EAAM+H,KAAK/H,IAAO,GAAE+H,KAAK/H,OAAO6sB,IAAaA,EACnD,OAAO,IAAI1B,EAAO,OAAD,QACbG,gBAAiBvjB,KAAKujB,gBACtBC,UAAWxjB,KAAKwjB,UAChBC,QAASzjB,KAAKyjB,QACdC,WAAY1jB,KAAK0jB,WACjB5E,SAAU9e,KAAK8e,UACZ+F,EAAI,CACPxrB,OACApB,QAER,CACA8sB,kBAAkBC,GACdhlB,KAAKujB,gBAAkBvjB,KAAKujB,gBAAgBzoB,OAAOkqB,EACvD,CACAC,mBAAmBzB,GACfxjB,KAAKujB,gBAAkB7I,IAAQ8I,EACnC,CACA0B,YAAYF,GACRhlB,KAAKwjB,UAAYxjB,KAAKwjB,UAAU1oB,OAAOkqB,EAC3C,CACAG,aAAa3B,GACTxjB,KAAKwjB,UAAY9I,IAAQ8I,EAC7B,CACA4B,UAAU7N,GACNvX,KAAKyjB,QAAUzjB,KAAKyjB,QAAQ3oB,OAAOyc,EACvC,CACA8N,WAAW5B,GACPzjB,KAAKyjB,QAAU/I,IAAQ+I,EAC3B,CACA6B,aAAaC,GACTvlB,KAAK0jB,WAAa1jB,KAAK0jB,WAAW5oB,OAAOyqB,GACzCvlB,KAAK0jB,WAAWlsB,KAAK+tB,EACzB,CACAC,cAAc9B,GACV1jB,KAAK0jB,WAAahJ,IAAQgJ,EAC9B,CACAE,SAASD,GACL3jB,KAAK2jB,MAAQA,CACjB,CACAG,eAEI,IAAK,IAAI3sB,EADGisB,EAAOc,YAAY7sB,OACZ,EAAGF,GAAK,EAAGA,IAAK,CAC/B,MAAM+rB,EAAYE,EAAOc,YAAY/sB,GAErC,GADe8rB,EAA0BC,GAC9Bzf,KAAKzD,KAAK3G,MAEjB,YADA2G,KAAK4jB,SAASR,EAAOe,aAAahtB,GAG1C,CACJ,CACAsuB,aAAa9B,EAAO9nB,GAChB,OAAO,OAAP,QACI6pB,KAAM,IAAI3f,MACP/F,KAAK8e,SAAQ,CAChBzlB,KAAM2G,KAAK3G,KACXF,KAAM6pB,EAAYW,GAClBA,QACA9nB,QAER,CACAgT,IAAI8U,EAAO9nB,GACP,IAAI8pB,EACA3lB,KAAKujB,gBAAgBlsB,SACrBsuB,EAAS3lB,KAAKylB,aAAa9B,EAAO9nB,IAEtC,IAAK,MAAMmpB,KAAYhlB,KAAKujB,gBACxByB,EAASnW,IAAI8W,GAEjB,QAA0B,IAAf3lB,KAAK2jB,OACZ,GAAIA,EAAQP,EAAOO,MACf,OAAO,OAGV,GAAIA,EAAQ3jB,KAAK2jB,MAClB,OAAO,EAENgC,IACDA,EAAS3lB,KAAKylB,aAAa9B,EAAO9nB,IAEtC,IAAK,MAAM0b,KAAUvX,KAAKyjB,QACtB,IAA8B,IAA1BlM,EAAOA,OAAOoO,GACd,OAAO,EAGf,IAAK,MAAMJ,KAAavlB,KAAK0jB,WACzBiC,EAASJ,EAAUK,OAAOD,GAE9B,IAAK,MAAMX,KAAYhlB,KAAKwjB,UACxBwB,EAASnW,IAAI8W,GAEjB,OAAO,CACX,EAEJvC,EAAOO,MAAQjB,EAAOK,OACtBK,EAAOE,UAAY,CAAC,EACpBF,EAAOc,YAAc,GACrBd,EAAOe,aAAe,GAEtB,MAAM0B,EAAc,CAChB,oBACA,qBACA,cACA,eACA,YACA,aACA,eACA,mBACG/tB,OAAO+C,KAAK6nB,IAEboD,EAAuB/lB,IACzB,MAAM0kB,EAAW,IAAIrB,EAAOrjB,GAC5B,OAAOjI,OAAO0H,QAAQqlB,GACXJ,EAASG,MAAMC,IACvBgB,EAAYE,QAAO,CAAC9Y,EAAK+Y,KACpBvB,EAASuB,KACT/Y,EAAI+Y,GAAUvB,EAASuB,GAAQhR,KAAKyP,IAEjCxX,IACR,CAAC,GAAI,CACJ2W,SAAUR,EAAOQ,SACjBqC,mBAAoB7C,EAAO6C,mBAC3BC,OAAQ9C,EAAO8C,OACfC,QAAS/C,EAAO+C,QAChBld,MAAOma,EAAOna,OAChB,EAGN,MAAMmd,EACFtmB,cACIE,KAAKqmB,aAAe,UACpBrmB,KAAKsmB,cAAgB,CACjB,EAAG,UACH,GAAI,UACJ,GAAI,UACJ,GAAI,UAEZ,CACAzX,IAAI8W,GACA,MAAMY,EAENZ,EAAOhC,MAAQ,GAAKrE,QAAQ5jB,MAAyB,KAAjBiqB,EAAOhC,MAAerE,QAAQtQ,KAAOsQ,QAAQzQ,IAG3E2X,EAAS,uBADDxmB,KAAKsmB,cAAcX,EAAOhC,QAAU3jB,KAAKqmB,6HAQjDI,EAAS,KAAI,CAACd,EAAOtsB,KAAMssB,EAAOxsB,MAAMoe,OAAOzS,SAAS3M,KAAK,OAErC,iBAAnBwtB,EAAO9pB,KAAK,GACnB0qB,EAAaruB,KAAKonB,QAAU,GAAEmH,OAAWd,EAAO9pB,KAAK,KAAM2qB,EAE3D,MAAOb,EAAO9pB,KAAKgO,MAAM,IAGzB0c,EAAaruB,KAAKonB,QAASmH,EAAOD,KAAUb,EAAO9pB,KAE3D,EAGJ,MAmBM6qB,EAAO,YAEb,IAAIC,EACAxV,EACJ,IACIwV,EAAKxqB,OAAOyqB,aACZzV,EAAQyB,KAAKiU,MAAMF,EAAGG,QAAQJ,GAEtB,CAAZ,MAAOxrB,GAAK,CACPiW,IACDA,EAjBkB,MAClB,IACI,MAdYnO,KAChB,IAAKA,EACD,OAEJ,MAAM+jB,EAAQ/jB,EAAM2K,MAAM,KAC1B,MAAO,CACHgW,MAAOjB,EAAOK,OACdoB,aAAc1sB,MAAMsvB,EAAM1vB,QAAQqP,KAAKgc,EAAOC,OAC9CuB,YAAa6C,EAChB,EAKUC,CAAW7qB,OAAOyqB,aAAaE,QAAQ,SAEtC,CAAZ,MAAO5rB,GAAK,GAaJ+rB,IAKZ7D,EAAO8D,aAAaC,IAChB,IACIR,EAAGS,QAAQV,EAAM9T,KAAKC,UAAUsU,GAExB,CAAZ,MAAOjsB,GAAK,KAEhBiW,GAASiS,EAAOiE,KAAKlW,GACrB,MAAMxC,EAASmX,EAAoB,CAC/BzsB,KAAM,GACNmqB,UAAW,CAAC,IAAI4C,KAEpBjqB,OAAOwS,OAASA,EAGhB,MAAM2Y,EAAe5rB,IACb2O,IAAS3O,KAETA,EAAQ,IAAIE,MAAMF,IAEf,OAAP,UACOA,EAAK,CAIR6rB,KAAMnF,EAAkB1mB,EAAM6rB,MAE9BC,KAAMpF,EAAkB1mB,EAAM8rB,MAC9BnoB,QAAS3D,EAAM2D,QACfI,MAAO/D,EAAM+D,SA8CrB,MAAMgoB,EACF3nB,aAAY,aAAE4nB,EAAY,YAAEC,EAAW,WAAEC,IACrC5nB,KAAK6nB,SAAW,EAChB7nB,KAAK8nB,MAAQ,GACb9nB,KAAK0nB,aAAeA,GAAgB,EACpC1nB,KAAK2nB,YAAcA,EACnB3nB,KAAK4nB,WAAaA,GAAc,CAAE9E,OAAO,EAC7C,CACAiF,aACQ/nB,KAAK8nB,MAAMzwB,QAAU2I,KAAK6nB,SAAW7nB,KAAK0nB,cAC1C1nB,KAAKgoB,aAEb,CACAA,cACI,MAAMrC,EAAS3lB,KAAK8nB,MAAMG,QAE1BjoB,KAAK6nB,WAEL7nB,KAAK2nB,YA7DOhC,KAChB,IACItmB,EACA3D,EAFAwsB,EAAS,KAGb,MAAM,KAAErsB,GAAS8pB,EACb9pB,EAAK,aAAcD,OACnBF,EAAQ4rB,EAAYzrB,EAAK,IAErBwD,EADAgL,IAASxO,EAAK,IACJA,EAAK,GAGLA,EAAK,GAAGwD,SAGjBwM,IAAShQ,EAAK,MAAQnE,IAAQmE,EAAK,KACxCqsB,EAASrsB,EAAK,GACdH,EAAQwsB,EAAOxsB,OAAS4rB,EAAYY,EAAOxsB,OACvCG,EAAK,GAAGwD,QACRA,EAAUxD,EAAK,GAAGwD,QAEbgL,IAASxO,EAAK,MACnBwD,EAAUxD,EAAK,KAInBwD,EAAUxD,EAAK,GAEnB,MAAMssB,EAAYtsB,EAAKgO,MAAMxK,IAAYxD,EAAK,GAAK,EAAI,GAAGwH,KAAK/L,GACvDA,aAAesE,MACR,CAAEF,MAAO4rB,EAAYhwB,IAEzBA,IAEX,OAAO,OAAP,UACOquB,EAAM,CACT9pB,KAAMssB,EAAU9wB,OAAS8wB,OAAYxsB,GAClCusB,EAAM,CACTxsB,QACA2D,WAAO,EAuBU+oB,CAAWzC,IACvB0C,MAAMC,KACN3Y,MAAK,KAEN3P,KAAK6nB,WACL7nB,KAAK+nB,YAAY,GAEzB,CACAQ,OAAO5C,GACH3lB,KAAK8nB,MAAMtwB,KAAKmuB,GAChB3lB,KAAK+nB,YACT,CACAlZ,IAAI8W,GACA,MAAM,KAAExsB,EAAI,OAAEovB,GAAW5C,EACX,MAAV4C,EAMAvoB,KAAK4nB,WAAWzuB,IAChB6G,KAAKuoB,OAAO5C,KANG,IAAX4C,GAAmBC,IAAO,CAAC,aAAcrvB,IAAO,EAAMovB,KACtDvoB,KAAKuoB,OAAO,OAAD,UAAM5C,EAAQ,CAAA4C,YAAQ5sB,IAO7C,EC7bJ,MCMM8sB,IAAgCtoB,EAAAA,EAAAA,IAAY,6BAK5CuoB,IAAiCvoB,EAAAA,EAAAA,IAAY,8BAK7CwoB,IAAmCxoB,EAAAA,EAAAA,IAAY,+BAAgC,CACjFU,OAAO,I,8CCLX,MAGM+nB,IAAUlY,EAAAA,EAAAA,IAAY,WACtBmY,IAAWjY,EAAAA,EAAAA,IAAc,UAAW,IAAIM,GAAG0X,IAAS,CAACpG,EAAGsG,IAASA,IAqBvE,MAAMC,GACFjpB,YAAYgpB,GACR9oB,KAAK8oB,KAAO,GACZ9oB,KAAK8oB,KAAOA,CAChB,CACAlD,OAAOD,GACH,MAAOzd,GAASyd,EAAO9pB,KAEvB,OAAOmE,KAAK8oB,KAAK5gB,EACrB,GAGA5G,EAAAA,EAAAA,IAAQ,CACJA,QAASwb,EAAAA,GACTjc,OAAO,EACPgC,WAAU,EAAC,SAAEmiB,KACDgE,IACJA,EAAe9D,YAAYF,EAAS,EAG5C/iB,KAAM,CACF+iB,SAAU,qBAGlB1jB,EAAAA,EAAAA,IAAQ,CACJA,QAAS,iBACTV,MAAO5B,EAAAA,GAAAA,UACP8D,SA9CR,MACIhD,cACIE,KAAK8oB,KAAO,EAChB,CACAja,IAAI8W,GACA3lB,KAAK8oB,KAAKtxB,KAAKmuB,EACnB,CACAsD,QACIjpB,KAAKkpB,OACT,CACAA,QACIlpB,KAAK8oB,KAAO,EAChB,CACAK,QACI,MAAMC,EAAUppB,KAAK8oB,KAErB,OADA9oB,KAAKkpB,QACEE,CACX,MA+BA9nB,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAUsnB,MAEdvnB,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAGmiB,cACJ,WACHA,EAASiE,OACb,EAEJhnB,KAAM,CACF+iB,SAAU,qBAGlB1jB,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,aACTvR,OAAO,EACPgC,WAAY,EAAGwP,UAAS2S,eACpB,MAAM8D,EAAO9D,EAASmE,QACtB,OAAO,WACH,OAAO9W,EAAQS,SAAS8V,GAAQE,GACpC,CAAC,EAEL7mB,KAAM,CACFoQ,QAASc,EAAAA,GACT6R,SAAU,qBAGlB1jB,EAAAA,EAAAA,IAAQ,CACJA,QAASqnB,GACT9nB,OAAO,EACPgC,WAAY,EAAGwmB,yBACX,OFnGcC,EEmGU,CACpBtD,OAAQ,MACRhZ,KAAM,UACNyB,eAAgB8a,WAAW,MAAEC,KACzB,MAAM,KAAEC,EAAI,MAAE9F,EAAK,OAAEuC,GAAWsD,EAE1BE,EAAqBD,GAAQ9F,GAASuC,EAC5C,IAAIyD,EACAC,EAHgC,YAATH,IAKvBE,EAAaN,EAAmB7nB,IAAI,eACpCooB,EAAcP,EAAmB7nB,IAAI,iBAErCmiB,IACAgG,EAAahG,GAEbuC,IACA0D,EAAc1D,GAEdwD,GACAG,EAAAA,QAEAF,GACAE,EAAAA,SAAkBF,GAElBC,GACAE,MAAMlhB,IACF,MAAO0b,EAAKjrB,GAAQuP,EAAI+E,MAAM,KAC9Bkc,EAAAA,OAAgBvF,EAAKjrB,EAAK,GAC3BsU,KAAM,IAAKic,GAEtB,GFjIG9xB,OAAO0H,OAAO8pB,EAAK9V,QAAS,CACvC,oBAAmB,OAAH,UACT8V,EAAI,CACPvpB,QAAS,OAAF,QACHqL,QAPQ,KAQLke,EAAKvpB,SAEZimB,OAAQsD,EAAKtD,QAAU,UARTsD,KEmIZ,EAENrnB,KAAM,CACFonB,mBAAoBpM,EAAAA,OAc5B3b,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAUsnB,MAEdvnB,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAG8L,SAAQsD,WACZ,WACH,MAAM6W,EAAO7W,EAAMC,SAAS2W,IApB1B,EAACkB,EAAWjB,KACtBA,GAAQA,EAAKzxB,SAEbioB,QAAQ0K,eAAe,wBAAyB,mBAChDlB,EAAK3nB,SAAQ,CAACwkB,EAAQzd,IAAU6hB,EAAUpE,EAAOxsB,MAAM+O,KAEvDoX,QAAQ2K,WACZ,EAqBYC,CAPkBvb,EAAO,CACrBtV,KAAM,aAENkqB,gBAAiB,GACjBC,UAAW,CAAC,IAAI4C,GAChB1C,WAAY,CAAC,IAAIqF,GAAiBD,MAEjBA,EACzB,EAEJ7mB,KAAM,CACF0M,OAAQC,EAAAA,GACRqD,MAAOE,EAAAA,MAjCnB,MAsCMxD,GAASmX,EAAoB,CAC/BzsB,KAvKgB,GAwKhBpB,IAvKe,UAwKfurB,UAAW,CAAC,IAAI4C,KAEpB,IAAI+D,GAAY,QAEhBA,IAAYrY,EAAAA,EAAAA,IAAW,EACnB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,CAEP,CACIzC,QAASsN,EAAAA,GACT/L,YAAW,gBAAEunB,IACT,GAAIA,EACA,IAAK,MAAMC,KAAUD,EACjBC,EAAO1b,IAGf,OAAOA,EACX,EACA1M,KAAM,CACFmoB,gBAAiB,CAAEzqB,MAAOmd,EAAAA,GAAkBjc,OAAO,EAAMT,UAAU,SAKpF+pB,I,qGC7MY,SAASG,KAYtB,OAXAA,GAAWxyB,OAAO0H,OAAS1H,OAAO0H,OAAOwV,OAAS,SAAU7Q,GAC1D,IAAK,IAAIhN,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAIuV,EAAStV,UAAUD,GACvB,IAAK,IAAIc,KAAOyU,EACV5U,OAAOC,UAAUf,eAAekB,KAAKwU,EAAQzU,KAC/CkM,EAAOlM,GAAOyU,EAAOzU,GAG3B,CACA,OAAOkM,CACT,EACOmmB,GAAS1yB,MAAMoI,KAAM5I,UAC9B,CCbe,SAASmzB,GAAgBC,EAAG7tB,GAKzC,OAJA4tB,GAAkBzyB,OAAO2yB,eAAiB3yB,OAAO2yB,eAAezV,OAAS,SAAyBwV,EAAG7tB,GAEnG,OADA6tB,EAAElX,UAAY3W,EACP6tB,CACT,EACOD,GAAgBC,EAAG7tB,EAC5B,C,eCeA,IAAI+tB,GACJC,KAAAA,gBAcIC,GACa,CAAC,EAGdC,GAAiB,UAEjBC,GAAkB,WAkClBlT,GAAW,SAAkB7a,GAC/B,OAAOA,CACT,EAEA,SAASguB,GAAeC,GACtB,IAAIC,EAAwBD,EAAKE,wBAC7BA,OAAoD,IAA1BD,EAAmCrT,GAAWqT,EACxEE,EAAUH,EAAKhxB,OACfoxB,EAASJ,EAAKI,OAElB,SAASC,EAASC,EAAqBvrB,QACrB,IAAZA,IACFA,EAAU,CAAC,GAGb,IAAIwrB,EA/CR,SAA4BA,GAC1B,MAAoB,mBAATA,EACF,CACLC,aAAcD,EACdE,QAAS,WAET,EACAC,UAAW,WAEX,GAIGH,CACT,CAiCeI,CAAmBL,GAC1BpK,EAAQ,CAAC,EAQb,SAAS0K,EAAajf,GACpB,OAAI5M,EAAQ8rB,SACH9rB,EAAQ8rB,SAASlf,GAGtB4e,EAAKE,QACAF,EAAKE,QAAQ9e,GAGf,QACT,CAUA,SAAS8e,EAAQrzB,EAAQuU,EAAOmf,GAC9B,IAAIC,EAAYhsB,EAAQisB,iBAAmBjsB,EAAQisB,iBAAiB5zB,EAAQuU,GAASue,EAAwB9yB,GAE7G,GAAI2H,EAAQisB,oBAAqBltB,EAAAA,GAAAA,oBAAmBitB,GAClD,MAAM,IAAInwB,MAAM,sEAMlB,OAHApB,KAAqBsxB,EAAUC,EAAW,CACxCE,SAAS,IAEJF,CACT,CAEA,IAzEiDA,EAC/CG,EAwEEC,EAAa,SAAoBxf,GACnC,IAAIkf,EAAWD,EAAajf,GAExByf,EAAUlL,EAAM2K,GAkBpB,OAhBKO,GAAWA,EAAQC,SAAWvB,MACjCsB,EAAUb,EAAKC,aAAa7e,IACpB0f,OAASxB,GACjB3J,EAAM2K,GAAYO,EAClBA,EAAQzc,MAAK,WACXyc,EAAQC,OAtGI,UAuGd,IAAG,SAAU3wB,GACX4jB,QAAQ5jB,MAAM,+DAAgE,CAC5E4wB,SAAUf,EAAKE,QAAQ9e,GACvB+e,UAAWH,EAAKG,UAAU/e,GAC1BjR,MAAOA,EAAQA,EAAM2D,QAAU3D,IAEjC0wB,EAAQC,OAASvB,EACnB,KAGKsB,CACT,EAEIG,EAEJ,SAAUC,GC9JC,IAAwBC,EAAUC,ED2K3C,SAASH,EAAc5f,GACrB,IAAItB,EAWJ,OATAA,EAAQmhB,EAAiBt0B,KAAK8H,KAAM2M,IAAU3M,MACxCmR,MAAQ,CACZjP,OAAQ,KACRxG,MAAO,KACPixB,SAAS,EACTd,SAAUD,EAAajf,IA3KjC,SAAmBxR,EAAWkE,GAC5B,IAAIlE,EAAJ,CACA,IAAIO,EAAQ,IAAIE,MAAM,aAAeyD,GAGrC,MAFA3D,EAAMM,YAAc,EACpBN,EAAMrC,KAAO,sBACPqC,CAJe,CAKvB,CAuKQ4e,EAAW3N,EAAMigB,kBAAoBrB,EAAKsB,YAAa,4DAEnDlgB,EAAMigB,mBAEY,IAAhB7sB,EAAQ+sB,MAMZvB,EAAKC,aAAa7e,GAAc,OAAE,WAChC,OAAO,IACT,IAEAtB,EAAM0hB,WAENpgB,EAAMigB,iBAAiBI,SAASzB,EAAKG,UAAU/e,KEtM1C,SAAgCzQ,GAC7C,QAAa,IAATA,EACF,MAAM,IAAI+wB,eAAe,6DAE3B,OAAO/wB,CACT,CFsLmBgxB,CAAuB7hB,MAoBd,IAAhBtL,EAAQ+sB,MACZvB,EAAK4B,SAAW5B,EAAK4B,QAAQxgB,IAC7B4e,EAAKG,WAAad,GAA8BW,EAAKG,UAAU/e,MAC7DtB,EAAM0hB,WAGD1hB,EACT,CCrN2CqhB,ED+JbF,GC/JGC,ED+JlBF,GC9JVx0B,UAAYD,OAAO+U,OAAO6f,EAAW30B,WAC9C00B,EAAS10B,UAAU+H,YAAc2sB,EACjChC,GAAegC,EAAUC,GD8JrBH,EAAcvzB,yBAA2B,SAAkC2T,EAAOwE,GAChF,IAAI0a,EAAWD,EAAajf,GAE5B,OAAO2d,GAAS,CAAC,EAAGnZ,EAAO,CACzB0a,SAAUA,EAEVc,QAASxb,EAAMwb,SAAWxb,EAAM0a,WAAaA,GAEjD,EA8CA,IAAIuB,EAASb,EAAcx0B,UAmL3B,OAjLAq1B,EAAOC,kBAAoB,WACzBrtB,KAAKstB,SAAU,EAEf,IAAIC,EAAgBvtB,KAAKwtB,WAErBD,GAAiBA,EAAclB,SAAWvB,IAC5C9qB,KAAKytB,WAIHztB,KAAKmR,MAAMwb,SACb3sB,KAAK0tB,WAET,EAEAN,EAAOO,mBAAqB,SAA4BC,EAAWC,GAE7DA,EAAUhC,WAAa7rB,KAAKmR,MAAM0a,UACpC7rB,KAAK0tB,WAET,EAEAN,EAAOU,qBAAuB,WAC5B9tB,KAAKstB,SAAU,CACjB,EAEAF,EAAOW,aAAe,SAAsBC,EAAWlX,GACjD9W,KAAKstB,SACPttB,KAAKqY,SAAS2V,EAAWlX,EAE7B,EAOAsW,EAAOa,YAAc,WACnB,OAAOrC,EAAa5rB,KAAK2M,MAC3B,EAMAygB,EAAOI,SAAW,WAChB,OAAOtM,EAAMlhB,KAAKiuB,cACpB,EAMAb,EAAOK,SAAW,SAAkBzqB,QACpB,IAAVA,IACFA,OAAQrH,GAGVulB,EAAMlhB,KAAKiuB,eAAiBjrB,CAC9B,EAEAoqB,EAAOc,cAAgB,WACrB,IAAIC,EAASnuB,KAETorB,GACF9iB,YAAW,WACT8iB,EAAO+C,EAAOhd,MAAMjP,OAAQisB,EAAOxhB,MACrC,GAEJ,EAQAygB,EAAOL,SAAW,WAGhB,GAAK/sB,KAAKmR,MAAMwb,QAEhB,IACE,IACIzqB,EAASupB,EADMF,EAAKsB,YAAY7sB,KAAK2M,OACN3M,KAAK2M,MAAOmf,GAC/C9rB,KAAKmR,MAAMjP,OAASA,EACpBlC,KAAKmR,MAAMwb,SAAU,CAQvB,CAPE,MAAOjxB,GACP4jB,QAAQ5jB,MAAM,8FAA+F,CAC3G4wB,SAAUf,EAAKE,QAAQzrB,KAAK2M,OAC5B+e,UAAWH,EAAKG,UAAU1rB,KAAK2M,OAC/BjR,MAAOA,EAAQA,EAAM2D,QAAU3D,IAEjCsE,KAAKmR,MAAMzV,MAAQA,CACrB,CACF,EAMA0xB,EAAOM,UAAY,WACjB,IAAIU,EAASpuB,KAETosB,EAAUpsB,KAAKquB,eAgBnB,OAfAjC,EAAQzc,MAAK,SAAU2e,GACrB,IAAIpsB,EAASupB,EAAQ6C,EAAcF,EAAOzhB,MAAOmf,GAEjDsC,EAAOL,aAAa,CAClB7rB,OAAQA,EACRyqB,SAAS,IACR,WACD,OAAOyB,EAAOF,eAChB,GACF,IAAU,OAAE,SAAUxyB,GACpB,OAAO0yB,EAAOL,aAAa,CACzBryB,MAAOA,EACPixB,SAAS,GAEb,IACOP,CACT,EAOAgB,EAAOiB,aAAe,WACpB,IAAIE,EAAcvuB,KAAK2M,MAGnBA,GAFmB4hB,EAAY3B,iBAChB2B,EAAYC,aACnB1Q,EAA8ByQ,EAAa,CAAC,mBAAoB,kBAE5E,OAAOpC,EAAWxf,EACpB,EAEAygB,EAAOpzB,OAAS,WACd,IAAIy0B,EAAezuB,KAAK2M,MACpB6hB,EAAeC,EAAaD,aAC5BE,EAAeD,EAAaztB,SAE5B2L,GADmB8hB,EAAa7B,iBACxB9O,EAA8B2Q,EAAc,CAAC,eAAgB,WAAY,sBAEjFE,EAAc3uB,KAAKmR,MACnBzV,EAAQizB,EAAYjzB,MACpBixB,EAAUgC,EAAYhC,QACtBzqB,EAASysB,EAAYzsB,OAEzB,GAAInC,EAAQ6uB,WACU5uB,KAAKwtB,YAAcxtB,KAAK0tB,aAE1BrB,SAAWxB,GAC3B,MAAM7qB,KAAK0tB,YAIf,GAAIhyB,EACF,MAAMA,EAGR,IAAIsF,EAAW0tB,GAAgB3uB,EAAQiB,UAAY,KAEnD,OAAI2rB,EACK3rB,EAGFmqB,EAAQ,CACbnqB,SAAUA,EACVkB,OAAQA,EACRnC,QAASA,EACT4M,MAAO2d,GAAS,CAAC,EAAG3d,EAAO,CACzBvD,IAAKolB,KAGX,EAEOjC,CACT,CA7OA,CA6OE5B,KAAAA,WAEEkE,GAjVF3C,EAA6B,SAAoCvf,GACnE,OAAOge,KAAAA,cAAoBD,GAAQxP,SAAU,MAAM,SAAU4T,GAC3D,OAAOnE,KAAAA,cAAoBoB,EAAWj0B,OAAO0H,OAAO,CAClDotB,iBAAkBkC,GACjBniB,GACL,GACF,GAPmDof,EAkVFQ,GAzUnC1zB,cACZqzB,EAA2BrzB,YAAckzB,EAAUlzB,YAAc,sBAG5DqzB,GAsUDJ,EAAWnB,KAAAA,YAAiB,SAAUhe,EAAOvD,GAC/C,OAAOuhB,KAAAA,cAAoBkE,EAAuB/2B,OAAO0H,OAAO,CAC9DgvB,aAAcplB,GACbuD,GACL,IAWA,OAVAmf,EAASjzB,YAAc,WAEvBizB,EAASG,QAAU,SAAUtf,GAC3Bmf,EAASzE,KAAK1a,EAChB,EAEAmf,EAASzE,KAAO,SAAU1a,GACxB,OAAOwf,EAAWxf,EACpB,EAEOmf,CACT,CAQA,MAAO,CACLT,SAAUA,EACV0D,KARF,SAAcxD,EAAMxrB,GAClB,OAAOsrB,EAASE,EAAMjB,GAAS,CAAC,EAAGvqB,EAAS,CAC1C6uB,UAAU,IAEd,EAMF,CASA,IAAII,GAEJjE,GAAe,CACbG,wBAVF,SAAiCoD,GAE/B,OAAOA,EAAaW,WAAaX,EAAsB,QAAIA,EAAsB,SAAKA,CACxF,EAQEt0B,OAAQ,SAAgBgxB,GACtB,IAAIe,EAAYf,EAAK9oB,OACjByK,EAAQqe,EAAKre,MACjB,OAAOge,KAAAA,cAAoBoB,EAAWpf,EACxC,IAEE0e,GAAW2D,GAAgB3D,SAC3B0D,GAAOC,GAAgBD,KAIvBG,GAEJnE,GAAe,CACbK,OAAQ,SAAgBlpB,EAAQyK,GAC1BzK,GAAUyK,EAAM6hB,eACgB,mBAAvB7hB,EAAM6hB,aACf7hB,EAAM6hB,aAAatsB,GAEnByK,EAAM6hB,aAAajlB,QAAUrH,EAGnC,EACAlI,OAAQ,SAAgBgxB,GACtB,IAAI9oB,EAAS8oB,EAAK9oB,OACdyK,EAAQqe,EAAKre,MAEjB,OAAIA,EAAMqO,SACDrO,EAAMqO,SAAS9Y,GAGjB,IACT,IAEEitB,GAAaD,GAAkB7D,SAC/B+D,GAASF,GAAkBH,KAiF3BM,GAAahE,GACjBgE,GAAWC,IAAMH,GACJJ,GACNO,IAAMF,GAGb,YG1iBMG,IAAYnY,EAAAA,GAAAA,eAAc,MAoBhC,SAASoY,GAAMvtB,GACX,MAAM+L,EAnBa,MACnB,MAAMA,GAAKkL,EAAAA,GAAAA,YAAWqW,IACtB,IAAKvhB,EAMD,MAAM,IAAIpS,MAAM,0BAEpB,OAAOoS,CAAE,EASEyhB,GACX,OAAOpW,EAAAA,GAAAA,UAAQ,KACX,MAAwB,oBAApBpX,EAAKpK,YARL,UADW8H,EAS4CsC,KAP5B,IAA9BnK,OAAO+C,KAAK8E,GAAOtI,QACU,kBAAnBsI,EAAMS,UACU,kBAAhBT,EAAMkB,OAMNmN,EAAGxM,IAAIS,GAEXytB,MAAQC,GAAQ3hB,EAAGxM,IAAImuB,IAAM1tB,GAZrBtC,KAY0B,GAC1C,CAACsC,EAAM+L,GACd,CAEA,MASM4hB,GAAgB,KACVC,EAAAA,GAAAA,MAAK,MAAO,CAAE7U,SAAU,EAACC,EAAAA,GAAAA,KAAI,MAAO,CAAEuL,MAAO,CACrCsJ,UAAW,SACXC,aAAc,GACdC,WAAY,GACZC,SAAU,GACVC,WAAY,OACZC,WAAY,KACbnV,SAAU,0BAA2B6U,EAAAA,GAAAA,MAAK,MAAO,CAAErJ,MAAO,CACzDsJ,UAAW,SACXC,aAAc,GACdK,MAAO,UACPH,SAAU,GACVC,WAAY,QACblV,SAAU,CAAC,MAAO,KAAKC,EAAAA,GAAAA,KAAI,IAAK,CAAEoV,KAAM,GAAIC,QAAS,IAAMn0B,OAAOmlB,SAASiP,SAAUvV,SAAU,6BAElH4U,GAAc/2B,YAAc,gBAE5B,MAAM23B,WAA+BzE,GAAAA,UACjCjsB,YAAY6M,GACR9I,MAAM8I,GACN3M,KAAKmR,MAAQ,CACTzV,MAAOiR,EAAMjR,OAAS,KACtB+0B,IAAK9jB,EAAM8jB,IAEnB,CAEAxY,gCAAgCtL,EAAOwE,GACnC,OAAIxE,EAAM8jB,MAAQtf,EAAMsf,IACb,CAAE/0B,MAAOiR,EAAMjR,OAAS,KAAM+0B,IAAK9jB,EAAM8jB,KAE7C,CAAE/0B,MAAOiR,EAAMjR,OAASyV,EAAMzV,MAAO+0B,IAAKtf,EAAMsf,IAC3D,CACAxY,gCAAgCvc,GAC5B,MAAO,CAAEA,QACb,CACAg1B,kBAAkBh1B,EAAOi1B,GACrB,MAAM,cAAEC,GAAkB5wB,KAAK2M,MAC3BikB,GACAA,EAAczvB,SAASqS,IACnBA,EAAQ9X,EAAOi1B,EAAU,GAGrC,CACA32B,SACI,MAAM,SAAEghB,EAAUha,SAAU6vB,EAAQ,eAAEC,GAAmB9wB,KAAK2M,OACxD,IAAE8jB,EAAG,MAAE/0B,GAAUsE,KAAKmR,MAC5B,OAAKzV,EAGDm1B,GACO5V,EAAAA,GAAAA,KAAI4V,EAAU,CAAEJ,IAAKA,EAAK/0B,MAAOA,IAExCo1B,IAGG7V,EAAAA,GAAAA,KAAI2U,GAAe,CAAC,GARhB5U,CASf,EAEJwV,GAAuB33B,YAAc,yBAErC,MAAMk4B,IAAuB5wB,EAAAA,EAAAA,IAAY,6BAA8B,CACnEU,OAAO,IAMLmwB,IAA0C7wB,EAAAA,EAAAA,IAAY,kCAK5D,IAAI8wB,GAAgB,cAA4BlF,GAAAA,UAC5CjsB,YAAY6M,GACR9I,MAAM8I,GACN3M,KAAKmR,MAAQ,CACT+f,UAAU,EAElB,CACAjZ,kCACI,MAAO,CAAEiZ,UAAU,EACvB,CACAR,kBAAkBh1B,EAAOi1B,GACrB,MAAM,cAAEC,GAAkB5wB,KAAK2M,MAC3BikB,GACAA,EAAczvB,SAASqS,IACnBA,EAAQ9X,EAAOi1B,EAAU,GAGrC,CACA32B,SACI,MAAM,SAAEghB,EAAQ,kBAAEmW,EAAiB,wBAAEC,GAA4BpxB,KAAK2M,OAChE,SAAEukB,GAAalxB,KAAKmR,MAC1B,OAAK+f,EAGEC,GAAqBC,IAA2BnW,EAAAA,GAAAA,KAAI2U,GAAe,CAAC,GAFhE5U,CAGf,GA3GY/Y,OA6GhBgvB,GAAcp4B,YAAc,gBAC5Bo4B,IAAgBnf,EAAAA,EAAAA,IAAW,EA9GX7P,GA+GL,CACH2uB,cAAe,CAAEjxB,MAAOoxB,GAAsB3wB,UAAU,GACxDgxB,wBAAyB,CAAEzxB,MAAOqxB,GAAyC5wB,UAAU,IAjHnEixB,GAMfC,MALP,SAAgC3kB,GAC5B,MAAM4kB,EAAe/B,GAAMvtB,IAE3B,OAAOgZ,EAAAA,GAAAA,KAAIoW,EAAkB,OAAF,UAAO1kB,EAAU4kB,GAChD,GAC4CF,KA6G7CJ,IAKH,MAOMO,GAAuB/iB,UACzB,GAAKgjB,EAAL,CAGA,GAAI,SAAUA,GAAuD,mBAA3BA,EAAkBpK,KAAqB,CAC7E,MAAM9hB,QAAYksB,EAAkBpK,OACpC,IAAIxtB,EAUJ,OARIA,EADA0L,EAAI0pB,WACQ1pB,EAAIjN,QAGJiN,EAAIjN,SAAWiN,EAI/B+rB,KAAaG,EAAmB53B,GACzBA,CACX,CACA,OAAO43B,CAfP,CAewB,EAMtBC,GAAqB,CAACh2B,EAAO2rB,KAK/B,GAAmE,2BAA9D3rB,aAAqC,EAASA,EAAM8rB,MAAmC,CACxF,MAAMmK,EAAgBj2B,EAAMk2B,QAK5B,GAFwBtgB,SAASugB,cAAe,cAAaF,QACzDrgB,SAASugB,cAAe,mBAAkBF,OAE1C,OAAOtK,GAEf,CACA,MAAM3rB,CAAK,EC1Mb,IACEo2B,OAAQ,CACN,iBD0MO,EAACzK,EAAMtnB,EAAU,CAAC,KAU3B,MAAMgyB,EAAsB1K,EAAK2K,YAIjC,OADA3K,EAAK2K,YAAc,IAAMD,IAAsB1J,OAAOntB,GAAMw2B,GAAmBx2B,EAAG62B,KAC3E1G,GAAShE,EAAM,CAClBrmB,SAAUjB,EAAQ4sB,SACpB,EC1NkBoC,CAAK,CAAD,wIAAC,IAAM,2CAAsG,6FAErIkD,MAAO,CAEP,EACAC,QAAS,CAET,EACAC,gBAAiB,CAEjB,GCAEC,GAA0B,IACrBC,GAAAA,QAELC,GAAkC,IAC7BD,GAAAA,gBAELE,GAA6BC,KAEzBA,GACkD,IAApDA,EAAczoB,QApBW,MA2D3B0oB,GAA6BD,GACvB,GAAEA,YAMRE,GAAoCF,GAC9B,GAAEA,mBAERG,GAAyBH,IAC3B,MAAMn5B,EAAOm5B,EACPxlB,EA5C0BwlB,IACxB,IAAGA,EACNz2B,QAAS,YAA2F,IACpGA,QAAQ,YAAa,OACrBA,QAAQ,UAAW,MAwCX62B,CAA2BJ,GAClCN,EAAUE,KACVD,EAAkBG,KAClBO,EAAQ,CACVx5B,OACA2T,OACA8lB,OAAQ,CACJN,kBASR,OANIA,KAAiBN,IACjBW,EAAMC,OAAOC,sBAAwBN,GAA0BD,IAE/DA,KAAiBL,IACjBU,EAAMC,OAAOE,uBAAyBN,GAAiCF,IAEpEK,CAAK,E,gDCpFhB,MAAMI,IAAkB9yB,EAAAA,EAAAA,IAAY,mBAK9B+yB,IAAmB/yB,EAAAA,EAAAA,IAAY,oB,sFCW/BgzB,I,OAlBgBC,GAAW,sBAkBhB3C,GACNA,EAAI4C,SAAW5C,EAAI6C,OAAS7C,EAAI8C,MAErCC,GAAiB/C,IACnB,MAAMjH,EAAQ1xB,OAAO+U,OAAO,MAC5B4jB,EAAIgD,aAAatyB,SAAQ,CAAC6B,EAAO/K,KAExBH,OAAOC,UAAUf,eAAekB,KAAKsxB,EAAOvxB,GAGxCR,MAAMC,QAAQ8xB,EAAMvxB,IACzBuxB,EAAMvxB,GAAKT,KAAKwL,GAGhBwmB,EAAMvxB,GAAO,CAACuxB,EAAMvxB,GAAM+K,GAN1BwmB,EAAMvxB,GAAO+K,CAOjB,IAEJ,MAAMuK,EAAMkjB,EAAI54B,WACVmV,EAAOmmB,GAAQ1C,GACfvuB,EAAS,CACXmuB,KAAMrjB,EACN0mB,OAAQjD,EAAIiD,OACZnS,SAAUkP,EAAIlP,SACdoS,SAAUlD,EAAIkD,SACdC,SAAUnD,EAAImD,SACdC,KAAMpD,EAAIoD,KACVR,SAAU5C,EAAI4C,SACdrmB,OACAsmB,OAAQ7C,EAAI6C,OACZC,KAAM9C,EAAI8C,KACV/J,SAaJ,MAXiB,cAAbiH,EAAI3O,MACJhqB,OAAO0H,OAAO0C,EAAQ,CAClBmuB,KAAMI,EAAIJ,KACVvO,KAAM2O,EAAI3O,KACVI,SAAUuO,EAAIvO,WAGtBpqB,OAAOoC,eAAegI,EAAQ,WAAY,CACtCc,MAAO,IAAMuK,EACbumB,YAAY,IAET5xB,CAAM,EAEX6xB,GAAW,CAACtD,EAAKuD,EA9CG,KAA4D73B,OAAOmlB,SAAS+O,KA8CrE4D,KACtB,IAAIC,IA/DOzD,KAClB,GAAIA,EAAIp5B,OAAS,EACb,OAAO,EAEX,IAAK,IAAI6Q,EAAQ,EAAGA,EAAQuoB,EAAIp5B,OAAQ6Q,IACpC,OAAQuoB,EAAIvoB,IACR,IAAK,IACD,OAAO,EACX,IAAK,IACD,MACJ,QACI,OAAO,EAGnB,OAAO,CAAI,EAiDIisB,CAAa1D,GAAOA,EAAI10B,QAAQ,OAAQ,KAAO00B,EAAKuD,GAEjEnN,GAAS4J,GACJ+C,GAAcO,GAAStD,IAiB5B2D,GAAc,oCAYdC,GAA4B,CAACZ,EAAcjK,KAC7CzF,KAAQ,CAACuQ,EAAI/3B,KACL9E,MAAMC,QAAQ48B,IACdb,EAAa5qB,OAAOtM,GACpButB,MAAM/sB,GAAM02B,EAAac,OAAOh4B,EAAGQ,IAAIu3B,SAEpB,IAAPA,EACZb,EAAa5qB,OAAOtM,GAGpBk3B,EAAalxB,IAAIhG,EAAG+3B,EACxB,GACD9K,EAAM,E,gDC9Gb,MAAMgL,IAAiCr0B,EAAAA,EAAAA,IAAY,gCAC7Cs0B,IAAmCt0B,EAAAA,EAAAA,IAAY,iCAAkC,CAAEU,OAAO,I,4NCHhG,MAAM6zB,WAAoB94B,MACtBkE,YAAYT,GACRwE,MAAMxE,GACNW,KAAK20B,UAAW,EAChB30B,KAAK3G,KAAOq7B,GAAYE,SAC5B,EAEJF,GAAYE,UAAY,cACxB,MAAMC,GAAiBt1B,KACVA,EAAIo1B,SAQjB,MAAMG,WAAkBl5B,MACpBkE,YAAY,GAA6D,IAA7D,QAAET,EAAU,aAAY,WAAE01B,GAAiC,EAAlBC,EAAgB,QACjEnxB,MAAMxE,GACNW,KAAK3G,KAAOy7B,GAAUF,UACtB50B,KAAK+0B,WAAaA,EAClBj9B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJF,GAAUF,UAAY,YAEtB,MAAMK,WAAsBH,GACxBh1B,YAAY,EAAiD,CAAC,GAAG,IAArD,QAAET,EAAU,aAAqC,EAArB21B,EAAgB,QACpDnxB,MAAM,CAAExE,UAAS01B,WAAY,MAC7B/0B,KAAK3G,KAAO47B,GAAcL,UAC1B98B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJC,GAAcL,UAAY,gBAE1B,MAAMM,WAA2BJ,GAC7Bh1B,YAAY,GAAgF,IAAhF,QAAET,EAAU,iBAAgB,QAAE81B,EAAO,WAAEJ,EAAa,KAA0B,EAAlBC,EAAgB,QACpFnxB,MAAM,CAAExE,UAAS01B,eACjB/0B,KAAK3G,KAAO67B,GAAmBN,UAC/B50B,KAAKm1B,QAAUA,EACfn1B,KAAK+0B,WAAaA,EAClBj9B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJE,GAAmBN,UAAY,qBAE/B,MASMQ,GAAwB71B,GACnBA,EAAIlG,OAAS67B,GAAmBN,UAS3C,MAAMS,WAAuBz5B,MACzBkE,YAAY,EAA2E,CAAC,GAAG,IAA/E,QAAET,EAAU,kBAAiB,MAAEi2B,EAAK,YAAEC,GAAqC,EAArBP,EAAgB,QAC9EnxB,MAAMxE,GACNW,KAAK3G,KAAOg8B,GAAeT,UAC3B50B,KAAKs1B,MAAQA,EACbt1B,KAAKu1B,YAAcA,EACnBz9B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJK,GAAeT,UAAY,iBAE3B,MAAMY,WAA4B55B,MAC9BkE,YAAY,EAAoE,CAAC,GAAG,IAAxE,QAAET,EAAU,kBAAiB,YAAEk2B,GAAqC,EAArBP,EAAgB,QACvEnxB,MAAMxE,GACNW,KAAK3G,KAAOm8B,GAAoBZ,UAChC50B,KAAKu1B,YAAcA,EACnBz9B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJQ,GAAoBZ,UAAY,sBAEhC,MAAMa,WAA8B75B,MAChCkE,YAAY,EAAsE,CAAC,GAAG,IAA1E,QAAET,EAAU,oBAAmB,YAAEk2B,GAAqC,EAArBP,EAAgB,QACzEnxB,MAAMxE,GACNW,KAAK3G,KAAOo8B,GAAsBb,UAClC50B,KAAKu1B,YAAcA,EACnBz9B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJS,GAAsBb,UAAY,wBAYlC,MAAMc,WAA2B95B,MAC7BkE,YAAY,GAAkF,IAAlF,QAAET,EAAU,mBAAkB,cAAEs2B,EAAa,WAAEC,GAAiC,EAAlBZ,EAAgB,QACtFnxB,MAAMxE,GACNW,KAAK3G,KAAOq8B,GAAmBd,UAC/B50B,KAAK21B,cAAgBA,EACrB31B,KAAK41B,WAAaA,EAClB51B,KAAK20B,UAAW,EAChB78B,OAAO0H,OAAOQ,KAAMg1B,EACxB,EAEJU,GAAmBd,UAAY,qBAC/B,MC/GMiB,GAAiB,CACnBlnB,OANe,CACfiU,MAAO0F,IACPzF,KAAMyF,IACN5sB,MAAO4sB,KAIPwN,gBAAkBrpB,GACK,IAAfA,EAAIpV,OACGoV,EAAI,GAERA,GAGf,MAAMspB,GACFj2B,YAAYC,GACRC,KAAKg2B,YAAc,IAAIp2B,IACvB,MAAMilB,EAAO,OAAH,UAAQgR,GAAmB91B,GACrCC,KAAK2O,OAASkW,EAAKlW,OACnB3O,KAAK81B,gBAAkBjR,EAAKiR,eAChC,CACAviB,UAAUtE,EAAOjF,GACbhK,KAAK2O,OAAOiU,MAAM,YAAa3T,EAAOjF,GACtC,IAAIisB,EAAOj2B,KAAKg2B,YAAYx0B,IAAIyN,GAQhC,OAPIgnB,EACAA,EAAK5wB,IAAI2E,IAGTisB,EAAO,IAAI/wB,IAAI,CAAC8E,IAChBhK,KAAKg2B,YAAYzzB,IAAI0M,EAAOgnB,IAEzB,IAAMA,EAAKptB,OAAOmB,EAC7B,CACAksB,QAAQjnB,KAAUpT,GACdmE,KAAK2O,OAAOiU,MAAM,UAAW3T,EAAOpT,GACpC,MAAMo6B,EAAOj2B,KAAKg2B,YAAYx0B,IAAIyN,GAClC,GAAIgnB,GAAQA,EAAKxvB,KAAM,CACnB,MAAM0vB,EAAW,GAEjB,OADAF,EAAK90B,SAASi1B,GAAQD,EAAS3+B,KAAK6+B,QAAQ5K,QAAQ2K,KAAOv6B,OACpDw6B,QAAQzV,IAAIuV,GAAUxmB,KAAK3P,KAAK81B,gBAC3C,CACA,OAAOO,QAAQ5K,SACnB,E,iFCHJ,MAAM6K,IAAen2B,EAAAA,EAAAA,IAAY,eAAgB,CAC7CU,OAAO,IA6BL01B,IAAoBp2B,EAAAA,EAAAA,IAAY,oBAAqB,CACvDU,OAAO,IAML21B,IAAgBr2B,EAAAA,EAAAA,IAAY,iBAK5Bs2B,IAAqBt2B,EAAAA,EAAAA,IAAY,qBAejCu2B,IAAcv2B,EAAAA,EAAAA,IAAY,eAI1Bw2B,IAAwBx2B,EAAAA,EAAAA,IAAY,sBAMpCy2B,IAAgBz2B,EAAAA,EAAAA,IAAY,gBAAiB,CAC/CU,OAAO,IAMLg2B,IAA2B12B,EAAAA,EAAAA,IAAY,0BAKvC22B,IAA2B32B,EAAAA,EAAAA,IAAY,0BAKvC42B,IAA2B52B,EAAAA,EAAAA,IAAY,0BAKvC62B,IAAmC72B,EAAAA,EAAAA,IAAY,iCAK/C82B,IAAiB92B,EAAAA,EAAAA,IAAY,gBAAiB,CAChDU,OAAO,IAaLq2B,IAAsB/2B,EAAAA,EAAAA,IAAY,qB,iDCjHlCg3B,GAA0B,YAChC,MAAMC,GACFt3B,aAAY,WAAEu3B,EAAU,kBAAEC,EAAiB,eAAEC,EAAc,WAAEnjB,EAAU,OAAEzF,IACrE3O,KAAK8N,QAAUupB,EACfr3B,KAAKs3B,kBAAoBA,EACzBt3B,KAAKu3B,eAAiBA,EACtBv3B,KAAKoU,WAAaA,EACY,CAC1B,MAAMvF,EAAMF,EAAO,oCACb6oB,EPjCP,OAAP,UAAYnF,GAAAA,OAA4BA,GAAAA,OOkC1BH,EAAUE,KACVD,EAAkBG,KAClBmF,EAAmB,CAACC,EAASC,IAAW7/B,OAAO+C,KAAK68B,GAAS3R,QAAO,CAAC7jB,EAAQjK,KAE/EiK,EAAOy1B,EAAO1/B,IAAQy/B,EAAQz/B,GACvBiK,IACR,CAAC,GACE01B,GAA0BznB,EAAAA,EAAAA,IAAa,CACzC9W,KAAM89B,GACNK,WAAY,OAAF,UACHC,EAAiBvF,EAASO,IAC1BgF,EAAiBtF,EAAiBO,IAClC8E,KAGXx3B,KAAK8N,QAAQqpB,IAA2B,IAAMd,QAAQ5K,QAAQ,CAC1DnzB,QAASs/B,IAEb,IAAK,MAAM3/B,KAAO2/B,EAAwBJ,WACtCx3B,KAAKs3B,kBAAkBjyB,IAAIpN,EAAK2/B,EAAwBJ,WAAWv/B,GAAMk/B,IAE7EtoB,EAAI+T,MAAM,CACN3T,MAAO,+CACPuoB,WAAY1/B,OAAO+C,KAAK28B,IAEhC,CACJ,CACAh2B,IAAInI,EAAMm5B,GAMN,OAJID,GAA0BC,KAE1Bn5B,EAAO89B,IAEJn3B,KAAK63B,WAAWx+B,EAAMm5B,GAAe7iB,MAAMmoB,GAAW93B,KAAKyrB,QAAQqM,EAAOx/B,QAASk6B,IAC9F,CACArwB,IAAI9I,EAAMm5B,GAMN,OAJID,GAA0BC,KAE1Bn5B,EAAO89B,MAEFn3B,KAAK8N,QAAQzU,EAC1B,CACAoV,cAAcqpB,EAAQtF,GAElB,GAAIA,GAAiBsF,EAAON,WAAWhF,GAAgB,CACnD,MAAMf,EAAoBqG,EAAON,WAAWhF,GACtC34B,QAAkB23B,GAAqBC,GAC7C,IAAK53B,EACD,OAGA,eAAgBA,GAAagS,IAAShS,EAAU29B,aAChDzT,KAAQ,CAACgU,EAAK1+B,KACV2G,KAAKs3B,kBAAkBjyB,IAAIhM,EAAM0+B,EAAKvF,EAAc,GACrD34B,EAAU29B,YAEb,YAAa39B,GAAanC,IAAQmC,EAAUkU,UAC5C/N,KAAKu3B,eAAelyB,IAAImtB,EAAe34B,EAAUkU,SAEjD,aAAclU,GAAanC,IAAQmC,EAAUke,WAC7Cle,EAAUke,SAAS5W,SAAS0V,IACxB7W,KAAKoU,WAAW6B,cAAcY,EAAQ,GAGlD,CAYA,OAXAkN,KAAQ,CAAClqB,EAAWR,KAChB2G,KAAKs3B,kBAAkBjyB,IAAIhM,EAAMQ,EAAWi+B,EAAOz+B,KAAK,GACzDy+B,EAAON,YACNM,EAAO/pB,SACP/N,KAAKu3B,eAAelyB,IAAIyyB,EAAOz+B,KAAMy+B,EAAO/pB,SAE5C+pB,EAAO/f,UACP+f,EAAO/f,SAAS5W,SAAS0V,IACrB7W,KAAKoU,WAAW6B,cAAcY,EAAQ,IAGvCihB,CACX,CACAD,WAAWx+B,EAAMm5B,GACb,OAAKxyB,KAAKmC,IAAI9I,EAAMm5B,GAGbxyB,KAAK8N,QAAQzU,KAAQgvB,OAAOntB,GAAMw2B,GAAmBx2B,EAAG8E,KAAK8N,QAAQzU,MAFjEg9B,QAAQ2B,OAAO,IAAIp8B,MAAO,WAAUvC,gBAGnD,EAGJ,MAAM4+B,GAAgB,YAqBhBC,IAAaxnB,EAAAA,EAAAA,IAAY,cACzBynB,IAAsBvnB,EAAAA,EAAAA,IAAc,iBAAkB,CAAC,GAAGM,GAAGgnB,IAAY,CAAC1V,EAAGrR,IACxEA,IAyDLinB,GAAoB,EACtB92B,EAAAA,EAAAA,IAAQ,CACJA,QAASyb,EAAAA,GACTnc,MAAO5B,EAAAA,GAAAA,QACP8D,SA1DR,MACIhD,aAAY,QAAE8xB,IACV5xB,KAAK4xB,QAAUA,GAAW,CAAC,EASvB5xB,KAAKywB,IAAMt0B,OAAOmlB,SAAS+O,IAEnC,CACAgI,UACI,OAAOr4B,KAAK4xB,QAAQrK,IACxB,CACA+Q,SACI,OAAOt4B,KAAKywB,GAChB,CACA8H,eAII,OAHKv4B,KAAKupB,YACNvpB,KAAKupB,UAAY1C,GAAM7mB,KAAKywB,MAEzBzwB,KAAKupB,SAChB,CACAiP,YACI,OAAOx4B,KAAK4xB,QAAQ5L,MACxB,CACAyS,UAAUxgC,GACN,IAAIyJ,EACJ,OAAuC,QAA/BA,EAAK1B,KAAK4xB,QAAQ8G,eAA4B,IAAPh3B,OAAgB,EAASA,EAAGzJ,EAC/E,CACA0gC,aACI,OAAO34B,KAAK4xB,QAAQ8G,OACxB,CACAE,UAAU3gC,GACN,OAAO+H,KAAK4xB,QAAQ7S,QAAQ9mB,EAChC,CACA4gC,aACI,OAAO74B,KAAK4xB,QAAQ7S,OACxB,CACA+Z,cACI,IAAIp3B,EAAIC,EACR,OAAO3B,KAAKy4B,UAAU,eAA+F,QAA7E92B,EAA6B,QAAvBD,EAAK1B,KAAK4xB,eAA4B,IAAPlwB,OAAgB,EAASA,EAAGq3B,cAA2B,IAAPp3B,OAAgB,EAASA,EAAGq3B,gBAAkB,EAC/K,CACAC,UAII,OAAO98B,OAAOmlB,SAASQ,IAC3B,GAQI7f,KAAM,CACF2vB,QAASqB,OAGjB3xB,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAU42B,MAIlB,IAAIe,GAAuB,QAE3BA,IAAuBpnB,EAAAA,EAAAA,IAAW,EAC9B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJq0B,IACH92B,EAAAA,EAAAA,IAAQ,CACJA,QAAS2xB,GACTpwB,WAAY,EAAGoP,YACX,MAAMknB,EAAalnB,EAAMC,SAASimB,IAClC,OAAO,OAAP,UACOgB,EAAU,CACbT,QAAS,OAAF,UACAS,aAA+C,EAASA,EAAWT,QAAO,CAC7E,aAAcU,UAAU3nB,UACxBuN,OAAQ1N,SAAS0N,UAIrB,EAGR/c,KAAM,CACFgQ,MAAOE,EAAAA,UAKxB+mB,IAkDH,MAAMG,GAAkB,EACpB/3B,EAAAA,EAAAA,IAAQ,CACJA,QAAS0b,EAAAA,GACTpc,MAAO5B,EAAAA,GAAAA,QACP8D,SApDR,MACIhD,cACIE,KAAKunB,KAAO,GACZvnB,KAAK04B,QAAU,CAAC,EAChB14B,KAAK+e,QAAU,CAAC,EAChB/e,KAAKqsB,OAAS,GAClB,CACAgM,UACI,OAAOr4B,KAAKunB,IAChB,CACA+R,QAAQt2B,GACJhD,KAAKunB,KAAOvkB,CAChB,CACAy1B,UAAUxgC,GACN,MAAY,eAARA,EACOiV,KAAOlN,KAAK+e,SAEhB/e,KAAK04B,QAAQzgC,EACxB,CACA0gC,aACI,OAAIY,KAAQv5B,KAAK+e,SACN/e,KAAK04B,QAET,OAAP,UACO14B,KAAK04B,QAAO,CACf,aAAcxrB,KAAOlN,KAAK+e,UAElC,CACAya,UAAUvhC,EAAK+K,GACXhD,KAAK04B,QAAQzgC,GAAO+K,CACxB,CACA41B,UAAU3gC,GACN,OAAO+H,KAAK+e,QAAQ9mB,EACxB,CACA4gC,aACI,OAAO74B,KAAK+e,OAChB,CACA0a,UAAUxhC,EAAK+K,GACXhD,KAAK+e,QAAQ9mB,GAAO+K,CACxB,CACA02B,UAAUrN,GACNrsB,KAAKqsB,OAASA,CAClB,CACAsN,YACI,OAAO35B,KAAKqsB,MAChB,MAWJ,IAAIuN,GAAwB,QAE5BA,IAAwB9nB,EAAAA,EAAAA,IAAW,EAC/B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJs1B,IACH/3B,EAAAA,EAAAA,IAAQ,CACJA,QAAS4xB,GAET3xB,SAAU,CAAC,QAIxBq4B,IAEH,MAAMC,GACF/5B,aAAY,GAAEkO,EAAE,kBAAE8rB,EAAiB,OAAEC,EAAM,MAAE9nB,IAEzCjS,KAAKsZ,cAAgB,CAACjJ,EAAQ6D,IACnBlU,KAAKgO,GAAGxM,IAAIua,EAAAA,IAAwB7M,IAAImB,EAAQ6D,GAG3DlU,KAAK8S,SAAW,CAACmB,EAAmBC,IACzB,IAAImiB,SAAQ,CAAC5K,EAASuM,KACzB,IACIvM,EAAQzrB,KAAKiS,MAAMa,UAASkB,EAAAA,EAAAA,IAAcC,EAAmBC,IAIjE,CAFA,MAAO3U,GACHy4B,EAAOz4B,EACX,KAGRS,KAAKg6B,aAAe,CAACC,EAAoBl6B,IACA,mBAAvBk6B,EACR,IAAIp+B,IAASmE,KAAK8S,SAASmnB,KAAsBp+B,GAAOkE,GACvDmU,GAAYlU,KAAK8S,SAASmnB,EAAoB/lB,GAKzDlU,KAAK+U,SAAY9C,GACNjS,KAAKoU,WAAWW,SAAS9C,GAEpCjS,KAAK2W,UAAY,KAAM,CACnBvC,WAAYpU,KAAKoU,WAAWuC,cAEhC3W,KAAKkS,SAAW,IAAIrW,IACTmE,KAAKiS,MAAMC,SAASrW,EAAK,IAEpCmE,KAAKuT,UAAY,IAAI1X,IACVmE,KAAKiS,MAAMsB,UAAU1X,EAAK,GAAIA,EAAK,IAE9CmE,KAAKiX,SAAYhF,GAAUjS,KAAKoU,WAAW6C,SAAShF,GACpDjS,KAAKiW,cAAiBhE,GAAUjS,KAAKoU,WAAW6B,cAAchE,GAC9DjS,KAAKkX,gBAAmBjF,GAAUjS,KAAKoU,WAAW8C,gBAAgBjF,GAClEjS,KAAKiS,MAAQA,EAEbjS,KAAKoU,WAAa0lB,EAElB95B,KAAKoU,WAAW4C,WAAWhX,MAC3BA,KAAKgO,GAAKA,EACVhO,KAAK+5B,OAASA,CAClB,EAwJJ,MAAMG,GAAY,CACd5c,KAAM,CAAClL,EAAAA,GAAAA,KAA4BA,EAAAA,GAAAA,QACnCqL,MAAO,CAACrL,EAAAA,GAAAA,OACR+nB,SAAU,CACN/nB,EAAAA,GAAAA,cACAA,EAAAA,GAAAA,gBACAA,EAAAA,GAAAA,gBACAA,EAAAA,GAAAA,aACAA,EAAAA,GAAAA,OAEJgoB,IAAK,CACDhoB,EAAAA,GAAAA,gBACAA,EAAAA,GAAAA,gBACAA,EAAAA,GAAAA,eAEJioB,SAAU,CAACjoB,EAAAA,GAAAA,qBAETkoB,GAAU,CACZC,OAAQL,GACRM,OAAQN,IAGZ,IAAIO,GAAgB,QAEpBA,IAAgB3oB,EAAAA,EAAAA,IAAW,EACvB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,EACP22B,EAAAA,EAAAA,IAAU,CAENp5B,QAASyN,EAAAA,GACTnO,MAAO+5B,EAAAA,GAAAA,UACP73B,SAhKhB,MACIhD,aAAY,MAAE86B,EAAK,OAAEC,EAAM,OAAElsB,EAAM,wBAAEmsB,EAAuB,qBAAEC,IAC1D/6B,KAAKg7B,qBAAuB,IAAIC,QAChCj7B,KAAKk7B,oBAAsB,IAAID,QAC/Bj7B,KAAK46B,MAAQA,EACb56B,KAAK66B,OAASA,EACd76B,KAAK6O,IAAMF,EAAO,+BAClB3O,KAAK86B,wBAA0BA,EAC/B96B,KAAK+6B,qBAAuBA,CAChC,CACA7rB,IAAI/V,EAAMkzB,EAAQtoB,EAAWo3B,GACzB,MAAMntB,EAAKmtB,QAA2CA,EAvB5C,EAAChiC,EAAMkzB,EAAQ+O,EAAar3B,KAC1C,IAAIiK,EAAKotB,EAST,MARe,aAAX/O,GAAkC,WAATlzB,IACzB6U,GAAKxI,EAAAA,EAAAA,IAAqBwI,IAE1BjK,GACAA,EAAU5C,SAASmE,GACR0I,EAAG3M,SAASiE,KAGpB0I,CAAE,EAa4DqtB,CAAUliC,EAAMkzB,EAAQrsB,KAAK66B,OAAQ92B,GAChGu3B,EAAuBttB,EAAGxM,IAAI,CAAE7B,MAAOwd,EAAAA,GAA8B/c,UAAU,IACrFJ,KAAK6O,IAAI+T,MAAM,CACX3T,MAAO,cACP9V,OACAkzB,WAEJ,MAAMkP,EAAa,CAAC,EAEpB,OADAvtB,EAAG3M,SAAS,CAAEC,QAASkzB,GAAgCjzB,SAAUg6B,IACzDv7B,KAAK46B,MAAMzhC,GAAMkzB,GACpBtG,QAAO,CAACyV,EAAOC,IACTD,EAAM7rB,MAAK,KACd,MAAM+rB,EAAWD,EAAK5jC,WAGtB,OAFA0jC,EAAWG,GAAY,CAAEzS,MAAOpjB,YAAYC,OAErCuwB,QAAQ5K,UACV9b,MAAK,IACC3P,KAAK86B,wBAAwBa,YAAYL,EAAuB,gBAAeI,KAAYjtB,MAAOmtB,EAAkBC,KACvH77B,KAAKg7B,qBAAqBz4B,IAAIyL,EAAI4tB,GAClC57B,KAAKk7B,oBAAoB34B,IAAIyL,EAAI6tB,SAC3B77B,KAAK87B,gBAAgB9tB,EAAIytB,EAAK,MAGvCM,SAAQ,KACTR,EAAWG,GAAUM,IAAMn2B,YAAYC,KAAK,GAC9C,KAEPuwB,QAAQ5K,WAENsQ,SAAQ,KAGT,GAFA/7B,KAAKg7B,qBAAqBnyB,OAAOmF,GACjChO,KAAKk7B,oBAAoBryB,OAAOmF,GAC5BhO,KAAK+6B,qBACL,IAAK,MAAMkB,KAAuBj8B,KAAK+6B,qBACnCkB,EAAoBjuB,EAAI7U,EAAMkzB,EAAQkP,EAE9C,IAEC5rB,MAAK,IAAM3B,GACpB,CACAkuB,8BAA8BluB,GAC1B,IAAItM,EACJ,OAAoD,QAA5CA,EAAK1B,KAAKg7B,qBAAqBx5B,IAAIwM,UAAwB,IAAPtM,EAAgBA,EAAK,IACrF,CACAo6B,gBAAgB9tB,EAAIytB,GAChB,IAAIU,EACJ,IAGI,GAFAA,EAAenuB,EAAGxM,IAAI,CAAE7B,MAAO87B,EAAMr7B,UAAU,IAE1B,OAAjB+7B,EACA,OAAO9F,QAAQ5K,SAOvB,CAJA,MAAOvwB,GAGH,OADA8E,KAAK6O,IAAInT,MAAMR,GACR8E,KAAKo8B,WAAWlhC,EAAG8S,EAC9B,CACA,OAAKvW,MAAMC,QAAQykC,GAGZ9F,QAAQzV,IAAIub,EAAa94B,KAAKohB,GAC1BzkB,KAAKq8B,gBAAgB5X,EAAUgX,EAAMztB,MAHrChO,KAAKq8B,gBAAgBF,EAAcV,EAAMztB,EAKxD,CACAquB,gBAAgB5X,EAAUgX,EAAMztB,GAC5B,KAAMyW,aAAoB6X,UAAW,CACjC,MAAM5gC,EAAQ,IAAI6gC,UAAW,+DAA8Dd,EAAK5jC,0BAA0B4sB,gFAkB1H,YALAzkB,KAAK6O,IAAInT,MAAM,CACXuT,MAAO,aACPvT,QACA+/B,KAAMA,EAAK5jC,YAGnB,CACA,MAAM,KAAEwB,EAAO,IAAOorB,EAMtB,OALAzkB,KAAK6O,IAAI+T,MAAM,CACX3T,MAAO,WACPwsB,KAAMA,EAAK5jC,WACX2kC,QAASnjC,IAENg9B,QAAQ5K,UACV9b,MAAK,IAAM8U,MACX4D,OAAO9oB,IACR,IAAImC,EACJ1B,KAAK6O,IAAIgmB,GAAct1B,GAAO,QAAU,SAAS,CAC7C0P,MAAO,aACPvT,MAAO6D,EACPk8B,KAAMA,EAAK5jC,WACX2kC,QAASnjC,IAG+B,QAA3CqI,EAAK1B,KAAKk7B,oBAAoB15B,IAAIwM,UAAwB,IAAPtM,GAAyBA,EAAG+6B,QAChFz8B,KAAKo8B,WAAW78B,EAAKyO,EAAG,GAEhC,CAEAouB,WAAW78B,EAAKyO,GAKZ,KAJmB,iBAARzO,IAEPA,EAAIyO,GAAKA,GAEPzO,CACV,GAmCY0C,KAAM,CACF24B,MAAOvd,EAAAA,GACPwd,OAAQx6B,EAAAA,GACRsO,OAAQC,EAAAA,GACRksB,wBAAyB5d,EAAAA,GACzB6d,qBAAsB,CAClBp7B,MAAO80B,GACPr0B,UAAU,OAItBs6B,EAAAA,EAAAA,IAAU,CACNp5B,QAAS8b,EAAAA,GACTva,WAAY,EAAGmL,KAAIc,uBACR,IACIA,EAAkBotB,8BAA8BluB,GAG/D/L,KAAM,CACF+L,GAAI3N,EAAAA,GACJyO,kBAAmBC,EAAAA,OAG3B2rB,EAAAA,EAAAA,IAAU,CAENp5B,QAAS+b,EAAAA,GACTzc,MAAO+5B,EAAAA,GAAAA,UACPp5B,SAAU+4B,SAIvBG,IAEH,IAAIiC,GAAe,QAEnBA,IAAe5qB,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CAEJA,QAAS6a,EAAAA,GACTvb,MAAO5B,EAAAA,GAAAA,UACP6D,WAAaZ,GAAS,IACX,IAAI8zB,GAAO,CACdpnB,OAAQ1M,EAAK0M,OAAO,YAG5B1M,KAAM,CACF0M,OAAQC,EAAAA,OAGhBtN,EAAAA,EAAAA,IAAQ,CACJA,QAAS8a,EAAAA,GACTxb,MAAO5B,EAAAA,GAAAA,QACP6D,WAAY,EAAG85B,kBAAmBA,IAClC16B,KAAM,CACF06B,aAAcxgB,EAAAA,OAGtB7a,EAAAA,EAAAA,IAAQ,CACJA,QAAS+a,EAAAA,GACTzb,MAAO5B,EAAAA,GAAAA,UACP6D,WAAY,EAAG85B,kBAAmBA,IAClC16B,KAAM,CACF06B,aAAcxgB,EAAAA,UAK/BugB,IAEH,MAAME,GAAc,EAChBt7B,EAAAA,EAAAA,IAAQ,CACJA,QAASub,EAAAA,GACTha,WAAY,KAAQ,IAAInB,EAAIC,EAAI,OAAOiR,KAAKiU,MAAyH,QAAlHllB,EAA6D,QAAvDD,EAAK4P,SAASurB,eAAe,4BAAyC,IAAPn7B,OAAgB,EAASA,EAAGo7B,mBAAgC,IAAPn7B,EAAgBA,EAAK,KAAK,EACvMf,MAAO5B,EAAAA,GAAAA,WAEXsC,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,OACTvP,WAAY,EAAGiM,uBACJ,WACH,OAAOA,EAAkBI,IAAI,SAAU,WAC3C,EAEJjN,KAAM,CAAE6M,kBAAmBC,EAAAA,IAC3BlO,OAAO,KAITk8B,IAAyBrsB,EAAAA,EAAAA,IAAY,oCAErCssB,IAAuBpsB,EAAAA,EAAAA,IAAc,gBADvB,CAAE4I,YAAa,CAAC,IACqCtI,GAAG6rB,IAAwB,CAAC5rB,EAAO+C,IAAY,OAAL,UAC5G/C,EAAK,CACRqI,YAAatF,MAMX+oB,GACM,SAINC,GAAqB,CAAC,EAC5B,MAAMC,GAEFr9B,YAAYs9B,EAAoBlpB,EAASiK,EAAYkf,EAAgBlkC,GACjE,IAAIuI,EACJ1B,KAAKo9B,mBAAqBA,EAC1Bp9B,KAAKkU,QAAUA,EACflU,KAAKme,WAAaA,EAClBne,KAAKq9B,eAAiBA,EACtBr9B,KAAK7G,KAAOA,EACZ6G,KAAKqsB,QAAS,EACdrsB,KAAKs9B,iBAAkB,EACvBt9B,KAAK/H,IAAM,KAEPkB,IAAS8jC,KAETj9B,KAAKqsB,OAAmC,YAA1BgR,EAAehR,QAEjCrsB,KAAKu9B,WAA8C,QAAhC77B,EAAKyc,EAAWof,kBAA+B,IAAP77B,EAAgBA,EAAKw7B,EACpF,CACAM,QAKI,OAJAx9B,KAAKo9B,mBAAmBj8B,SAASoW,IAC7BvX,KAAK/H,IAAMsf,EAAOtf,IAClBsf,EAAOvN,GAAGhK,KAAK,IAEZA,KAAK25B,WAChB,CACAthB,SAASrV,GACLhD,KAAKq9B,eAAelsB,MAAMnR,KAAK/H,KAAO+K,CAC1C,CACAkP,WACI,OAAOlS,KAAKq9B,eAAelsB,MAAMnR,KAAK/H,IAC1C,CACAwlC,SACIz9B,KAAKq9B,eAAehR,OAAS,YAC7BrsB,KAAKq9B,eAAeK,YAAc19B,KAAK/H,IACvC+H,KAAKs9B,iBAAkB,CAC3B,CACAK,QACI39B,KAAKqsB,QAAS,CAClB,CACAsN,YACI,OAAI35B,KAAKs9B,iBAGFt9B,KAAKqsB,MAChB,EAGJ,MAAMuR,GAAa,CAAC,EACdC,GAAkB,CAAC,EAgGnBC,GAAmB,WAsFnBC,GAAa,CACf9lC,IAAK,aACL+R,GAAKg0B,IACGA,EAAQT,WAAWQ,YAAcC,EAAQ7kC,OAAS8jC,IAClDe,EAAQP,QACZ,GAaFQ,IAA+B99B,EAAAA,EAAAA,IAAY,4BACjD,IAAI+9B,GAAe,QAEnBA,IAAepsB,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAUy7B,MAEd17B,EAAAA,EAAAA,IAAQ,CAEJA,QAASwa,EAAAA,GACTlb,MAAO5B,EAAAA,GAAAA,UACP8D,SAtHhB,MACIhD,aAAY,YAAEq+B,IACVn+B,KAAK+N,QAAU,IAAInO,IAAI,CAAC,CAACk+B,GAAkB5zB,KAAQi0B,KACvD,CACA94B,IAAIlM,EAAM4U,GACN,MAAMqwB,EAAa1jB,IAAQ3M,GAC3B/N,KAAK+N,QAAQxL,IAAIpJ,EAAMklC,KAAKr+B,KAAK+N,QAAQ5L,IAAIhJ,GAAQ,IAAI6G,KAAK+N,QAAQvM,IAAIrI,MAAUilC,GAAcA,GACtG,CACA58B,IAAIrI,EAAMmlC,GACN,OAAOD,KAAK,IAAKr+B,KAAK+N,QAAQvM,IAAIrI,IAAS,MAASmlC,GAAiB,IACzE,CACAC,YACI,OAAOv+B,KAAK+N,QAAQvM,IAAIs8B,GAC5B,CACA3b,OAAOhpB,EAAM4U,GACT,IAAKA,EAED,YADA/N,KAAK+N,QAAQlF,OAAO1P,GAGxB,MAAMilC,EAAa1jB,IAAQ3M,GACvB/N,KAAK+N,QAAQ5L,IAAIhJ,IACjB6G,KAAK+N,QAAQxL,IAAIpJ,EAAMqlC,KAAWx+B,KAAK+N,QAAQvM,IAAIrI,GAAOilC,GAElE,GAgGYn8B,KAAM,CAAEk8B,YAAa7vB,EAAAA,OAEzBhN,EAAAA,EAAAA,IAAQ,CACJA,QAASya,EAAAA,GACTnb,MAAO5B,EAAAA,GAAAA,QACP8D,SA3NhB,MACIhD,aAAY,MAAEmS,EAAK,QAAEI,EAAO,GAAErE,EAAE,wBAAE8sB,EAAuB,mBAAE2D,EAAkB,gBAAEC,IAC3E1+B,KAAKy+B,mBAAqBv0B,KAAQu0B,QAA+DA,EAAqB,IACtHz+B,KAAKqS,QAAUA,EACfrS,KAAKiS,MAAQA,EACbjS,KAAKgO,GAAKA,EACVhO,KAAK86B,wBAA0BA,EAC/B96B,KAAK2+B,UAAY,IAAI/+B,IACrBI,KAAK0+B,gBAAkBA,GAAmB9mB,KAC1C,MAAMvD,EAAepC,EAAMC,SAAS8qB,IAChC3oB,GAAgBA,EAAamF,aAC7BolB,MAAU,CAAC57B,EAAO/K,KACd+H,KAAK2+B,UAAUp8B,IAAItK,EAAK+K,EAAM,GAC/BqR,EAAamF,YAExB,CACA/K,mBAAmBmtB,EAAkBvrB,KAAWlH,GAC5C,IAAIzH,EAAIC,EACR,IAAIwc,EACJ,MAAMjK,EAA+B,QAApBxS,EAAKyH,EAAO,UAAuB,IAAPzH,EAAgBA,EAAKm8B,GAE5D1kC,GAAqH,KAA7GyiC,aAA2D,EAASA,EAAiB1uB,OAAO2xB,aAAwB5B,GA5E/H,SA8EC1sB,EAAAA,EAAAA,IAAgBF,GAChB8N,EAAa9N,GAGbrQ,KAAK0+B,gBAAgBruB,GACrB8N,EA7BW9N,IAAWA,EAAO4N,GA6BhB6gB,CAAczuB,IAE/B,MAAMgtB,EAAiBr9B,KAAK++B,kBAAkB5gB,EAAW9kB,MACzD,OAAK2G,KAAKg/B,iBAAiB9qB,EAASiK,EAAYkf,EAAgBlkC,IAWhEkkC,EAAehR,OAAS,UACjBrsB,KAAK86B,wBAAwBa,YAAYC,EAAkB,CAC9DviC,KAAM8kB,EAAW9kB,KACjB6T,QAAsH,KAA7G0uB,aAA2D,EAASA,EAAiB1uB,OAAO2xB,aAAwB,CAAEA,aAAa,QAAUljC,IACvJ,CAACsjC,EAAwBpD,KACxB,MAAMxpB,EAAUrS,KAAKk/B,oBAAoBtD,EAAkBqD,EAAwBpD,EAAiB1d,GACpG,OAAOkY,QAAQ5K,UACV9b,MAAK,KACFY,EAAAA,EAAAA,IAAgBF,GACTA,EAAOrG,GAAGpS,MAAMya,EAASlJ,GAE7BkH,EAAOrQ,KAAKqS,QAAS6B,EAAS7B,EAAQpQ,QAE5C0N,MAAMwvB,IACP9B,EAAehR,OAAS,UACjB8S,KAEN9W,OAAO9oB,IAER,MADA89B,EAAehR,OAAS,SAClB9sB,CAAG,GACX,KA7BO,WADD4e,EAAWihB,qBAEJ/I,QAAQ2B,OAAO,IAAItC,GAAmB,CACzCC,cAAqD,QAArCh0B,EAAK07B,EAAeK,mBAAgC,IAAP/7B,EAAgBA,EAAK,UAClFi0B,WAAYzX,EAAW9kB,QAGpBg9B,QAAQ5K,SAyB/B,CACAhd,UAAU4B,KAAWlH,GACjB,OAAOnJ,KAAKq/B,aAAa,KAAMhvB,KAAWlH,EAC9C,CACA41B,kBAAkB1lC,GACd,IAAIgkC,EAAiBr9B,KAAK2+B,UAAUn9B,IAAInI,GAMxC,OAJKgkC,IACDA,EAAiB,CAAEhR,OAAQ,UAAWlb,MAAO,CAAC,GAC9CnR,KAAK2+B,UAAUp8B,IAAIlJ,EAAMgkC,IAEtBA,CACX,CACA2B,iBAAiB9qB,EAASiK,EAAYkf,EAAgBlkC,GAElD,OADsB,IAAIgkC,GAAcn9B,KAAKy+B,mBAAoBvqB,EAASiK,EAAYkf,EAAgBlkC,GACjFqkC,OACzB,CACA0B,oBAAoBI,EAAwBC,EAAwB1D,EAAiB1d,GACjF,MAAO,CACH0d,kBACA2D,YAAaD,aAAuE,EAASA,EAAuBC,YACpHlmB,cAAetZ,KAAKq/B,aAAarqB,KAAKhV,KAAMu/B,GAC5Ct9B,KAAMkc,EAAWlc,KAAOjC,KAAKgO,GAAGhM,UAAUmc,EAAWlc,MAAQ27B,GAC7DX,YAAaqC,aAAuE,EAASA,EAAuBpyB,OAAO2xB,aAAe,OAAS,aACnJ/rB,SAAU9S,KAAKiS,MAAMa,SACrBZ,SAAUlS,KAAKiS,MAAMC,SAE7B,GAiIYjQ,KAAM,CACFw8B,mBAAoB,CAAE9+B,MAAOsc,EAAAA,GAAqB7b,UAAU,GAC5DiS,QAASc,EAAAA,GACTlB,MAAOE,EAAAA,GACPnE,GAAI3N,EAAAA,GACJy6B,wBAAyB5d,EAAAA,GACzBwhB,gBAAiB,CACb/+B,MAAO,wBACPS,UAAU,OAItBkB,EAAAA,EAAAA,IAAQ,CACJA,QAAS0a,EAAAA,GACTpb,MAAO5B,EAAAA,GAAAA,QACP8D,SAlHhB,MACIhD,YAAYmC,GACRjC,KAAKiC,KAAOA,EACZjC,KAAK6O,IAAM5M,EAAK0M,OAAO,4BAC3B,CACA8wB,WAAW1xB,EAAS2xB,EAAiB,MAAM,IACvC,OAAO1/B,KAAKiC,KAAK64B,wBAAwBa,YAAY37B,KAAKiC,KAAK09B,8BAA+B,CAAEtmC,KAAM,cAAe6T,OAAQ,CAAE2xB,aAAa,KAAUpwB,gBAkB5I4nB,QAAQzV,IAAI7S,EAAQ1K,KAjBJgN,GACXgmB,QAAQ5K,UACV9b,MAAK,IAAM3P,KAAKiC,KAAK29B,gBAAgBP,aAAazD,EAAkBvrB,KACpEgY,OAAO3sB,IACR,IAAKm5B,GAAcn5B,GAAQ,CACvB,MAAMyiB,GAAa5N,EAAAA,EAAAA,IAAgBF,GAAUA,EAASA,EAAO4N,GAC7Dje,KAAK6O,IAAInT,MAAM,CACXA,QACAuT,MAAQ,yBACR5P,QAAU,GAAE8e,EAAW9kB,wBAE/B,CACA,GAAIqmC,EAAehkC,GACf,MAAMA,CACV,MAGoC,GAEpD,GAyFYuG,KAAM,CACF29B,gBAAiB7jB,EAAAA,GACjB+e,wBAAyB5d,EAAAA,GACzByiB,4BAA6BviB,EAAAA,GAC7BnL,MAAOE,EAAAA,GACP0tB,UAAW5B,GACXtvB,OAAQC,EAAAA,OAGhBtN,EAAAA,EAAAA,IAAQ,CACJA,QAAS28B,GACT18B,SAAU,OAEdD,EAAAA,EAAAA,IAAQ,CACJA,QAAS2a,EAAAA,GACTpb,OAAO,EACPU,SAAU,CAtGF,CACpBtJ,IAAK,kBACL+R,GAAKg0B,IACGA,EAAQT,WAAWuC,QACnB9B,EAAQL,OACZ,GAOW,CACf1lC,IAAK,aACL+R,GAAKg0B,IACGA,EAAQT,WAAWwC,YACnB/B,EAAQP,QACZ,GAIY,CAChBxlC,IAAK,cACL+R,GAAKg0B,IACGA,EAAQT,WAAWyC,WAEvB,GA4E6DjC,GA/DjD,CAChB9lC,IAAK,cACL+R,GAAKg0B,IACGA,EAAQT,WAAW0C,aAAejC,EAAQ7kC,IAE9C,UA8DL+kC,IAEH,IAAIgC,GAAc,QAElBA,IAAcpuB,EAAAA,EAAAA,IAAW,EACrB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CACJA,QAASob,EAAAA,GACT9b,MAAO5B,EAAAA,GAAAA,UACP6D,WAAY,EAAGwS,aAAaoC,EAAAA,EAAAA,IAAiB,CAAEpC,OAAQA,GAAUnL,KAAQmL,KACzEpT,KAAM,CACFoT,OAAQ,CACJ1V,MAAO+R,EAAAA,GACPtR,UAAU,OAItBkB,EAAAA,EAAAA,IAAQ,CACJA,QAASqb,EAAAA,GACT/b,MAAO5B,EAAAA,GAAAA,QACP6D,WAAY,EAAGuR,aAAYC,eAAcC,iBAC9BF,EAAWgD,cAAc,CAAC,EAAG/C,EAAc,CAC9C8rB,EAAAA,GAAAA,gBACGj2B,KAAQoK,GAAe,MAGlCrS,KAAM,CACFmS,WAAYsI,EAAAA,GACZpI,YAAa,CAAE3U,MAAOid,EAAAA,GAAkBxc,UAAU,GAClDiU,aAAc,CAAE1U,MAAOkd,EAAAA,GAAyBzc,UAAU,OAGlEkB,EAAAA,EAAAA,IAAQ,CACJA,QAAS6Q,EAAAA,GACTvR,MAAO5B,EAAAA,GAAAA,QACP6D,WAAY,EAAGi3B,wBAAwB,CACnC5nB,SAAU4nB,EAAkB5nB,SAAS8C,KAAK8kB,GAC1ChnB,SAAUgnB,EAAkBhnB,SAASkC,KAAK8kB,GAC1CvmB,UAAWumB,EAAkBvmB,UAAUyB,KAAK8kB,KAEhD73B,KAAM,CACF63B,kBAAmBnd,EAAAA,UAKpCujB,IAEH,MAAME,GAAe,CAACjnC,EAAM4G,EAAU,CAAEkG,IAAK,OAClC,IAAIo6B,KAAJ,CAAQtgC,GAKbugC,IAAcC,EAAAA,EAAAA,IAAc,eAClC,IAAIC,GAAc,QAElBA,IAAc1uB,EAAAA,EAAAA,IAAW,EACrB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,CAEP,CACIzC,QAASg/B,GACT1/B,MAAO5B,EAAAA,GAAAA,UACPuC,SAAU,IAEd,CACID,QAASgb,EAAAA,GACTzZ,WAAY,EAAG49B,SAAQC,eACfA,EACON,GAEJ,CAACjnC,KAAS0C,KACb,MAAMqlB,EAAQkf,GAAajnC,KAAS0C,GAEpC,OADA4kC,EAAOjpC,KAAK0pB,GACLA,CAAK,EAGpBjf,KAAM,CACFw+B,OAAQH,GACRI,UAAW,CAAE/gC,MAAO+D,EAAAA,GAA6BtD,UAAU,KAGnE,CACIkB,QAASkb,EAAAA,GACT5b,MAAO5B,EAAAA,GAAAA,UACP6D,WAAY,EAAG49B,SAAQE,iBACXxnC,IACJsnC,EAAOt/B,SAAS+f,GAAUA,EAAMjY,UAC5B03B,EACOtK,QAAQzV,IAAI+f,EAAYt9B,KAAK4F,GAAUA,EAAM9P,MAEjDk9B,QAAQ5K,WAGvBxpB,KAAM,CACFw+B,OAAQH,GACRK,YAAa,CAAEhhC,MAAO4c,EAAAA,GAA4Bnc,UAAU,SAK7EogC,IAEH,MAAMI,GAAe,CAAC,EAqDtB,IAAIC,GAAe,QAEnBA,IAAe/uB,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHC,QAAS,CACLu2B,GACA7b,EACA8d,GACAvS,GACAhJ,EACA+c,GACAgC,GACAhH,GACAU,GACA4G,IAEJz8B,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CAEJA,QAAS4a,EAAAA,GACTtb,MAAO5B,EAAAA,GAAAA,UACP8D,SC9nChB,MACIhD,cACIE,KAAK8gC,MAAQhpC,OAAO+U,OAAO,KAC/B,CAIAk0B,cAAc1nC,EAAMqR,GACX1K,KAAK8gC,MAAMznC,KACZ2G,KAAK8gC,MAAMznC,GAAQ,IAEvB2G,KAAK8gC,MAAMznC,GAAQglC,KAAKr+B,KAAK8gC,MAAMznC,GAAMyB,OAAO4P,GACpD,CAKAs2B,SAAS3nC,EAAMgZ,EAAS6B,EAASnU,GAC7B,MAAMkhC,EAAUjhC,KAAK8gC,MAAMznC,GAC3B,IAAK4nC,EACD,OAAO/sB,EAEX,IAAI3K,EAAU2K,EACd,IAAK,IAAI/c,EAAI,EAAGA,EAAI8pC,EAAQ5pC,OAAQF,IAChCoS,EAAU03B,EAAQ9pC,GAAGkb,EAAS9I,EAASxJ,GAE3C,OAAOwJ,CACX,CAIA23B,cAAc7nC,EAAMgZ,EAAS6B,EAASnU,GAClC,MAAMkhC,EAAUjhC,KAAK8gC,MAAMznC,GAC3B,IAAK4nC,EACD,OAAO/sB,EAEX,IAAK,IAAI/c,EAAI,EAAGA,EAAI8pC,EAAQ5pC,OAAQF,IAAK,CACrC,MAAMgqC,EAASF,EAAQ9pC,GACvBmR,YAAW,KACP64B,EAAO9uB,EAAS6B,EAASnU,EAAQ,GAEzC,CACA,OAAOmU,CACX,CAIAktB,gBAAgB/nC,EAAMgZ,EAAStS,GAC3B,MAAMkhC,EAAUjhC,KAAK8gC,MAAMznC,GAC3B,OAAQ6a,IACJ,IAAK+sB,EACD,OAAO5K,QAAQ5K,QAAQvX,GAE3B,IAAImtB,EAAY,EAChB,OAAOhL,QAAQ5K,QAAQvX,GAASvE,MAAK,SAAS2xB,EAASnC,GAEnD,MAAMgC,EAASF,EAAQI,KACvB,OAAKF,EAIE9K,QAAQ5K,QAAQ0V,EAAO9uB,EAAS8sB,EAAMp/B,IAAU4P,KAAK2xB,GAHjDnC,CAIf,GAAE,CAEV,MDgkCQ79B,EAAAA,EAAAA,IAAQ,CAEJA,QAASmb,EAAAA,GACT7b,MAAO5B,EAAAA,GAAAA,UACP8D,SAhgChB,MACIhD,aAAY,cAAEyhC,GAAkB,CAAC,GAC7BvhC,KAAKw3B,WAAa,CACd,CAACS,IAAgBngC,OAAO0H,OAAO,CAAC,KAAM0K,KAAQq3B,QAAqDA,EAAgB,KAE3H,CACAl8B,IAAIhM,EAAMQ,EAAW2nC,EAAQvJ,IACzB,MAAMwJ,EAAkBzhC,KAAKw3B,WAAWgK,IAAU,CAAC,EACnDC,EAAgBpoC,GAAQQ,EACxBmG,KAAKw3B,WAAWgK,GAASC,CAC7B,CACAjgC,IAAInI,EAAMmoC,EAAQvJ,IAEd,OADwBj4B,KAAKw3B,WAAWgK,IAAU,CAAC,GAC5BnoC,IAAS2G,KAAKw3B,WAAWS,IAAe5+B,EACnE,CACAqoC,kBAAkBC,EAAOC,EAAc/nC,EAAW2nC,GAC9C,OAAOK,KAAO,CAACF,GAAQC,EAAc5hC,KAAKwB,IAAI3H,EAAW2nC,GAC7D,GAg/BYv/B,KAAM,CACFs/B,cAAe,CAAE5hC,MAAO,uBAAwBS,UAAU,OAGlEkB,EAAAA,EAAAA,IAAQ,CAEJA,QAASsa,EAAAA,GACThb,MAAO5B,EAAAA,GAAAA,UACP6D,WAAY,IAAoD,IAAnD,qBAAEi/B,GAA4C,EAAnBC,EAAiB,QAUrD,OATAD,SAA4EA,EAAqB3gC,SAAS2M,IACtGiW,KAAQ,CAAC+T,EAAQz+B,KACeA,KAAQ0oC,EAAkB1K,aAGlD0K,EAAkB1K,WAAWh+B,GAAQ,IAAMg9B,QAAQ5K,QAAQ,CAAEnzB,QAASw/B,IAC1E,GACDhqB,EAAQ,IAER,IAAIspB,GAAc2K,EAAkB,EAE/C9/B,KAAM,CACFo1B,WAAYhpB,EAAAA,GACZyzB,qBAAsB,CAAEniC,MAAOkc,EAAAA,GAAyBzb,UAAU,GAClEk3B,kBAAmB7a,EAAAA,GACnB8a,eAAgBzb,EAAAA,GAChB1H,WAAYsI,EAAAA,GACZ/N,OAAQC,EAAAA,OAGhBtN,EAAAA,EAAAA,IAAQ,CAEJA,QAAS6R,EAAAA,GACTvS,MAAO5B,EAAAA,GAAAA,QACP6D,WA7yBhB,UAA+B,GAAEmL,EAAE,kBAAE8rB,EAAiB,OAAEC,EAAM,MAAE9nB,IAC5D,OAAO,IAAI4nB,GAAgB,CACvB7rB,KACA8rB,oBACAC,SACA9nB,SAER,EAuyBgBhQ,KAAM,CACF+L,GAAI3N,EAAAA,GACJ05B,OAAQ3d,EAAAA,GACR0d,kBAAmBnd,EAAAA,GACnB1K,MAAOE,EAAAA,OAGf7Q,EAAAA,EAAAA,IAAQ,CACJA,QAAS4b,EAAAA,GACTpa,SAxHhB,MACI2L,kBAAkBuzB,EAAeC,EAAeC,GAC5C,MAAMniC,EALYkiC,IACU,iBAAlBA,EAA6B,CAAE5oC,KAAM4oC,GAAkBA,EAIjDE,CAAiBF,IAC3B,KAAE5oC,EAAM6T,OAAQk1B,EAAaxB,IAAiB7gC,EAC9Cw1B,EAAcyM,EAAiB,GAAEA,EAAc3oC,QAAQA,IAASA,EACtE,GAAI2oC,aAAqD,EAASA,EAAcxC,YAAY6C,QACxF,MAAM,IAAI7M,GAAoB,CAC1Bn2B,QAAU,iCAAgCk2B,KAC1CA,gBAGR,MAAMsG,EAAkB,IAAIz/B,GAAAA,EAC5B,IAAIkmC,EACAp1B,EAASk1B,EACTJ,IACA90B,EAAS,OAAH,UACC80B,EAAc90B,OACdk1B,GAEPE,EAAgB,KACZzG,EAAgBY,OAAO,EAG3BuF,EAAcxC,YAAYtsB,iBAAiB,QAASovB,IAExD,MAAMjwB,EAAU,CACZhZ,KAAMk8B,EACNiK,YAAa3D,EAAgB0G,OAC7Br1B,UAEJ,IAEI,aADqBg1B,EAAG7vB,EAASwpB,EAcrC,CAXA,MAAOngC,GAIH,KAHqB,iBAAVA,GAAuBA,EAAM8mC,uBACpC9mC,EAAM8mC,qBAAuBnwB,EAAQhZ,MAEnCqC,CACV,CAAC,QAGO4mC,GAAiBN,GACjBA,EAAcxC,YAAYiD,oBAAoB,QAASH,EAE/D,CACJ,QA4EW1F,OAGZiE,IAEH,MAAM98B,GAAY,EACdzC,EAAAA,EAAAA,IAAQ,CACJA,QAASub,EAAAA,GACTha,WAAY,EAAG6/B,cAAa5P,YACjB4P,EAAa,GAAE5P,EAAO76B,OAEjCgK,KAAM,CACFygC,YAAa/mB,GAAAA,GACbmX,OAAQrX,GAAAA,OAKdknB,GAAiB,EACnBrhC,EAAAA,EAAAA,IAAQ,CACJA,QAASoa,GAAAA,EACT7a,OAAO,EACPU,SAAU,CAACmb,EAAAA,GAAkBvK,EAAAA,GAAagB,EAAAA,OAI5CqpB,GAAU,CACZrC,SAAU,CACNyI,GAAAA,GAAAA,cACAA,GAAAA,GAAAA,gBACAA,GAAAA,GAAAA,iBAEJ35B,MAAO,CAAC25B,GAAAA,GAAAA,OACRxI,IAAK,CACDwI,GAAAA,GAAAA,gBACAA,GAAAA,GAAAA,gBACAA,GAAAA,GAAAA,eAEJvI,SAAU,CAACuI,GAAAA,GAAAA,qBAEThI,GAAQ,CACVL,OAAQiC,GACRhC,OAAQgC,IAENqG,GAAmB,EACrBvhC,EAAAA,EAAAA,IAAQ,CACJA,QAASoa,GAAAA,EACT7a,OAAO,EACPU,SAAUwN,EAAAA,MAEdzN,EAAAA,EAAAA,IAAQ,CACJA,QAAS+b,EAAAA,GACTzc,MAAO5B,EAAAA,GAAAA,UACPuC,SAAUq5B,MAIZkI,GAAmB,EACrBxhC,EAAAA,EAAAA,IAAQ,CACJA,QAASoa,GAAAA,EACT7a,OAAO,EACPU,SAAU,CAACwa,EAAAA,GAAwBC,EAAAA,OAEvC1a,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAUy7B,MAIlB,IAAI+F,GAAuB,QAE3BA,IAAuBjxB,EAAAA,EAAAA,IAAW,EAC9B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJA,MACA4+B,MACAE,MACAC,IACHxhC,EAAAA,EAAAA,IAAQ,CACJA,QAASs1B,GACT/1B,OAAO,EACPgC,WAAY,EAAGwP,cACX,MAAMmH,EAA8CnH,EAAQH,WAC5D,OAAQlY,IACIihB,EAAAA,GAAAA,KAAIF,EAAAA,GAAU,CAAE1I,QAASA,EAASmH,YAAaA,EAAawB,SAAUhhB,GACjF,EAELiI,KAAM,CACFoQ,QAASc,EAAAA,UAK1B4vB,I,4FEpwCH,MACMC,GAAkB,KAClBC,GAA0B,qBAC1BC,GAAsB,6BAKtBC,GAAyB,CAAC9P,EAAU+P,GAAgB,KACtD,MAAMC,EAAmBhQ,EAASiQ,SAAS,KAC3C,OAAIF,EACOC,GANKhQ,IACT,eAAe5vB,KAAK4vB,GAKIkQ,CAAWlQ,GAAYA,EAAY,GAAEA,KAE7DA,EAASh8B,OAAS,GAAKgsC,EAAmBhQ,EAASxpB,MAAM,GAAI,GAAKwpB,CAAQ,EAM/EmQ,GAEC/S,IACSA,EAAI3O,MAAQ2O,EAAI3O,OAAS3lB,OAAOmlB,SAASQ,KAEnD2hB,GAAuB1jC,GACF,iBAAZA,EACA,CAAE0wB,IAAK1wB,GAEXA,EAEL2jC,GAAe,CAACC,EAAUC,KAC5BD,EAASt+B,IAAIu+B,GACN,KACHD,EAAS96B,OAAO+6B,EAAK,GAIvBC,GAAYxQ,GAAaA,EAC1B1lB,MAAM,KACN9D,MAAMwpB,EAASyQ,WAAW,KAAO,EAAI,EAAGzQ,EAASiQ,SAAS,MAAQ,EAAIS,KACrEC,GAAqBC,GAChBhB,GAAwBx/B,KAAKwgC,GAElCC,GAAcD,GACTjB,GAAgBv/B,KAAKwgC,GAE1BE,GAAmBF,GACdA,EAAKjsC,SA/CY,KAkEtB6uB,GAASod,GACPD,GAAkBC,GACX,CAAE9qC,KAAM,GAEf+qC,GAAWD,GACJ,CAAE9qC,KAAM,GAEfgrC,GAAgBF,GAxBAA,KACpB,MAAOG,EAAS,GAAIzC,EAAO0C,EAAU,IAAMJ,EAAKt2B,MAlDxB,KAmDlB22B,EAAQpB,GAAoBqB,KAAK5C,GACvC,IAAK2C,EACD,MAAM,IAAI1oC,MAAM,2EAEpB,MAAO,CAAE4oC,EAAWhgB,EAAQpkB,GAAYkkC,EAExC,MAAO,CACHnrC,KAAM,EACNqrC,YACAhgB,OAJc4f,GAAUC,GAAW7f,EAK7B,IAAIrB,OAAQ,IAAGihB,KAAU5f,GAAU,QAAQpkB,EAAW,IAAM,KAAKikC,WACjE1oC,EACNyE,WAAYA,IAAagkC,IAAWC,EACvC,EAUUI,CAAeR,GAEnB,CAAE9qC,KAAM,EAA0B6J,MAAOihC,GAE9CS,GAAW,CAACrR,EAAUlqB,KACxB,MAAMw7B,EAAQd,GAASxQ,GACjBnxB,EAASmB,MAAK4gC,IAChB,IAAIviC,EACJ,GAAIsiC,GAAkBC,IAASC,GAAWD,GACtC,MAAM,IAAIroC,MAAO,uFAAsFy3B,KAE3G,GAAI8Q,GAAgBF,GAAO,CACvB,MAAOG,EAAS,GAAIzC,EAAQ,GAAI0C,EAAU,IAAMJ,EAAKt2B,MAtFrC,KAuFV22B,EAAQpB,GAAoBqB,KAAK5C,GACvC,IAAK2C,EACD,MAAM,IAAI1oC,MAAM,2EAEpB,MAAO,CAAE4oC,EAAWhgB,EAAQpkB,GAAYkkC,EAClCthC,EAAqC,QAA5BtB,EAAKyH,EAAOq7B,UAA+B,IAAP9iC,OAAgB,EAASA,EAAG7J,WAC/E,GAAIuI,IAAa4C,EACb,MAAO,GAEX,IAAKA,EACD,MAAM,IAAIpH,MAAO,2BAA0B4oC,iCAE/C,GAAIhgB,IAAW,IAAIrB,OAAOqB,GAAQ/gB,KAAKT,GACnC,MAAM,IAAIpH,MAAO,wBAAuB4oC,4BAAoChgB,WAAgBxhB,KAEhG,OAAOohC,EAASphC,EAAQqhC,GAAWJ,CACvC,CACA,OAAOA,CAAI,GACZU,GAAOxsC,KAAK,KACf,OAAOgrC,GAAwB,IAAGjhC,IAAUmxB,EAASiQ,SAAS,KAAK,EAIvE,IAAI30B,GAAS,CACTgU,MAAO2F,IACP1F,MAAO0F,IACPzF,KAAMyF,IACNtZ,KAAMsZ,IACN5sB,MAAO4sB,KAMX,MAAMsc,GACF9kC,aAAY,cAAEsjC,EAAa,aAAEyB,EAAY,cAAEC,EAAgB,GAAE,eAAEC,EAAiB,GAAE,cAAEC,EAAgB,GAAE,oBAAEC,EAAsB,GAAE,mBAAEC,EAAqB,GAAE,OAAEC,EAAS,GAAE,SAAElhB,EAAW,GAAE,WAAEmhB,EAAU,WAAEC,EAAU,QAAEC,IAC3MtlC,KAAKulC,SAAU,EACfvlC,KAAKojC,eAAgB,EACrBpjC,KAAKwlC,qBAAsB,EAC3BxlC,KAAK6kC,cAAe,EACpB7kC,KAAKojC,cAAgBA,SAAqDA,EAC1EpjC,KAAKwlC,yBAA+C,IAAlBpC,EAClCpjC,KAAK6kC,aAAeA,SAAmDA,EACvE7kC,KAAK8gC,MAAQ,IAAIlhC,IAAI,CACjB,CAAC,gBAAiB,IAAIsF,IAAI4/B,IAC1B,CAAC,iBAAkB,IAAI5/B,IAAI6/B,IAC3B,CAAC,gBAAiB,IAAI7/B,IAAI8/B,IAC1B,CAAC,sBAAuB,IAAI9/B,IAAI+/B,IAChC,CAAC,qBAAsB,IAAI//B,IAAIggC,MAEnCllC,KAAKmlC,OAAS,IAAIjgC,IAAIigC,GACtBnlC,KAAKylC,UAAY,IAAI7lC,IAAI,CAAC,CAAC,SAAU,IAAIsF,IAAI+e,MAC7CjkB,KAAKolC,WAAaA,EAClBplC,KAAKqlC,WAAaA,EAClBrlC,KAAKslC,QAAUA,CACnB,CAGA72B,cACIE,GAAOiU,MAAM,CACT3T,MAAO,UAEXjP,KAAKulC,SAAU,CACnB,CACAG,kBACI,IAAIhkC,EAAIC,EAAIie,EAGZ,OAA2F,QAAnFje,EAAuC,QAAjCD,EAAK1B,KAAK2lC,yBAAsC,IAAPjkC,OAAgB,EAASA,EAAGkkC,UAAuB,IAAPjkC,EAAgBA,EAAoC,QAA9Bie,EAAK5f,KAAK6lC,sBAAmC,IAAPjmB,OAAgB,EAASA,EAAGgmB,EAC/L,CACAE,gBACI,IAAIpkC,EAAIC,EAAIie,EAEZ,OAA4F,QAApFje,EAAuC,QAAjCD,EAAK1B,KAAK2lC,yBAAsC,IAAPjkC,OAAgB,EAASA,EAAG+uB,WAAwB,IAAP9uB,EAAgBA,EAAoC,QAA9Bie,EAAK5f,KAAK6lC,sBAAmC,IAAPjmB,OAAgB,EAASA,EAAG6Q,GAChM,CACAsV,eACI,IAAIrkC,EACJ,OAAsC,QAA9BA,EAAK1B,KAAK6lC,sBAAmC,IAAPnkC,OAAgB,EAASA,EAAGkkC,EAC9E,CACAI,aACI,IAAItkC,EACJ,OAAsC,QAA9BA,EAAK1B,KAAK6lC,sBAAmC,IAAPnkC,OAAgB,EAASA,EAAG+uB,GAC9E,CACAwV,iBAAiBC,GACbv3B,GAAOiU,MAAM,CACT3T,MAAO,oBACPi3B,eAECA,EAAWC,SAEZnmC,KAAKmmC,QAAQ9hB,KAAK6hB,GAEtBlmC,KAAK6lC,eAAiBK,EACtBlmC,KAAK2lC,kBAAoB,KACzB3lC,KAAKomC,aAAa,SAAUF,EAChC,CACAz3B,yBAAyB43B,GACrB,OAAOrmC,KAAKsmC,2BAA2BD,EAAoB,CAAC,EAChE,CACA53B,iCAAiC43B,GAAoB,QAAEF,IACnD,IAAIzkC,EACJ,MAAM6kC,EAAmD,QAAjC7kC,EAAK1B,KAAK2lC,yBAAsC,IAAPjkC,EAAgBA,EAAK1B,KAAK6lC,eAC3F,IAAKU,EACD,MAAM,IAAI3qC,MAAM,yEAEpB,MAAM,QAAEG,EAAO,OAAEoN,EAAM,cAAEq9B,GAAkBH,GACnCT,GAAIvjC,EAAMouB,IAAKgW,GAAYF,EAC7BL,EAAa,CACf/sC,KAAM,qBACNkJ,OACAujC,GAAI5lC,KAAK0mC,aAAa,CAAEv9B,SAAQq9B,iBAAiB,CAAEG,UAAU,IAC7DlW,IAAKzwB,KAAK4mC,WAAWP,GACrBI,UACA1qC,UACAoqC,UACAK,gBACAhf,KAAM6e,EAAmB7e,MAE7B7Y,GAAOiU,MAAM,CACT3T,MAAO,uBACPo3B,qBACAH,qBAEElmC,KAAKkP,IAAIg3B,EACnB,CACAz3B,4BAA4By3B,SAClBlmC,KAAKghC,SAAS,sBAAuBkF,GAC3ClmC,KAAKimC,iBAAiBC,SAChBlmC,KAAKghC,SAAS,qBAAsBkF,EAC9C,CACAz3B,eAAeo4B,GACX,OAAO7mC,KAAK8mC,iBAAiBrD,GAAoBoD,GAAkB,CAAC,EACxE,CACAp4B,uBAAuBo4B,GAAiB,QAAEV,EAAO,SAAEY,IAC/C,IAAIrlC,EACJ,MAAM,IAAE+uB,EAAG,QAAE10B,EAAO,OAAEoN,EAAM,cAAEq9B,EAAa,KAAEhf,GAASqf,EAChDN,EAAiBQ,EACjB/mC,KAAK6lC,eAC6B,QAAjCnkC,EAAK1B,KAAK2lC,yBAAsC,IAAPjkC,EAAgBA,EAAK1B,KAAK6lC,eAC1E,IAAKpV,IAAQ8V,EACT,MAAM,IAAI3qC,MAAM,+EAEpB,MAAMorC,EAAchnC,KAAK4mC,WAAWC,IAC5BjB,GAAIvjC,EAAMouB,IAAKgW,GAAYF,QAAuDA,EAAiB,CAAC,EAE5G,IAAIL,EAAa,CACb/sC,KAAM,WACNkJ,OACAouB,IAAKuW,EACLP,UACA1qC,UACAoqC,UACAK,gBACAhf,OACAuf,WACAE,aAXiBF,EAAW/mC,KAAK2lC,kBAAkBC,QAAKjqC,SAatDqE,KAAKghC,SAAS,gBAAiBkF,GACrC,MAAMN,EAAK5lC,KAAK0mC,aAAa,CAAEjW,IAAKuW,EAAa79B,SAAQq9B,iBAAiB,CAAEG,UAAU,IAWtF,GAVIf,IACAM,EAAa,OAAH,UACHA,EAAU,CACbN,QAGRj3B,GAAOiU,MAAM,CACT3T,MAAO,aACPi3B,gBAECA,EAAWN,GACZ,OAAO5lC,KAAKknC,SAAShB,SAEnBlmC,KAAKkP,IAAIg3B,EACnB,CACAz3B,kBAAkBy3B,GAEd,GAAIA,EAAWN,GAAGmB,SACd,OAAO/mC,KAAK+mC,SAASb,EAAYzC,GAAoByC,EAAWN,GAAGmB,iBAEjE/mC,KAAKmnC,UAAUjB,SACflmC,KAAKghC,SAAS,iBAAkBkF,GACtClmC,KAAKimC,iBAAiBC,SAChBlmC,KAAKghC,SAAS,gBAAiBkF,EACzC,CACAz3B,UAAUy3B,GACNlmC,KAAK2lC,kBAAoBO,EACD,aAApBA,EAAW/sC,YACL6G,KAAKonC,YAAYlB,GAEH,uBAApBA,EAAW/sC,YACL6G,KAAKqnC,sBAAsBnB,EAEzC,CACAza,QAAQ6b,EAAgBvnC,GACpB,MAAM8kB,EAAiC,iBAAnByiB,EAA8B,CAAE7W,IAAK6W,GAAmBA,EAC5E,OAAOtnC,KAAK0mC,aAAa,OAAD,UAAM7hB,EAAM,CAAA4L,IAAK8W,GAAQ1iB,EAAK4L,OAAQ1wB,EAClE,CACAynC,KAAKznC,GACD,OAAOC,KAAKynC,IAAI,EAAG1nC,EACvB,CACA2nC,UACI,OAAO1nC,KAAKynC,GAAG,EACnB,CACAh5B,SAASm3B,EAAI7lC,GAKT,OAJA4O,GAAOiU,MAAM,CACT3T,MAAO,aACP22B,OAEG5lC,KAAKmmC,QAAQsB,GAAG7B,EAAI7lC,EAC/B,CACA4nC,eACI,QAAS3nC,KAAK2lC,iBAClB,CACAl3B,kBACI,MAAM,IAAI7S,MAAM,kBACpB,CACA6S,gBAAgBy3B,GACZ,MAAM,IAAItqC,MAAM,kBACpB,CACAgsC,SAAS/U,GACL,IAAInxB,EACiB,QAApBA,EAAK1B,KAAK6nC,YAAyB,IAAPnmC,GAAyBA,EAAGkmC,SAAS/U,EACtE,CACApkB,eAAey3B,EAAY/hC,GACvB,IAAIzC,EAMJ,OALAiN,GAAOiU,MAAM,CACT3T,MAAO,WACPi3B,aACA/hC,WAE8B,QAA1BzC,EAAK1B,KAAKolC,kBAA+B,IAAP1jC,OAAgB,EAASA,EAAGxJ,KAAK8H,KAAM,OAAF,UACxEkmC,EAAU,CACb7jC,KAAM6jC,EAAWN,GACjBa,QAASP,EAAWzV,IACpBmV,GAAI,KACJnV,IAAKzwB,KAAK4mC,WAAWziC,KAE7B,CACAsK,eAAey3B,GACX,IAAIxkC,EAKJ,OAJAiN,GAAOiU,MAAM,CACT3T,MAAO,YACPi3B,eAE8B,QAA1BxkC,EAAK1B,KAAKqlC,kBAA+B,IAAP3jC,OAAgB,EAASA,EAAGxJ,KAAK8H,KAAMkmC,EACrF,CACAz3B,YAAYy3B,GAMR,GALAv3B,GAAOiU,MAAM,CACT3T,MAAO,UACPi3B,eAEJlmC,KAAK2lC,kBAAoB,KACrB3lC,KAAKslC,QACL,OAAOtlC,KAAKslC,QAAQY,GAExB,MAAM,IAAItqC,MAAM,qBACpB,CACAksC,kBAAkBzU,GACd,IAAI+K,EAAa/K,EAOjB,OANIrzB,KAAK6kC,eACLzG,EA5UkB2J,KAC1B,MAAO1X,KAASiD,GAAUyU,EAAWp6B,MAAM,KAC3C,MAAO,CAAC0iB,EAAKt0B,QAAQ,OAAQ,KAAKA,QAAQ,YAAa,YAAau3B,GAAQn7B,KAAK,IAAI,EA0UhE6vC,CAAqB5J,IAEjCp+B,KAAKwlC,sBACNpH,EAAa+E,GAAuB/E,EAAYp+B,KAAKojC,gBAElDhF,CACX,CACAwI,YAAW,IAAEnW,EAAG,MAAEjH,EAAQ,CAAC,EAAC,OAAErgB,EAAM,cAAE8+B,EAAa,KAAE1U,IACjD,IAAI7xB,EACJ,MAAMwmC,EAAeloC,KAAK0lC,kBACpByC,EAAanoC,KAAK8lC,gBAClBsC,EAAY3X,EP3SJ,EAACuD,EAASvD,KAC5B,MAAM4X,EAAkBtU,GAASC,EAAQn8B,YACzC,OAAOk8B,GAAStD,EAAK4X,EAAgB,EOySTC,CAAiG,QAAlF5mC,EAAKymC,aAA+C,EAASA,EAAW9X,YAAyB,IAAP3uB,EAAgBA,EAAK,GAAI+uB,GAAOsD,GAASoU,EAAW9X,MACrL,IAAI,SAAEgD,GAAa+U,EAYnB,OAXIj/B,IACIsnB,EACA4C,EAAWqR,GAAS0D,EAAU/U,SAAUlqB,GAEnC++B,IACL7U,EAAWqR,GAASwD,EAAal7B,KAAM,OAAF,UAAOk7B,EAAa/+B,OAAWA,MAGxEq6B,GAAW4E,KACX/U,EAAWrzB,KAAK8nC,kBAAkBzU,IAE/BG,GPzQM,EAAC/C,EAAKtnB,KACvB,MAAM,KAAQ6D,EAAI,MAAEwc,EAAK,KAAUqK,EAAI,SAAEF,EAAQ,SAAEC,GAAsBzqB,EAATo/B,EAAI,EAAKp/B,EAAM,IAC/E,GAAI6D,EAAM,CACN,MAAMw7B,EAlCIx7B,KACd,MAAMu3B,EAAOnQ,GAAYmQ,KAAKv3B,GAC9B,GAAIu3B,EAAM,CACN,MAAO/hB,EAAG6Q,EAAUC,EAAS,GAAIC,EAAO,IAAMgR,EAC9C,MAAO,CACHlR,WACAC,SACAC,OAER,GAyBuBkV,CAASz7B,GACxBw7B,GACA1wC,OAAO0H,OAAOixB,EAAK+X,EAE3B,CA4BA,GAjBI7U,IACAlD,EAAIkD,SAAWA,GAEfC,IACAnD,EAAImD,SAAWA,GAInB97B,OAAO0H,OAAOixB,EAAK8X,QACC,IAAT1U,IACPpD,EAAIoD,KAAOA,EAGM,MAAbpD,EAAIoD,OACJpD,EAAIoD,KAAwB,UAAjBpD,EAAIlP,SAAuB,KAAO,QAGjDiI,EAAO,CACP,MAAMiK,EAAe,IAAIiV,gBAAgBv/B,EAAOmqB,QAChDe,GAA0BZ,EAAcjK,GACxCiH,EAAI6C,OAASG,EAAa57B,UAC9B,CACA,OAAO44B,CAAG,EOiOekY,CAAaP,EAAW,CACzC/U,WACAC,OAAQ7C,EAAM2X,EAAU9U,OAAS,GACjC9J,MAAO,OAAF,UACGye,EAAgBjoC,KAAK8lC,gBAAgBtc,MAAQ,CAAC,EAC/CA,GAEP+J,KAAMA,QAAmCA,EAAO6U,EAAU7U,OAElE,CACAmT,cAAa,IAAEjW,EAAG,OAAEtnB,EAAM,cAAEq9B,IAAiB,SAAEG,GAAa,CAAC,GACzD,IAAIjlC,EAAIC,EACR,IAAIkxB,EAAQpC,EAA2B,QAApB/uB,EAAK1B,KAAK6nC,YAAyB,IAAPnmC,OAAgB,EAASA,EAAGknC,SAASnY,EAAI4C,UAAYrzB,KAAK0lC,kBAKzG,GAJIiB,IAAa9T,GAASpC,IAEtBoC,EAA6B,QAApBlxB,EAAK3B,KAAK6nC,YAAyB,IAAPlmC,OAAgB,EAASA,EAAGknC,YAAYpY,EAAI4C,WAEhFR,EAIL,OAAK1pB,GAAUq9B,IAAkB3T,EAAM2T,cAGhC,OAAP,UACO3T,EAAK,CACR1pB,OAAQ,OAAF,UAAO0pB,EAAM1pB,OAAWA,GAC9Bq9B,kBALO3T,CAOf,CACApkB,gBAAgBy3B,GAKZ,GAJAv3B,GAAOiU,MAAM,CACT3T,MAAO,aACPi3B,gBAEClmC,KAAKmlC,OAKN,YAJAx2B,GAAOiU,MAAM,CACT3T,MAAO,eACPi3B,eAIR,MAAM4C,QAAgBzS,QAAQzV,IAAInpB,MAAM4K,KAAKrC,KAAKmlC,QAAQ9hC,KAAK0lC,GAAU1S,QAAQ5K,QAAQsd,EAAM7C,IAAa7d,OAAO3sB,IAC/GiT,GAAOK,KAAK,CACRC,MAAO,cACPvT,SACF,OAENiT,GAAOiU,MAAM,CACT3T,MAAO,cACPi3B,aACA4C,YAEJ,IAAK,MAAM5mC,KAAU4mC,EAAS,CAC1B,IAAe,IAAX5mC,EACA,OAAOlC,KAAKgpC,MAAM9C,GAEtB,GAAI77B,IAASnI,IAAW2J,IAAS3J,GAC7B,OAAOlC,KAAK+mC,SAASb,EAAYzC,GAAoBvhC,GAE7D,CACJ,CACA+mC,cAAcF,GACV,OAAOrF,GAAa1jC,KAAKmlC,OAAQ4D,EACrC,CACA3C,aAAa8C,EAAUhD,GACnBv3B,GAAOiU,MAAM,CACT3T,MAAO,iBACPi6B,WACAhD,eAEJ,MAAMpF,EAAQ9gC,KAAKylC,UAAUjkC,IAAI0nC,GACjC,GAAKpI,EAAL,CAQA,IAAK,MAAM8C,KAAQ9C,EACf,IACI8C,EAAKsC,EAOT,CALA,MAAOxqC,GACHiT,GAAOK,KAAK,CACRC,MAAO,mBACPvT,SAER,CAEJiT,GAAOiU,MAAM,CACT3T,MAAO,kBACPi6B,WACAhD,cAfJ,MANIv3B,GAAOiU,MAAM,CACT3T,MAAO,mBACPi6B,WACAhD,cAoBZ,CACAiD,iBAAiBD,EAAUtF,GACvB,OAAOF,GAAa1jC,KAAKylC,UAAUjkC,IAAI0nC,GAAWtF,EACtD,CACAn1B,eAAey6B,EAAUhD,GACrBv3B,GAAOiU,MAAM,CACT3T,MAAO,YACPi6B,WACAhD,eAEJ,MAAMpF,EAAQ9gC,KAAK8gC,MAAMt/B,IAAI0nC,GACxBpI,SAQCzK,QAAQzV,IAAInpB,MAAM4K,KAAKy+B,GAAOz9B,KAAKugC,GAASvN,QAAQ5K,QAAQmY,EAAKsC,IAAa7d,OAAO3sB,IAOvF,GANAiT,GAAOK,KAAK,CACRC,MAAO,aACPvT,UAIa,kBAAbwtC,EACA,MAAMxtC,CACV,OAEJiT,GAAOiU,MAAM,CACT3T,MAAO,aACPi6B,WACAhD,gBArBAv3B,GAAOiU,MAAM,CACT3T,MAAO,cACPi6B,WACAhD,cAoBZ,CACAxC,aAAawF,EAAUtF,GACnB,OAAOF,GAAa1jC,KAAK8gC,MAAMt/B,IAAI0nC,GAAWtF,EAClD,EAGJ,MAAMwF,GACF9rB,KAAK4oB,GAAc,CACnB3oB,OAAO3J,GACH5T,KAAK4T,SAAWA,CACpB,CACAy1B,QAAQxB,GACJ7nC,KAAK6nC,KAAOA,CAChB,EAGJ,MAAMyB,GAAwDntC,OAAOgqC,SAAWhqC,OAAOgqC,QAAQoD,UAqEzFC,GAAkBr4B,GACbA,GAA8B,iBAAdA,EAAMlZ,IAQ3BwxC,GAAgB,CAACvD,EAAYwD,KAC/B,MAAMzxC,EAPWiuC,KACjB,MAAM,GAAEN,GAAOM,EACf,GAAIN,EACA,MAAQ,GAAEA,EAAGvsC,QAAQusC,EAAG54B,MAC5B,EAGY28B,CAAYzD,GACxB,IAAI,KAAE/sC,GAAS+sC,EAIf,OAHIA,EAAWnqC,SAAW2tC,IACtBvwC,EAAOuwC,EAAavwC,OAASA,EAAOA,EAAO,YAExC,CACHlB,MACAkB,OACAqtC,cAAeN,EAAWM,cAC7B,EAEL,MAAMoD,WAAsBR,GACxBtpC,cACI+D,QACA7D,KAAK6pC,aAAe,EACpB7pC,KAAK8pC,eA7FO,GAAGC,iBACnB,IAAKT,GAAsB,CACvB,MAAMU,EAAW,CAAC7K,EAAM8K,EAAOxZ,KAC3Bt0B,OAAOmlB,SAAS+O,KAAOI,EAAI54B,UAAU,EAIzC,OAFAsE,OAAOgqC,QAAQoD,UAAYS,EAC3B7tC,OAAOgqC,QAAQ+D,aAAeF,EACvB,CACHA,SAAU,EAAGh9B,UAAWg9B,EAAS,CAAC,EAAG,GAAIh9B,GACzCm5B,QAAS,KACL,MAAM,IAAIvqC,MAAM,yBAAyB,EAE7C0hB,KAAMgL,IACN/U,UAAW+U,IAEnB,CACA,IAAI6hB,EAAiBhuC,OAAOgqC,QACxB,sBAAuBhqC,OAAOgqC,QAC9BgE,EAAiBhuC,OAAOgqC,QAAQiE,kBAGhCjuC,OAAOgqC,QAAQiE,kBAAoB,CAC/Bb,UAAWY,EAAeZ,UAAUv0B,KAAK7Y,OAAOgqC,SAChD+D,aAAcC,EAAeD,aAAal1B,KAAK7Y,OAAOgqC,SACtDsB,GAAI0C,EAAe1C,GAAGzyB,KAAK7Y,OAAOgqC,UAG1C,MAAMoD,EAAYY,EAAeZ,UAAUv0B,KAAK7Y,OAAOgqC,SACjD+D,EAAeC,EAAeD,aAAal1B,KAAK7Y,OAAOgqC,SACvDsB,EAAK0C,EAAe1C,GAAGzyB,KAAK7Y,OAAOgqC,SASnCA,EAAWkE,IACb5C,EAAG4C,EAAM,EAEPC,EAAkB,CAACvuC,GAAU,IACxB,CAACyqC,EAAeyD,EAAOxZ,KAC1BsZ,EAAW,CAAEtZ,IAAKA,EAAI54B,WAAYkE,UAASyqC,iBAAgB,EAQnE,OALArqC,OAAOgqC,QAAQoD,UAAYe,GAAgB,GAC3CnuC,OAAOgqC,QAAQ+D,aAAeI,GAAgB,GAC9CnuC,OAAOgqC,QAAQsB,GAAKtB,EACpBhqC,OAAOgqC,QAAQqB,KAAO,IAAMrB,GAAS,GACrChqC,OAAOgqC,QAAQuB,QAAU,IAAMvB,EAAQ,GAChC,CACH6D,SAtBa,EAAGh9B,OAAMjR,UAASoV,YAC3BpV,EACAmuC,EAAa/4B,EAAO,GAAInE,GAGxBu8B,EAAUp4B,EAAO,GAAInE,EACzB,EAiBAm5B,UACA7oB,KAAOnM,IACH+4B,EAAa/4B,EAAO,GAAG,EAE3BoC,UAAYC,IACRrX,OAAO+W,iBAAiB,YAAY,EAAG/B,YACnCqC,EAAQ,CACJxG,KAAM7Q,OAAOmlB,SAAS+R,SAAWl3B,OAAOmlB,SAASgS,OAASn3B,OAAOmlB,SAASiS,KAC1EpiB,SACF,GACJ,EAET,EA4ByBo5B,CAAY,CAC9BR,WAAY,EAAGtZ,MAAK10B,UAASyqC,oBACzBxmC,KAAK4T,SAAS,CACV6c,MACA10B,UACAyqC,iBACF,GAGd,CACAlpB,KAAK4oB,GACD,IAAIxkC,EACJ1B,KAAK0pC,aAAeF,GAAyC,QAAzB9nC,EAAKvF,OAAOgqC,eAA4B,IAAPzkC,OAAgB,EAASA,EAAGyP,OAC3FhV,OAAOgqC,QAAQh1B,MACfs4B,GAAcvD,GACpBlmC,KAAK8pC,eAAexsB,KAAKtd,KAAK0pC,cAC9B1pC,KAAK8pC,eAAev2B,WAAU9E,OAASzB,OAAMmE,YACzC,IAAIzP,EAAIC,EACR,IACI,IAAI6oC,EACAhE,EACJ,GAAIgD,GAAer4B,GAAQ,CACvB,MAAQlZ,IAAKwyC,EAAStxC,KAAMuxC,GAAa1qC,KAAK0pC,cACxC,IAAEzxC,EAAG,KAAEkB,GAASgY,EACtBnR,KAAK0pC,aAAev4B,EACpBq1B,EAAgBr1B,EAAMq1B,cAMlBgE,EALAvyC,IAAQwyC,GACE,uBAATtxC,GAA8C,uBAAbuxC,EAIjB,WAHA,oBAKzB,MAGI1qC,KAAK6pC,aAAe,QAElB7pC,KAAK4T,SAAS,CAChBza,KAAMqxC,EACNrE,SAAS,EACT1V,IAAKzjB,EACLw5B,kBAE6B,QAAhC9kC,EAAK1B,KAAK2qC,wBAAqC,IAAPjpC,GAAyBA,EAAGxJ,KAAK8H,KAI9E,CAFA,MAAOT,GAC6B,QAA/BoC,EAAK3B,KAAK4qC,uBAAoC,IAAPjpC,GAAyBA,EAAGzJ,KAAK8H,KAAMT,EACnF,IAER,CACA8kB,KAAK6hB,GACD,MAAM,QAAEnqC,EAAO,IAAE00B,GAAQyV,EACpBnqC,GACDiE,KAAK6pC,eAET7pC,KAAK0pC,aAAeD,GAAcvD,EAAYlmC,KAAK0pC,cACnD1pC,KAAK8pC,eAAeE,SAAS,CACzBh9B,KAAMyjB,EAAIzjB,KACVjR,UACAoV,MAAOnR,KAAK0pC,cAEpB,CACAjC,GAAG7B,EAAI7lC,GACH,IAAI2B,EAEJ,GADc1B,KAAK6pC,aAAejE,EACtB,EAAG,CACX,GAAI7lC,aAAyC,EAASA,EAAQ8qC,gBAC1D,OAAO7qC,KAAK4T,SAAS,CACjB6c,IAAK1wB,EAAQ8qC,gBACb1xC,KAAM,WACNgtC,SAAS,IAGjB,MAAM2E,EAA4C,QAApBppC,EAAK1B,KAAK6nC,YAAyB,IAAPnmC,OAAgB,EAASA,EAAGqpC,mBAAmB5uC,OAAOmlB,SAAS+R,UACzH,GAAIyX,EACA,OAAO9qC,KAAK4T,SAAS,CACjB6c,IAAKqa,EAAqBE,WAC1B7xC,KAAM,WACNgtC,SAAS,GAGrB,CACA,MAAM/Z,EAAU,IAAIiK,SAAQ,CAAC5K,EAASuM,KAClCh4B,KAAK2qC,iBAAmBlf,EACxBzrB,KAAK4qC,gBAAkB5S,CAAM,IAGjC,OADAh4B,KAAK8pC,eAAe3D,QAAQP,GACrBxZ,CACX,EAGJ,MAAM6e,WAAqBrG,GACvB9kC,YAAYC,GACR8D,MAAM9D,GACNC,KAAKmmC,QAAU,IAAIyD,GACnB5pC,KAAKmmC,QAAQ5oB,QAAO9O,OAAStV,OAAMs3B,MAAK+V,gBAAezqC,UAASoqC,cAC5D,IAAIzkC,EACJ,MAAMymC,EAAanoC,KAAK8lC,iBAClB,SAAEzS,EAAQ,MAAE7J,GAAUxpB,KAAK4mC,WAAW,CAAEnW,QACxCya,EAAsB/C,EAAW9U,WAAaA,EACpD,GAAa,uBAATl6B,IAAmCA,GAAQ+xC,EAAsB,CACjE,MAAMrY,EAA6B,QAApBnxB,EAAK1B,KAAK6nC,YAAyB,IAAPnmC,OAAgB,EAASA,EAAGknC,SAASvV,SAC1ErzB,KAAKsmC,2BAA2B,CAClCn9B,OAAQ0pB,aAAqC,EAASA,EAAM1pB,OAC5DqgB,QACAztB,UACAyqC,iBACD,CAAEL,WACT,YAEUnmC,KAAK8mC,iBAAiB,CACxBrW,MACA10B,UACAyqC,iBACD,CAAEL,WACT,GAER,CACA13B,gBAAgBy3B,GACZv3B,GAAOiU,MAAM,CACT3T,MAAO,YACPi3B,eAEJ,MAAMzV,EAAM8W,GAAQprC,OAAOmlB,SAAS+O,MACpCrwB,KAAK2lC,kBAAoB,OAAH,UACfO,EAAU,CACb/sC,KAAM,WACNs3B,QAEJzwB,KAAK6lC,eAAiB7lC,KAAK2lC,wBAErB3lC,KAAKmnC,UAAUnnC,KAAK2lC,mBAE1B3lC,KAAKmmC,QAAQ7oB,KAAKtd,KAAK2lC,mBACvB3lC,KAAK2lC,kBAAoB,KAErBO,EAAWN,IACX5lC,KAAK4nC,SAAS,CACVvuC,KAAM6sC,EAAWN,GAAGvsC,KACpB2T,KAAMk5B,EAAWN,GAAG54B,KACpB8lB,OAAQoT,EAAWN,GAAG9S,OAGtBqY,MAAO1a,EAAI4C,UAGvB,CACAqT,gBAAgB3mC,GACZ,MAAM,IAAE0wB,GAAQ1wB,EAAQ,GAExB,IAAI0wB,GAAQ+S,GAAW/S,GAGvB,OAAO5sB,MAAM6iC,gBAAgB3mC,EACjC,CACA0O,eAAey3B,GACX,IAAIxkC,EAAIC,QACFkC,MAAMqjC,SAAShB,GAErB,MAAMkF,EAA4F,QAAjFzpC,EAAmC,QAA7BD,EAAKwkC,EAAWO,eAA4B,IAAP/kC,OAAgB,EAASA,EAAG2uB,YAAyB,IAAP1uB,EAAgBA,EAAKxF,OAAOmlB,SAAS+O,KACzI8E,EAAU+Q,EAAWzV,IAAIJ,KAc/B,OAb0B6V,EAAW7jC,OAAS6jC,EAAWN,IAI1BwF,IAAYjW,KACnC+Q,EAAWnqC,QACXI,OAAOmlB,SAASvlB,QAAQo5B,GAGxBh5B,OAAOmlB,SAAS9hB,OAAO21B,IAIxB,IAAIkB,SAAQ,QACvB,CACA5nB,YAAYy3B,GACR,OAAOlmC,KAAKknC,SAAShB,EACzB,CACAz3B,eAAey3B,EAAY/hC,GAEvB,aADMN,MAAMkjC,SAASb,EAAY/hC,GAC1BnE,KAAK8mC,iBAAiB,OAAD,UACrB3iC,EAAM,CACTpI,QAASoI,EAAOpI,SAAWmqC,EAAWnqC,UACvC,CACCgrC,UAAU,GAElB,EAGJ,MAAMsE,GAAcxY,IACT,CACHA,QACA7X,SAAUljB,OAAO+U,OAAO,MACxBsR,WAAY,KAGdmtB,GAAwB,CAACzY,EAAOQ,EAAUlqB,IACrC,OAAP,UACO0pB,EAAK,CACRmY,WAAY3X,EACZlqB,OAAQA,QAAuCA,EAAS,CAAC,IAGjE,MAAMoiC,GACFzrC,YAAYgyB,GACR9xB,KAAK6nC,KAAOwD,KACZvhB,MAAM+I,GAAU7yB,KAAK4nC,SAAS/U,IAAQf,EAC1C,CAEA8V,SAAS/U,GACL,MAAM8R,EAAQd,GAAShR,EAAM7lB,MAC7B,IAAIw+B,EAAcxrC,KAAK6nC,KACvB,IAAK,IAAI1wC,EAAI,EAAGA,EAAIwtC,EAAMttC,OAAQF,IAAK,CACnC,MAAM8sC,EAAOU,EAAMxtC,GACbs0C,EAAS5kB,GAAMod,GACrB,GAAoB,IAAhBwH,EAAOtyC,KAEP,YADAqyC,EAAYV,qBAAuBjY,GAGvC,GAAoB,IAAhB4Y,EAAOtyC,KAEP,YADAqyC,EAAYE,cAAgB7Y,GAGhC,GAAoB,IAAhB4Y,EAAOtyC,KAAqC,CAC5C,MAAM,UAAEqrC,EAAS,OAAEhgB,EAAM,SAAEpkB,GAAaqrC,EAElCE,EAAQC,MAAMC,GAAQA,EAAI5zC,MAAQgsC,GAAMuH,EAAYrtB,YAC1D,GAAIwtB,EACAH,EAAcG,EAAM9D,SAEnB,CACD,MAAMiE,EAAY,CACd7zC,IAAKgsC,EACLO,YACAhgB,SACApkB,WACAynC,KAAMwD,MAEV,GAAI7mB,IAAWpkB,EAAU,CAErB,MAAM8H,EAAQ6jC,MAAWF,IAASA,EAAIrnB,QAAQgnB,EAAYrtB,YAC1DqtB,EAAYrtB,WAAWuG,OAAOxc,EAAO,EAAG4jC,EAC5C,MAEIN,EAAYrtB,WAAW3mB,KAAKs0C,GAEhCN,EAAcM,EAAUjE,IAC5B,CACJ,MAES2D,EAAYxwB,SAASipB,KACtBuH,EAAYxwB,SAASipB,GAAQoH,MAEjCG,EAAcA,EAAYxwB,SAASipB,EAE3C,CACAuH,EAAY3Y,MAAQA,CACxB,CACA+V,SAASvV,GACL,OAAOrzB,KAAKgsC,UAAU3Y,EAAU,QACpC,CACAwV,YAAYxV,GACR,OAAOrzB,KAAKgsC,UAAU3Y,EAAU,gBACpC,CACA0X,mBAAmB1X,GACf,MAAMR,EAAQ7yB,KAAKgsC,UAAU3Y,EAAU,wBACvC,OAAQR,GAAS,OAAJ,UACNA,EAAK,CAERmY,WAAYnY,EAAM7lB,KAAKjR,QAAQknC,GAAyB,KAAO,KAEvE,CAEA+I,UAAU3Y,EAAU4Y,GAGhB,MAAMC,EAA8B,UAAjBD,EACbtH,EAAQd,GAASxQ,GACjBvL,EAAQ,CACV,CAAC9nB,KAAK6nC,KAAM,IAEhB,KAAO/f,EAAMzwB,QAAQ,CACjB,MAAOm0C,EAAatjC,EAAOiB,GAAU2e,EAAMhhB,OACrC,SAAEkU,EAAQ,WAAEmD,GAAeqtB,EAKjC,IAAIW,GAAe,EACnB,GAAIjkC,GAASy8B,EAAMttC,OAAQ,CACvB,GAAIm0C,EAAYS,GACZ,OAAOX,GAAsBE,EAAYS,GAAe5Y,EAAUlqB,GAGtEgjC,GAAe,CACnB,EAEKD,GAAcV,EAAYS,IAC3BnkB,EAAMtwB,KAAK,CAACg0C,EAAa7G,EAAMttC,OAAQ8R,IAE3C,MAAM86B,EAAOU,EAAMz8B,GACb0c,EAAQ5J,EAASipB,GAEvB,IAAK,MAAMtC,KAASxjB,EAAY,CAC5B,MAAM,SAAE/d,EAAQ,KAAEynC,GAASlG,EACvBvhC,GACA0nB,EAAMtwB,KAAK,CAACqwC,EAAM3/B,EAAOiB,GAEjC,CACA,IAAIgjC,EAAJ,CAIA,IAAK,IAAIh1C,EAAIgnB,EAAW9mB,OAAS,EAAGF,GAAK,EAAGA,IAAK,CAC7C,MAAMwqC,EAAQxjB,EAAWhnB,IACnB,UAAEqtC,EAAS,KAAEqD,EAAI,OAAErjB,GAAWmd,EAC9B2C,EAAQ9f,aAAuC,EAASA,EAAO+f,KAAKN,GACpEmI,EAAa5nB,EAAS8f,aAAqC,EAASA,EAAM,GAAKL,EACjFmI,GACAtkB,EAAMtwB,KAAK,CAACqwC,EAAM3/B,EAAQ,EAAG,OAAF,UAAOiB,EAAQ,EAACq7B,GAAY4H,KAE/D,CACIxnB,GAEAkD,EAAMtwB,KAAK,CAACotB,EAAO1c,EAAQ,EAAGiB,GAblC,CAeJ,CACJ,EAoKJ,MAcMkjC,IAAgBj1B,EAAAA,GAAAA,eAAc,MAC9Bk1B,IAAel1B,EAAAA,GAAAA,eAAc,MAC7Bm1B,IAAan1B,EAAAA,GAAAA,eAAc,MAE3B2D,GAAW,EAAGyxB,SAAQhzB,cAAawB,eACrC,MAAM6X,GAAQhZ,EAAAA,GAAAA,uBAAsBqoB,GAAOsK,EAAOrD,iBAAiB,SAAUjH,KAAK,IAAMsK,EAAOzG,gBAAgBvsB,EAAc,IAAMA,EAAY0uB,aAAe,IAAMsE,EAAOzG,gBACrKtV,GAAM5W,EAAAA,GAAAA,uBAAsBqoB,GAAOsK,EAAOrD,iBAAiB,SAAUjH,KAAK,IAAMsK,EAAOxG,cAAcxsB,EAAc,IAAMA,EAAY2uB,WAAa,IAAMqE,EAAOxG,cACrK,OAAQ/qB,EAAAA,GAAAA,KAAIoxB,GAActxB,SAAU,CAAE/X,MAAOwpC,EAAQxxB,UAAUC,EAAAA,GAAAA,KAAIqxB,GAAavxB,SAAU,CAAE/X,MAAO6vB,EAAO7X,UAAUC,EAAAA,GAAAA,KAAIsxB,GAAWxxB,SAAU,CAAE/X,MAAOytB,EAAKzV,SAAUA,OAAiB,EAE1LD,GAASliB,YAAc,WAEvB,MClnCM4zC,IAAetsC,EAAAA,EAAAA,IAAY,iBAK3BusC,IAAevsC,EAAAA,EAAAA,IAAY,gBAAiB,CAAEU,OAAO,IAKrD8rC,IAAqBxsC,EAAAA,EAAAA,IAAY,eAAgB,CAAEU,OAAO,IAK1D+rC,IAAqBzsC,EAAAA,EAAAA,IAAY,sBAKjC0sC,IAAsB1sC,EAAAA,EAAAA,IAAY,uBAKlC2sC,IAAwB3sC,EAAAA,EAAAA,IAAY,wBAAyB,CAC/DU,OAAO,IAMLksC,IAAoC5sC,EAAAA,EAAAA,IAAY,qBAChD6sC,IAA8B7sC,EAAAA,EAAAA,IAAY,yB,oFCd1C8sC,IAAuBv8B,EAAAA,EAAAA,IAAY,qBACnCw8B,IAAoBx8B,EAAAA,EAAAA,IAAY,wBAOhCy8B,IAAcv8B,EAAAA,EAAAA,IAAc,SANb,CACjBs3B,aAAc,KACdkF,cAAe,KACfjF,WAAY,KACZkF,YAAa,OAGZn8B,GAAG+7B,IAAsB,CAAC97B,GAASy0B,KAAIvjC,OAAMouB,MAAKgW,UAAS1qC,cAGrD,CACHmsC,aAActC,EACdwH,cAAerxC,EAAUoV,EAAMi8B,cAAgB/qC,EAC/C8lC,WAAY1X,EACZ4c,YAAatxC,EAAUoV,EAAMk8B,YAAc5G,MAG9Cv1B,GAAGg8B,IAAmB,CAAC/7B,EAAOsf,IACxB,OAAP,UACOtf,EAAK,CACRg3B,WAAY1X,MAId6c,IAAmBntC,EAAAA,EAAAA,IAAY,2BAC/BotC,IAA6BptC,EAAAA,EAAAA,IAAY,+BACzCqtC,IAAqBrtC,EAAAA,EAAAA,IAAY,uBAAwB,CAC3DU,OAAO,IAEL4sC,IAA0BttC,EAAAA,EAAAA,IAAY,4BAA6B,CACrEU,OAAO,IAEL6sC,IAA2BvtC,EAAAA,EAAAA,IAAY,6BAA8B,CACvEU,OAAO,IAEL8sC,IAA0BxtC,EAAAA,EAAAA,IAAY,4BAA6B,CACrEU,OAAO,IAEL+sC,IAAgCztC,EAAAA,EAAAA,IAAY,kCAAmC,CAAEU,OAAO,IACxFgtC,IAA+B1tC,EAAAA,EAAAA,IAAY,iCAAkC,CAAEU,OAAO,IACtFitC,IAAsB3tC,EAAAA,EAAAA,IAAY,8BA+ElC4tC,GAAe,CACjB,CACIzsC,QAASqrC,GACT9rC,OAAO,EACPgC,WAhFW,EAAGmrC,gBAAer/B,SAAQ4oB,iBAAgB0W,kBAAiB75B,aAAY0lB,oBAAmBoU,kBACzG,MAAMr/B,EAAMF,EAAO,sBACnB,OAAOF,OAASm3B,SACZ,IAAIlkC,EACJmN,EAAI+T,MAAM,CACN3T,MAAO,cACP4jB,MAAO+S,IAEX,MAAM,OAAE9N,EAAM,cAAEtF,EAAa,sBAAEO,GAA0B6S,EAAG9S,OAC5D,IAAKkb,EAAc7rC,IAAI21B,EAAQtF,GAS3B,OARA3jB,EAAIgU,KAAK,CACL5T,MAAO,wBACP6oB,SACAtF,kBAIJyb,EAAgBvU,UAAU,MACnB,EAKX,IACI,MAAMvD,EAAW,GAGjBA,EAAS3+B,KAAKw2C,EAAcxsC,IAAIs2B,EAAQtF,IACpCO,GACAoD,EAAS3+B,KAAKg6B,GAAqB0c,EAAYC,2BAA2B,kBAE9E,MAAOC,EAAgBC,SAAwBhY,QAAQzV,IAAIuV,IACrD,WAAEqB,EAAU,SAAEzf,GAAaq2B,EAC3Bv0C,EAAY29B,EAAWhF,GAGuD,QAAnF9wB,EAAK7H,aAA6C,EAASA,EAAUke,gBAA6B,IAAPrW,GAAyBA,EAAGP,SAAS0V,GAAYijB,EAAkB/kB,SAAS8B,KACxKkB,SAAoDA,EAAS5W,SAAS0V,GAAYijB,EAAkB/kB,SAAS8B,KAGzGw3B,IACI,YAAaA,GAAkB32C,IAAQ22C,EAAetgC,UACtDwpB,EAAelyB,IAAImtB,EAAe6b,EAAetgC,SAEjD,aAAcsgC,GAAkB32C,IAAQ22C,EAAet2B,WACvDs2B,EAAet2B,SAAS5W,SAAS0V,IAC7BzC,EAAW6B,cAAcY,GACzBijB,EAAkB/kB,SAAS8B,EAAQ,IAYnD,CAPA,MAAOnb,GAMH,OALAmT,EAAInT,MAAM,CACNuT,MAAO,qBACPvT,WAGG,CACX,EACH,EAqBGuG,KAAM,CACF0M,OAAQC,EAAAA,GACRo/B,cAAepyB,EAAAA,GACf2b,eAAgBzb,EAAAA,GAChBmyB,gBAAiBjxB,EAAAA,GACjB5I,WAAYsI,EAAAA,GACZod,kBAAmBnd,EAAAA,GACnBuxB,YAAatB,KAGrB,CACItrC,QAASqrC,GACT9rC,OAAO,EACPgC,WA/Bc,EAAGorC,kBAAiBt/B,aACtC,MAAME,EAAMF,EAAO,2BACnB,OAAOF,UACH,GAAIw/B,EAAgBtU,aAAe,IAK/B,OAJA9qB,EAAInT,MAAM,CACNuT,MAAO,kBACPod,OAAQ4hB,EAAgBtU,eAErB,CACX,CACH,EAsBG13B,KAAM,CACF0M,OAAQC,EAAAA,GACRq/B,gBAAiBjxB,EAAAA,MAWvBsxB,GAAc,CAChB,CACIhtC,QAASksC,GACT3sC,OAAO,EACPgC,WAVgB,EAAGwP,aACf6zB,IACJ7zB,EAAQS,SAASm6B,GAAqB/G,GAAY,EASlDjkC,KAAM,CACFoQ,QAASc,EAAAA,MA+Bfo7B,GAAgB,EAAG/B,aACrB,MAAMhzB,EAAc,CAChB0uB,aAAcsE,EAAO9G,kBACrByC,WAAYqE,EAAO1G,iBAEvB,OAAQ9rC,IACIihB,EAAAA,GAAAA,KAAIF,GAAU,CAAEyxB,OAAQA,EAAQhzB,YAAaA,EAAawB,SAAUhhB,GAC/E,EAGCw0C,GAAe,CACjB,CACIltC,QAASwsC,GACTjrC,WAvCe,EAAG4rC,kBACjBA,GAAwC,IAAxBA,EAAap3C,OAG3Bke,QAAWrL,KAAQukC,IAFf72B,KAsCP3V,KAAM,CACFwsC,aAAc,CACV9uC,MAAOmtC,GACP1sC,UAAU,KAItB,CACIkB,QAASwrC,GACTjsC,OAAO,EACPU,SA3CkBsxB,IACtB,MAAMC,EAAS,OAAH,QACRgF,OAAQ,cACRtF,cAAe,eACZK,EAAMC,QAEb,OAAO,OAAP,UACOD,EAAK,CACRC,UAAM,GAqCV,CACIxxB,QAASwrC,GACTjsC,OAAO,EACPU,SApCgBsxB,GACb,OAAP,UACOA,EAAK,CACR7lB,KAAMjR,KAAQ,OAAQ,IAAK82B,EAAM7lB,SAmCrC,CACI1L,QAASs1B,GACT/1B,OAAO,EACPgC,WAAY0rC,GACZtsC,KAAM,CACFuqC,OAAQC,MAiEd7P,GAAc,EAEZt7B,EAAAA,EAAAA,IAAQ,CACJA,QAASorC,GACT7rC,OAAO,EACPgC,WAAY,EAAG8L,aACX,MAAME,EAAMF,EAAO,2BAEbmjB,EADah6B,OAAO+C,KX7T/Bw3B,GAAAA,QW8T+BhvB,IAAIsvB,IAK9B,OAJA9jB,EAAI+T,MAAM,CACN3T,MAAO,8CACP6iB,WAEGA,CAAM,EAEjB7vB,KAAM,CACF0M,OAAQC,EAAAA,OAGtB2I,OAAOzS,SAEH4pC,GAAc,IACbX,MACAO,MACAE,MACA5R,GACH,CACIt7B,QAASmrC,GACT5pC,WAAY,EAAG8rC,cAAa7c,SAAQ8c,iBAAgBC,eAAcC,2BAC9D,MAAMtC,EAAS,IAAImC,EAAY,OAAD,UACvBG,EAAoB,CACvB1L,eAAe,EACfyB,cAAc,EACd/S,OAAQ5nB,KAAQ4nB,QAAuCA,EAAS,IAAIzuB,IAAIurC,MAY5E,OAVIC,GACArC,EAAO9I,aAAa,iBAAiBj1B,UACjC,IAAK+9B,EAAO/gB,QAAQya,EAAWzV,IAAIJ,MAAO,CACtC,MAAMwC,QAAcgc,EAAa3I,GAC7BrT,GACA2Z,EAAO5E,SAASgH,EAAe/b,GAEvC,KAGD2Z,CAAM,EAEjBvqC,KAAM,CACF0sC,YAAarB,GACbwB,qBAAsB,CAClBnvC,MAAO4tC,GACPntC,UAAU,GAEd0xB,OAAQ,CACJnyB,MAAO+sC,GACPtsC,UAAU,GAEdwuC,eAAgBd,GAChBe,aAAc,CACVlvC,MAAOktC,GACPzsC,UAAU,KAItB,CACIkB,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAG2pC,SAAQrH,SAAQlhB,WAAU6gB,gBAAeC,iBAAgBC,gBAAeC,sBAAqBC,wBACjG,WACHh7B,KAAQi7B,QAAuCA,EAAS,IAAIhkC,SAAS4nC,GAAUyD,EAAOvD,cAAcF,KACpG7+B,KAAQ+Z,QAA2CA,EAAW,IAAI9iB,SAASyiC,GAAS4I,EAAOrD,iBAAiB,SAAUvF,KACtH15B,KAAQ46B,QAAqDA,EAAgB,IAAI3jC,SAASyiC,GAAS4I,EAAO9I,aAAa,gBAAiBE,KACxI15B,KAAQ66B,QAAuDA,EAAiB,IAAI5jC,SAASyiC,GAAS4I,EAAO9I,aAAa,iBAAkBE,KAC5I15B,KAAQ86B,QAAqDA,EAAgB,IAAI7jC,SAASyiC,GAAS4I,EAAO9I,aAAa,gBAAiBE,KACxI15B,KAAQ+6B,QAAiEA,EAAsB,IAAI9jC,SAASyiC,GAAS4I,EAAO9I,aAAa,sBAAuBE,KAChK15B,KAAQg7B,QAA+DA,EAAqB,IAAI/jC,SAASyiC,GAAS4I,EAAO9I,aAAa,qBAAsBE,IAChK,EAEJ3hC,KAAM,CACFuqC,OAAQC,GACRtH,OAAQ,CACJxlC,MAAOgtC,GACPvsC,UAAU,GAEd6jB,SAAU,CACNtkB,MAAO6tC,GACPptC,UAAU,GAEd0kC,cAAe,CACXnlC,MAAO8tC,GACPrtC,UAAU,GAEd2kC,eAAgB,CACZplC,MAAO+tC,GACPttC,UAAU,GAEd4kC,cAAe,CACXrlC,MAAOguC,GACPvtC,UAAU,GAEd6kC,oBAAqB,CACjBtlC,MAAOiuC,GACPxtC,UAAU,GAEd8kC,mBAAoB,CAChBvlC,MAAOkuC,GACPztC,UAAU,KAItB,CACIkB,QAAS8Q,EAAAA,GAAAA,KACTvR,OAAO,EACPgC,WAAY,EAAG8L,YACJ,WF3SAogC,QE4SOpgC,EAAO,gBF3S7BA,GAASogC,CE4SD,EAEJ9sC,KAAM,CACF0M,OAAQC,EAAAA,KAGhB,CACItN,QAASyrC,GAITxrC,SAAU,UAEdD,EAAAA,EAAAA,IAAQ,CACJA,QAASsrC,GACT9pC,SA/LR,MACIhD,aAAY,OAAE0sC,EAAM,kBAAElV,IAClBt3B,KAAKwsC,OAASA,EACdxsC,KAAKs3B,kBAAoBA,CAC7B,CACAoO,kBACI,OAAO1lC,KAAKwsC,OAAO9G,iBACvB,CACAI,gBACI,OAAO9lC,KAAKwsC,OAAO1G,eACvB,CACAkJ,YACI,IAAIttC,EAAIC,EACR,OAA+F,QAAvFA,EAAuC,QAAjCD,EAAK1B,KAAK0lC,yBAAsC,IAAPhkC,OAAgB,EAASA,EAAGoxB,cAA2B,IAAPnxB,EAAgBA,EAAK,CAAC,CACjI,CACAstC,aACI,IAAIvtC,EACJ,OAA2C,QAAnCA,EAAK1B,KAAKgvC,YAAYE,eAA4B,IAAPxtC,EAAgBA,EAAK,CAAC,CAC7E,CACAytC,UACI,IAAIztC,EACJ,OAAwC,QAAhCA,EAAK1B,KAAKgvC,YAAYI,YAAyB,IAAP1tC,EAAgBA,EAAK,CAAC,CAC1E,CACAsoC,SAASjqC,GACL,OAAOC,KAAKwsC,OAAOxC,SAASjqC,EAChC,CACAsvC,mBAAmBtvC,GACf,OAAOC,KAAKwsC,OAAO6C,mBAAmBtvC,EAC1C,CACAynC,KAAKznC,GACD,OAAOC,KAAKwsC,OAAOhF,KAAKznC,EAC5B,CACA2nC,UACI,OAAO1nC,KAAKwsC,OAAO9E,SACvB,CACAD,GAAG7B,EAAI7lC,GACH,OAAOC,KAAKwsC,OAAO/E,GAAG7B,EAAI7lC,EAC9B,CACAuvC,aAAaj2C,EAAMQ,GACf,MAAM2nC,EAAQxhC,KAAKuvC,yBACnB,OAAOvvC,KAAKs3B,kBAAkBjyB,IAAIhM,EAAMQ,EAAW2nC,EACvD,CACAgO,aAAan2C,GACT,MAAMmoC,EAAQxhC,KAAKuvC,yBACnB,OAAOvvC,KAAKs3B,kBAAkB91B,IAAInI,EAAMmoC,EAC5C,CACA2M,2BAA2BsB,GACvB,IAAI/tC,EACJ,MAAMguC,EAAc,GAAED,aAChBE,EAAoB,GAAEF,WACtBG,EAAwD,QAAvCluC,EAAK1B,KAAKgvC,YAAYU,UAAgC,IAAPhuC,EAAgBA,EAAKiuC,EAC3F,OAAO3vC,KAAKwvC,aAAaI,IAAkB5vC,KAAKwvC,aAAaG,EACjE,CACAJ,yBACI,MAAM,OAAEzX,EAAM,cAAEtF,GAAkBxyB,KAAKgvC,YAEvC,OADczc,GAA0BC,GAAiBA,EAAgBsF,CAE7E,GAuII71B,KAAM,CACFuqC,OAAQC,GACRnV,kBAAmB7a,EAAAA,MAG3B,CACInb,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAU4rC,KAIZ0C,IAA+BtP,EAAAA,EAAAA,MAC/BuP,IAA+BvP,EAAAA,EAAAA,MAC/BwP,GAAoB,EACtBzuC,EAAAA,EAAAA,IAAQ,CACJA,QAASuuC,GACTtuC,SAAU,IAAI2D,OAElB5D,EAAAA,EAAAA,IAAQ,CACJA,QAASwuC,GACTjtC,WAAY,KACR,IAAIilB,EAAQuO,QAAQ5K,UACpB,MAAO,CACHpmB,IAAI6J,IACA4Y,EAAQA,EAAMnY,KAAKT,GACZ4Y,GAEd,KAGTxmB,EAAAA,EAAAA,IAAQ,CACJA,QAAS0rC,GACTnqC,WAAY,EAAG2pC,SAAQoC,iBAAgBC,eAAcvX,oBAAmB0W,gBAAer/B,SAAQqhC,uBAAsBC,2BACjH,MAAMphC,EAAMF,EAAO,yBA0DnB,MAAO,CACHuhC,SAAWzf,GAEAwf,EAAqB5qC,KAAI,IA5DvBoJ,WAGb,GAAIuhC,EAAqB7tC,IAAIsuB,GACzB,OAEJuf,EAAqB3qC,IAAIorB,GACzB5hB,EAAIgU,KAAK,CAAE5T,MAAO,sBAAuBwhB,QAEzC,IAAIoC,EAAQ2Z,EAAO/gB,QAAQgF,GAG3B,IAAKoC,GAASgc,EAAc,CAGxB,MAAMtlB,EThYT,EAACkH,EAAKjH,KACnB,MAAMiiB,EAAS1X,GAAStD,EAAI54B,YAE5B,OADAw8B,GAA0BoX,EAAOhY,aS8Xe,CAAE0c,cAAe,ST7X1D3c,GAAciY,EAAO,ES6XM2E,CAAS3f,GAC3BoC,QAAcgc,EAAa,CACvBpe,IAAKlH,EACLpwB,KAAM,aAEN05B,IACAA,EAAQ+b,EAAe/b,GAE/B,CACA,IAAKA,EAED,YADAhkB,EAAIgU,KAAK,CAAE5T,MAAO,2BAA4BwhB,QAMlD,MAAQqC,QAAQ,cAAEN,EAAa,OAAEsF,EAAM,sBAAE/E,IAA6BF,EAChEsD,EAAW,GAIb6X,EAAc7rC,IAAI21B,EAAQtF,IAC1B2D,EAAS3+B,KAAKw2C,EAAcxsC,IAAIs2B,EAAQtF,IAKxCO,GACAoD,EAAS3+B,KAAKg6B,GAAqB8F,EAAkB91B,IAAIuxB,EAAuBR,GAA0BC,GAAiB,YAAcsF,WAEvIzB,QAAQzV,IAAIuV,GACbxmB,MAAK,KACNd,EAAIgU,KAAK,CAAE5T,MAAO,yBAA0BwhB,OAAM,IAEjDpI,OAAO3sB,IACRmT,EAAIG,KAAK,CACLC,MAAO,gBACPwhB,MACA/0B,SACF,GACJ,EAKwCw0C,CAASzf,KAEtD,EAELxuB,KAAM,CACFuqC,OAAQC,GACRmC,eAAgBd,GAChBe,aAAc,CACVlvC,MAAOktC,GACPzsC,UAAU,GAEdk3B,kBAAmB7a,EAAAA,GACnBuxB,cAAepyB,EAAAA,GACfjN,OAAQC,EAAAA,GACRohC,qBAAsBH,GACtBI,qBAAsBH,OAK5BO,GAAe,IAAIN,IAEnBrQ,GAAkBhkC,IACpB,GAAoBA,EPngBTrC,OAAS47B,GAAcL,WOmgBJQ,GAAqB15B,GAC/C,OAAO,CACX,EAEE40C,GAAoB,EAAGr+B,QAAOu6B,SAAQjV,iBAAgBgZ,sBACjD,WACH,MAAM1d,EAAQ2Z,EAAO9G,mBACb5S,QAAQ,OAAEgF,EAAM,cAAEtF,GAAkB,CAAC,GAAMK,EACnD,IAAKiF,IAAWtF,EACZ,MAAM,IAAI52B,MAAO,uDAAsDi3B,KAE3E,MAAM9kB,EAAUswB,KAAK,IACb9G,EAAegH,aAAe,MAC9BhH,EAAe/1B,IAAIs2B,IAAW,MAC9BP,EAAe/1B,IAAIgxB,IAAkB,KAE7C,OAAO+d,EAAiB9Q,WAAW1xB,EAAS2xB,IAAgBrX,OAAO9oB,IAC/D,GAAI61B,GAAqB71B,GACrB,OAAOitC,EAAOxC,SAAS,CACnBvZ,IAAKlxB,EAAI41B,QACTp5B,SAAS,EACTyrB,KAAMjoB,EAAIw1B,aAGlB,MAAMx1B,EAAI7D,OAAS6D,CAAG,GAE9B,EAGEwE,GAAY,IACXssC,MACA3B,IACHptC,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAG2pC,SAAQv6B,WACZxD,iBACH,MAAMy5B,EAAej2B,EAAMC,SAASi7B,IAAajF,aACjD,OAAOsE,EAAOr3B,UAAU,CACpBywB,GAAIsC,GAEZ,EAEJjmC,KAAM,CACFuqC,OAAQC,GACRx6B,MAAOE,EAAAA,OAGf7Q,EAAAA,EAAAA,IAAQ,CAGJA,QAAS8Q,EAAAA,GAAAA,MACTvR,OAAO,EACPgC,WAAY,EAAG2pC,SAAQv6B,WACZ,WAKH,OAJoBA,EAAMC,WAAWs6B,OACrBrE,WAAW9X,OAASl0B,OAAOmlB,SAAS+O,MAChDpe,EAAMa,SAASo6B,GAAkBV,EAAO1G,kBAErC0G,EAAOvjB,OAClB,EAEJhnB,KAAM,CACFuqC,OAAQC,GACRx6B,MAAOE,EAAAA,OAGf7Q,EAAAA,EAAAA,IAAQ,CAGJA,QAAS8Q,EAAAA,GAAAA,MACTvR,OAAO,EACPgC,WAAaZ,IACT,MAAMimC,EAAejmC,EAAKgQ,MAAMC,SAASi7B,IAAajF,aAEtD,MAAwB,WAApBjmC,EAAKuuC,cACHtI,GAAiBA,GAAgBA,EAAa8C,aAAe7uC,OAAOmlB,SAAS+R,UACxE/K,IAEJgoB,GAAkBruC,EAAK,EAElCA,KAAM,CACFgQ,MAAOE,EAAAA,GACPq6B,OAAQC,GACRlV,eAAgBzb,EAAAA,GAChBy0B,iBAAkBv0B,EAAAA,GAClBw0B,WAAYtZ,OAGpB51B,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,MACTvR,OAAO,EACPgC,WAAY,EAAGoP,QAAOu6B,SAAQgE,gBACnB/hC,iBACH,MAAMy5B,EAAej2B,EAAMC,SAASi7B,IAAajF,aAGjD,GAAmB,WAAfsI,KACEtI,GAAiBA,GAAgBA,EAAa8C,aAAe7uC,OAAOmlB,SAAS+R,UAG/E,OAAOmZ,EAAOxC,SAAS,CAAEvZ,IAAKt0B,OAAOmlB,SAAS+O,KAAMt0B,SAAS,GAErE,EAEJkG,KAAM,CACFgQ,MAAOE,EAAAA,GACPq6B,OAAQC,GACR+D,WAAYtZ,OAKlBuZ,GAAmBjsC,GACd,CAACstB,EAAQ/xB,EAAU,CAAC,KAChB,CACHyE,aACAT,UAAW,CACP,CACIzC,QAASorC,GACT7rC,OAAO,EACPU,SAAUuwB,GAEd/xB,EAAQ2wC,gBAAkB,CACtBpvC,QAASyrC,GACTxrC,SAAUxB,EAAQ2wC,iBAExBn5B,OAAOzS,WAKrB,IAAI6rC,IASAA,GAAO,SAEFC,QAAUH,GAAgBE,IAVnC,MAwBME,GAAW,CACb,CACIvvC,QAASosC,GACT7sC,OAAO,EACPgC,WAfe,EAAGiM,oBAAmBd,QAClCS,gBACGK,EAAkBI,IAAI,SAAU,MAAO,GAAIlB,EAAG,EAcpD/L,KAAM,CACF+L,GAAI3N,EAAAA,GACJyO,kBAAmBC,EAAAA,KAG3B,CACIzN,QAASqsC,GACT9sC,OAAO,EACPgC,WAnBoB,EAAGiM,oBAAmBd,QACvCS,gBACGK,EAAkBI,IAAI,SAAU,WAAY,GAAIlB,EAAG,EAkBzD/L,KAAM,CACF+L,GAAI3N,EAAAA,GACJyO,kBAAmBC,EAAAA,KAG3B,CACIzN,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,IAA0B,IAAzB,QAAEiuC,GAAkB,EAAN7uC,EAAI,QAC3B,MAAgB,UAAZ6uC,EACOR,GAAkBruC,GAEtBqmB,GAAI,EAEfrmB,KAAM,CACFgQ,MAAOE,EAAAA,GACPq6B,OAAQC,GACRlV,eAAgBzb,EAAAA,GAChBy0B,iBAAkBv0B,EAAAA,GAClB80B,QAAS,CACLnxC,MAAOotC,GACP3sC,UAAU,KAItB,CACIkB,QAAS8Q,EAAAA,GAAAA,mBACTvR,OAAO,EACPgC,WAAY,IAA0B,IAAzB,QAAEiuC,GAAkB,EAAN7uC,EAAI,QAC3B,MAAgB,UAAZ6uC,EACOR,GAAkBruC,GAEtBqmB,GAAI,EAEfrmB,KAAM,CACFgQ,MAAOE,EAAAA,GACPq6B,OAAQC,GACRlV,eAAgBzb,EAAAA,GAChBy0B,iBAAkBv0B,EAAAA,GAClB80B,QAAS,CACLnxC,MAAOotC,GACP3sC,UAAU,MAM1B,IAAIsB,GACJ,MAAMqvC,IAAkC9sC,EAAAA,EAAAA,IAAO,CAC3CF,UAAW,IACJA,MACA8sC,GACH,CACIvvC,QAASgsC,GACT/rC,SFwKZ,cAAqB0pC,GACjBnrC,YAAYC,GACR8D,MAAM9D,GACNC,KAAK6nC,KAAO,IAAI0D,GAAUxrC,EAAQ+xB,QAClC9xB,KAAKmmC,QAAQkD,QAAQrpC,KAAK6nC,KAC9B,CACAp5B,gBAAgBy3B,GACZ,OAAOlmC,KAAKgxC,oBAAoBntC,MAAMsR,UAAU+wB,GACpD,CACAz3B,cAEI,SADM5K,MAAMolB,QACRjpB,KAAKixC,kBAAmB,CACxB,MAAM,kBAAEA,GAAsBjxC,KAE9B,OADAA,KAAKixC,kBAAoB,KAClBjxC,KAAKkxC,yBAAyBD,EACzC,CACJ,CACAxiC,UAAUy3B,GAEN,GAAKlmC,KAAKulC,QAKV,OAAIvlC,KAAK2lC,kBACE3lC,KAAKmxC,gBAAgBjL,IAG5BlmC,KAAKixC,oBACLtiC,GAAOkU,KAAK,CACR5T,MAAO,wBACPgiC,kBAAmBjxC,KAAKixC,kBACxB/K,eAEJlmC,KAAKixC,kBAAoB,MAEtBjxC,KAAKkxC,yBAAyBhL,IAhBjClmC,KAAKmxC,gBAAgBjL,EAiB7B,CACAiL,gBAAgBjL,GAMZ,OALAlmC,KAAKixC,kBAAoB/K,EACzBv3B,GAAOkU,KAAK,CACR5T,MAAO,mBACPi3B,eAEAlmC,KAAKoxC,iBAITpxC,KAAKoxC,eAAiB,IAAI/a,SAAQ,CAAC5K,EAASuM,KACxCh4B,KAAKqxC,eAAiB5lB,EACtBzrB,KAAKsxC,cAAgBtZ,CAAM,KALpBh4B,KAAKoxC,cAQpB,CACAnL,iBAAiBC,GAEb,IAAIA,EAAWqL,UAOf,OAAO1tC,MAAMoiC,iBAAiBC,GAN1Bv3B,GAAOiU,MAAM,CACT3T,MAAO,sBACPi3B,cAKZ,CACAz3B,gBAAgBy3B,GAEZ,IAAIA,EAAWqL,UAOf,OAAO1tC,MAAMsjC,UAAUjB,GANnBv3B,GAAOiU,MAAM,CACT3T,MAAO,sBACPi3B,cAKZ,CACAz3B,eAAey6B,EAAUhD,GAKrB,GAAIA,EAAWqL,WAAavxC,KAAK6lC,iBAAmBK,EAChDv3B,GAAOiU,MAAM,CACT3T,MAAO,qBACPi3B,oBAIR,UACUriC,MAAMm9B,SAASkI,EAAUhD,EAInC,CAFA,MAAOxqC,GACH,OAAOsE,KAAKknC,SAAShB,EACzB,CACJ,CACAz3B,0BAA0B+iC,GACtB,IAAIC,EACJ,MAAMC,EAAQC,aAAY,KACtB,IAAIjwC,EACA1B,KAAKixC,oBAC+B,aAAhCjxC,KAAKixC,kBAAkB93C,MACvB6G,KAAKixC,kBAAkB93C,QAA4C,QAAjCuI,EAAK1B,KAAK2lC,yBAAsC,IAAPjkC,OAAgB,EAASA,EAAGvI,OACvGwV,GAAOkU,KAAK,CACR5T,MAAO,yBACPi3B,WAAYlmC,KAAKixC,oBAGjBjxC,KAAK2lC,oBACL3lC,KAAK2lC,kBAAkB4L,WAAY,EACnCvxC,KAAK2lC,kBAAoB,MAG7B8L,KAIAzxC,KAAKqxC,iBAEb,GAvHiB,UAyHfhb,QAAQub,KAAK,CACfJ,EACA,IAAInb,SAAS5K,IACTgmB,EAAehmB,CAAO,MAG9BomB,cAAcH,GACdD,GACJ,CACAhjC,+BAA+By3B,GAC3B,MAAMh8B,EAAUuE,UAIZ,SAHMzO,KAAKgxC,oBAAoBntC,MAAMqL,IAAI4iC,IAGrC9xC,KAAKixC,kBAAmB,CACxB,MAAM,kBAAEA,GAAsBjxC,KAM9B,OALA2O,GAAOkU,KAAK,CACR5T,MAAO,uBACPi3B,WAAY+K,IAEhBjxC,KAAKixC,kBAAoB,KAClB/mC,EAAQ+mC,EACnB,GAEJ,OAAO/mC,EAAQg8B,GACVv2B,MAAK,KACN,IAAIjO,EAC2B,QAA9BA,EAAK1B,KAAKqxC,sBAAmC,IAAP3vC,GAAyBA,EAAGxJ,KAAK8H,KAAK,IAC7ET,IACA,IAAImC,EAC0B,QAA7BA,EAAK1B,KAAKsxC,qBAAkC,IAAP5vC,GAAyBA,EAAGxJ,KAAK8H,KAAMT,EAAI,IAEhFw8B,SAAQ,KACT/7B,KAAKoxC,eAAiB,KACtBpxC,KAAKqxC,eAAiB,KACtBrxC,KAAKsxC,cAAgB,IAAI,GAEjC,ME3UoCrtC,GASpCvC,GAAK,SAEFkvC,QAAUH,GAAgB/uC,IAC7BA,KAEJ,IAAIqwC,GAAuB,QAE3BA,IAAuBjgC,EAAAA,EAAAA,IAAW,EAC9B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,EACPzC,EAAAA,EAAAA,IAAQ,CACJA,QAASs1B,GACT/1B,OAAO,EACPgC,WAAY0rC,GACZtsC,KAAM,CACFuqC,OAAQC,MAGhB,CACInrC,QAASyQ,GAAAA,GACTlR,OAAO,EACPU,SAAU4rC,QAIvB4E,IAEyB51C,OAAO61C,oBAIR71C,OAAO81C,mBAyFlC,MAAMC,GAAiB,MF2OZh5B,EAAAA,GAAAA,YAAWozB,IEzOX9c,GAAMod,K,iGCj5BXlyB,GAAWzQ,GAASxS,MAAMC,QAAQuS,GAAOA,EAAM,CAACA,GAChDkoC,GAAmB,CAACpmB,EAAWqmB,IAC1B13B,GAAQ03B,QAA2CA,EAAW,IAAIrsB,QAAO,CAACssB,EAASC,IAAYA,EAAQD,IAAUtmB,GAuBtHwmB,GAAiB,EAAGv3B,cAAeA,EACnCw3B,GAAa,QAAC,SAAEx3B,GAAoB,EAAF,OAAOA,EAAP,QAAsB,ECDxDy3B,IAAoB/hC,EAAAA,EAAAA,IAAY,gBAEhCgiC,IAAiB9hC,EAAAA,EAAAA,IAAc,YADhB,MAC2CM,GAAGuhC,IAAmB,CAACthC,EAAOzV,IAAUA,GAdxG,SAAwBA,GACpB,OAAO,OAAP,UACOA,EAAK,CACR2D,QAAS3D,EAAM2D,QACfI,MAAO/D,EAAM+D,OAErB,CAQiHkzC,CAAej3C,KAE1Hk3C,GAAqBjmC,IACvB,MAAM,SAAEqO,GAAarO,EACfuhC,EAAc1e,GAAMod,IACpBnc,GJ8lCCvX,EAAAA,GAAAA,YAAWqzB,II7lCZsG,GAAkBt5B,EAAAA,EAAAA,IAASm5B,IAC3Bh3C,GAAQ2d,EAAAA,GAAAA,UAAQ,IACXw5B,GAff,SAA0BA,GACtB,MAAMn3C,EAAQ,IAAIE,MAAMi3C,EAAgBxzC,SAExC,OADAvH,OAAO0H,OAAO9D,EAAOm3C,GACdn3C,CACX,CAWkCo3C,CAAiBD,IAC5C,CAACA,IACEjiB,EAAgBpB,GAAM,CAAE7vB,MAAOoxB,GAAsB3wB,UAAU,IAC/D0wB,EAAiBtB,GAAM,CAAE7vB,MAAOqxB,GAAyC5wB,UAAU,IACnFY,EAAWktC,EAAYC,2BAA2B,iBACxD,OAAQlzB,EAAAA,GAAAA,KAAIuV,GAAwB,CAAEC,IAAKA,EAAK/0B,MAAOA,EAAOk1B,cAAeA,EAAe5vB,SAAUA,EAAU8vB,eAAgBA,EAAgB9V,SAAUA,GAAW,EAuBnK+3B,GAAwB,EAAG/3B,eAC7B,MAAMkzB,EAAcgE,KACdc,EAAkB9E,EAAYC,2BAA2B,UACzD8E,EAAkB/E,EAAYC,2BAA2B,UACzD+E,EAAkBhF,EAAYC,2BAA2B,UAE/D,OADe90B,EAAAA,GAAAA,UAAQ,KAAO4B,EAAAA,GAAAA,KAAI+3B,EAAiB,CAAEG,OAAQF,EAAiBG,OAAQF,EAAiBl4B,SAAUA,KAAc,CAACg4B,EAAiBC,EAAiBC,EAAiBl4B,GACtK,EAEXq4B,GAA8B,EAAGr4B,eACnC,MACMs4B,EADcpB,KACsB/D,2BAA2B,gBAErE,OADqB90B,EAAAA,GAAAA,UAAQ,KAAM4B,EAAAA,GAAAA,KAAIq4B,EAAuB,CAAEt4B,SAAUA,KAAa,CAACs4B,EAAuBt4B,GAC5F,EAEjBu4B,GAAsB,KACxB,MAAMrF,EAAcgE,MACd,cAAE1f,GAAkB0b,EAAYc,YACtC,IAAIwE,EAAgBtF,EAAYsB,aAAahd,GAO7C,OANKghB,IACDA,EAAgB,KACZ,MAAM,IAAI53C,MAAO,mBAAkB42B,eAA2B,IAGzDnZ,EAAAA,GAAAA,UAAQ,KAAO4B,EAAAA,GAAAA,KAAI23B,GAAmB,CAAE53B,UAAUC,EAAAA,GAAAA,KAAIu4B,EAAe,CAAC,MAAQ,CAACA,GACjF,EAETC,GAAO,KACT,MAAMC,GAAsBr6B,EAAAA,GAAAA,UAAQ,KAAM4B,EAAAA,GAAAA,KAAIs4B,GAAqB,CAAC,IAAI,IAClEI,GAA8Bt6B,EAAAA,GAAAA,UAAQ,KAAM4B,EAAAA,GAAAA,KAAIo4B,GAA6B,CAAEr4B,SAAU04B,KAAwB,CAACA,IACxH,OAAOz4B,EAAAA,GAAAA,KAAI83B,GAAuB,CAAE/3B,SAAU24B,GAA8B,EAQhF,IAAIC,GACAC,GACJ,IAEID,GAAcjqC,EAAAA,MAAAA,EACdkqC,GAAkBlqC,EAAAA,MAAAA,eAEd,CAAR,SAAQ,CACR,MAAMmqC,GAAwB,EAAG94B,WAAUlE,gBAEvCtN,EAAAA,GAAAA,GAA0BsN,EAAU,IAE7BkE,GA2EX,MAAM+4B,GAA0B,EAAG/4B,cAAeA,EAClD,IAAIg5B,GAAe,QAEnBA,IAAeliC,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,CACP,CACIzC,QAASu1B,GACTh0B,WAAY,EAAGoxC,oBD/LDvpC,MCiMV,MD1KC,GAAG8sB,WAAAA,EAAa,CAAC,EAAG4a,SAAAA,EAAW,CAAC,GAAM,CAAC,KACxD,MAAQ8B,OAAQC,EAAa3B,GAAY4B,OAAQC,EAAa7B,GAAY8B,OAAQC,EAAahC,GAAgBrD,QAASsF,EAAcjC,GAAgBkC,KAAMC,EAAWnC,IAAwC/a,EAArBmd,EAAgB,EAAKnd,EAAU,IACnNod,EAAgBzC,GAAiBoC,EAAYnC,EAASkC,QACtDO,EAAiB1C,GAAiBqC,EAAapC,EAASlD,SACxD4F,EAAc3C,GAAiBuC,EAAUtC,EAASqC,MAClDM,EAAgB5C,GAAiBgC,EAAY/B,EAAS8B,QACtDc,EAAgB7C,GAAiBkC,EAAYjC,EAASgC,QACtDa,EAAiBn9C,OAAO+C,KAAK85C,GAAkBtxC,KAAKhK,IAE/C,CAAEA,OAAM0yB,UADGomB,GAAiBwC,EAAiBt7C,GAAO+4C,EAAS/4C,QAGlE67C,EAAS,EAAGl6B,WAAUm4B,SAAQC,aACxBvjB,EAAAA,GAAAA,MAAK+kB,EAAe,CAAE55B,SAAU,CAACi6B,EAAe5xC,KAAI,EAAG0oB,YAAW1yB,WAAY4hB,EAAAA,GAAAA,KAAI8Q,EAAW,CAAC,EAAG1yB,MAASw2B,EAAAA,GAAAA,MAAKglB,EAAgB,CAAE75B,SAAU,CAACm4B,GAASl4B,EAAAA,GAAAA,KAAI85B,EAAe,CAAE/5B,SAAWrO,IAAUsO,EAAAA,GAAAA,KAAIk4B,EAAQ,OAAF,UAAOxmC,MAAc,MAAMsO,EAAAA,GAAAA,KAAI65B,EAAa,CAAE95B,SAAUA,IAAao4B,GAASn4B,EAAAA,GAAAA,KAAI+5B,EAAe,CAAEh6B,SAAWrO,IAAUsO,EAAAA,GAAAA,KAAIm4B,EAAQ,OAAF,UAAOzmC,MAAc,WAG5W,OADAuoC,EAAOr8C,YAAc,SACdq8C,CAAM,EC2JUC,EDjMGzqC,ECgM2BupC,ED/L9C/pC,KAAQQ,QAAmCA,EAAO,IAAIqb,QAAO,CAAC9Y,EAAK3H,KACtE,MAAM,WAAEkyB,EAAU,SAAE4a,GAAanlC,EAYjC,OAXI3H,EAAKkyB,YACL1/B,OAAO0H,OAAOg4B,EAAYlyB,EAAKkyB,YAE/BlyB,EAAK8sC,UACLt6C,OAAO+C,KAAKyK,EAAK8sC,UAAUjxC,SAAStH,IAC3Bu4C,EAASv4C,KACVu4C,EAASv4C,GAAa,IAE1Bu4C,EAASv4C,GAAWrC,QAAQkjB,GAAQpV,EAAK8sC,SAASv4C,IAAY,IAG/DoT,CAAG,GACX,CACCuqB,WAAY,CAAC,EACb4a,SAAU,CAAC,KCgL6B,EAEhCnwC,KAAM,CACFgyC,cAAe,CAAEt0C,MAAOs3B,GAAgB72B,UAAU,KAG1D,CACIkB,QAAS,uBACTT,OAAO,EACPgC,WAAa20B,GAAU,iBAChBA,EAAU,CACb4d,oBAAqBrB,KAEzB9xC,KAAM,CACFozC,cAAexe,GACfye,cAAe,CAAE31C,MAAOo3B,GAA0B32B,UAAU,GAC5Dm1C,cAAe,CAAE51C,MAAOm3B,GAA0B12B,UAAU,GAC5Do1C,qBAAsB,CAAE71C,MAAOq3B,GAAkC52B,UAAU,SAK5F4zC,IAEH,MAAMjwC,GAAY,EACdzC,EAAAA,EAAAA,IAAQ,CACJA,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAUmxC,MAEdpxC,EAAAA,EAAAA,IAAQ,CACJA,QAAS41B,GACT31B,SAAU,SAIlB,IAAIk0C,GAOJ,IAAIC,GAAeD,GAAiB,MAChCx9B,gBAAe,KAAEwR,EAAI,cAAEksB,IACnB,MAAM5xC,EAAY,GAOlB,MANoB,iBAAT0lB,GAA8C,kBAAlBksB,GACnC5xC,EAAUvM,KAAK,CACX8J,QAASq1B,GACTp1B,SAAUo0C,QAAqDA,EAAyB,WAATlsB,IAGhF,CACHjlB,WAAYixC,GACZ1xC,YAER,GAEJ2xC,GAAeD,IAAiB3jC,EAAAA,EAAAA,IAAW,EACvC7N,EAAAA,EAAAA,IAAO,CACHC,QAAS,CAAC8vC,IACVjwC,UAAW,IACJA,IACHzC,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAG2pC,SAAQv6B,WACZ,WACHu6B,EAAO9I,aAAa,iBAAiBj1B,UAC7BwD,EAAMC,SAASwgC,KACfzgC,EAAMa,SAAS2/B,GAAkB,MACrC,GAER,EAEJxwC,KAAM,CACFuqC,OAAQC,GACRx6B,MAAOE,EAAAA,OAGf7Q,EAAAA,EAAAA,IAAQ,CACJA,QAASm1B,GACT5zB,WAAY,EAAG8L,aAAa,CACxBinC,iBAAkB,IAEP,GAEXv0C,SAAU,KACd,IACAY,KAAM,CACF0M,OAAQC,EAAAA,OAGhBtN,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,aACTvP,WAAaZ,GACF,WAEH,OADA9F,OAAO05C,gBAAkB5zC,EAAK6zC,gBArJtD,UAAmB,OAAEnnC,EAAM,gBAAEmnC,EAAe,aAAEC,EAAY,aAAEC,EAAY,GAAEhoC,EAAE,cAAE2nC,EAAa,iBAAEM,IACzF,MAAMpnC,EAAMF,EAAO,iBACnB,OAAO,IAAI0nB,SAAQ,CAAC5K,EAASuM,KACzB,IAAIke,EArDZ,UAAqB,GAAEloC,GAAMqE,GACzB,MAAMmH,EAA8CnH,EAAQH,WAC5D,OAAQ+I,EAAAA,GAAAA,KAAIF,EAAAA,GAAU,CAAE1I,QAASA,EAASmH,YAAaA,EAAawB,UAAUC,EAAAA,GAAAA,KAAIsU,GAAUxU,SAAU,CAAE/X,MAAOgL,EAAIgN,UAAUC,EAAAA,GAAAA,KAAIw4B,GAAM,CAAC,MAC5I,CAkD2B0C,CAAY,CAAEnoC,MAAM8nC,GAMvC,GALIE,GACAlsB,MAAM9vB,IACFk8C,EAAel8C,EAAOk8C,EAAa,GACpCF,GAEHD,EACA,OAAOA,EAAaG,GAEpBP,IACAO,GAAeE,EAAAA,GAAAA,eAAcp4C,GAAAA,WAAY,KAAMk4C,IAEnD,MAAMzwC,EAAY6L,SAASugB,cAAc,gBACnCwkB,EAA4BC,GAAcL,aAA2D,EAASA,EAAiB90C,SAAS+gC,IAC1I,IACIA,EAAGoU,EAKP,CAHA,MAAOC,GAEHj3B,QAAQ5jB,MAAM66C,EAClB,KAQEptC,EAAS,CAAEqtC,QAASN,EAAczwC,YAAWqR,SANlC,KACbjI,EAAI+T,MAAM,iBACVtR,SAASugB,cAAc,QAAQ4kB,UAAUt0B,OAAO,SAChDk0B,IACA5qB,GAAS,EAEgD5c,OAC7D,IA/DS,GAAG2nC,UAAS/wC,YAAWqR,WAAUjI,UAC9C,GAAwE,mBAAhB+kC,GAA4B,CAChF,MAAM8C,GAAiBN,EAAAA,GAAAA,eAActC,GAAuB,CAAEh9B,YAAY0/B,GAC1E,IAAIG,EAAY,IAAI/2C,IACpB,MAAMg3C,EAA6B3jC,KAAS,IAAI,KAC5C,GAAuB,IAAnB0jC,EAAUlwC,KACV,OAEJ,OAAO,MAAE/K,EAAK,UAAEi1B,MAAgBkmB,GAAep/C,MAAM4K,KAAKs0C,EAAUzpC,UACpEypC,EAAY,IAAI/2C,IAChBiP,EAAInT,MAAM,CACNuT,MAAO,8BACPvT,QACAi1B,YACAkmB,eACF,IAEN,OAAOhD,IAAgB,KACnBD,GAAYnuC,EAAWixC,EAAgB,CACnCI,mBAAoB,CAACp7C,EAAOi1B,KAExBgmB,EAAUp0C,KAAK7G,aAAqC,EAASA,EAAM2D,UAAYsxB,aAA6C,EAASA,EAAUomB,gBAAiB,CAAEr7C,QAAOi1B,cACzKimB,GAA4B,GAElC,GAEV,CACA,MAAM,QAAE70C,GAAY4H,EAAQ,KACrB5H,EAAQy0C,EAAS/wC,EAAWqR,EAAS,EAoCpCkgC,CAAS7tC,EAKb,CAHA,MAAOjO,GACHm7C,EAAyBn7C,GACzB88B,EAAO98B,EACX,IAER,CA8G+B+7C,CAAUh1C,EACrB,EAEJA,KAAM,CACF0M,OAAQC,EAAAA,GACRmnC,aAAc,CAAEp2C,MAAO62B,GAAep2B,UAAU,GAChD41C,aAAc,CAAEr2C,MAAOi3B,GAAex2B,UAAU,GAChD61C,iBAAkB,CAAEt2C,MAAO42B,GAAmBn2B,UAAU,GACxD01C,gBAAiB3iC,EAAAA,GACjBnF,GAAI3N,EAAAA,GACJs1C,cAAehf,IAEnB91B,OAAO,KAEXS,EAAAA,EAAAA,IAAQ,CACJA,QAASi1B,GACT1zB,WAAY,EAAGizC,qBAAsB,KACjCA,EAAgB9nC,GAAG3M,SAAS,CAAEC,QAAS,qBAAsBC,UAAU,GAAO,EAElFU,KAAM,CACF6zC,gBAAiB3iC,EAAAA,OAGzB7R,EAAAA,EAAAA,IAAQ,CACJA,QAASq1B,GACT9zB,WAAY,EAAGq0C,oBACY,WAAnBA,EAKRj1C,KAAM,CACFi1C,eAAgBxgB,OAGxBp1B,EAAAA,EAAAA,IAAQ,CACJA,QAASo1B,GACTn1B,SAAU,eAIvBm0C,IC7UH,MAAMyB,IAAuBh3C,EAAAA,EAAAA,IAAY,iBCNnCi3C,GAAYC,GAAchzC,KAAKizC,MAAMD,GAAa,IAClDjkB,GAAc5lB,GAAa+pC,GAAS/pC,EAAQ/J,KAAK8zC,GACjDC,GAAOpkB,GAAW,SAClBqkB,GAAQrkB,GAAW,UACnBskB,GAAQtkB,GAAW,gCACnBukB,GAASvkB,GAAW,4BAC1B,IAAIwkB,IACJ,SAAWA,GACPA,EAAmB,KAAI,OACvBA,EAAiB,GAAI,KACrBA,EAAkB,IAAI,MACtBA,EAAkB,IAAI,MACtBA,EAAmB,KAAI,OACvBA,EAAoB,MAAI,OAC3B,CAPD,CAOGA,KAAiBA,GAAe,CAAC,IACpC,MAcMC,GAAmB,CAAChyC,EAAa1M,KACnC,GAAI0M,EAAYgyC,iBACZ,OAAOhyC,EAAYgyC,iBAAiB1+C,EACxC,EAEE2+C,GAAkBjyC,IACpB,MAAMkyC,EAAQF,GAAiBhyC,EAAa,SAC5C,OAAIkyC,GAASA,EAAM,GACRA,EAAM,GAAGC,UAEb,CAAC,EAENC,GAAyB,CAACC,EAAIjgD,IACxBigD,GAAMA,EAAGjgD,IAAS,EAExBkgD,GAAkB,CAAC1wC,EAAMD,KACpB,CACH4wC,SAAUH,GAAuBxwC,EAAM,YAAc2vC,GAAS5vC,EAAK4wC,UACnEC,aAAcJ,GAAuBxwC,EAAM,gBAAkBD,EAAK6wC,aAClEC,gBAAiBL,GAAuBxwC,EAAM,mBAAqBD,EAAK8wC,kBC/ChF,MAAMC,GACFz4C,YAAY04C,GAAgB,CAC5BC,MAAQ,CACRvvB,QAAU,CACV/G,SAAW,CACXu2B,SACI,MAAO,CACHD,MAAQ,EAEhB,EAEJ,MAAME,GACF74C,YAAY04C,GAAgB,CAC5BC,MAAQ,CACRG,MAAQ,CACRr2C,MAAQ,CACRs2C,mBAAqB,CACrB3vB,QAAU,CACV/G,SAAW,CACX22B,WAAWJ,GACP,OAAQK,KACZ,CACAL,SACI,MAAO,CACHD,MAAQ,EACRG,MAAQ,EACRr2C,MAAQ,EACRs2C,mBAAqB,EACrBC,WAAU,IACEC,MAGpB,EAEJ,MAAMC,GACFl5C,YAAY04C,GAAgB,CAC5BS,UAAY,CACZH,WAAWJ,GACP,OAAQK,KACZ,CACA7vB,QAAU,CACV/G,SAAW,CACXu2B,SACI,MAAO,CACHO,UAAY,EACZH,WAAU,IACC,OAGnB,EAEJ,MAAMI,GACFp5C,YAAY04C,GAAgB,CAC5BS,UAAY,CACZH,aACI,OAAQJ,KACZ,CACAxvB,QAAU,CACVwvB,OAAOA,GACH,MAAO,CACHO,UAAY,EACZH,WAAU,IACEC,MAGpB,CACA52B,SAAW,EC7Df,MA6BMg3B,IAAeh5C,EAAAA,EAAAA,IAAY,gBCvB3Bi5C,IAAoB1oC,EAAAA,EAAAA,IAAY,2BAChC2oC,IAAezoC,EAAAA,EAAAA,IAAc,iBAAkB,CAAE0oC,kBAAmB,CAAC,IAAKpoC,GAAGkoC,IAAmB,CAACG,EAAYvrB,IACxGA,IAGLqL,GAAkB,CACpB,CACI/3B,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAU,CAAC83C,MAInB,IAAIG,GAAuB,QAE3BA,IAAuB1nC,EAAAA,EAAAA,IAAW,EAC9B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJs1B,GACH,CAII/3B,QAAS8Q,EAAAA,GAAAA,KACTxR,MAAO5B,EAAAA,GAAAA,UACP6B,OAAO,EACPgC,YAAW,OAAE8L,EAAM,YAAE8qC,EAAW,QAAEpnC,IAC9B,IAAKonC,EACD,MAAO,OAEX,MAAMC,EAAkBrnC,EAAQ0C,SAAS,kBAAkB7C,WAAWonC,kBAChEK,EAAyB,IAAIlyB,EAAe,CAC9CC,aAAc,EACdE,WAAY,CACRjF,OAAO,EACPC,OAAO,EACPC,MAAM,EACN7T,MAAM,EACNtT,OAAO,EACPonB,OAAO,GAEX6E,YAAYiyB,GACJF,EAAgBE,EAAU3qC,OACnBwqC,EACF7nB,QAAQ,CACT5kB,KAAO,WAAU4sC,EAAU3qC,QAC3B+W,OAAQ,OACR9R,QAAS0lC,EAAU52C,MACb,CACEA,MAAO42C,EAAU52C,OAEnB,CAAC,IAEN2M,MAAK,EAAGuE,aAAcA,IAExBmiB,QAAQ5K,YAGvB,MAAO,KACH9c,EAAOoW,kBAAkB40B,EAAuB,CAExD,EACA13C,KAAM,CACFw3C,YAAa,CACT95C,MAAOw5C,GACP/4C,UAAU,GAEdiS,QAASc,EAAAA,GACTxE,OAAQC,EAAAA,SAKzB4qC,IAe+C,oBAAhB3zC,aACF,mBAArBA,YAAYg0C,MACe,mBAA3Bh0C,YAAYi0C,YACY,mBAAxBj0C,YAAYk0C,SACZl0C,YAAYm0C,cA0DvB,IAAIC,GAAgB,QAEpBA,IAAgBnoC,EAAAA,EAAAA,IAAW,EACvB7N,EAAAA,EAAAA,IAAO,CACHC,QAAS,CAACs1C,IACVz1C,UAAW,CACP,CACIzC,QAAS61C,GACTt0C,WAAY,KASD,CACHq3C,QAAUC,GAAQ,IAAI5B,GAAQ,OAAD,UAAM4B,IACnCC,MAAQD,GAAQ,IAAIxB,GAAM,OAAD,UAAMwB,IAC/BE,UAAYF,GAAQ,IAAInB,GAAU,OAAD,UAAMmB,IACvCG,QAAUH,GAAQ,IAAIjB,GAAQ,OAAD,UAAMiB,MAG3Cv5C,MAAO5B,EAAAA,GAAAA,WAEX,CACIsC,QAAS8Q,EAAAA,GAAAA,KACTvP,WAAY,EAAG8L,SAAQu/B,iBAAkB,KACrC/xC,OAAO+W,iBAAiB,QAAQ,KAC5B5K,YAAW,KACP,IAAI5G,EAAIC,EACR,MAAM44C,EHxHlC,WACI,IAAI10C,EACJ,IAGI,GADAA,EAAc1J,OAAO0J,aAChBA,EAAY20C,SAAW30C,EAAY20C,OAAOC,aAM3C,MAJwC,IAApC50C,EAAY20C,OAAOC,cAEnBn7B,QAAQ5jB,MAAM,0DAEZ,IAAIE,MAAM,6BAKxB,CAFA,MAAOV,GACH,MAAO,CAAC,CACZ,CACA,MAAM,aAAEw/C,EAAY,cAAEC,EAAa,YAAEC,EAAW,YAAEC,EAAW,aAAEJ,EAAY,eAAEK,EAAc,gBAAEC,GAAqBl1C,EAAY20C,OACxHQ,EAAmB,CACrB,CACI/iD,IAAK,aACLgxB,MAAO8xB,EACP/e,IAAK0e,GAET,CACIziD,IAAK,UACLgxB,MAAOyxB,EACP1e,IAAK2e,GAET,CACI1iD,IAAK,eACLgxB,MAAO0xB,EACP3e,IAAK4e,GAET,CACI3iD,IAAK,cACLgxB,MAAO,EACP+S,IAAK8b,GAAejyC,IAExB,CACI5N,IAAK,iBACLgxB,MAAO8xB,EACP/e,IAAK8e,GAET,CACI7iD,IAAK,cACLgxB,MAAO8xB,EACP/e,IAAK6e,GAET,CACI5iD,IAAK,eACLgxB,MAAO8xB,EACP/e,IAAKye,IAGPF,EAAU,CAAC,EAOjB,OANAS,EAAiB75C,SAAS85C,IACtB,MAAMC,EAAO9D,GAAS6D,EAAGjf,IAAMif,EAAGhyB,OAElCsxB,EAAQU,EAAGhjD,KAAOijD,EAAO,GAAKA,EAAO,IAAOA,OAAOv/C,CAAS,IAEhE4+C,EAAQY,SApFgBt1C,KACxB,MAAM3D,EAAS,CAAC,EACVk5C,EAAUvD,GAAiBhyC,EAAa,YAC9C,GAAIu1C,GAAWA,EAAQ/jD,OAAS,EAAG,CAC/B,MAAMgkD,EAAc,CAAC,EACrBD,EAAQj6C,SAASm6C,IACb,MAAMjiD,EA1CDA,KACb,QAAQ,GACJ,KAAKo+C,GAAMp+C,GACP,OAAOu+C,GAAa2D,IACxB,KAAK/D,GAAKn+C,GACN,OAAOu+C,GAAa4D,GACxB,KAAK9D,GAAMr+C,GACP,OAAOu+C,GAAa6D,IACxB,KAAK9D,GAAOt+C,GACR,OAAOu+C,GAAa8D,KACxB,QACI,OAAO9D,GAAa+D,MAAM,EA+Bb7jC,CAAQwjC,EAAMjiD,KAAKsU,MAAM,IAAK,GAAG,IAC1CiqC,GAAav+C,KACRgiD,EAAYhiD,KACbgiD,EAAYhiD,GAAQ,GAExBgiD,EAAYhiD,KACZ6I,EAAO7I,GAAQ8+C,GAAgBj2C,EAAO7I,GAAOiiD,GAC7Cp5C,EAAO7I,GAAMuiD,MAAQP,EAAYhiD,GACrC,GAER,CACA,MAAMwiD,EAAUhE,GAAiBhyC,EAAa,cAI9C,OAHIg2C,GAAWA,EAAQxkD,OAAS,IAC5B6K,EAAO01C,GAAakE,MAAQ3D,GAAgB,CAAC,EAAG0D,EAAQ,KAErD35C,CAAM,EA+DM65C,CAAmBl2C,GAC/B00C,CACX,CGyD4CyB,GACJrtC,EAAO,CACftV,KAAM,eACNylB,SAAU,CACNyJ,OAAQ,CACJX,WAAY,CACR/E,MAAM,OAKlBA,KAAK,OAAD,UACD03B,EAAO,CACVtrC,MAAO,eACPgtC,YAAsG,KAA1D,QAA9Bv6C,EAAK03B,UAAU3nB,iBAA8B,IAAP/P,OAAgB,EAASA,EAAGqI,QAAQ,SAAkB,SAAW,UACrHmyC,QAAkD,QAAxCv6C,EAAKusC,EAAYxI,yBAAsC,IAAP/jC,OAAgB,EAASA,EAAGqL,OACxF,GACH,EAAE,GACP,EAENnM,OAAO,EACPoB,KAAM,CACF0M,OAAQC,EAAAA,GACRs/B,YAAatB,SAK9BqN,ICxNH,MAAM5gB,GAAkB,CACpB,CACI/3B,QAASmnB,GACT5lB,WAAY,EAAGs5C,aACH,IAAGA,EAAQ/tC,eAEvBnM,KAAM,CACFk6C,QAAShuC,EAAAA,KAGjB,CACI7M,QAASonB,GACT7lB,WAAY,EAAGs5C,aACH,IAAGA,EAAQ/tC,uBAEvBnM,KAAM,CACFk6C,QAAShuC,EAAAA,MAKrB,IAAIiuC,GAAoB,QAExBA,IAAoBtqC,EAAAA,EAAAA,IAAW,EAC3B7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IAAIs1B,OAEpB+iB,IAEH,IAAIC,GAAe,QAEnBA,IAAevqC,EAAAA,EAAAA,IAAW,EACtB7N,EAAAA,EAAAA,IAAO,CACHC,QAAS,CAAC+1C,GAAemC,IACzBr4C,UAAW,MAEhBs4C,ICrCH,MAAMhjB,GAAkB,EACpB/3B,EAAAA,EAAAA,IAAQ,CACJA,QAASyvB,GACTluB,WAAY,EAAG8L,aACX,MAAME,EAAMF,EAAO,oCACnB,OAAO,SAA0BjT,EAAOmnB,GACpChU,EAAInT,MAAM,CACNuT,MAAO,sBACPvT,QACAmnB,QAER,CAAC,EAEL5gB,KAAM,CACF0M,OAAQC,EAAAA,IAEZ/N,OAAO,KAIf,IAAIy7C,GAAyB,QAE7BA,IAAyBxqC,EAAAA,EAAAA,IAAW,EAChC7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IAAIs1B,OAEpBijB,I,gDCzBH,MAAMC,GACFz8C,cACIE,KAAKmR,MAAQ,IAAIvR,GACrB,CACA48C,SAASC,GACLz8C,KAAKmR,MAAMhQ,SAAQ,CAAC6B,EAAO/K,IAAQwkD,EAAKz5C,EAAO/K,IACnD,CACAykD,WAAWC,EAAUC,GACjB,IAAIl7C,EAgBJ,OAfAqiB,KAAQ,CAAC/gB,EAAO3J,KACZ,IAAK2J,GAAmB,OAAVA,EACV,OAEJ,MAAM65C,EAAY78C,KAAKmR,MAAM3P,IAAInI,KAC5BwjD,GAAaF,GAAYE,EAAUF,YACtB,OAAV35C,EACAhD,KAAKmR,MAAMtI,OAAOxP,GAGlB2G,KAAKmR,MAAM5O,IAAIlJ,EAAM,CAAE2J,QAAO25C,aAEtC,GACDC,GACsB,QAAxBl7C,EAAK1B,KAAKikB,gBAA6B,IAAPviB,GAAyBA,EAAGxJ,KAAK8H,MAC3DA,IACX,CACAwB,IAAIvJ,GACA,OAAO+H,KAAKmR,MAAM3P,IAAIvJ,EAC1B,CACAixB,QACIlpB,KAAKmR,MAAMlI,OACf,CACAsK,UAAUK,GACN5T,KAAKikB,SAAWrQ,CACpB,EAGJ,MAAMkpC,GAAoB95C,GAAUb,KAAI,MAAOa,GAASA,EAAQ,KAChE,MAAM+5C,GACFj9C,aAAY,KAAE4K,EAAI,eAAEsyC,EAAiBplC,KAAQ,WAAEqlC,EAAa,CAAC,EAAC,SAAEC,IAC5Dl9C,KAAKm9C,YAAczyC,EACnB1K,KAAKg9C,eAAiBA,EACtBh9C,KAAKi9C,WAAaA,EAClBj9C,KAAKk9C,SAAWA,CACpB,CACAE,kBAAkBvhD,GACd,IAAI6F,EACJ,MAAMw7C,EAAoC,QAAxBx7C,EAAK1B,KAAKk9C,gBAA6B,IAAPx7C,EAAgBA,EAAK,IAAI66C,GAC3Ev8C,KAAKm9C,YAAY95C,KAAK2G,GAAOA,EAAGkzC,KAAarhD,KAC7C,IAAIqG,EAAS,GASb,OARAg7C,EAASV,UAAS,CAAC5zC,EAAK3Q,KACpB,MAAM+K,EAAQhD,KAAKg9C,eAAep0C,GAE5B6D,GADYzM,KAAKi9C,WAAWhlD,IACR6kD,IAAkB95C,EAAMA,OAC9CyJ,IACAvK,EAASA,EAAOpH,OAAOpD,IAAQ+U,GAAOA,EAAI8K,OAAOK,MAAYnL,GACjE,IAEGvK,CACX,EAGJ,MAAMm7C,GAAiB,oBAEJC,MAAU,CAACrwC,EAAKjK,EAAO/K,IAAS,GAAEgV,KAAOhV,MAAQ+K,MAAU,IAiB9E,MAAM6J,GAAS,EAAG0wC,MAAKC,aAAYC,gBAC/B,MAAMC,EAAapsC,SAAS8kC,cAAcmH,GAS1C,OARIE,IACAC,EAAWC,UAAYF,GAE3BD,GACIz5B,KAAQ,CAAC/gB,EAAO/K,KACZylD,EAAWE,aAAa3lD,EAAK+K,GAAS,GAAG,GAC1Cw6C,GACPE,EAAWE,aAAaP,GAAgB,QACjCK,CAAU,EAErB,MAAMG,GACF/9C,YAAYsvC,GACRpvC,KAAKovC,KAAOA,CAChB,CACA5wB,SACI,MAAM9W,EAAO4J,SAAS5J,MAAQ4J,SAASugB,cAAc,QAC/CisB,EAAU99C,KAAKovC,KAAKgO,iBAAiB/5C,IAAIwJ,IACzCkxC,EAAar2C,EAAKs2C,iBAAkB,IAAGX,OACvCY,EAAW3sC,SAAS4sC,yBAC1B,GAAGr0C,MAAM3R,KAAK6lD,GAAY58C,SAASo8C,GAAQ71C,EAAKy2C,YAAYZ,KAC5DO,EAAQ38C,SAASo8C,GAAQU,EAASG,YAAYb,KAC9C71C,EAAK22C,aAAaJ,EAAUv2C,EAAK42C,WACrC,E,4FC9FJ,MACMC,GAAaC,KAAOn0C,IAAUgD,KAAQuK,MAEtColC,GAAkB13C,GAChBA,EAAKq3C,SAJkB,GAKhB,CAAEA,SAAUr3C,EAAKq3C,SAAU35C,MAAOu7C,GAAWj5C,EAAKtC,QAEtDsC,EAcLm5C,IAAqBt+C,EAAAA,EAAAA,IAAY,mBACjCu+C,IAAkBv+C,EAAAA,EAAAA,IAAY,YAC9Bw+C,IAAqBx+C,EAAAA,EAAAA,IAAY,cAAe,CAAEU,OAAO,IAKzD+9C,GAAoB,CAAC3mD,EAAK2J,EAAS,CAAC,KACtC,MAAMM,EAAS,CAAC,EAIhB,OAHApK,OAAO+C,KAAK+G,GAAQT,SAASmE,IALbiI,MAMZrL,EAAOjK,GANKsV,EAMYjI,EALpB,GAAEiI,EAAIsxC,OAAO,GAAGC,gBAAgBvxC,EAAI1D,MAAM,OAKbjI,EAAO0D,EAAK,IAE1CpD,CAAM,EAEXm3B,GAAkB,CACpB,CACI/3B,QAASo9C,GACT57C,SAAUy5C,IAGd,CACIj7C,QAASm9C,GACTl9C,SA7BY,CAChB0oC,MAAO,YA8BP,CACI3oC,QAASq9C,GACT99C,OAAO,EACPgC,WAAY,EAAGk8C,kBAAkBC,OA/BhB7f,EA+BgC4f,EA/BtBE,IAC/BA,EAAOvC,WARmB,EAQevd,EAAK,EADzBA,KA+B4C,EAC7Dl9B,KAAM,CACF88C,YAAaN,KAGrB,CAEIn9C,QAASq9C,GACT97C,WAAY,EAAGqrC,iBACH+Q,IACJ,MAAMC,EAAWhR,EAAYiB,UAAUgQ,KAAO,CAAC,GAEzC,cAAE3sB,GAAkB0b,EAAYc,aAAe,CAAC,EAEhDoQ,GADgBlR,EAAYsB,aAAahd,IAAkB,CAAC,GAC3B2sB,KAAO,CAAC,EACzCA,EAAM5yC,KAAU,CAAC,EAAG2yC,EAAUE,GAC9BC,EAAcF,EAAIE,aAAe,CAAC,EAClCC,EAAW,OAAH,UACPH,EAAIG,SACJV,GAAkB,UAAWS,EAAYE,aACzCX,GAAkB,KAAMS,EAAYG,YAE3CP,EAAOvC,WA3DK,GA2D2B4C,EAAS,EAGxDz+C,OAAO,EACPoB,KAAM,CACFisC,YAAatB,KAGrB,CAGItrC,QAASq9C,GACT99C,OAAO,EACPgC,WAAY,EAAGwP,UAASotC,eACpB,MAAM/0C,EAAOR,KAAQu1C,GAAY,IACjC,OAAQR,IACJv0C,EAAKvJ,SAAS6I,GAAOA,EAAGqI,EAAS4sC,IAAQ,CAC5C,EAELh9C,KAAM,CACFoQ,QAASc,EAAAA,GACTssC,SAAU,CAAE9/C,MAAO,WAAYS,UAAU,MAK/Cs/C,GAAgBh2C,KAAO,GAAG,CAAC6zC,EAAKE,IAAcA,GAAa,CAAEF,MAAKE,eAClEkC,GAAWj2C,KAAO,GAAG,CAACrQ,EAAM61C,IAAYA,GAAW,CAAEqO,IAAK,OAAQC,WAAY,CAAEnkD,OAAM61C,cACtF0Q,GAAel2C,KAAO,GAAG,CAAC+lC,EAAUP,IAAYA,GAAW,CAAEqO,IAAK,OAAQC,WAAY,CAAE/N,WAAUP,cAClG2Q,GAAWn2C,KAAO,GAAG,CAACo2C,EAAKzvB,IAASA,GAAQ,CAAEktB,IAAK,OAAQC,WAAY,CAAEsC,MAAKzvB,WAE9E0vB,GAAgB,CAACJ,GAAS,SAAU,mBAAoBA,GAAS,SAAU,cAC3EK,GAAiB,CAACL,GAAS,SAAU,mBAAoBA,GAAS,SAAU,cAC5EM,GAAa,CACfN,GAAS,SAAU,QACnBA,GAAS,SAAU,qBACnBA,GAAS,SAAU,cAEjBO,GAAoB,CACtBt/B,IAAK,CACD++B,GAAS,SAAU,OACnBA,GAAS,SAAU,iBACnBA,GAAS,SAAU,cAEvBQ,QAASJ,GACT,kBAAmBA,GACnBK,SAAUJ,GACV,kBAAmBA,GACnBK,KAAMJ,GACN,oBAAqBA,IAEnBhD,GAAa,CACfhT,MAAOyV,GAAc,SACrBY,YAAaX,GAAS,eACtBY,SAAUZ,GAAS,YACnBa,UAAWX,GAAS,aACpBY,SAAUd,GAAS,YACnBe,QAASd,GAAa,YACtBe,cAAef,GAAa,kBAC5BgB,WAAYhB,GAAa,gBACzBiB,MAAOjB,GAAa,UACpBkB,OAAQlB,GAAa,WACrBmB,QAASnB,GAAa,YACtBoB,cAAepB,GAAa,uBAC5BqB,YAAarB,GAAa,iBAC1BsB,WAAYtB,GAAa,gBACzBuB,aAAcvB,GAAa,kBAC3BwB,cAAexB,GAAa,mBAC5ByB,SAAUzB,GAAa,aACvB0B,aAAc3B,GAAS,iBACvB4B,mBAAoB5B,GAAS,uBAC7BJ,YAAaI,GAAS,gBACtB6B,YAAa7B,GAAS,gBACtB8B,eAAgB9B,GAAS,mBACzB+B,aAAc/B,GAAS,iBACvBgC,gBAAiBhC,GAAS,qBAC1BiC,OAAS3kD,GAAMijD,GAAkBjjD,IAGrC,IAAI4kD,GACJ,IAAIC,GAAYD,GAAc,MAC1B5pC,eAAelY,GAGX,GAAIrI,IAAQqI,GACR,MAAO,CACHyE,WAAYq9C,GACZ99C,UAAW,CACP,CACIzC,QAAS,WACTC,SAAUxB,EACVc,OAAO,KAKvB,MAAM,aAAEkhD,EAAY,YAAEC,GAAgBjiD,EAChCgE,EAAY,GAclB,OAbIi+C,GACAj+C,EAAUvM,KAAK,CACX8J,QAASm9C,GACTl9C,SAAUygD,IAGdD,GACAh+C,EAAUvM,KAAK,CACX8J,QAASq9C,GACTp9C,SAAUwgD,EACVlhD,OAAO,IAGR,CACHkD,YACAS,WAAYq9C,GAEpB,GAEJC,GAAYD,IAAc/vC,EAAAA,EAAAA,IAAW,EACjC7N,EAAAA,EAAAA,IAAO,CACHF,UAAW,IACJs1B,IACH/3B,EAAAA,EAAAA,IAAQ,CACJA,QAAS8Q,EAAAA,GAAAA,cACTvR,OAAO,EACPgC,WAAY,EAAGq6C,WAAU6E,mBACrB,MAAM3S,EAAO,IAAI2N,GAAK,CAClBryC,KAAMR,KAAQ63C,GAAgB,IAC9B/E,kBACAC,cACAC,aAEJ,IAAI+E,GAAS,EACb,MAAMzjC,EAAS,KACXyjC,GAAS,EACT,IAAIpE,GAAOzO,GAAM5wB,SACjByjC,GAAS,CAAK,EAEZC,EAAYjvC,KAAS,IAAKuL,GAWhC,OARA0+B,EAAS3pC,WAGT,KACS0uC,GACDC,GACJ,IAEG,WACHhF,EAASh0B,QACT1K,GACJ,CAAC,EAELvc,KAAM,CACFi7C,SAAUwB,GACVqD,aAAc,CAAEpiD,MAAOg/C,GAAoBv+C,UAAU,EAAMS,OAAO,UAKnFihD,I,IC/OCK,GAmDAC,G,uBAlDJ,SAAWD,GACPA,EAAqB,OAAI,SACzBA,EAAsB,QAAI,SAC7B,CAHD,CAGGA,KAAiBA,GAAe,CAAC,IACrBA,GAAalqC,OACZkqC,GAAaE,QA8C7B,SAAWD,GACPA,EAAwB,SAAI,WAC5BA,EAAoB,KAAI,OACxBA,EAA4B,aAAI,eAChCA,EAAsB,OAAI,SAC1BA,EAAoB,KAAI,OACxBA,EAA8B,eAAI,iBAClCA,EAA2B,YAAI,cAC/BA,EAA2B,YAAI,cAC/BA,EAAqB,MAAI,OAC5B,CAVD,CAUGA,KAAkBA,GAAgB,CAAC,IACpBA,GAAcE,SACnBF,GAAchT,KACLgT,GAAcG,aACrBH,GAAcI,OACfJ,GAAcK,KACJL,GAAcM,eACjBN,GAAcO,YACdP,GAAcQ,YACrBR,GAAc57B,MAR5B,MAUMq8B,GAAY,IAAI39C,IAAI,CAAC,SACrB49C,GAAaxF,MAAU,CAACrwC,EAAKjK,EAAO/K,IAClCA,GAAO+K,EACC,GAAEiK,KAAOhV,MAAQ+K,KAEf,OAAVA,EACOiK,EAEH,GAAEA,KAAOhV,KAClB,IAWGglD,GAAa,CACf,CAACmF,GAAcK,MAAOr2C,KAAK,WAC3B,CAACg2C,GAAcE,UAAW,EAAGpuC,UAAS6uC,YAAY,CAC9CxF,IAAK,OACLC,WAAY,OAAF,UACHuF,EAAK,CACR1yB,KAAMnc,MAGd,CAACkuC,GAAchT,MAAOhjC,KAAK,WAC3B,CAACg2C,GAAcG,cAAe,EAAGruC,UAAS6uC,YAU/B,CACHxF,IAAK,SACLE,UAAWvpC,EACXspC,WAAYuF,IAGpB,CAACX,GAAcI,QAAS,EAAGtuC,UAAS6uC,YAAY,CAC5CxF,IAAK,SACLC,WAAY,OAAF,QACNwF,MAAO,QACPC,QAAS,QACTC,YAAa,aACVH,EAAK,CACRv2C,IAAK0H,MAGb,CAACkuC,GAAcM,gBAAiB,EAAGxuC,UAAS6uC,YAAY,CACpDxF,IAAK,OACLC,WAAY,OAAF,UACHuF,EAAK,CACRjD,IAAK,aACLzvB,KAAMnc,MAGd,CAACkuC,GAAcO,aAAc,EAAGzuC,UAAS6uC,YAAY,CACjDxF,IAAK,OACLC,WAAY,OAAF,QACNyF,QAAS,SACNF,EAAK,CACRjD,IAAK,UACLzvB,KAAMnc,MAGd,CAACkuC,GAAcQ,aAAc,EAAG1uC,cAAc,CAC1CqpC,IAAK,QACLC,WAAY,CACRrkD,KAAM,YAEVskD,UAAWvpC,IAEf,CAACkuC,GAAc57B,OAAQ,EAAGtS,UAAS6uC,YAAY,CAC3CxF,IAAK,OACLC,WAAY,OAAF,UACHuF,EAAK,CACRjD,IAAK,aACLzvB,KAAMnc,OAIYwb,MAAQyzB,GAAc,IAAItnD,KACpD,MAAMqG,EAASihD,KAAatnD,GAC5B,MAAyB,iBAAXqG,EAAsBA,EAjFzB,GAAGq7C,MAAKC,aAAYC,gBAC/B,MAAM2F,EAAQ,GAAEN,GAAWtF,KAC3B,OAAIqF,GAAU1gD,IAAIo7C,GACN,IAAGA,IAAM6F,KAEjB3F,EACQ,IAAGF,IAAM6F,KAAQ3F,MAAcF,KAEnC,IAAGA,IAAM6F,OAAU7F,IAAM,EAyEYniD,CAAO8G,EAAO,GAC5D+6C,I,gBC/JH1tC,EAAAA,EAAAA,IAAU,CACRlW,KAAM,SACN2L,QAAS,CACP67B,GACAkQ,GACA2E,GAAa9E,QAAQ,CAAEnnB,KAAM,WAC7Bq4B,GACAzF,GACAC,GACA+G,GAAAA,GAEFt/C,UAAW,CACT,CACEzC,QAASg1B,GACTz1B,OAAO,EACPU,SAAU,CACRpI,KAAMmqD,GAAAA,KACNC,KlB5BU,YkB6BVrvC,QACE,2E,yIC9BH,MAAMsvC,GAAO9yC,EAAAA,EAAAA,IAAkB,QACzB+yC,GAAO/yC,EAAAA,EAAAA,IAAkB,QACzBgzC,GAAgBhzC,EAAAA,EAAAA,IAAoB,mBAEpCizC,GAAYjzC,EAAAA,EAAAA,IAA+B,cAE3CkzC,GAAUlzC,EAAAA,EAAAA,IAAsC,YAEhDmzC,GAA6BnzC,EAAAA,EAAAA,IACxC,iCAGWozC,GAA6BpzC,EAAAA,EAAAA,IACxC,iCAGWqzC,GAAuBrzC,EAAAA,EAAAA,IAClC,2BAGWszC,GAAatzC,EAAAA,EAAAA,IAAsB,eAEnCuzC,GAAavzC,EAAAA,EAAAA,IAAkB,eAE/BwzC,GAAkBxzC,EAAAA,EAAAA,IAAqB,sBAEvCyzC,GAAezzC,EAAAA,EAAAA,IAAoB,kBACnC0zC,GAAe1zC,EAAAA,EAAAA,IAAoB,kBACnC2zC,GAAiB3zC,EAAAA,EAAAA,IAAoB,oBCSrC4zC,GAAc1zC,EAAAA,EAAAA,IACzB,cAzBmB,CACnB2zC,YAAa,CACXC,OAAQ,KACRC,QAAS,CACPte,QAAS,GACTue,mBAAoB,EACpBC,cAAc,IAGlBC,KAAM,OAmBL1zC,GAAGyyC,GAAW,CAACxyC,EAAOqzC,IACd,OAAP,UAAYrzC,EAAO,CAAAozC,YAAa,OAAF,UAAOpzC,EAAMozC,YAAa,CAAAC,eAGzDtzC,GAAG0yC,GAAS,CAACzyC,EAAOyzC,IACZ,OAAP,UAAYzzC,EAAO,CAAAyzC,WAGpB1zC,GAAGwyC,GAAe,CAACvyC,EAAO0zC,IAClB,OAAP,UACK1zC,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5Bte,QAAS,IAAIh1B,EAAMozC,YAAYE,QAAQte,QAAS0e,WAKvD3zC,GAAG2yC,GAA6B1yC,GACxB,OAAP,UACKA,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5BC,kBAAmBvzC,EAAMozC,YAAYE,QAAQC,kBAAoB,UAKxExzC,GAAG4yC,GAA6B3yC,GACxB,OAAP,UACKA,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5BC,kBAAmBvzC,EAAMozC,YAAYE,QAAQC,kBAAoB,UAKxExzC,GAAG6yC,GAAsB,CAAC5yC,EAAOjJ,IACzB,OAAP,UACKiJ,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5BC,kBAAmBx8C,UAK1BgJ,GAAG8yC,GAAY,CAAC7yC,EAAOg1B,IACf,OAAP,UACKh1B,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5Bte,kBAKPj1B,GAAG+yC,GAAa9yC,IACf,MAAM,QAAEszC,GAAYtzC,EAAMozC,YAEpB1a,EAAe4a,EAAQC,kBACvBI,EAAaL,EAAQte,QAAQt8B,MAAM,EAAGggC,EAAe,GAE3D,OAAO,OAAP,UACK14B,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5Bte,QAAS2e,OAEZ,IAGJ5zC,GAAGgzC,GAAiB,CAAC/yC,EAAOwzC,IACpB,OAAP,UACKxzC,EAAK,CACRozC,YAAa,OAAF,UACNpzC,EAAMozC,YAAW,CACpBE,QAAS,OAAF,UACFtzC,EAAMozC,YAAYE,QAAO,CAC5BE,uBAKPzzC,GAAGizC,GAAc,CAAChzC,EAAOL,KACpBK,EAAMyzC,OAERzzC,EAAMyzC,KAAKG,UAAYj0C,GAElBK,KAERD,GAAGkzC,GAAc,CAACjzC,EAAOif,KACpBjf,EAAMyzC,OAERzzC,EAAMyzC,KAAKI,UAAY50B,GAElBjf,KAERD,GAAGmzC,GAAgB,CAAClzC,EAAOif,KACtBjf,EAAMyzC,OAERzzC,EAAMyzC,KAAKK,YAAc70B,GAEpBjf,K,wBC9IJ,MAAM+zC,GAAkB90C,EAAAA,EAAAA,IAAc,CAC3C/W,KAAM,YACNoV,SAAS+1C,GACPxkD,KAAK8S,SAAS6wC,EAAUa,GAC1B,IAGWW,GAAgB/0C,EAAAA,EAAAA,IAAc,CACzC/W,KAAM,UACNoV,SAASm2C,GACP5kD,KAAK8S,SAAS8wC,EAAQgB,GACxB,IAGWQ,GAAqBh1C,EAAAA,EAAAA,IAAc,CAC9C/W,KAAM,eACNoV,SAASqC,GACP9Q,KAAK8S,SAASqxC,EAAarzC,GAC7B,IAGWu0C,GAAqBj1C,EAAAA,EAAAA,IAAc,CAC9C/W,KAAM,eACNoV,SAAS2hB,GACPpwB,KAAK8S,SAASsxC,EAAah0B,GAC7B,IAGWk1B,GAAuBl1C,EAAAA,EAAAA,IAAc,CAChD/W,KAAM,iBACNoV,SAAS2hB,GACPpwB,KAAK8S,SAASuxC,EAAej0B,GAC/B,IAiBWm1B,IAdan1C,EAAAA,EAAAA,IAAc,CACtC/W,KAAM,OACNoV,WACEzO,KAAK8S,SAAS0wC,IAChB,KAGwBpzC,EAAAA,EAAAA,IAAc,CACtC/W,KAAM,OACNoV,WACEzO,KAAK8S,SAAS2wC,IAChB,KAGiCrzC,EAAAA,EAAAA,IAAc,CAC/C/W,KAAM,gBACNoV,SAASo2C,GACP,MAAM38C,EAAQ5B,OAAOsgB,aAAaE,QAAQ,sBAC1CF,aAAaQ,QAAQ,oBAAsB,GAAElf,EAAQ,KAErD,MAAMi+B,EAAUvzB,KAAKiU,MAAMD,aAAaE,QAAQ,YAEhDF,aAAaQ,QAAQ,UAAWxU,KAAKC,UAAU,IAAIszB,EAAS0e,WAEtD7kD,KAAK8S,SAAS4wC,EAAcmB,UAC5B7kD,KAAK8S,SAAS+wC,WACd7jD,KAAK8S,SAASoxC,GAAgB,GACtC,KAiBWsB,IAdmCp1C,EAAAA,EAAAA,IAAc,CAC5D/W,KAAM,6BACNoV,WACEzO,KAAK8S,SAAS+wC,IAChB,KAG8CzzC,EAAAA,EAAAA,IAAc,CAC5D/W,KAAM,6BACNoV,WACEzO,KAAK8S,SAASgxC,IAChB,KAGwC1zC,EAAAA,EAAAA,IAAc,CACtD/W,KAAM,uBACNoV,SAASvG,GACPlI,KAAK8S,SAASixC,EAAqB77C,GACrC,KAGWu9C,GAAmBr1C,EAAAA,EAAAA,IAAc,CAC5C/W,KAAM,aACNoV,SAAS03B,GACPnmC,KAAK8S,SAASkxC,EAAW7d,GAC3B,IAGWuf,GAAmBt1C,EAAAA,EAAAA,IAAc,CAC5C/W,KAAM,aACNoV,WACEzO,KAAK8S,SAASmxC,IAChB,IAGW0B,GAAwBv1C,EAAAA,EAAAA,IAAc,CACjD/W,KAAM,kBACNoV,SAASk2C,GACP3kD,KAAK8S,SAASoxC,EAAgBS,GAChC,I,gCC5GF,MAmGA,EAxFe,EAAG7zC,QAAOD,aACvB,MAAM+0C,GAAYv8C,EAAAA,EAAAA,UACZs6C,GAAYxqC,EAAAA,EAAAA,IAAW+rC,GAEvBxB,GAAgBvqC,EAAAA,EAAAA,IAAWosC,GAC3BtB,GAAa9qC,EAAAA,EAAAA,IAAWusC,GAExB1B,GAAa7qC,EAAAA,EAAAA,IAAWssC,GACxBI,GAAuB1sC,EAAAA,EAAAA,IAAWqsC,GAElCb,GAAe/yC,EAAAA,EAAAA,IACnB0yC,GACA,EAAGwB,iBAAkBA,EAAYvB,YAAYE,QAAQE,eAEjDT,GAAkB/qC,EAAAA,EAAAA,IAAWwsC,GA+DnC,OA7DAI,EAAAA,EAAAA,YAAU,KAGR,IAAIlB,EAFJlB,EAAUiC,EAAUr8C,SAIpB,MAAMy8C,EAAiBp/B,aAAaE,QAAQ,WACtCm/B,EAA2Br/B,aAAaE,QAAQ,qBAChDo/B,EAAsBt/B,aAAaE,QAAQ,gBAEjD,GAAIk/B,GAAsD,iBAA7BC,EAAuC,CAClE,MAAME,EAAuBvzC,KAAKiU,MAAMm/B,GAClC99C,EAAQ5B,OAAO2/C,GAErBjC,EAAWmC,GACXN,EAAqB39C,GAErB28C,EAAUsB,EAAqBj+C,EACjC,MA3CF0e,aAAaQ,QAAQ,UAAY,MACjCR,aAAaQ,QAAQ,oBAAqB,MAC1CR,aAAaQ,QAAQ,eAAgB,KA6C/B8+B,GACFhC,EAAgBp/C,QAAQohD,IAG1B,MAAME,EAAMR,EAAUr8C,QAAQuL,WAAW,MAEzC,GAAI+vC,GAAWuB,EAAK,CAClB,MAAM3K,EAAM,IAAI4K,MAEhB5K,EAAIjvC,IAAMq4C,EACVpJ,EAAI6K,OAAS,KACXF,EAAIG,UAAU,EAAG,EAAGX,EAAUr8C,QAAQuH,MAAO80C,EAAUr8C,QAAQsH,QAC/Du1C,EAAII,UACF/K,EACA,EACA,EACAmK,EAAUr8C,QAAQuH,MAClB80C,EAAUr8C,QAAQsH,OACnB,CAEL,IACC,CAAC8yC,EAAWkC,EAAsB7B,EAAYE,KAoB/C,mBACEuC,UAAWC,IAAAA,OACX51C,MAAOA,EACPD,OAAQA,EACRzH,IAAKw8C,EACLe,UAAW,IAvBQl4C,WACjBk2C,UACIV,UACAC,GAAgB,GACtBt9B,aAAaQ,QAAQ,eAAgB,MAGvC,MAAMy9B,EAAUe,EAAUr8C,QAAQq9C,kBAE5BlD,EAAcmB,GACpB,MAAMmB,EAAiBp/B,aAAaE,QAAQ,WAEU,IAAlDrvB,MAAM4K,KAAKuQ,KAAKiU,MAAMm/B,IAAiB3uD,QACzCuvB,aAAaQ,QAAQ,UAAWxU,KAAKC,UAAU,CAACgyC,IAClD,EASmBgC,IACjB,E,0CC7GN,MAEA,EAFa,IAA0B,uCCEvC,GDGO,ICLM,IAA0B,wCAKhC,I,uBCKP,MAwBA,EAxBc,KACZ,MAAOzC,EAAcC,IAAkBlrC,EAAAA,EAAAA,IAAW,CAChDksC,EACAC,IAOF,OACE,iCACE,gBAAKmB,UAAWK,IAAAA,KAAct6C,IAAKu6C,EAAMC,IAAI,MAC7C,gBAAKP,UAAWC,IAAAA,eAAiB,UAC/B,kBACED,UAAWC,IAAAA,MACXvtD,KAAK,QACL8qB,SAAW/oB,GAXEA,KACnBkpD,EAAalpD,EAAEiJ,OAAOnB,OACtBqhD,EAAenpD,EAAEiJ,OAAOnB,MAAM,EASPikD,CAAY/rD,SAGhC,E,MCrBP,MA4BA,EA5BgB,EAAGgsD,eACjB,MAAM/C,GAAehrC,EAAAA,EAAAA,IAAWisC,GAEhC,OACE,gBACEqB,UAAWU,IACTT,IAAAA,SACmB,UAAlBQ,EAAStC,MAAsC,SAAlBsC,EAAStC,OAAoB8B,IAAAA,UAC3D,WAEF,2BACE,gBAAKD,UAAWC,IAAAA,KAAQl6C,IAAKu6C,EAAMC,IAAI,aACvC,kBACE/iC,SAAW/oB,GAAMipD,EAAajpD,EAAEiJ,OAAOnB,OACvCoB,GAAG,aACHjL,KAAK,QACLiuD,IAAK,EACLnhD,IAAK,GACL27B,aAAc,OAEb,OACL,yBACE,SAAC,EAAK,SAEL,E,uBCjCT,MAEA,EAFa,IAA0B,uCAKhC,I,0BCLQ,MAAMylB,GAInBvnD,YAAY0kD,GAA2B,KAHhCA,YAAM,OACN4B,SAAG,EAGRpmD,KAAKwkD,OAASA,EACdxkD,KAAKomD,IAAM5B,EAAO1vC,WAAW,KAC/B,CAEIkwC,cAAU50B,GACZpwB,KAAKomD,IAAIkB,UAAYl3B,CACvB,CAEI60B,gBAAY70B,GACdpwB,KAAKomD,IAAImB,YAAcn3B,CACzB,CAEI20B,cAAUj0C,GACZ9Q,KAAKomD,IAAIrB,UAAYj0C,CACvB,CAEA02C,eACExnD,KAAKwkD,OAAOiD,YAAc,KAC1BznD,KAAKwkD,OAAOkD,YAAc,KAC1B1nD,KAAKwkD,OAAOmD,UAAY,IAC1B,ECvBa,MAAMC,WAAcP,GAGjCvnD,YAAY0kD,GACV3gD,MAAM2gD,GAAQ,KAHRqD,aAAc,EAIpB7nD,KAAKud,QACP,CAEAA,SACEvd,KAAKwkD,OAAOiD,YAAcznD,KAAK8nD,iBAAiB9yC,KAAKhV,MACrDA,KAAKwkD,OAAOkD,YAAc1nD,KAAK+nD,iBAAiB/yC,KAAKhV,MACrDA,KAAKwkD,OAAOmD,UAAY3nD,KAAK6mD,eAAe7xC,KAAKhV,KACnD,CAGA6mD,eAAe/mC,GACb9f,KAAK6nD,aAAc,CACrB,CAEAE,iBAAiB7sD,GACf8E,KAAK6nD,aAAc,EACnB7nD,KAAKomD,IAAI4B,YACThoD,KAAKomD,IAAI6B,OACP/sD,EAAEgtD,MAAQhtD,EAAEiJ,OAAOgkD,WACnBjtD,EAAEktD,MAAQltD,EAAEiJ,OAAOkkD,UAEvB,CAEAP,iBAAiB5sD,GACX8E,KAAK6nD,aACP7nD,KAAKsoD,KAAKptD,EAAEgtD,MAAQhtD,EAAEiJ,OAAOgkD,WAAYjtD,EAAEktD,MAAQltD,EAAEiJ,OAAOkkD,UAEhE,CAEAC,KAAKrrD,EAAWC,GACd8C,KAAKomD,IAAImC,OAAOtrD,EAAGC,GACnB8C,KAAKomD,IAAIoC,QACX,EC7BF,MA+BA,GA/BoB,EAClBC,YACAC,mBAKA,MAAMC,GAAiBxvC,EAAAA,EAAAA,IAAWgsC,GAC5BX,GAAS5yC,EAAAA,EAAAA,IACb0yC,GACCnzC,GAAUA,EAAM20C,YAAYvB,YAAYC,SAU3C,OACE,mBACErrD,KAAK,SACLstD,UAAWU,IAAGT,KAAAA,KAA8B,UAAtBgC,EAAa9D,MAAoB8B,KAAAA,QACvDp2B,QAXa,KACXk0B,IACFiE,EAAU,CAAE7D,KAAM,UAClB+D,EAAe,IAAIC,GAAUpE,IAC/B,EAOoB,gBAElB,gBAAKh4C,IAAKu6C,EAAMC,IAAI,YACb,ECnCb,GAFa,IAA0B,uC,OAKhC,ICIP,MAqCA,GArCe,EACbyB,YACAC,mBAKA,MAAMG,GAAkB1vC,EAAAA,EAAAA,IAAWgsC,GAC7BX,GAAS5yC,EAAAA,EAAAA,IACb0yC,GACCnzC,GAAUA,EAAM20C,YAAYvB,YAAYC,SAErCI,GAAOhzC,EAAAA,EAAAA,IAAY0yC,GAAcnzC,GAAUA,EAAM20C,YAAYlB,OAcnE,OACE,mBACEzrD,KAAK,SACLstD,UAAWU,IAAGT,KAAAA,KAA8B,WAAtBgC,EAAa9D,MAAqB8B,KAAAA,QACxDp2B,QAhBc,KACZk0B,IACFiE,EAAU,CAAE7D,KAAM,WAEdA,GACFA,EAAK4C,eAGPqB,EAAgB,MAClB,EAOqB,kBAEnB,gBAAKr8C,IAAKu6C,GAAMC,IAAI,aACb,ECxCb,GAFa,IAA0B,uC,OAKhC,ICGP,MAiCA,GAjCqB,KACnB,MAAMxC,GAAS5yC,EAAAA,EAAAA,IACb0yC,GACCnzC,GAAUA,EAAM20C,YAAYvB,YAAYC,SAErCd,GAAgBvqC,EAAAA,EAAAA,IAAWosC,GAE3Ba,EAAY,MAAN5B,OAAM,EAANA,EAAQ1vC,WAAW,MAmB/B,OACE,mBAAQ3b,KAAK,SAASstD,UAAWC,KAAAA,KAAQp2B,QAlB1B,KACf,GAAI81B,GAAO5B,EAAQ,CACjB4B,EAAIG,UAAU,EAAG,EAAG/B,EAAO1zC,MAAO0zC,EAAO3zC,QACzC,MAAMg0C,EAAUL,EAAOoC,YAEjBnL,EAAM,IAAI4K,MAEhB5K,EAAIjvC,IAAMq4C,EACVpJ,EAAI6K,OAAS,KACR,MAAHF,GAAAA,EAAKG,UAAU,EAAG,EAAG/B,EAAO1zC,MAAO0zC,EAAO3zC,QACvC,MAAHu1C,GAAAA,EAAKI,UAAU/K,EAAK,EAAG,EAAG+I,EAAO1zC,MAAO0zC,EAAO3zC,OAAO,EAGxD6yC,EAAcmB,EAChB,GAI2D,kBACzD,gBAAKr4C,IAAKu6C,GAAMC,IAAI,aACb,ECnCb,GAFa,IAA0B,uCAKhC,ICHQ,MAAM8B,WAAazB,GAMhCvnD,YAAY0kD,GACV3gD,MAAM2gD,GAAQ,KANRqD,aAAc,EAAK,KACnBkB,OAAS,EAAC,KACVC,OAAS,EAAC,KACVC,MAAQ,GAIdjpD,KAAKud,QACP,CAEAA,SACEvd,KAAKwkD,OAAOiD,YAAcznD,KAAK8nD,iBAAiB9yC,KAAKhV,MACrDA,KAAKwkD,OAAOkD,YAAc1nD,KAAK+nD,iBAAiB/yC,KAAKhV,MACrDA,KAAKwkD,OAAOmD,UAAY3nD,KAAK6mD,eAAe7xC,KAAKhV,KACnD,CAGA6mD,eAAe/mC,GACb9f,KAAK6nD,aAAc,CACrB,CAEAE,iBAAiB7sD,GACf8E,KAAK6nD,aAAc,EACnB7nD,KAAKomD,IAAI4B,YACThoD,KAAK+oD,OAAS7tD,EAAEgtD,MAAQhtD,EAAEiJ,OAAOgkD,WACjCnoD,KAAKgpD,OAAS9tD,EAAEktD,MAAQltD,EAAEiJ,OAAOkkD,UACjCroD,KAAKipD,MAAQjpD,KAAKwkD,OAAOoC,WAC3B,CAEAkB,iBAAiB5sD,GACf,GAAI8E,KAAK6nD,YAAa,CACpB,MAAMqB,EAAWhuD,EAAEgtD,MAAQhtD,EAAEiJ,OAAOgkD,WAC9BgB,EAAWjuD,EAAEktD,MAAQltD,EAAEiJ,OAAOkkD,UAC9Bv3C,EAAQo4C,EAAWlpD,KAAK+oD,OACxBl4C,EAASs4C,EAAWnpD,KAAKgpD,OAE/BhpD,KAAKsoD,KAAKtoD,KAAK+oD,OAAQ/oD,KAAKgpD,OAAQl4C,EAAOD,EAC7C,CACF,CAEAy3C,KAAKrrD,EAAWC,EAAWF,EAAWV,GACpC,MAAMm/C,EAAM,IAAI4K,MAChB5K,EAAIjvC,IAAMxM,KAAKipD,MACfxN,EAAI6K,OAAS,KACXtmD,KAAKomD,IAAIG,UAAU,EAAG,EAAGvmD,KAAKwkD,OAAO1zC,MAAO9Q,KAAKwkD,OAAO3zC,QACxD7Q,KAAKomD,IAAII,UAAU/K,EAAK,EAAG,EAAGz7C,KAAKwkD,OAAO1zC,MAAO9Q,KAAKwkD,OAAO3zC,QAC7D7Q,KAAKomD,IAAI4B,YACThoD,KAAKomD,IAAIgD,KAAKnsD,EAAGC,EAAGF,EAAGV,GACvB0D,KAAKomD,IAAIoC,SACTxoD,KAAKomD,IAAI1/C,MAAM,CAEnB,E,OC5CF,MA+BA,GA/BmB,EACjB+hD,YACAC,mBAKA,MAAMW,GAAgBlwC,EAAAA,EAAAA,IAAWgsC,GAC3BX,GAAS5yC,EAAAA,EAAAA,IACb0yC,GACA,EAAGwB,iBAAkBA,EAAYvB,YAAYC,SAU/C,OACE,mBACErrD,KAAK,SACLstD,UAAWU,IAAGT,KAAAA,KAA8B,SAAtBgC,EAAa9D,MAAmB8B,KAAAA,QACtDp2B,QAXY,KACVk0B,IACFiE,EAAU,CAAE7D,KAAM,OAAQsC,UAAU,IACpCmC,EAAc,IAAIC,GAAS9E,IAC7B,EAOmB,kBAEjB,gBAAKh4C,IAAKu6C,GAAMC,IAAI,aACb,ECnCb,GAFa,IAA0B,uCCEvC,IDGO,ICLM,IAA0B,wCAKhC,I,gCCEP,MAeA,GAfoB,KAClB,MAAOxD,EAAMC,GCHY,MACzB,MAAMe,GAAS5yC,EAAAA,EAAAA,IACb0yC,GACA,EAAGwB,iBAAkBA,EAAYvB,YAAYC,SAGzCE,GAAoB9yC,EAAAA,EAAAA,IACxB0yC,GACA,EAAGwB,iBAAkBA,EAAYvB,YAAYE,QAAQC,oBAGjDve,GAAUv0B,EAAAA,EAAAA,IACd0yC,GACA,EAAGwB,iBAAkBA,EAAYvB,YAAYE,QAAQte,UAGjD4d,GAAuB5qC,EAAAA,EAAAA,IAAWqsC,GAClCtB,GAAkB/qC,EAAAA,EAAAA,IAAWwsC,GAEnC,IAAKnB,EAAQ,MAAO,GACpB,MAAM4B,EAAM5B,EAAO1vC,WAAW,MAsD9B,MAAO,CApDMrG,UACX,GAAIi2C,GAAqB,EAAG,OACpBR,GAAgB,GACtBt9B,aAAaQ,QAAQ,eAAgB,KAErC,MAAMmiC,EAAY7E,EAAoB,EAChCG,EAAU1e,EAAQojB,GAEnB1E,IACA,MAAHuB,GAAAA,EAAKG,UAAU,EAAG,EAAG/B,EAAO1zC,MAAO0zC,EAAO3zC,QAC1C+V,aAAaQ,QAAQ,oBAAqB,aAGtC28B,EAAqBwF,GAE3B,MAAM9N,EAAM,IAAI4K,MAEhB5K,EAAIjvC,IAAMq4C,EACVpJ,EAAI6K,OAAS,KACR,MAAHF,GAAAA,EAAKG,UAAU,EAAG,EAAG/B,EAAO1zC,MAAO0zC,EAAO3zC,QACvC,MAAHu1C,GAAAA,EAAKI,UAAU/K,EAAK,EAAG,EAAG+I,EAAO1zC,MAAO0zC,EAAO3zC,OAAO,EAGxD+V,aAAaQ,QAAQ,oBAAsB,GAAEmiC,IAC/C,GAGW96C,UACX,GAAI03B,EAAQ9uC,OAAS,EAAG,OAChB6sD,GAAgB,GACtBt9B,aAAaQ,QAAQ,eAAgB,KAErC,MAAMoiC,EAAY9E,EAAoB,EAEhCG,EAAU1e,EAAQqjB,GAAarjB,EAAQqjB,GAAa,KAE1D,IAAK3E,EAAS,aAERd,EAAqByF,GAE3B,MAAM/N,EAAM,IAAI4K,MAEhB5K,EAAIjvC,IAAMq4C,EACVpJ,EAAI6K,OAAS,KACR,MAAHF,GAAAA,EAAKG,UAAU,EAAG,EAAG/B,EAAO1zC,MAAO0zC,EAAO3zC,QACvC,MAAHu1C,GAAAA,EAAKI,UAAU/K,EAAK,EAAG,EAAG+I,EAAO1zC,MAAO0zC,EAAO3zC,OAAO,EAGxD+V,aAAaQ,QAAQ,oBAAsB,GAAEoiC,IAC/C,GAGiB,EDvEEC,GAErB,OACE,iBAAKhD,UAAWjgC,KAAAA,YAAkB,WAChC,mBAAQrtB,KAAK,SAASm3B,QAASkzB,EAAMiD,UAAWC,KAAAA,KAAO,kBACrD,gBAAKl6C,IAAKk9C,GAAU1C,IAAI,aAE1B,mBAAQ7tD,KAAK,SAASm3B,QAASmzB,EAAMgD,UAAWC,KAAAA,KAAO,kBACrD,gBAAKl6C,IAAKm9C,GAAU3C,IAAI,cAEtB,E,UENV,MAmBA,GAnBgB,KACd,MAAO0B,EAAckB,IAAmBC,EAAAA,EAAAA,UAAS,CAC/CjF,KAAM,KAGR,OACE,iCACE,iBAAK6B,UAAWC,IAAAA,QAAU,WACxB,SAACoD,GAAY,CAACrB,UAAWmB,EAAiBlB,aAAcA,KACxD,SAAC,GAAW,CAACD,UAAWmB,EAAiBlB,aAAcA,KACvD,SAAC,GAAI,CAACD,UAAWmB,EAAiBlB,aAAcA,IAAgB,SAChE,SAAC,GAAY,KAAG,SAChB,SAAC,GAAW,SAEd,SAAC,EAAO,CAACxB,SAAUwB,MAClB,E,4BChBA,MAAMqB,GAAS,EAAGC,YAAWC,iBAClC,MAAM74C,GAAQO,EAAAA,EAAAA,OACR,MAAEb,EAAK,OAAED,GAAWO,EAEpB84C,EAAcF,GAAal5C,GCdpB,IDePq5C,EAAeF,GAAcp5C,GCdrB,IDgBd,OACE,iBAAK41C,UAAWC,KAAAA,OAAS,mBACvB,SAAC,GAAO,MACR,SAAC,EAAM,CAAC51C,MAAOo5C,EAAar5C,OAAQs5C,MAChC,E,OEVV,IAUa9G,IAVZp/C,EAAAA,EAAAA,IAAO,CACNC,QAAS,CAAC8N,EAAAA,IACVjO,UAAW,CACT,CACEzC,QAASoQ,EAAAA,GACT7Q,OAAO,EACPU,SAAU,CAAC+iD,MAGf,IATF,UAU4B,E,oCCbf,IAAIppD,EAAE,EAAQ,MAA4EqB,EAAE,mBAAoBzE,OAAOsyD,GAAGtyD,OAAOsyD,GAA1G,SAAW/uD,EAAEC,GAAG,OAAOD,IAAIC,IAAI,IAAID,GAAG,EAAEA,GAAI,EAAEC,IAAID,GAAIA,GAAGC,GAAIA,CAAC,EAAiDkB,EAAEtB,EAAE2uD,SAASptD,EAAEvB,EAAE6qD,UAAUrpD,EAAExB,EAAEuO,gBAAgB9M,EAAEzB,EAAEmvD,cACtM,SAASxtD,EAAExB,GAAG,IAAIC,EAAED,EAAEivD,YAAYjvD,EAAEA,EAAE2H,MAAM,IAAI,IAAIxH,EAAEF,IAAI,OAAOiB,EAAElB,EAAEG,EAAoB,CAAjB,MAAMC,GAAG,OAAM,CAAE,CAAC,CAA4B,IAAI2B,EAAE,oBAAqBjB,aAAQ,IAAqBA,OAAOmV,eAAU,IAAqBnV,OAAOmV,SAAS8kC,cAAzI,SAAW/6C,EAAEC,GAAG,OAAOA,GAAG,EAD+F,SAAWD,EAAEC,GAAG,IAAIE,EAAEF,IAAIG,EAAEe,EAAE,CAAC+tD,KAAK,CAACvnD,MAAMxH,EAAE8uD,YAAYhvD,KAAKC,EAAEE,EAAE,GAAG8uD,KAAKluD,EAAEZ,EAAE,GAAwJ,OAArJiB,GAAE,WAAWnB,EAAEyH,MAAMxH,EAAED,EAAE+uD,YAAYhvD,EAAEuB,EAAEtB,IAAIc,EAAE,CAACkuD,KAAKhvD,GAAG,GAAE,CAACF,EAAEG,EAAEF,IAAImB,GAAE,WAA6B,OAAlBI,EAAEtB,IAAIc,EAAE,CAACkuD,KAAKhvD,IAAWF,GAAE,WAAWwB,EAAEtB,IAAIc,EAAE,CAACkuD,KAAKhvD,GAAG,GAAE,GAAE,CAACF,IAAIsB,EAAEnB,GAAUA,CAAC,EAC5MnD,EAAQwhB,0BAAqB,IAAS3e,EAAE2e,qBAAqB3e,EAAE2e,qBAAqBzc,C,oCCD7T,IAAId,EAAE,EAAQ,MAASI,EAAE,EAAQ,MAAmGE,EAAE,mBAAoB9E,OAAOsyD,GAAGtyD,OAAOsyD,GAA1G,SAAW/uD,EAAEC,GAAG,OAAOD,IAAIC,IAAI,IAAID,GAAG,EAAEA,GAAI,EAAEC,IAAID,GAAIA,GAAGC,GAAIA,CAAC,EAAiDuB,EAAEH,EAAEmd,qBAAqB/c,EAAER,EAAE+M,OAAOjM,EAAEd,EAAEypD,UAAUhpD,EAAET,EAAE+c,QAAQrc,EAAEV,EAAE+tD,cAC/PhyD,EAAQwiB,iCAAiC,SAASxf,EAAEC,EAAEJ,EAAEsB,EAAEH,GAAG,IAAId,EAAEuB,EAAE,MAAM,GAAG,OAAOvB,EAAEgO,QAAQ,CAAC,IAAI9N,EAAE,CAAC+uD,UAAS,EAAGxnD,MAAM,MAAMzH,EAAEgO,QAAQ9N,CAAC,MAAMA,EAAEF,EAAEgO,QAAQhO,EAAEwB,GAAE,WAAW,SAAS1B,EAAEA,GAAG,IAAIE,EAAE,CAAiB,GAAhBA,GAAE,EAAGC,EAAEH,EAAEA,EAAEmB,EAAEnB,QAAM,IAASgB,GAAGZ,EAAE+uD,SAAS,CAAC,IAAIlvD,EAAEG,EAAEuH,MAAM,GAAG3G,EAAEf,EAAED,GAAG,OAAOkB,EAAEjB,CAAC,CAAC,OAAOiB,EAAElB,CAAC,CAAK,GAAJC,EAAEiB,EAAKK,EAAEpB,EAAEH,GAAG,OAAOC,EAAE,IAAIJ,EAAEsB,EAAEnB,GAAG,YAAG,IAASgB,GAAGA,EAAEf,EAAEJ,GAAUI,GAAEE,EAAEH,EAASkB,EAAErB,EAAC,CAAC,IAASM,EAAEe,EAAPhB,GAAE,EAAOkB,OAAE,IAASvB,EAAE,KAAKA,EAAE,MAAM,CAAC,WAAW,OAAOG,EAAEC,IAAI,EAAE,OAAOmB,OAAE,EAAO,WAAW,OAAOpB,EAAEoB,IAAI,EAAE,GAAE,CAACnB,EAAEJ,EAAEsB,EAAEH,IAAI,IAAIb,EAAEqB,EAAExB,EAAEE,EAAE,GAAGA,EAAE,IACnc,OAAhD6B,GAAE,WAAW3B,EAAE+uD,UAAS,EAAG/uD,EAAEuH,MAAMxH,CAAC,GAAE,CAACA,IAAIwB,EAAExB,GAAUA,CAAC,C,oCCRtDpD,EAAOC,QAAU,EAAjB,K,mCCAAD,EAAOC,QAAU,EAAjB,K,GCFEoyD,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBhvD,IAAjBivD,EACH,OAAOA,EAAavyD,QAGrB,IAAID,EAASqyD,EAAyBE,GAAY,CAGjDtyD,QAAS,CAAC,GAIPwyD,GAAQ,EACZ,IACCC,EAAoBH,GAAUvyD,EAAQA,EAAOC,QAASqyD,GACtDG,GAAQ,CAGT,CAFE,QACEA,UAAcJ,EAAyBE,EAC3C,CAGA,OAAOvyD,EAAOC,OACf,CAGAqyD,EAAoBjuD,EAAIquD,EAGxBJ,EAAoBnvD,EAAIkvD,ErJlCpBj0D,EAAW,GACfk0D,EAAoBK,EAAI,SAAS7oD,EAAQ8oD,EAAUhhD,EAAI2yC,GACtD,IAAGqO,EAAH,CAMA,IAAIC,EAAelnB,IACnB,IAAS5sC,EAAI,EAAGA,EAAIX,EAASa,OAAQF,IAAK,CAGzC,IAFA,IAAK6zD,EAAUhhD,EAAI2yC,GAAYnmD,EAASW,GACpC+zD,GAAY,EACP9gD,EAAI,EAAGA,EAAI4gD,EAAS3zD,OAAQ+S,MACpB,EAAXuyC,GAAsBsO,GAAgBtO,IAAa7kD,OAAO+C,KAAK6vD,EAAoBK,GAAGI,OAAM,SAASlzD,GAAO,OAAOyyD,EAAoBK,EAAE9yD,GAAK+yD,EAAS5gD,GAAK,IAChK4gD,EAAStmC,OAAOta,IAAK,IAErB8gD,GAAY,EACTvO,EAAWsO,IAAcA,EAAetO,IAG7C,GAAGuO,EAAW,CACb10D,EAASkuB,OAAOvtB,IAAK,GACrB,IAAI0F,EAAImN,SACErO,IAANkB,IAAiBqF,EAASrF,EAC/B,CACD,CACA,OAAOqF,CAnBP,CAJCy6C,EAAWA,GAAY,EACvB,IAAI,IAAIxlD,EAAIX,EAASa,OAAQF,EAAI,GAAKX,EAASW,EAAI,GAAG,GAAKwlD,EAAUxlD,IAAKX,EAASW,GAAKX,EAASW,EAAI,GACrGX,EAASW,GAAK,CAAC6zD,EAAUhhD,EAAI2yC,EAsB/B,EsJ1BA+N,EAAoBhuD,EAAI,SAAStE,GAChC,IAAIgzD,EAAShzD,GAAUA,EAAO62B,WAC7B,WAAa,OAAO72B,EAAgB,OAAG,EACvC,WAAa,OAAOA,CAAQ,EAE7B,OADAsyD,EAAoBlvD,EAAE4vD,EAAQ,CAAE/vD,EAAG+vD,IAC5BA,CACR,ECNAV,EAAoBlvD,EAAI,SAASnD,EAASgzD,GACzC,IAAI,IAAIpzD,KAAOozD,EACXX,EAAoBlgC,EAAE6gC,EAAYpzD,KAASyyD,EAAoBlgC,EAAEnyB,EAASJ,IAC5EH,OAAOoC,eAAe7B,EAASJ,EAAK,CAAE67B,YAAY,EAAMtyB,IAAK6pD,EAAWpzD,IAG3E,ECPAyyD,EAAoBjvD,EAAI,CAAC,EAGzBivD,EAAoBxvD,EAAI,SAASowD,GAChC,OAAOj1B,QAAQzV,IAAI9oB,OAAO+C,KAAK6vD,EAAoBjvD,GAAGsqB,QAAO,SAASoQ,EAAUl+B,GAE/E,OADAyyD,EAAoBjvD,EAAExD,GAAKqzD,EAASn1B,GAC7BA,CACR,GAAG,IACJ,ECPAu0B,EAAoBttD,EAAI,SAASkuD,GAEhC,OAAYA,EAAL,4BACR,ECHAZ,EAAoBa,SAAW,SAASD,GAEvC,OAAYA,EAAL,6BACR,ECJAZ,EAAoBlgC,EAAI,SAASre,EAAKC,GAAQ,OAAOtU,OAAOC,UAAUf,eAAekB,KAAKiU,EAAKC,EAAO,E1JAlG3V,EAAa,CAAC,EACdC,EAAoB,gBAExBg0D,EAAoBluD,EAAI,SAASi0B,EAAK+6B,EAAMvzD,EAAKqzD,GAChD,GAAG70D,EAAWg6B,GAAQh6B,EAAWg6B,GAAKj5B,KAAKg0D,OAA3C,CACA,IAAIhJ,EAAQiJ,EACZ,QAAW9vD,IAAR1D,EAEF,IADA,IAAIyzD,EAAUp6C,SAASq6C,qBAAqB,UACpCx0D,EAAI,EAAGA,EAAIu0D,EAAQr0D,OAAQF,IAAK,CACvC,IAAIuvD,EAAIgF,EAAQv0D,GAChB,GAAGuvD,EAAEkF,aAAa,QAAUn7B,GAAOi2B,EAAEkF,aAAa,iBAAmBl1D,EAAoBuB,EAAK,CAAEuqD,EAASkE,EAAG,KAAO,CACpH,CAEGlE,IACHiJ,GAAa,GACbjJ,EAASlxC,SAAS8kC,cAAc,WAEzB6M,QAAU,QACjBT,EAAOp3C,QAAU,IACbs/C,EAAoBmB,IACvBrJ,EAAO5E,aAAa,QAAS8M,EAAoBmB,IAElDrJ,EAAO5E,aAAa,eAAgBlnD,EAAoBuB,GACxDuqD,EAAOh2C,IAAMikB,EAC4C,IAArD+xB,EAAOh2C,IAAIzC,QAAQ5N,OAAOmlB,SAASoS,OAAS,OAC/C8uB,EAAOsJ,YAAc,cAGvBr1D,EAAWg6B,GAAO,CAAC+6B,GACnB,IAAIO,EAAmB,SAAStkD,EAAMwH,GAErCuzC,EAAOwJ,QAAUxJ,EAAO8D,OAAS,KACjCh7C,aAAaF,GACb,IAAI6gD,EAAUx1D,EAAWg6B,GAIzB,UAHOh6B,EAAWg6B,GAClB+xB,EAAO0J,YAAc1J,EAAO0J,WAAW/N,YAAYqE,GACnDyJ,GAAWA,EAAQ9qD,SAAQ,SAAS6I,GAAM,OAAOA,EAAGiF,EAAQ,IACzDxH,EAAM,OAAOA,EAAKwH,EACtB,EACI7D,EAAU9C,WAAWyjD,EAAiB/2C,KAAK,UAAMrZ,EAAW,CAAExC,KAAM,UAAWgL,OAAQq+C,IAAW,MACtGA,EAAOwJ,QAAUD,EAAiB/2C,KAAK,KAAMwtC,EAAOwJ,SACpDxJ,EAAO8D,OAASyF,EAAiB/2C,KAAK,KAAMwtC,EAAO8D,QACnDmF,GAAcn6C,SAAS5J,KAAK02C,YAAYoE,EAtCkB,CAuC3D,E2J1CAkI,EAAoB7tD,EAAI,SAASxE,GACX,oBAAXxB,QAA0BA,OAAOs1D,aAC1Cr0D,OAAOoC,eAAe7B,EAASxB,OAAOs1D,YAAa,CAAEnpD,MAAO,WAE7DlL,OAAOoC,eAAe7B,EAAS,aAAc,CAAE2K,OAAO,GACvD,ECNA0nD,EAAoB/tD,EAAIR,OAAOiwD,G,WCA/B1B,EAAoB2B,EAAI,CAAC,EACzB,IAAIC,EAAe,CAAC,EAChBC,EAAa,CAAC,EAClB7B,EAAoB8B,EAAI,SAASnzD,EAAMozD,GAClCA,IAAWA,EAAY,IAE3B,IAAIC,EAAYH,EAAWlzD,GAE3B,GADIqzD,IAAWA,EAAYH,EAAWlzD,GAAQ,CAAC,KAC5CozD,EAAU1iD,QAAQ2iD,IAAc,GAAnC,CAGA,GAFAD,EAAUj1D,KAAKk1D,GAEZJ,EAAajzD,GAAO,OAAOizD,EAAajzD,GAEvCqxD,EAAoBlgC,EAAEkgC,EAAoB2B,EAAGhzD,KAAOqxD,EAAoB2B,EAAEhzD,GAAQ,CAAC,GAEvF,IAAIuH,EAAQ8pD,EAAoB2B,EAAEhzD,GAE9BszD,EAAa,eACbtrD,EAAW,SAAShI,EAAMuzD,EAASlsD,EAASmsD,GAC/C,IAAIC,EAAWlsD,EAAMvH,GAAQuH,EAAMvH,IAAS,CAAC,EACzC0zD,EAAgBD,EAASF,KACzBG,IAAmBA,EAAcC,UAAYH,IAAUE,EAAcF,MAAQA,EAAQF,EAAaI,EAAc1qD,SAAQyqD,EAASF,GAAW,CAAEprD,IAAKd,EAAS2B,KAAMsqD,EAAYE,QAASA,GAC5L,EAYI12B,EAAW,GASf,MAPM,YADC98B,IAELgI,EAAS,YAAa,UAAU,WAAa,OAAO,WAAa,OAAOqpD,EAAoB,KAAO,CAAG,GAAG,GACzGrpD,EAAS,oBAAqB,UAAU,WAAa,OAAO,WAAa,OAAOqpD,EAAoB,KAAO,CAAG,GAAG,GACjHrpD,EAAS,QAAS,UAAU,WAAa,OAAO,WAAa,OAAOqpD,EAAoB,KAAO,CAAG,GAAG,IAKhG4B,EAAajzD,GADhB88B,EAAS9+B,OACeg/B,QAAQzV,IAAIuV,GAAUxmB,MAAK,WAAa,OAAO28C,EAAajzD,GAAQ,CAAG,IADlD,CAnCL,CAqC7C,C,eC7CA,IAAI4zD,EAAe,SAAS1/C,GAE3B,IAAI5Q,EAAE,SAASA,GAAG,OAAOA,EAAEgR,MAAM,KAAKtK,KAAI,SAAU1G,GAAG,OAAOA,GAAGA,GAAGA,EAAEA,CAAE,GAAE,EAAED,EAAE,sCAAsC6nC,KAAKh3B,GAAK1Q,EAAEH,EAAE,GAAGC,EAAED,EAAE,IAAI,GAAG,OAAOA,EAAE,KAAKG,EAAExF,SAASwF,EAAErF,KAAKI,MAAMiF,EAAEF,EAAED,EAAE,MAAMA,EAAE,KAAKG,EAAErF,KAAK,IAAIqF,EAAErF,KAAKI,MAAMiF,EAAEF,EAAED,EAAE,MAAMG,CAC9O,EAyBIqwD,EAA0B,SAAStsD,EAAO3I,GAC7C,IAAI60D,EAAWlsD,EAAM3I,GACrB,OAAOH,OAAO+C,KAAKiyD,GAAU/mC,QAAO,SAAS1qB,EAAGC,GAC/C,OAAQD,IAAOyxD,EAASzxD,GAAG2xD,QA3Bb,SAAS3xD,EAAGC,GAE3BD,EAAE4xD,EAAa5xD,GAAGC,EAAE2xD,EAAa3xD,GAAG,IAAI,IAAIuB,EAAE,IAAI,CAAC,GAAGA,GAAGxB,EAAEhE,OAAO,OAAOwF,EAAEvB,EAAEjE,QAAQ,aAAaiE,EAAEuB,IAAI,GAAG,IAAI3B,EAAEG,EAAEwB,GAAGH,UAAUxB,GAAG,GAAG,GAAG2B,GAAGvB,EAAEjE,OAAO,MAAM,KAAKqF,EAAE,IAAII,EAAExB,EAAEuB,GAAGpB,UAAUqB,GAAG,GAAG,GAAGJ,GAAGjB,EAAE,MAAM,KAAKiB,GAAG,KAAKjB,GAAI,KAAKA,GAAG,KAAKiB,EAAG,GAAG,KAAKA,GAAG,KAAKA,GAAGxB,GAAG4B,EAAE,OAAO5B,EAAE4B,EAAED,GAAG,CACnR,CAwBuCswD,CAAU9xD,EAAGC,GAAMA,EAAID,CAC7D,GAAG,EACJ,EAyCImG,EAAM,SAAS85C,GAElB,OADAA,EAAM0R,OAAS,EACR1R,EAAM95C,KACd,EAsCI4rD,EArCO,SAASpjD,GAAM,OAAO,SAASqjD,EAAWhyD,EAAGC,EAAGC,GAC1D,IAAI6wB,EAAUs+B,EAAoB8B,EAAEa,GACpC,OAAIjhC,GAAWA,EAAQzc,KAAayc,EAAQzc,KAAK3F,EAAGgL,KAAKhL,EAAIqjD,EAAW3C,EAAoB2B,EAAEgB,GAAYhyD,EAAGC,EAAGC,IACzGyO,EAAGqjD,EAAW3C,EAAoB2B,EAAEgB,GAAYhyD,EAAGC,EAAGC,EAC9D,CAAG,CAiCuC+hB,EAAK,SAAS+vC,EAAWzsD,EAAO3I,EAAK+I,GAC9E,OAAIJ,GAAU8pD,EAAoBlgC,EAAE5pB,EAAO3I,GA/EzB,SAAS2I,EAAOysD,EAAWp1D,EAAKq1D,GAClD,IAAIV,EAAUM,EAAwBtsD,EAAO3I,GAC7C,OAAOuJ,EAAIZ,EAAM3I,GAAK20D,GACvB,CA6EQW,CAAa3sD,EAAOysD,EAAWp1D,GADkB+I,GAEzD,IAaIwsD,EAAmB,CAAC,EACpBC,EAAyB,CAC5B,IAAK,WAAa,OAAOL,EAAsB,UAAW,qBAAqB,WAAa,OAAO,WAAa,OAAO1C,EAAoB,KAAO,CAAG,GAAI,EACzJ,KAAM,WAAa,OAAO0C,EAAsB,UAAW,SAAS,WAAa,OAAO,WAAa,OAAO1C,EAAoB,KAAO,CAAG,GAAI,EAC9I,IAAK,WAAa,OAAO0C,EAAsB,UAAW,aAAa,WAAa,OAAO,WAAa,OAAO1C,EAAoB,KAAO,CAAG,GAAI,GAE5H,CAAC,IAAI,KAAK,KAChBvpD,SAAQ,SAASiD,GAChCsmD,EAAoBjuD,EAAE2H,GAAM,SAAShM,GAEpCo1D,EAAiBppD,GAAM,SAChBsmD,EAAoBnvD,EAAE6I,GAC7B,IAAI1D,EAAU+sD,EAAuBrpD,KACrC,GAAsB,mBAAZ1D,EAAwB,MAAM,IAAI9E,MAAM,yDAA2DwI,GAC7GhM,EAAOC,QAAUqI,GAClB,CACD,IACA,IAAIgtD,EAAe,CAAC,EACpBhD,EAAoBjvD,EAAEkyD,SAAW,SAASrC,EAASn1B,GAC/Cu0B,EAAoBlgC,EAAEkjC,EAAcpC,IACtCoC,EAAapC,GAASnqD,SAAQ,SAASiD,GACtC,GAAGsmD,EAAoBlgC,EAAEgjC,EAAkBppD,GAAK,OAAO+xB,EAAS3+B,KAAKg2D,EAAiBppD,IACtF,IAAIwpD,EAAY,SAASltD,GACxB8sD,EAAiBppD,GAAM,EACvBsmD,EAAoBjuD,EAAE2H,GAAM,SAAShM,UAC7BsyD,EAAoBnvD,EAAE6I,GAC7BhM,EAAOC,QAAUqI,GAClB,CACD,EACImtD,EAAU,SAASnyD,UACf8xD,EAAiBppD,GACxBsmD,EAAoBjuD,EAAE2H,GAAM,SAAShM,GAEpC,aADOsyD,EAAoBnvD,EAAE6I,GACvB1I,CACP,CACD,EACA,IACC,IAAI0wB,EAAUqhC,EAAuBrpD,KAClCgoB,EAAQzc,KACVwmB,EAAS3+B,KAAKg2D,EAAiBppD,GAAMgoB,EAAQzc,KAAKi+C,GAAkB,MAAEC,IAChED,EAAUxhC,EACO,CAAvB,MAAMlxB,GAAK2yD,EAAQ3yD,EAAI,CAC1B,GAEF,C,I7JpIIvE,EAAiB,SAAS20D,GAC7B,OAAO,IAAIj1B,SAAQ,SAAS5K,EAASuM,GACpC,IAAI3H,EAAOq6B,EAAoBa,SAASD,GACpCwC,EAAWpD,EAAoB/tD,EAAI0zB,EACvC,GAlBmB,SAASA,EAAMy9B,GAEnC,IADA,IAAIC,EAAmBz8C,SAASq6C,qBAAqB,QAC7Cx0D,EAAI,EAAGA,EAAI42D,EAAiB12D,OAAQF,IAAK,CAChD,IACI62D,GADAzQ,EAAMwQ,EAAiB52D,IACRy0D,aAAa,cAAgBrO,EAAIqO,aAAa,QACjE,GAAe,eAAZrO,EAAIuC,MAAyBkO,IAAa39B,GAAQ29B,IAAaF,GAAW,OAAOvQ,CACrF,CACA,IAAI0Q,EAAoB38C,SAASq6C,qBAAqB,SACtD,IAAQx0D,EAAI,EAAGA,EAAI82D,EAAkB52D,OAAQF,IAAK,CACjD,IAAIomD,EAEJ,IADIyQ,GADAzQ,EAAM0Q,EAAkB92D,IACTy0D,aAAa,gBAChBv7B,GAAQ29B,IAAaF,EAAU,OAAOvQ,CACvD,CACD,CAKK2Q,CAAe79B,EAAMy9B,GAAW,OAAOriC,KA/CrB,SAAS6/B,EAASwC,EAAUriC,EAASuM,GAC3D,IAAIm2B,EAAU78C,SAAS8kC,cAAc,QAErC+X,EAAQrO,IAAM,aACdqO,EAAQh1D,KAAO,WAiBfg1D,EAAQnC,QAAUmC,EAAQ7H,OAhBL,SAASr3C,GAG7B,GADAk/C,EAAQnC,QAAUmC,EAAQ7H,OAAS,KAChB,SAAfr3C,EAAM9V,KACTsyB,QACM,CACN,IAAI2iC,EAAYn/C,IAAyB,SAAfA,EAAM9V,KAAkB,UAAY8V,EAAM9V,MAChEk1D,EAAWp/C,GAASA,EAAM9K,QAAU8K,EAAM9K,OAAOksB,MAAQy9B,EACzDvuD,EAAM,IAAI3D,MAAM,qBAAuB0vD,EAAU,cAAgB+C,EAAW,KAChF9uD,EAAIioB,KAAO,wBACXjoB,EAAIpG,KAAOi1D,EACX7uD,EAAIqyB,QAAUy8B,EACdF,EAAQjC,WAAW/N,YAAYgQ,GAC/Bn2B,EAAOz4B,EACR,CACD,EAEA4uD,EAAQ99B,KAAOy9B,EAC4C,IAAvDK,EAAQ99B,KAAKtmB,QAAQ5N,OAAOmlB,SAASoS,OAAS,OACjDy6B,EAAQrC,YAAc,aAEvBx6C,SAAS5J,KAAK02C,YAAY+P,EAE3B,CAoBEG,CAAiBhD,EAASwC,EAAUriC,EAASuM,EAC9C,GACD,EAEIphC,EAAqB,CACxB,SAAY,GAGb8zD,EAAoBjvD,EAAE8yD,QAAU,SAASjD,EAASn1B,GAE9Cv/B,EAAmB00D,GAAUn1B,EAAS3+B,KAAKZ,EAAmB00D,IACzB,IAAhC10D,EAAmB00D,IAFX,CAAC,iBAAiB,GAEqBA,IACtDn1B,EAAS3+B,KAAKZ,EAAmB00D,GAAW30D,EAAe20D,GAAS37C,MAAK,WACxE/Y,EAAmB00D,GAAW,CAC/B,IAAG,SAASpwD,GAEX,aADOtE,EAAmB00D,GACpBpwD,CACP,IAEF,E,W8J9DA,IAAIszD,EAAkB,CACrB,SAAY,GAGb9D,EAAoBjvD,EAAE2O,EAAI,SAASkhD,EAASn1B,GAE1C,IAAIs4B,EAAqB/D,EAAoBlgC,EAAEgkC,EAAiBlD,GAAWkD,EAAgBlD,QAAW3vD,EACtG,GAA0B,IAAvB8yD,EAGF,GAAGA,EACFt4B,EAAS3+B,KAAKi3D,EAAmB,QAC3B,CAGL,IAAIriC,EAAU,IAAIiK,SAAQ,SAAS5K,EAASuM,GAAUy2B,EAAqBD,EAAgBlD,GAAW,CAAC7/B,EAASuM,EAAS,IACzH7B,EAAS3+B,KAAKi3D,EAAmB,GAAKriC,GAGtC,IAAIqE,EAAMi6B,EAAoB/tD,EAAI+tD,EAAoBttD,EAAEkuD,GAEpD5vD,EAAQ,IAAIE,MAgBhB8uD,EAAoBluD,EAAEi0B,GAfH,SAASxhB,GAC3B,GAAGy7C,EAAoBlgC,EAAEgkC,EAAiBlD,KAEf,KAD1BmD,EAAqBD,EAAgBlD,MACRkD,EAAgBlD,QAAW3vD,GACrD8yD,GAAoB,CACtB,IAAIL,EAAYn/C,IAAyB,SAAfA,EAAM9V,KAAkB,UAAY8V,EAAM9V,MAChEu1D,EAAUz/C,GAASA,EAAM9K,QAAU8K,EAAM9K,OAAOqI,IACpD9Q,EAAM2D,QAAU,iBAAmBisD,EAAU,cAAgB8C,EAAY,KAAOM,EAAU,IAC1FhzD,EAAMrC,KAAO,iBACbqC,EAAMvC,KAAOi1D,EACb1yD,EAAMk2B,QAAU88B,EAChBD,EAAmB,GAAG/yD,EACvB,CAEF,GACyC,SAAW4vD,EAASA,EAE/D,CAEH,EAUAZ,EAAoBK,EAAE3gD,EAAI,SAASkhD,GAAW,OAAoC,IAA7BkD,EAAgBlD,EAAgB,EAGrF,IAAIqD,EAAuB,SAASC,EAA4BzvB,GAC/D,IAGIwrB,EAAUW,GAHTN,EAAU6D,EAAaC,GAAW3vB,EAGhBhoC,EAAI,EAC3B,GAAG6zD,EAAS+D,MAAK,SAAS3qD,GAAM,OAA+B,IAAxBoqD,EAAgBpqD,EAAW,IAAI,CACrE,IAAIumD,KAAYkE,EACZnE,EAAoBlgC,EAAEqkC,EAAalE,KACrCD,EAAoBjuD,EAAEkuD,GAAYkE,EAAYlE,IAGhD,GAAGmE,EAAS,IAAI5sD,EAAS4sD,EAAQpE,EAClC,CAEA,IADGkE,GAA4BA,EAA2BzvB,GACrDhoC,EAAI6zD,EAAS3zD,OAAQF,IACzBm0D,EAAUN,EAAS7zD,GAChBuzD,EAAoBlgC,EAAEgkC,EAAiBlD,IAAYkD,EAAgBlD,IACrEkD,EAAgBlD,GAAS,KAE1BkD,EAAgBlD,GAAW,EAE5B,OAAOZ,EAAoBK,EAAE7oD,EAC9B,EAEI8sD,EAAqB9yD,KAAU,IAAIA,KAAU,KAAK,GACtD8yD,EAAmB7tD,QAAQwtD,EAAqB35C,KAAK,KAAM,IAC3Dg6C,EAAmBx3D,KAAOm3D,EAAqB35C,KAAK,KAAMg6C,EAAmBx3D,KAAKwd,KAAKg6C,G,IClFvF,IAAIC,EAAsBvE,EAAoBK,OAAEpvD,EAAW,CAAC,UAAU,WAAa,OAAO+uD,EAAoB,KAAO,IACrHuE,EAAsBvE,EAAoBK,EAAEkE,E","sources":["webpack:///webpack/runtime/chunk loaded","webpack:///webpack/runtime/load script","webpack:///webpack/runtime/css loading","webpack:///../state/node_modules/react-is/cjs/react-is.production.min.js","webpack:///../state/node_modules/react-is/index.js","webpack:///../../classnames/index.js","webpack:///../../hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js","webpack:///../../invariant/browser.js","webpack:///../../../src/shared/sketch/components/canvas/canvas.module.css","webpack:///../../../src/shared/sketch/components/sidebar/sidebar.module.css","webpack:///../../../src/shared/sketch/components/sketch.module.css","webpack:///../../../src/shared/sketch/components/toolbar/toolbar.module.css","webpack:///../../../src/shared/sketch/components/toolbar/tools/color/color.module.css","webpack:///../../../src/shared/sketch/components/toolbar/tools/general.module.css","webpack:///../../../src/shared/sketch/components/toolbar/tools/undoRedoBar/undoRedoBar.module.css","webpack:///../../node-abort-controller/browser.js","webpack:///../../react-is/cjs/react-is.production.min.js","webpack:///../../react-is/index.js","webpack:///../../@tinkoff/dippy/lib/di.es.js","webpack:///../../@tinkoff/lru-cache-nano/index.js","webpack:///../../@tinkoff/react-hooks/lib/index.es.js","webpack:///../../@tinkoff/utils/array/concat.js","webpack:///../../@tinkoff/utils/array/difference.js","webpack:///../../@tinkoff/utils/array/each.js","webpack:///../../@tinkoff/utils/array/find.js","webpack:///../../@tinkoff/utils/array/findIndex.js","webpack:///../../@tinkoff/utils/array/flatten.js","webpack:///../../@tinkoff/utils/array/indexOf.js","webpack:///../../@tinkoff/utils/array/map.js","webpack:///../../@tinkoff/utils/array/slice.js","webpack:///../../@tinkoff/utils/array/toArray.js","webpack:///../../@tinkoff/utils/array/uniq.js","webpack:///../../@tinkoff/utils/assign.js","webpack:///../../@tinkoff/utils/function/always.js","webpack:///../../@tinkoff/utils/function/compose.js","webpack:///../../@tinkoff/utils/function/curryN.js","webpack:///../../@tinkoff/utils/function/debounce.js","webpack:///../../@tinkoff/utils/function/identity.js","webpack:///../../@tinkoff/utils/function/ifElse.js","webpack:///../../@tinkoff/utils/function/noop.js","webpack:///../../@tinkoff/utils/is/array.js","webpack:///../../@tinkoff/utils/is/arrayLike.js","webpack:///../../@tinkoff/utils/is/empty.js","webpack:///../../@tinkoff/utils/is/nil.js","webpack:///../../@tinkoff/utils/is/object.js","webpack:///../../@tinkoff/utils/is/plainObject.js","webpack:///../../@tinkoff/utils/is/reactComponent.js","webpack:///../../@tinkoff/utils/is/reactElement.js","webpack:///../../@tinkoff/utils/is/shallowEqual.js","webpack:///../../@tinkoff/utils/is/string.js","webpack:///../../@tinkoff/utils/object/each.js","webpack:///../../@tinkoff/utils/object/has.js","webpack:///../../@tinkoff/utils/object/keys.js","webpack:///../../@tinkoff/utils/object/map.js","webpack:///../../@tinkoff/utils/object/mergeDeep.js","webpack:///../../@tinkoff/utils/object/mergeWith.js","webpack:///../../@tinkoff/utils/object/omit.js","webpack:///../../@tinkoff/utils/object/path.js","webpack:///../../@tinkoff/utils/object/pathEq.js","webpack:///../../@tinkoff/utils/object/pathOr.js","webpack:///../../@tinkoff/utils/object/prop.js","webpack:///../../@tinkoff/utils/object/reduce.js","webpack:///../../@tinkoff/utils/object/values.js","webpack:///../../@tinkoff/utils/string/escape.js","webpack:///../../@tinkoff/utils/string/replace.js","webpack:///../../@tinkoff/utils/string/split.js","webpack:///../../@tinkoff/utils/string/test.js","webpack:///../../@tinkoff/utils/string/toLower.js","webpack:///../core/lib/index.es.js","webpack:///../module-client-hints/lib/browser.js","webpack:///../state/lib/index.es.js","webpack:///../tokens-child-app/lib/index.es.js","webpack:///../tokens-common/lib/index.es.js","webpack:///../tokens-cookie/lib/index.es.js","webpack:///../tokens-core/lib/index.es.js","webpack:///../../tslib/tslib.es6.js","webpack:///../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///../types-actions-state-context/lib/index.es.js","webpack:///../module-environment/lib/browser.js","webpack:///../../@tinkoff/browser-cookies/lib/index.es.js","webpack:///../module-cookie/lib/browser.js","webpack:///../safe-strings/lib/utils.es.js","webpack:///../../@tinkoff/logger/lib/index.browser.js","webpack:///../papi/lib/index.es.js","webpack:///../tokens-server/lib/index.es.js","webpack:///../module-log/lib/browser.js","webpack:///../../@babel/runtime/helpers/esm/extends.js","webpack:///../../@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///../../@loadable/component/dist/loadable.esm.js","webpack:///../../@babel/runtime/helpers/esm/inheritsLoose.js","webpack:///../../@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///../react/lib/react.es.js","webpack:///./lib/external/pages.js","webpack:///../experiments/lib/index.es.js","webpack:///../tokens-server-private/lib/index.es.js","webpack:///../../@tinkoff/url/lib/url.es.js","webpack:///../tokens-core-private/lib/index.es.js","webpack:///../../@tinkoff/errors/lib/index.es.js","webpack:///../../@tinkoff/pubsub/lib/pubsub.es.js","webpack:///../tokens-render/lib/index.es.js","webpack:///../module-common/lib/index.browser.js","webpack:///../../@tinkoff/hook-runner/lib/index.es.js","webpack:///../../@tinkoff/router/lib/index.browser.js","webpack:///../tokens-router/lib/index.es.js","webpack:///../module-router/lib/index.browser.js","webpack:///../../@tinkoff/layout-factory/lib/index.es.js","webpack:///../module-render/lib/browser.js","webpack:///../tokens-metrics/lib/index.es.js","webpack:///../../@tinkoff/browser-timings/lib/browser-timings.es.js","webpack:///../../@tinkoff/metrics-noop/lib/index.es.js","webpack:///../tokens-http-client/lib/index.es.js","webpack:///../module-metrics/lib/browser.js","webpack:///../module-server/lib/browser.js","webpack:///../module-error-interceptor/lib/browser.js","webpack:///../../@tinkoff/meta-tags-generate/lib/index.es.js","webpack:///../module-seo/lib/browser.js","webpack:///../../@tinkoff/htmlpagebuilder/lib/index.es.js","webpack:///../../../src/index.ts","webpack:///../../../src/shared/sketch/store/events.ts","webpack:///../../../src/shared/sketch/store/store.ts","webpack:///../../../src/shared/sketch/store/actions.ts","webpack:///../../../src/shared/sketch/components/canvas/Canvas.tsx","webpack:///../../../src/shared/sketch/components/sidebar/img/line-adjustment.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/color/img/color-circle.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/color/Color.tsx","webpack:///../../../src/shared/sketch/components/sidebar/Sidebar.tsx","webpack:///../../../src/shared/sketch/components/toolbar/tools/brush/img/paint-brush.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/Tool.ts","webpack:///../../../src/shared/sketch/components/toolbar/tools/brush/Brush.ts","webpack:///../../../src/shared/sketch/components/toolbar/tools/brush/BrushButton.tsx","webpack:///../../../src/shared/sketch/components/toolbar/tools/cursor/img/cursor.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/cursor/CursorButton.tsx","webpack:///../../../src/shared/sketch/components/toolbar/tools/eraser/img/eraser.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/eraser/EraserButton.tsx","webpack:///../../../src/shared/sketch/components/toolbar/tools/rect/img/square.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/rect/Rect.ts","webpack:///../../../src/shared/sketch/components/toolbar/tools/rect/RectButton.tsx","webpack:///../../../src/shared/sketch/components/toolbar/tools/undoRedoBar/img/undo.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/undoRedoBar/img/redo.png","webpack:///../../../src/shared/sketch/components/toolbar/tools/undoRedoBar/UndoRedoBar.tsx","webpack:///../../../src/shared/sketch/hooks/useUndoRedo.ts","webpack:///../../../src/shared/sketch/components/toolbar/Toolbar.tsx","webpack:///../../../src/shared/sketch/components/Sketch.tsx","webpack:///../../../src/shared/sketch/config.ts","webpack:///../../../src/shared/sketch/index.ts","webpack:///../../use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack:///../../use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","webpack:///../../use-sync-external-store/shim/index.js","webpack:///../../use-sync-external-store/shim/with-selector.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/ensure chunk","webpack:///webpack/runtime/get javascript chunk filename","webpack:///webpack/runtime/get mini-css chunk filename","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/runtime-path-module","webpack:///webpack/runtime/sharing","webpack:///webpack/runtime/consumes","webpack:///webpack/runtime/jsonp chunk loading","webpack:///webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"@tramvai/cli:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 240;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t\tif (script.src.indexOf(window.location.origin + '/') !== 0) {\n\t\t\tscript.crossOrigin = \"anonymous\";\n\t\t}\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t};\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 240000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var createStylesheet = function(chunkId, fullhref, resolve, reject) {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tvar onLinkComplete = function(event) {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + realHref + \")\");\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tlinkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\tif (linkTag.href.indexOf(window.location.origin + '/') !== 0) {\n\t\tlinkTag.crossOrigin = \"anonymous\";\n\t}\n\tdocument.head.appendChild(linkTag);\n\treturn linkTag;\n};\nvar findStylesheet = function(href, fullhref) {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = function(chunkId) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t\"platform\": 0\n};\n\n__webpack_require__.f.miniCss = function(chunkId, promises) {\n\tvar cssChunks = {\"@_routes_index\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(function() {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, function(e) {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr","/**\n * @license React\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var b=Symbol.for(\"react.element\"),c=Symbol.for(\"react.portal\"),d=Symbol.for(\"react.fragment\"),e=Symbol.for(\"react.strict_mode\"),f=Symbol.for(\"react.profiler\"),g=Symbol.for(\"react.provider\"),h=Symbol.for(\"react.context\"),k=Symbol.for(\"react.server_context\"),l=Symbol.for(\"react.forward_ref\"),m=Symbol.for(\"react.suspense\"),n=Symbol.for(\"react.suspense_list\"),p=Symbol.for(\"react.memo\"),q=Symbol.for(\"react.lazy\"),t=Symbol.for(\"react.offscreen\"),u;u=Symbol.for(\"react.module.reference\");\nfunction v(a){if(\"object\"===typeof a&&null!==a){var r=a.$$typeof;switch(r){case b:switch(a=a.type,a){case d:case f:case e:case m:case n:return a;default:switch(a=a&&a.$$typeof,a){case k:case h:case l:case q:case p:case g:return a;default:return r}}case c:return r}}}exports.ContextConsumer=h;exports.ContextProvider=g;exports.Element=b;exports.ForwardRef=l;exports.Fragment=d;exports.Lazy=q;exports.Memo=p;exports.Portal=c;exports.Profiler=f;exports.StrictMode=e;exports.Suspense=m;\nexports.SuspenseList=n;exports.isAsyncMode=function(){return!1};exports.isConcurrentMode=function(){return!1};exports.isContextConsumer=function(a){return v(a)===h};exports.isContextProvider=function(a){return v(a)===g};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===b};exports.isForwardRef=function(a){return v(a)===l};exports.isFragment=function(a){return v(a)===d};exports.isLazy=function(a){return v(a)===q};exports.isMemo=function(a){return v(a)===p};\nexports.isPortal=function(a){return v(a)===c};exports.isProfiler=function(a){return v(a)===f};exports.isStrictMode=function(a){return v(a)===e};exports.isSuspense=function(a){return v(a)===m};exports.isSuspenseList=function(a){return v(a)===n};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===d||a===f||a===e||a===m||a===n||a===t||\"object\"===typeof a&&null!==a&&(a.$$typeof===q||a.$$typeof===p||a.$$typeof===g||a.$$typeof===h||a.$$typeof===l||a.$$typeof===u||void 0!==a.getModuleId)?!0:!1};exports.typeOf=v;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\tvar nativeCodeString = '[native code]';\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","'use strict';\n\nvar reactIs = require('react-is');\n\n/**\n * Copyright 2015, Yahoo! Inc.\n * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n */\nvar REACT_STATICS = {\n  childContextTypes: true,\n  contextType: true,\n  contextTypes: true,\n  defaultProps: true,\n  displayName: true,\n  getDefaultProps: true,\n  getDerivedStateFromError: true,\n  getDerivedStateFromProps: true,\n  mixins: true,\n  propTypes: true,\n  type: true\n};\nvar KNOWN_STATICS = {\n  name: true,\n  length: true,\n  prototype: true,\n  caller: true,\n  callee: true,\n  arguments: true,\n  arity: true\n};\nvar FORWARD_REF_STATICS = {\n  '$$typeof': true,\n  render: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true\n};\nvar MEMO_STATICS = {\n  '$$typeof': true,\n  compare: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true,\n  type: true\n};\nvar TYPE_STATICS = {};\nTYPE_STATICS[reactIs.ForwardRef] = FORWARD_REF_STATICS;\nTYPE_STATICS[reactIs.Memo] = MEMO_STATICS;\n\nfunction getStatics(component) {\n  // React v16.11 and below\n  if (reactIs.isMemo(component)) {\n    return MEMO_STATICS;\n  } // React v16.12 and above\n\n\n  return TYPE_STATICS[component['$$typeof']] || REACT_STATICS;\n}\n\nvar defineProperty = Object.defineProperty;\nvar getOwnPropertyNames = Object.getOwnPropertyNames;\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar getPrototypeOf = Object.getPrototypeOf;\nvar objectPrototype = Object.prototype;\nfunction hoistNonReactStatics(targetComponent, sourceComponent, blacklist) {\n  if (typeof sourceComponent !== 'string') {\n    // don't hoist over string (html) components\n    if (objectPrototype) {\n      var inheritedComponent = getPrototypeOf(sourceComponent);\n\n      if (inheritedComponent && inheritedComponent !== objectPrototype) {\n        hoistNonReactStatics(targetComponent, inheritedComponent, blacklist);\n      }\n    }\n\n    var keys = getOwnPropertyNames(sourceComponent);\n\n    if (getOwnPropertySymbols) {\n      keys = keys.concat(getOwnPropertySymbols(sourceComponent));\n    }\n\n    var targetStatics = getStatics(targetComponent);\n    var sourceStatics = getStatics(sourceComponent);\n\n    for (var i = 0; i < keys.length; ++i) {\n      var key = keys[i];\n\n      if (!KNOWN_STATICS[key] && !(blacklist && blacklist[key]) && !(sourceStatics && sourceStatics[key]) && !(targetStatics && targetStatics[key])) {\n        var descriptor = getOwnPropertyDescriptor(sourceComponent, key);\n\n        try {\n          // Avoid failures from read-only properties\n          defineProperty(targetComponent, key, descriptor);\n        } catch (e) {}\n      }\n    }\n  }\n\n  return targetComponent;\n}\n\nmodule.exports = hoistNonReactStatics;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"ajg--G7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidebar\":\"atVqIi\",\"tool\":\"btVqIi\",\"isActive\":\"ctVqIi\",\"upDown\":\"dtVqIi\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sketch\":\"a7iVXO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"a0Vd4--\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"colorContainer\":\"aFAjQC\",\"color\":\"bFAjQC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tool\":\"aOQK--E\",\"active\":\"bOQK--E\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"undoRedoBar\":\"avpLPM\"};","'use strict'\n\nconst _global =\n  typeof self !== 'undefined'\n    ? self\n    : typeof window !== 'undefined'\n    ? window\n    : /* otherwise */ undefined\n\nif (!_global) {\n  throw new Error(\n    `Unable to find global scope. Are you sure this is running in the browser?`\n  )\n}\n\nif (!_global.AbortController) {\n  throw new Error(\n    `Could not find \"AbortController\" in the global scope. You need to polyfill it first`\n  )\n}\n\nmodule.exports.AbortController = _global.AbortController","/** @license React v16.13.1\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var b=\"function\"===typeof Symbol&&Symbol.for,c=b?Symbol.for(\"react.element\"):60103,d=b?Symbol.for(\"react.portal\"):60106,e=b?Symbol.for(\"react.fragment\"):60107,f=b?Symbol.for(\"react.strict_mode\"):60108,g=b?Symbol.for(\"react.profiler\"):60114,h=b?Symbol.for(\"react.provider\"):60109,k=b?Symbol.for(\"react.context\"):60110,l=b?Symbol.for(\"react.async_mode\"):60111,m=b?Symbol.for(\"react.concurrent_mode\"):60111,n=b?Symbol.for(\"react.forward_ref\"):60112,p=b?Symbol.for(\"react.suspense\"):60113,q=b?\nSymbol.for(\"react.suspense_list\"):60120,r=b?Symbol.for(\"react.memo\"):60115,t=b?Symbol.for(\"react.lazy\"):60116,v=b?Symbol.for(\"react.block\"):60121,w=b?Symbol.for(\"react.fundamental\"):60117,x=b?Symbol.for(\"react.responder\"):60118,y=b?Symbol.for(\"react.scope\"):60119;\nfunction z(a){if(\"object\"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;\nexports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};\nexports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||\"object\"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","const Scope = {\n    REQUEST: 'request',\n    SINGLETON: 'singleton',\n};\nconst Errors = {\n    NOT_FOUND: 'NotFound',\n    CIRCULAR_DEP: 'CircularDep',\n    REQUIRE_MULTI: 'RequireMulti',\n    MIXED_MULTI: 'MixedMulti',\n    WRONG_FORMAT: 'WrongFormat',\n};\n\nconst createError = (message, additional) => {\n    const err = new Error(message);\n    return Object.assign(err, {\n        ...additional,\n        stack: additional.stack ? `${err.stack}\\n---- caused by: ----\\n${additional.stack}` : err.stack,\n    });\n};\n\n/**\n * @private\n */\nconst TOKENS_SYMBOL_BY_STRING_NAME_REGISTRY = new Map();\n/**\n * @private\n */\nfunction tokenToString(token) {\n    return token.toString().replace(/^Symbol\\((.+)\\)$/, '$1');\n}\nclass TokenClass {\n    constructor(name, options = {}) {\n        this.isToken = true;\n        // for potential breaking changes, not very useful at this moment\n        this.isModernToken = true;\n        this.name = name ? Symbol.for(name) : Symbol('token');\n        this.options = options;\n        if (process.env.NODE_ENV === 'development') {\n            if (name) {\n                if (!TOKENS_SYMBOL_BY_STRING_NAME_REGISTRY.has(name)) {\n                    TOKENS_SYMBOL_BY_STRING_NAME_REGISTRY.set(name, this.name);\n                }\n                else {\n                    console.error(`Token with name \"${name}\" already created!`);\n                }\n            }\n        }\n    }\n    /**\n     * toString будет использоваться для получения индитификатора токена\n     */\n    toString() {\n        return tokenToString(this.name);\n    }\n}\nfunction createToken(name, options) {\n    return new TokenClass(name, options);\n}\n/**\n * Helper function to declare a optional token dependency\n */\nfunction optional(token) {\n    return { token, optional: true };\n}\n\nconst DI_TOKEN = /* #__PURE__*/ createToken('di');\n\n/**\n * Маркер, который указывает, что значение еще не создано. Для проверки по ссылке.\n */\nconst NOT_YET = '__NOT_YET__MARKER';\n/**\n * Маркер, который указывает, что создание значения находится в процессе вызова.\n *\n * И если будет найдено это значение при создании дочерних зависимостей, то значит у нас\n * кольцевая зависимость\n */\nconst CIRCULAR = '__CIRCULAR__MARKER';\nfunction tokenToKey(token) {\n    return token.isModernToken ? token.name : Symbol.for(token.toString());\n}\n/* eslint-disable no-underscore-dangle */\nfunction proxyHydrationError(token, e) {\n    const name = tokenToString(token);\n    if (!e.__extendedWithStack) {\n        e.__extendedWithStack = true;\n        e.message = `${e.message} at \"${name}\"`;\n    }\n    else {\n        e.message += ` < ${name}`;\n    }\n    if (Object.hasOwnProperty.call(e, 'stack') && typeof e.stack === 'string') {\n        e.stack = e.stack.replace(/^.+\\n/, `${e.name}: ${e.message}\\n`);\n    }\n    throw e;\n}\n/* eslint-enable no-underscore-dangle */\nfunction checkIfProviderMatchToken(provider) {\n    if (typeof provider.provide === 'string') {\n        return;\n    }\n    const tokenOptions = provider.provide.options;\n    if (!provider.provide.isModernToken && tokenOptions && tokenOptions.multi && !provider.multi) {\n        throw createError(`Token ${provider.provide.toString()} require multi providers`, {\n            type: Errors.REQUIRE_MULTI,\n            stack: provider.__stack,\n        });\n    }\n}\nfunction checkValidateInterfaceProvider(provider) {\n    if (!provider ||\n        !provider.provide ||\n        // @ts-ignore\n        (provider.useValue === undefined &&\n            // @ts-ignore\n            provider.useClass === undefined &&\n            // @ts-ignore\n            provider.useFactory === undefined)) {\n        throw createError(`Invalid provider. Check what is passed to the DI. Current value is not a provider: ${JSON.stringify(provider, (k, v) => {\n            return v === undefined ? 'undefined' : v;\n        })}`, {\n            type: Errors.WRONG_FORMAT,\n            stack: provider === null || provider === void 0 ? void 0 : provider.__stack,\n        });\n    }\n}\nfunction checkFound(record, token) {\n    if (record === undefined) {\n        const name = tokenToString(token);\n        throw createError(`Token not found \"${name}\"`, {\n            type: Errors.NOT_FOUND,\n        });\n    }\n}\nfunction checkCircularDeps(record, token, value) {\n    if (value === CIRCULAR) {\n        const name = tokenToString(token);\n        throw createError(`Circular dep for \"${name}\"`, {\n            type: Errors.CIRCULAR_DEP,\n            stack: record.stack,\n        });\n    }\n}\n// eslint-disable-next-line max-params\nfunction makeRecord(factory, resolvedDeps, scope, multi, stack) {\n    return {\n        factory,\n        resolvedDeps,\n        scope,\n        multi: multi ? [] : undefined,\n        stack,\n    };\n}\nfunction providerToRecord(provider) {\n    let factory;\n    let resolvedDeps;\n    let scope = Scope.REQUEST;\n    if ('useFactory' in provider) {\n        factory = (deps) => provider.useFactory(deps);\n        if ('deps' in provider) {\n            resolvedDeps = provider.deps;\n        }\n        if (provider.scope) {\n            scope = provider.scope;\n        }\n    }\n    else if ('useClass' in provider) {\n        // eslint-disable-next-line new-cap\n        factory = (deps) => new provider.useClass(deps);\n        if ('deps' in provider) {\n            resolvedDeps = provider.deps;\n        }\n        if (provider.scope) {\n            scope = provider.scope;\n        }\n    }\n    return makeRecord(factory, resolvedDeps, scope, false, provider.__stack);\n}\nfunction providerToValue(provider) {\n    if ('useValue' in provider) {\n        return provider.useValue;\n    }\n    return NOT_YET;\n}\nclass Container {\n    constructor(additionalProviders, fallback) {\n        /**\n         * Список c записями инстансов провайдеров\n         */\n        this.records = new Map();\n        this.recordValues = new Map();\n        if (additionalProviders) {\n            additionalProviders.forEach((provider) => this.register(provider));\n        }\n        this.fallback = fallback;\n        this.register({ provide: DI_TOKEN, useValue: this });\n    }\n    get(tokenORObject) {\n        var _a, _b;\n        let token;\n        let optional = false;\n        let multi = false;\n        if (typeof tokenORObject === 'string') {\n            token = tokenORObject;\n        }\n        else if ('token' in tokenORObject) {\n            token = tokenORObject.token;\n            optional = tokenORObject.optional;\n            multi = ((_a = token.options) === null || _a === void 0 ? void 0 : _a.multi) || false;\n        }\n        else {\n            token = tokenORObject;\n        }\n        token = tokenToKey(token);\n        const record = this.getRecord(token);\n        if (!record && ((_b = this.fallback) === null || _b === void 0 ? void 0 : _b.getRecord(token))) {\n            return this.fallback.get(tokenORObject);\n        }\n        if (!record && optional) {\n            // return empty array for optional multi token\n            if (multi) {\n                return [];\n            }\n            // for legacy string tokens we cannot know if the token is multi or not\n            return null;\n        }\n        checkFound(record, token);\n        return this.hydrate(record, token, optional);\n    }\n    getOfDeps(deps) {\n        const result = {};\n        for (const key in deps) {\n            if (Object.prototype.hasOwnProperty.call(deps, key)) {\n                result[key] = this.get(deps[key]);\n            }\n        }\n        return result;\n    }\n    getRecord(token) {\n        const record = this.records.get(token);\n        return record;\n    }\n    has(token) {\n        return !!this.getRecord(tokenToKey(token));\n    }\n    borrowToken(from, token) {\n        const tokenKey = tokenToKey(token);\n        if (!this.getRecord(tokenKey)) {\n            const record = from.getRecord(tokenKey);\n            if (record) {\n                this.records.set(tokenKey, record);\n                this.recordValues.set(record, NOT_YET);\n            }\n        }\n    }\n    getValue(record) {\n        return this.recordValues.get(record);\n    }\n    register(provider) {\n        if (process.env.NODE_ENV !== 'production') {\n            checkValidateInterfaceProvider(provider);\n        }\n        checkIfProviderMatchToken(provider);\n        return this.processProvider(provider);\n    }\n    /**\n     * Обработка различных видов провайдеров\n     */\n    processProvider(provider) {\n        var _a;\n        const token = tokenToKey(provider.provide);\n        const record = providerToRecord(provider);\n        const value = providerToValue(provider);\n        if ((provider.provide.isModernToken && ((_a = provider.provide.options) === null || _a === void 0 ? void 0 : _a.multi)) || provider.multi) {\n            // Сначала идем за multiRecord, так как он может быть уже создан\n            let multiRecord = this.getRecord(token);\n            if (multiRecord) {\n                // Смешанный провайдер\n                if (multiRecord.multi === undefined) {\n                    throw createError(`Mixed multi-provider for ${tokenToString(token)}`, {\n                        type: Errors.MIXED_MULTI,\n                        stack: provider.__stack,\n                    });\n                }\n            }\n            else {\n                multiRecord = makeRecord(undefined, {}, provider.scope || Scope.REQUEST, true, provider.__stack);\n                this.records.set(token, multiRecord);\n                this.recordValues.set(multiRecord, NOT_YET);\n            }\n            multiRecord.multi.push(record);\n        }\n        else {\n            this.records.set(token, record);\n        }\n        this.recordValues.set(record, value);\n    }\n    hydrateDeps(record) {\n        return this.getOfDeps(record.resolvedDeps);\n    }\n    hydrate(record, token, optional) {\n        let value = this.getValue(record);\n        checkCircularDeps(record, token, value);\n        if (value !== NOT_YET) {\n            return value;\n        }\n        if (record.multi) {\n            this.recordValues.set(record, CIRCULAR);\n            // мульти провайдеры не могут быть optional\n            value = record.multi.map((rec) => this.hydrate(rec, token, false));\n        }\n        else {\n            /* Устаналиваем изначально value к CIRCULAR, для последующего нахождения цикла при резолве депенденси */\n            this.recordValues.set(record, CIRCULAR);\n            try {\n                value = record.factory(this.hydrateDeps(record));\n            }\n            catch (e) {\n                this.recordValues.set(record, NOT_YET);\n                if (optional && e.type === Errors.NOT_FOUND) {\n                    return null;\n                }\n                // Заполняем ошибку списком токенов модулей, которые находятся в цепочке инициализации.\n                // Вызовы тут рекурсивные поэтому на каждом уровне try/catch будем дописывать обрабатываемый токен.\n                proxyHydrationError(token, Object.assign(e, {\n                    stack: !record.stack || /---- caused by: ----/g.test(e.stack)\n                        ? e.stack\n                        : `${e.stack}\\n---- caused by: ----\\n${record.stack || ''}`,\n                }));\n            }\n        }\n        this.recordValues.set(record, value);\n        return value;\n    }\n}\n\nconst IS_DI_CHILD_CONTAINER_TOKEN = \n/* #__PURE__*/ createToken('isDiChildContainer');\nclass ChildContainer extends Container {\n    constructor(root, fallback) {\n        super(undefined, fallback);\n        this.root = root;\n        this.register({ provide: DI_TOKEN, useValue: this });\n        this.register({ provide: IS_DI_CHILD_CONTAINER_TOKEN, useValue: true });\n    }\n    /**\n     * Замена базовой реализации getRecord, которая инициализует children провайдеры внутри контейнера\n     * При этом root провайдеры берет из корневого\n     * @param token\n     */\n    getRecord(token) {\n        const record = super.getRecord(token);\n        if (record) {\n            return record;\n        }\n        return this.root.getRecord(token);\n    }\n    getValue(record) {\n        if (this.recordValues.has(record)) {\n            return this.recordValues.get(record);\n        }\n        if (record.scope === Scope.SINGLETON || !record.factory) {\n            return this.root.getValue(record);\n        }\n        return NOT_YET;\n    }\n    /**\n     * Замена базовой реализации hydrateDeps, которая резолвит зависимости относительно текущего контейнера,\n     * если у записи выставлен scope === Scope.REQUEST, и относительно родительского иначе\n     * @param record\n     */\n    hydrateDeps(record) {\n        if (record.scope === Scope.REQUEST) {\n            return super.hydrateDeps(record);\n        }\n        return super.hydrateDeps.call(this.root, record);\n    }\n    hydrate(record, token, optional) {\n        if (record.scope === Scope.REQUEST) {\n            return super.hydrate(record, token, optional);\n        }\n        return super.hydrate.call(this.root, record, token, optional);\n    }\n}\n\nfunction createContainer(providers) {\n    return new Container(providers);\n}\n\nconst MODULE_PARAMETERS$1 = '_module_parameters_';\nfunction Module({ providers, imports, deps = {}, }) {\n    return (target) => {\n        return Object.assign(target, {\n            [MODULE_PARAMETERS$1]: {\n                providers,\n                deps,\n                imports: imports,\n                name: target.name,\n                // Math.random since it is possible to use several versions of the library at the same time\n                id: `${target.name}-${Math.random()}`,\n            },\n        });\n    };\n}\n\nconst isExtendedModule = (module) => {\n    return !!module.mainModule;\n};\n\nconst getModuleParameters = (module) => {\n    let moduleParameters;\n    if (isExtendedModule(module)) {\n        const main = module.mainModule[MODULE_PARAMETERS$1];\n        moduleParameters = { ...main };\n        moduleParameters.providers = moduleParameters.providers.concat(module.providers || []);\n        // imports not a required parameter\n        const importsParam = moduleParameters.imports || [];\n        moduleParameters.imports = importsParam.concat(module.imports || []);\n    }\n    else {\n        moduleParameters = module[MODULE_PARAMETERS$1];\n    }\n    return moduleParameters;\n};\n\nconst isValidModule = (module) => {\n    // If we have undefined or null\n    if (Boolean(module) === false)\n        return false;\n    // If it is a module\n    if (MODULE_PARAMETERS$1 in module)\n        return true;\n    // If it is a module that extends another module\n    if ('mainModule' in module)\n        return isValidModule(module.mainModule);\n    return false;\n};\n\nconst INVALID_MODULE_ERROR = 'An invalid module was passed in the list of modules';\nconst walkOfModules = (modules) => {\n    const result = [];\n    const modulesIdInitialized = new Set();\n    const modulesNameInitialized = new Set();\n    const innerWalkOfModules = (module) => {\n        if (!isValidModule(module)) {\n            throw new Error(INVALID_MODULE_ERROR);\n        }\n        const moduleParameters = getModuleParameters(module);\n        if (!modulesIdInitialized.has(moduleParameters.id)) {\n            if (process.env.NODE_ENV !== 'production') {\n                if (modulesNameInitialized.has(moduleParameters.name)) {\n                    // eslint-disable-next-line no-console\n                    console.error(`Module ${moduleParameters.id} has already been initialized. Most likely there are duplicate dependencies in the project:`, module, moduleParameters);\n                }\n            }\n            modulesIdInitialized.add(moduleParameters.id);\n            modulesNameInitialized.add(moduleParameters.name);\n            // If the module imports other modules, then initialize their providers\n            if (moduleParameters.imports) {\n                moduleParameters.imports.forEach((item) => {\n                    innerWalkOfModules(item);\n                });\n            }\n            result.push(module);\n        }\n    };\n    modules.forEach((mod) => {\n        innerWalkOfModules(mod);\n    });\n    return result;\n};\n\nconst initContainer = ({ modules = [], initialProviders = [], providers = [], } = {}) => {\n    const di = createContainer();\n    const modulesToResolve = new Set();\n    const walkOfProviders = (providers) => {\n        providers.forEach((provide) => {\n            di.register(provide);\n        });\n    };\n    const resolveModuleDeps = (module) => {\n        const { deps } = module[MODULE_PARAMETERS$1];\n        if (deps) {\n            return di.getOfDeps(deps);\n        }\n    };\n    const resolveModules = () => {\n        modulesToResolve.forEach((ModuleToResolve) => {\n            // eslint-disable-next-line no-new\n            new ModuleToResolve(resolveModuleDeps(ModuleToResolve));\n        });\n    };\n    walkOfProviders(initialProviders);\n    walkOfModules(modules).forEach((mod) => {\n        const moduleParameters = getModuleParameters(mod);\n        modulesToResolve.add(isExtendedModule(mod) ? mod.mainModule : mod);\n        walkOfProviders(moduleParameters.providers);\n    });\n    walkOfProviders(providers);\n    resolveModules();\n    return di;\n};\n\nfunction createChildContainer(container, providers) {\n    const childContainer = new ChildContainer(container);\n    if (providers) {\n        providers.forEach((provider) => {\n            childContainer.register(provider);\n        });\n    }\n    return childContainer;\n}\n\n// Исключительно для тайпчека переданного описания провайдера\nfunction provide(descr) {\n    return descr;\n}\n\nconst MODULE_PARAMETERS = '_module_parameters_';\nfunction declareModule({ name, providers = [], imports = [], \n// @ts-expect-error\nextend = {}, }) {\n    // use class for backward compatibility, will be called with new\n    class DeclaredModule {\n    }\n    // @ts-expect-error\n    const extensionObject = {};\n    for (const key in extend) {\n        const method = extend[key];\n        // @ts-expect-error\n        extensionObject[key] = (...args) => {\n            return {\n                mainModule: DeclaredModule,\n                providers: method(...args),\n            };\n        };\n    }\n    Object.assign(DeclaredModule, {\n        [MODULE_PARAMETERS]: {\n            name,\n            // Math.random since it is possible to use several versions of the library at the same time\n            id: `${name}-${Math.random()}`,\n            providers,\n            imports,\n        },\n    }, extensionObject);\n    return DeclaredModule;\n}\n\nexport { ChildContainer, Container, DI_TOKEN, INVALID_MODULE_ERROR, IS_DI_CHILD_CONTAINER_TOKEN, MODULE_PARAMETERS$1 as MODULE_PARAMETERS, Module, Scope, createChildContainer, createContainer, createToken, declareModule, getModuleParameters, initContainer, isExtendedModule, optional, provide, walkOfModules };\n","const perf = typeof performance === 'object' && performance &&\n  typeof performance.now === 'function' ? performance : Date\n\nconst isPosInt = n => n && n === Math.floor(n) && n > 0 && isFinite(n)\n\n/* istanbul ignore next - This is a little bit ridiculous, tbh.\n * The maximum array length is 2^32-1 or thereabouts on most JS impls.\n * And well before that point, you're caching the entire world, I mean,\n * that's ~32GB of just integers for the next/prev links, plus whatever\n * else to hold that many keys and values.  Just filling the memory with\n * zeroes at init time is brutal when you get that big.\n * But why not be complete?\n * Maybe in the future, these limits will have expanded. */\nconst getUintArray = max => max <= Math.pow(2, 8) ? Uint8Array\n: max <= Math.pow(2, 16) ? Uint16Array\n: max <= Math.pow(2, 32) ? Uint32Array\n: max <= Number.MAX_SAFE_INTEGER ? ZeroArray\n: null\n\nclass ZeroArray extends Array {\n  constructor (size) {\n    super(size)\n    this.fill(0)\n  }\n}\n\nclass Stack {\n  constructor (max) {\n    if (max === 0) {\n      return []\n    }\n    const UintArray = getUintArray(max)\n    this.heap = new UintArray(max)\n    this.length = 0\n  }\n  push (n) {\n    this.heap[this.length++] = n\n  }\n  pop () {\n    return this.heap[--this.length]\n  }\n}\n\nclass LRUCache {\n  constructor (options = {}) {\n    const {\n      max = 0,\n      ttl,\n      ttlResolution = 1,\n      updateAgeOnGet,\n      allowStale,\n      maxAge,\n      stale,\n    } = options\n\n    this.max = max\n\n    const UintArray = max ? getUintArray(max) : Array\n\n    if (process.env.NODE_ENV === 'development') {\n      if (max !== 0 && !isPosInt(max)) {\n        throw new TypeError('max option must be a nonnegative integer')\n      }\n\n      if (!UintArray) {\n        throw new Error('invalid max value: ' + max)\n      }\n    }\n\n    this.keyMap = new Map()\n    this.keyList = new Array(max).fill(null)\n    this.valList = new Array(max).fill(null)\n    this.next = new UintArray(max)\n    this.prev = new UintArray(max)\n    this.head = 0\n    this.tail = 0\n    this.free = new Stack(max)\n    this.initialFill = 1\n    this.size = 0\n\n    this.allowStale = !!allowStale || !!stale\n    this.updateAgeOnGet = !!updateAgeOnGet\n    this.ttlResolution = ttlResolution\n    this.ttl = ttl || maxAge || 0\n    if (this.ttl) {\n      if (process.env.NODE_ENV === 'development') {\n        if (!isPosInt(this.ttl)) {\n          throw new TypeError('ttl must be a positive integer if specified')\n        }\n      }\n      this.initializeTTLTracking()\n    }\n  }\n\n  initializeTTLTracking () {\n    this.ttls = new ZeroArray(this.max)\n    this.starts = new ZeroArray(this.max)\n\n    this.setItemTTL = (index, ttl) => {\n      this.starts[index] = ttl !== 0 ? perf.now() : 0\n      this.ttls[index] = ttl\n    }\n\n    this.updateItemAge = (index) => {\n      this.starts[index] = this.ttls[index] !== 0 ? perf.now() : 0\n    }\n\n    // debounce calls to perf.now() to 1s so we're not hitting\n    // that costly call repeatedly.\n    let cachedNow = 0\n    const getNow = () => {\n      const n = perf.now()\n      if (this.ttlResolution > 0) {\n        cachedNow = n\n        const t = setTimeout(() => cachedNow = 0, this.ttlResolution)\n        /* istanbul ignore else - not available on all platforms */\n        if (t.unref) {\n          t.unref()\n        }\n      }\n      return n\n    }\n\n    this.isStale = (index) => {\n      return this.ttls[index] !== 0 && this.starts[index] !== 0 &&\n        ((cachedNow || getNow()) - this.starts[index] > this.ttls[index])\n    }\n  }\n  updateItemAge (index) {}\n  setItemTTL (index, ttl) {}\n  isStale (index) { return false }\n\n  set (k, v, {\n    ttl = this.ttl,\n  } = {}) {\n    let index = this.size === 0 ? undefined : this.keyMap.get(k)\n    if (index === undefined) {\n      // addition\n      index = this.newIndex()\n      this.keyList[index] = k\n      this.valList[index] = v\n      this.keyMap.set(k, index)\n      this.next[this.tail] = index\n      this.prev[index] = this.tail\n      this.tail = index\n      this.size ++\n    } else {\n      // update\n      const oldVal = this.valList[index]\n      if (v !== oldVal) {\n        this.valList[index] = v\n      }\n      this.moveToTail(index)\n    }\n    if (ttl !== 0 && this.ttl === 0 && !this.ttls) {\n      this.initializeTTLTracking()\n    }\n\n    this.setItemTTL(index, ttl)\n    return this\n  }\n\n  newIndex () {\n    if (this.size === 0) {\n      return this.tail\n    }\n    if (this.size === this.max && this.max !== 0) {\n      return this.evict(false)\n    }\n    if (this.free.length !== 0) {\n      return this.free.pop()\n    }\n    // initial fill, just keep writing down the list\n    return this.initialFill++\n  }\n\n  pop () {\n    if (this.size) {\n      const val = this.valList[this.head]\n      this.evict(true)\n      return val\n    }\n  }\n\n  evict (free) {\n    const head = this.head\n    const k = this.keyList[head]\n    // if we aren't about to use the index, then null these out\n    if (free) {\n      this.keyList[head] = null\n      this.valList[head] = null\n      this.free.push(head)\n    }\n    this.head = this.next[head]\n    this.keyMap.delete(k)\n    this.size --\n    return head\n  }\n\n  has (k) {\n    const index = this.keyMap.get(k)\n    if (index !== undefined) {\n      if (!this.isStale(index)) {\n        return true\n      }\n    }\n    return false\n  }\n\n  // like get(), but without any LRU updating or TTL expiration\n  peek (k, { allowStale = this.allowStale } = {}) {\n    const index = this.keyMap.get(k)\n    if (index !== undefined && (allowStale || !this.isStale(index))) {\n      return this.valList[index]\n    }\n  }\n\n  get (k, {\n    allowStale = this.allowStale,\n    updateAgeOnGet = this.updateAgeOnGet,\n  } = {}) {\n    const index = this.keyMap.get(k)\n    if (index !== undefined) {\n      const value = this.valList[index]\n      if (this.isStale(index)) {\n        this.delete(k)\n        return allowStale ? value : undefined\n      } else {\n        this.moveToTail(index)\n        if (updateAgeOnGet) {\n          this.updateItemAge(index)\n        }\n        return value\n      }\n    }\n  }\n\n  connect (p, n) {\n    this.prev[n] = p\n    this.next[p] = n\n  }\n\n  moveToTail (index) {\n    // if tail already, nothing to do\n    // if head, move head to next[index]\n    // else\n    //   move next[prev[index]] to next[index] (head has no prev)\n    //   move prev[next[index]] to prev[index]\n    // prev[index] = tail\n    // next[tail] = index\n    // tail = index\n    if (index !== this.tail) {\n      if (index === this.head) {\n        this.head = this.next[index]\n      } else {\n        this.connect(this.prev[index], this.next[index])\n      }\n      this.connect(this.tail, index)\n      this.tail = index\n    }\n  }\n\n  delete (k) {\n    let deleted = false\n    if (this.size !== 0) {\n      const index = this.keyMap.get(k)\n      if (index !== undefined) {\n        deleted = true\n        if (this.size === 1) {\n          this.clear()\n        } else {\n          this.keyMap.delete(k)\n          this.keyList[index] = null\n          this.valList[index] = null\n          if (index === this.tail) {\n            this.tail = this.prev[index]\n          } else if (index === this.head) {\n            this.head = this.next[index]\n          } else {\n            this.next[this.prev[index]] = this.next[index]\n            this.prev[this.next[index]] = this.prev[index]\n          }\n          this.size --\n          this.free.push(index)\n        }\n      }\n    }\n    return deleted\n  }\n\n  clear () {\n    this.keyMap.clear()\n    this.valList.fill(null)\n    this.keyList.fill(null)\n    if (this.ttls) {\n      this.ttls.fill(0)\n      this.starts.fill(0)\n    }\n    this.head = 0\n    this.tail = 0\n    this.initialFill = 1\n    this.free.length = 0\n    this.size = 0\n  }\n}\n\nmodule.exports = LRUCache\n","import { useRef, useLayoutEffect, useEffect } from 'react';\nimport shallowEqual from '@tinkoff/utils/is/shallowEqual';\n\nconst useShallowEqual = (params) => {\n    const ref = useRef(params);\n    if (!shallowEqual(ref.current, params)) {\n        ref.current = params;\n    }\n    return ref.current;\n};\n\n// React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser. We need useLayoutEffect to ensure the store\n// subscription callback always has the selector from the latest render commit\n// available, otherwise a store update may happen between render and the effect,\n// which may cause missed updates; we also must ensure the store subscription\n// is created synchronously, otherwise a store update may occur before the\n// subscription is created and an inconsistent state may be observed\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\nexport { useIsomorphicLayoutEffect, useShallowEqual };\n","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar isArray = require('../is/array');\n\nvar isArrayLike = require('../is/arrayLike');\n\nvar slice = require('./slice');\n\n/**\n * Returns the result of concatenating the given arrays or strings.\n *\n * @param {Array|String} a The first list\n * @param {Array|String} b The second list\n * @return {Array|String} A list consisting of the elements of `firstList` followed by the elements of\n * `secondList`.\n *\n * @example\n *\n *      concat('ABC', 'DEF'); // 'ABCDEF'\n *      concat([4, 5, 6], [1, 2, 3]); //=> [4, 5, 6, 1, 2, 3]\n *      concat([], []); //=> []\n */\nmodule.exports = curryN(2, function (a, b) {\n  if (a === void 0) {\n    a = [];\n  }\n\n  if (b === void 0) {\n    b = [];\n  }\n\n  if (isArray(a)) {\n    return a.concat(b);\n  }\n\n  if (isArrayLike(a)) {\n    var resultArr = slice(0, a.length, a);\n\n    for (var i = 0; i < b.length; i++) {\n      resultArr.push(b[i]);\n    }\n\n    return resultArr;\n  }\n\n  return a + b;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar indexOf = require('./indexOf');\n\n/**\n * Returns the array of all elements in the first array not\n * contained in the second array.\n *\n * @param {Array} a The first array.\n * @param {Array} b The second array.\n * @return {Array} The elements in `a` that are not in `b`.\n * @example\n *\n *      difference([1,2,3,4], [7,6,5,4,3]); //=> [1,2]\n *      difference([7,6,5,4,3], [1,2,3,4]); //=> [7,6,5]\n */\nmodule.exports = curryN(2, function (a, b) {\n  if (a === void 0) {\n    a = [];\n  }\n\n  if (b === void 0) {\n    b = [];\n  }\n\n  var result = [];\n\n  for (var i = 0; i < a.length; i++) {\n    if (indexOf(a[i], b) < 0) {\n      result.push(a[i]);\n    }\n  }\n\n  return result;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Iterate over an input `list`, calling a provided function `fn` for each\n * element in the list.\n *\n * @param {Function} fn The function to invoke. Receives three argument: `value`, `index`, `arr`.\n * @param {Array} arr The list to iterate over.\n * @example\n *\n *      var printXPlusFive = x => console.log(x + 5);\n *      each(printXPlusFive, [1, 2, 3]);\n *      // logs 6\n *      // logs 7\n *      // logs 8\n */\nmodule.exports = curryN(2, function (fn, arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  for (var i = 0; i < arr.length; i++) {\n    fn(arr[i], i, arr);\n  }\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Returns the first element of the list which matches the predicate, or\n * `undefined` if no element matches.\n *\n * @param {Function} fn The predicate function used to determine if the element is the\n *        desired one.\n * @param {Array} arr The array to consider.\n * @return {Object} The element found, or `undefined`.\n * @example\n *\n *      var xs = [{a: 1}, {a: 2}, {a: 3}];\n *      find(x => x.a === 2)(xs); //=> {a: 2}\n *      find(x => x.a === 4)(xs); //=> undefined\n */\nmodule.exports = curryN(2, function (fn, arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  for (var i = 0; i < arr.length; i++) {\n    if (fn(arr[i], i, arr)) {\n      return arr[i];\n    }\n  }\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Returns the index of the first element of the list which matches the\n * predicate, or `-1` if no element matches.\n *\n * @param {Function} fn The predicate function used to determine if the element is the\n * desired one.\n * @param {Array} arr The array to consider.\n * @return {Number} The index of the element found, or `-1`.\n * @example\n *\n *      var xs = [{a: 1}, {a: 2}, {a: 3}];\n *      findIndex(x => x.a === 2)(xs); //=> 1\n *      findIndex(x => x.a === 4)(xs); //=> -1\n */\nmodule.exports = curryN(2, function (fn, arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  for (var i = 0; i < arr.length; i++) {\n    if (fn(arr[i], i, arr)) {\n      return i;\n    }\n  }\n\n  return -1;\n});","\"use strict\";\n\nvar isArrayLike = require('../is/arrayLike');\n\n/**\n * Returns a new list by pulling every item out of it (and all its sub-arrays)\n * and putting them in a new array, depth-first.\n *\n * @param {Array} arr The array to consider.\n * @return {Array} The flattened list.\n * @example\n *\n *      flatten([1, 2, [3, 4], 5, [6, [7, 8, [9, [10, 11], 12]]]]);\n *      //=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\n */\nvar flatten = function flatten(arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  var result = [];\n\n  for (var i = 0; i < arr.length; i++) {\n    var a = arr[i];\n\n    if (isArrayLike(a)) {\n      var nested = flatten(a);\n\n      for (var j = 0; j < nested.length; j++) {\n        result.push(nested[j]);\n      }\n    } else {\n      result.push(a);\n    }\n  }\n\n  return result;\n};\n\nmodule.exports = flatten;","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar isString = require('../is/string');\n\n/**\n * Returns the position of the first occurrence of an item in an array, or -1\n * if the item is not included in the array.\n *\n * @param {*} target The item to find.\n * @param {Array} xs The array to search in.\n * @return {Number} the index of the target, or -1 if the target is not found.\n * @example\n *\n *      indexOf(3, [1,2,3,4]); //=> 2\n *      indexOf(10, [1,2,3,4]); //=> -1\n */\nmodule.exports = curryN(2, function (target, xs) {\n  if (xs === void 0) {\n    xs = [];\n  }\n\n  if (isString(xs)) {\n    return xs.indexOf(target);\n  }\n\n  return Array.prototype.indexOf.call(xs, target);\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Creates an array of values by running each element in list through fn. The fn is invoked with three arguments:\n * (value, index, arr).\n *\n * @param {Function} fn The function to be called on every element of the input `list`.\n * @param {Array} arr The list to be iterated over.\n * @return {Array} The new list.\n * @example\n *\n *      var double = x => x * 2;\n *\n *      map(double, [1, 2, 3]); //=> [2, 4, 6]\n */\nmodule.exports = curryN(2, function (fn, arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  var len = arr.length;\n  var result = new Array(len);\n\n  for (var i = 0; i < len; i++) {\n    result[i] = fn(arr[i], i, arr);\n  }\n\n  return result;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar isString = require('../is/string');\n\n/**\n * Returns the elements of the given list or string (or object with a `slice`\n * method) from `fromIndex` (inclusive) to `toIndex` (exclusive).\n *\n * @param {Number} fromIndex The start index (inclusive).\n * @param {Number} toIndex The end index (exclusive).\n * @param {Array | String} list\n * @return {Array | String}\n * @example\n *\n *      slice(1, 3, ['a', 'b', 'c', 'd']);        //=> ['b', 'c']\n *      slice(1, Infinity, ['a', 'b', 'c', 'd']); //=> ['b', 'c', 'd']\n *      slice(0, -1, ['a', 'b', 'c', 'd']);       //=> ['a', 'b', 'c']\n *      slice(-3, -1, ['a', 'b', 'c', 'd']);      //=> ['b', 'c']\n */\nmodule.exports = curryN(3, function (fromIndex, toIndex, list) {\n  if (list === void 0) {\n    list = [];\n  }\n\n  return isString(list) ? list.slice(fromIndex, toIndex) : Array.prototype.slice.call(list, fromIndex, toIndex);\n});","\"use strict\";\n\nvar isArray = require('../is/array');\n\nvar isArrayLike = require('../is/arrayLike');\n\n/**\n * Converts val to array. If val is array return it.\n * @param {*} val\n * @return {Array}\n * @example\n *\n *      toArray([1,2,3]) // => [1,2,3]\n *      toArray(5) // => [5]\n *      toArray('test') // => ['test']\n */\nmodule.exports = function (val) {\n  if (isArray(val)) {\n    return val;\n  }\n\n  if (isArrayLike(val)) {\n    return Array.prototype.slice.call(val);\n  }\n\n  return [val];\n};","\"use strict\";\n\n/**\n * Returns unique items in array\n *\n * @param {Array} arr\n * @return {Array}\n *\n * @example\n *\n *  unique([1,2,1,2,3,4,1,2]) // => [1, 2, 3, 4]\n */\nmodule.exports = function (arr) {\n  if (arr === void 0) {\n    arr = [];\n  }\n\n  var result = [];\n\n  for (var i = 0; i < arr.length; i++) {\n    if (result.indexOf(arr[i]) === -1) {\n      result.push(arr[i]);\n    }\n  }\n\n  return result;\n};","\"use strict\";\n\nvar isArray = require('./is/array');\n\n/**\n * Create a new object/array with the own properties of the first entry merged with\n * the own properties of the others objects. If a key exists in several objects,\n * the value from the last object will be used.\n *\n * **Note** if first argument is array then result of function is array,\n * otherwise it is an object.\n *\n * @param sources\n * @example\n *\n * assign({a:1}, {b:2}) // => {a:1, b:2}\n * assign([1,2,3], [4,5]) // => [4,5,3]\n */\nmodule.exports = function () {\n  for (var _len = arguments.length, sources = new Array(_len), _key = 0; _key < _len; _key++) {\n    sources[_key] = arguments[_key];\n  }\n\n  if (isArray(sources[0])) {\n    return Object.assign.apply(Object, [[]].concat(sources));\n  }\n\n  return Object.assign.apply(Object, [{}].concat(sources));\n};","\"use strict\";\n\n/**\n * Returns a function that always returns the given value. Note that for\n * non-primitives the value returned is a reference to the original value.\n *\n * @param {*} x The value to wrap in a function\n * @return {Function}\n * @example\n *\n *      var t = always('Tee');\n *      t(); //=> 'Tee'\n */\nmodule.exports = function (x) {\n  return function () {\n    return x;\n  };\n};","\"use strict\";\n\n/**\n * Performs right-to-left function composition. The rightmost function may have\n * any arity; the remaining functions must be unary.\n *\n * **Note:** The result of compose is not automatically curried.\n *\n * @param {...Function} fns\n * @return {Function}\n * @example\n *\n *      var f = compose(x => x + 1, x => -x, Math.pow);\n *\n *      f(3, 4); // -(3^4) + 1\n */\nmodule.exports = function () {\n  for (var _len = arguments.length, fns = new Array(_len), _key = 0; _key < _len; _key++) {\n    fns[_key] = arguments[_key];\n  }\n\n  return function () {\n    var n = fns.length - 1;\n    var result = fns[n].apply(fns, arguments);\n\n    for (var i = n - 1; i >= 0; i--) {\n      result = fns[i](result);\n    }\n\n    return result;\n  };\n};","\"use strict\";\n\n/**\n * Returns a curried equivalent of the provided function, with the specified\n * arity. If `g` is `curryN(3, f)`, the\n * following are equivalent:\n *\n *   - `g(1)(2)(3)`\n *   - `g(1)(2, 3)`\n *   - `g(1, 2)(3)`\n *   - `g(1, 2, 3)`\n *\n * @param {Number} arity The arity for the returned function.\n * @param {Function} fn The function to curry.\n * @return {Function} A new, curried function.\n * @example\n *\n *      var sumArgs = (...args) => sum(args);\n *\n *      var curriedAddFourNumbers = curryN(4, sumArgs);\n *      var f = curriedAddFourNumbers(1, 2);\n *      var g = f(3);\n *      g(4); //=> 10\n */\nmodule.exports = function (arity, fn) {\n  return function curried() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (args.length >= arity) {\n      return fn.apply(this, args);\n    }\n\n    return function () {\n      for (var _len2 = arguments.length, newArgs = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        newArgs[_key2] = arguments[_key2];\n      }\n\n      return curried.apply(this, args.concat(newArgs));\n    };\n  };\n};","\"use strict\";\n\nvar curryN = require('./curryN');\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. Delayed function invocation might be cancelled by calling cancel method.\n *\n * @param {number} wait The number of milliseconds to delay.\n * @param {Function} fn The function to debounce.\n * @returns {Function} Returns the new debounced function.\n */\nmodule.exports = curryN(2, function (wait, fn) {\n  var timeout;\n\n  function f() {\n    var _this = this;\n\n    var args = arguments;\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      return fn.apply(_this, args);\n    }, // eslint-disable-line prefer-rest-params\n    wait);\n  }\n\n  f.cancel = function () {\n    return clearTimeout(timeout);\n  };\n\n  return f;\n});","\"use strict\";\n\n/**\n * A function that does nothing but return the parameter supplied to it. Good\n * as a default or placeholder function.\n *\n * @param {*} x The value to return.\n * @return {*} The input value, `x`.\n * @example\n *\n *      identity(1); //=> 1\n *\n *      const obj = {};\n *      identity(obj) === obj; //=> true\n */\nmodule.exports = function (x) {\n  return x;\n};","\"use strict\";\n\nvar curryN = require('./curryN');\n\n/**\n * Creates a function that will process either the `onTrue` or the `onFalse`\n * function depending upon the result of the `condition` predicate.\n *\n * @param {Function} condition A predicate function\n * @param {Function} onTrue A function to invoke when the `condition` evaluates to a truthy value.\n * @param {Function} onFalse A function to invoke when the `condition` evaluates to a falsy value.\n * @return {Function} A new unary function that will process either the `onTrue` or the `onFalse`\n *                    function depending upon the result of the `condition` predicate.\n * @example\n *\n *      const prop = ifElse(\n *        x => x.a,\n *        x => x.b,\n *        x => x.c\n *      );\n *      prop({ a: false, c: 2 }); //=> 2\n *      prop({ a: true, b: 1, c: 2 }); //=> 1\n */\nmodule.exports = curryN(3, function (condition, onTrue, onFalse) {\n  return function () {\n    return condition.apply(void 0, arguments) ? onTrue.apply(void 0, arguments) : onFalse.apply(void 0, arguments);\n  };\n});","\"use strict\";\n\n/**\n * This method doing nothing and returns `undefined`.\n */\nmodule.exports = function () {};","\"use strict\";\n\n/**\n * Checks if `test` is array.\n *\n * @param {*} test The value to check.\n * @returns {boolean} Returns `true` if `test` is array, else `false`.\n * @example\n *\n * isArray([]); // => true\n * isArray(null); // => false\n */\nmodule.exports = function (test) {\n  return !!test && Array.isArray(test);\n};","\"use strict\";\n\nvar isArray = require('./array');\n\nvar isString = require('./string');\n\nvar has = require('../object/has');\n\n/**\n * Checks if `test` is arrayLike (has `length` and index properties).\n *\n * @param {*} test The value to check.\n * @returns {boolean}\n * @example\n *\n * isArrayLike([]); // => true\n * isArrayLike({ 0:'a', 1: 'b', length: 2 }); // => true\n * isArrayLike(null); // => false\n */\nmodule.exports = function (test) {\n  switch (true) {\n    case isArray(test):\n      return true;\n\n    case !test:\n    case typeof test !== 'object':\n    case isString(test):\n      return false;\n\n    case test.nodeType === 1:\n      return !!test.length;\n\n    case test.length === 0:\n      return true;\n\n    case test.length > 0:\n      return has('0', test) && has(String(test.length - 1), test);\n  }\n\n  return false;\n};","\"use strict\";\n\nvar isNil = require('./nil');\n\nvar isArray = require('./array');\n\nvar isString = require('./string');\n\nvar isObject = require('./object');\n\n/**\n * Checks if `test` is empty.\n *\n * @param {*} test The value to check.\n * @returns {boolean} Returns `true` if `test` is empty, else `false`.\n * @example\n *\n * isEmpty([]); // => true\n * isEmpty(null); // => true\n * isEmpty({}); // => true\n * isEmpty(''); // => true\n * isEmpty('test'); // => false\n * isEmpty({ a: 5 }); // => false\n * isEmpty([1]); // => false\n */\nmodule.exports = function (test) {\n  switch (true) {\n    case isNil(test):\n      return true;\n\n    case isString(test):\n      return test === '';\n\n    case isArray(test):\n      return test.length === 0;\n\n    case isObject(test):\n      return Object.keys(test).length === 0;\n  }\n\n  return false;\n};","\"use strict\";\n\n/**\n * Checks if `test` is nil (null or undefined).\n *\n * @param {*} test The value to check.\n * @returns {boolean} Returns `true` if `test` is nil, else `false`.\n * @example\n *\n * isNil(undefined); // => true\n * isNil(null); // => true\n * isNil(''); // => false\n * isNil(5); // => false\n */\nmodule.exports = function (test) {\n  return test == null;\n};","\"use strict\";\n\n/**\n * Checks if `test` is object.\n *\n * @param {*} test The value to check.\n * @returns {boolean} Returns `true` if `test` is object, else `false`.\n * @example\n *\n * isObject({ a: 'test' }); // => true\n * isObject(null); // => false\n */\nmodule.exports = function (test) {\n  return test !== null && typeof test === 'object';\n};","\"use strict\";\n\nvar isReactElement = require('./reactElement');\n\nvar isReactComponent = require('./reactComponent');\n\nvar isObject = require('./object');\n\n/**\n * Returns whether a value is a plain object\n * (an object that is created using an object literal, Object.create(null) or similar).\n * Rejects anything with a custom prototype or a non-object ECMAScript type.\n * Also rejects React elements and components\n *\n * **Note:** if the host environment does not support Symbol, any object with a $$typeof\n * property is considered a React element\n *\n * @param {*} test The value to check\n * @returns {boolean} Returns `true` if `test` is a plain object, else `false`.\n * @example\n *\n * isPlainObject({ a: 'test' }); // => true\n *\n * isPlainObject(moment()); // => false\n *\n * isPlainObject(<span></span>); // => false\n */\nmodule.exports = isPlainObject;\n\nfunction isPlainObject(test) {\n  if (!isObject(test)) {\n    return false;\n  }\n\n  var prototype = Object.getPrototypeOf(test);\n\n  if (prototype === null) {\n    // objects created with Object.create(null) are still plain objects\n    return true;\n  }\n\n  if (prototype !== Object.prototype) {\n    // has a custom prototype, probably was created with a custom constructor,\n    // may contain internal data that's not meant to be accessed from outside\n    return false;\n  }\n\n  if (isReactElement(test) || isReactComponent(test)) {\n    // react elements _are_ plain objects, but we don't treat them like that\n    // (e.g. in recursive merges)\n    return false;\n  }\n\n  return true;\n}","\"use strict\";\n\nvar has = require('../object/has');\n\nvar isComponent;\n\ntry {\n  isComponent = require('react-is').isValidElementType;\n} catch (e) {}\n\nif (!isComponent) {\n  isComponent = function isComponent(test) {\n    return typeof test === 'string' || typeof test === 'function' || !!test && has('$$typeof', test);\n  };\n}\n/**\n * Returns whether a value is a valid React component\n *\n * **Note:** uses `react-is` library internally. If the host environment does not has `react-is` library,\n * any strings, function or object with $$typeof property are considered valid.\n *\n * **Note:**\n *\n * @param {*} test a reference being tested\n * @returns whether a value is a React component\n */\n\n\nmodule.exports = isComponent;","\"use strict\";\n\nvar has = require('../object/has');\n\nvar isElement;\n\ntry {\n  isElement = require('react-is').isElement;\n} catch (e) {}\n\nif (!isElement) {\n  isElement = function isElement(test) {\n    return !!test && has('$$typeof', test);\n  };\n}\n/**\n * Returns whether a value is a valid React element\n *\n * **Note:** uses `react-is` library internally. If the host environment does not has `react-is` library,\n * any object with $$typeof property is considered valid.\n *\n * **Note:**\n *\n * @param {*} test a reference being tested\n * @returns whether a value is a React element\n */\n\n\nmodule.exports = isElement;","\"use strict\";\n\nvar isObject = require('./object');\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n/**\n * Returns `true` if its arguments are equivalent is shallow equal terms, `false` otherwise.\n *\n * @param {*} test1\n * @param {*} test2\n * @return {Boolean}\n * @example\n *\n *      isShallowEqual(1, 1); //=> true\n *      isShallowEqual(1, '1'); //=> false\n *      isShallowEqual([1, 2, 3], [1, 2, 3]); //=> true\n *      isShallowEqual({ a: { b: 1 }}, { a: { b: 1 }}); //=> false\n */\n\nmodule.exports = function (test1, test2) {\n  if (test1 === test2) {\n    return true;\n  }\n\n  if (!isObject(test1) || !isObject(test2)) {\n    return false;\n  }\n\n  var keys = Object.keys(test1);\n\n  if (keys.length !== Object.keys(test2).length) {\n    return false;\n  }\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n\n    if (!hasOwnProperty.call(test2, key) || test1[key] !== test2[key]) {\n      return false;\n    }\n  }\n\n  return true;\n};","\"use strict\";\n\n/**\n * Checks if `test` is string.\n *\n * @param {*} test The value to check.\n * @returns {boolean} Returns `true` if `value` is string, else `false`.\n * @example\n *\n * isString('test'); // => true\n * isString(new String('test')); // => true\n * isString(null); // => false\n */\nmodule.exports = function (test) {\n  return typeof test === 'string' || test instanceof String;\n};","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Iterate over an input `object`, calling a provided function `fn` for each\n * key and value in the object.\n *\n * @param {Function} fn The function to invoke. Receives three argument, `value`, `key`, `obj`.\n * @param {Object} obj The object to iterate over.\n * @return {Object} The original object.\n * @example\n *\n *      var printKeyConcatValue = (value, key) => console.log(key + ':' + value);\n *      each(printKeyConcatValue, {x: 1, y: 2}); //=> {x: 1, y: 2}\n *      // logs x:1\n *      // logs y:2\n */\nmodule.exports = curryN(2, function (fn, obj) {\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      fn(obj[key], key, obj);\n    }\n  }\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Returns whether or not an object has an own property with the specified name\n *\n * @param {String} prop The name of the property to check for.\n * @param {Object} obj The object to query.\n * @return {Boolean} Whether the property exists.\n * @example\n *\n *      var hasName = has('name');\n *      hasName({name: 'alice'});   //=> true\n *      hasName({name: 'bob'});     //=> true\n *      hasName({});                //=> false\n */\nmodule.exports = curryN(2, function (prop, obj) {\n  return obj != null && Object.prototype.hasOwnProperty.call(obj, prop);\n});","\"use strict\";\n\nvar isObject = require('../is/object');\n\n/**\n * Returns a list containing the names of all the enumerable own properties of\n * the supplied object.\n * Note that the order of the output array is not guaranteed to be consistent\n * across different JS platforms.\n *\n * @param {Object} obj The object to extract properties from\n * @return {Array} An array of the object's own properties.\n * @example\n *\n *      keys({a: 1, b: 2, c: 3}); //=> ['a', 'b', 'c']\n */\nmodule.exports = function (obj) {\n  return isObject(obj) ? Object.keys(obj) : [];\n};","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Applies `fn` to each of the `obj` values, and returns new object.\n *\n * @param {Function} fn The function to be called on every value of the input `obj`. Receives three argument, `value`, `key`, `obj`.\n * @param {Object} obj The object to be iterated over.\n * @return {Object} The new object.\n * @example\n *\n *      var double = x => x * 2;\n *\n *      map(double, {x: 1, y: 2, z: 3}); //=> {x: 2, y: 4, z: 6}\n */\nmodule.exports = curryN(2, function (fn, obj) {\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  var result = {};\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      result[key] = fn(obj[key], key, obj);\n    }\n  }\n\n  return result;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar isPlainObject = require('../is/plainObject');\n\nvar objectKeys = require('./keys');\n\nvar assign = require('../assign');\n\n/**\n * Create a new object with the own properties of the first object deeply merged with\n * the own properties of the other objects. If a key exists in several objects, then all values associated with this key\n * are merged recursively unless at least one of them is not a plain object. Merging is done from left to right.\n *\n * @param {...Object} sources\n * @return {Object}\n * @example\n *\n * mergeDeep({ 'name': 'fred', 'info': { 'age': 10, 'sex': 'm' } }, { 'info': { 'age': 40 }); //=> { 'name': 'fred', 'info': { 'age': 40, 'sex': 'm' } }\n */\nvar mergeDeep = function mergeDeep() {\n  var result = assign((arguments.length <= 0 ? undefined : arguments[0]) || {});\n\n  for (var i = 1; i < arguments.length; i++) {\n    var src = i < 0 || arguments.length <= i ? undefined : arguments[i];\n\n    if (!src) {\n      continue;\n    }\n\n    var keys = objectKeys(src);\n\n    for (var j = 0; j < keys.length; j++) {\n      var key = keys[j];\n      var value = src[key];\n      var res = result[key];\n\n      if (isPlainObject(res) && isPlainObject(value)) {\n        result[key] = mergeDeep(res, value);\n      } else {\n        result[key] = value;\n      }\n    }\n  }\n\n  return result;\n};\n\nmodule.exports = curryN(2, mergeDeep);","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar objectKeys = require('./keys');\n\nvar assign = require('../assign');\n\n/**\n * Create a new object with the own properties of the first object merged with\n * the own properties of the others objects. If a key exists in several objects\n * provided `fn` will be called and should return resolve value\n *\n * @param {Function} fn function to call if prop conflict appear. Receives three argument, `valueLeft`, `valueRight`,\n * `key`, `leftObj`, `rightObj`.\n * @param {...Object} sources\n * @return {Object}\n * @example\n *\n * mergeWith((x, y) => x + y, { 'name': 'fred', 'age': 10 }, { 'age': 40 }); //=> { 'name': 'fred', 'age': 50 }\n */\nmodule.exports = curryN(3, function (fn) {\n  var result = assign(arguments.length <= 1 ? undefined : arguments[1]);\n\n  for (var i = 1; i < (arguments.length <= 1 ? 0 : arguments.length - 1); i++) {\n    var source = i + 1 < 1 || arguments.length <= i + 1 ? undefined : arguments[i + 1];\n    var keys = objectKeys(source);\n\n    for (var j = 0; j < keys.length; j++) {\n      var key = keys[j];\n\n      if (Object.prototype.hasOwnProperty.call(result, key)) {\n        result[key] = fn(result[key], source[key], key, result, source);\n      } else {\n        result[key] = source[key];\n      }\n    }\n  }\n\n  return result;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar objectKeys = require('./keys');\n\n/**\n * Returns a partial copy of an object omitting the keys specified.\n *\n * @param {Array} props an array of String property names to omit from the new object\n * @param {Object} obj The object to copy from\n * @return {Object} A new object with properties from `names` not on it.\n * @example\n *\n *      omit(['a', 'd'], {a: 1, b: 2, c: 3, d: 4}); //=> {b: 2, c: 3}\n */\nmodule.exports = curryN(2, function (props, obj) {\n  if (props === void 0) {\n    props = [];\n  }\n\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  var propsSet = Object.create(null);\n\n  for (var i = 0; i < props.length; i++) {\n    propsSet[props[i]] = true;\n  }\n\n  var result = {};\n  var keys = objectKeys(obj);\n\n  for (var _i = 0; _i < keys.length; _i++) {\n    var prop = keys[_i];\n\n    if (!propsSet[prop]) {\n      result[prop] = obj[prop];\n    }\n  }\n\n  return result;\n});","\"use strict\";\n\nvar curryN = require(\"../function/curryN\");\n\n;\n\nvar _path = function _path(paths, obj) {\n  if (paths === void 0) {\n    paths = [];\n  }\n\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  var val = obj;\n\n  for (var i = 0; i < paths.length; i++) {\n    if (val == null) {\n      return undefined;\n    }\n\n    val = val[paths[i]];\n  }\n\n  return val;\n};\n\nmodule.exports = curryN(2, _path);","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar path = require('./path');\n\n/**\n * Determines whether a nested path on an object has a specific value\n *\n * @param {Array} paths The path of the nested property to use\n * @param {*} value The value to compare the nested property with\n * @param {Object} obj The object to check the nested property in\n * @return {Boolean} `true` if the value is the nested object property,\n *         `false` otherwise.\n * @example\n *\n *      var user1 = { address: { zipCode: 90210 } };\n *      var user2 = { address: { zipCode: 55555 } };\n *      var user3 = { name: 'Bob' };\n *      var users = [ user1, user2, user3 ];\n *      var isFamous = pathEq(['address', 'zipCode'], 90210);\n *      filter(isFamous, users); //=> [ user1 ]\n */\nmodule.exports = curryN(3, function (paths, value, obj) {\n  if (paths === void 0) {\n    paths = [];\n  }\n\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  return path(paths, obj) === value;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\nvar path = require('./path');\n\n/**\n * If the given, non-null object has a value at the given path, returns the\n * value at that path. Otherwise returns the provided default value.\n *\n * @param {[String]} paths The path to use.\n * @param {*} value The default value.\n * @param {Object} obj The object to retrieve the nested property from.\n * @return {*} The data at `path` of the supplied object or the default value.\n * @example\n *\n *      pathOr(['a', 'b'],'N/A', {a: {b: 2}}); //=> 2\n *      pathOr(['a', 'b'], 'N/A', {c: {b: 2}}); //=> \"N/A\"\n */\nmodule.exports = curryN(3, function (paths, value, obj) {\n  if (paths === void 0) {\n    paths = [];\n  }\n\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  var v = path(paths, obj);\n  return v != null ? v : value;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Returns a function that when supplied an object returns the indicated\n * property of that object, if it exists.\n *\n * @param {String} prop The property name\n * @param {Object} obj The object to query\n * @return {*} The value at `obj.p`.\n *\n * @example\n *\n *      prop('x', {x: 100}); //=> 100\n *      prop('x', {}); //=> undefined\n */\nmodule.exports = curryN(2, function (prop, obj) {\n  return obj != null ? obj[prop] : undefined;\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Returns a single item by iterating through the obj, successively calling\n * the iterator function and passing it an accumulator value, current\n * value and current key from the obj, and then passing the result to the next call.\n *\n * @param {Function} fn The iterator function. Receives three argument, `accumulator`, `value`, `key`.\n * @param {*} acc The accumulator value.\n * @param {Object} obj The object to iterate over.\n * @return {*} The final, accumulated value.\n * @example\n *\n *      var obj = { a: 1, b: 2, c: 3};\n *      var plus = (a, b) => a + b;\n *\n *      reduce(plus, 10, obj); //=> 16\n */\nmodule.exports = curryN(3, function (fn, acc, obj) {\n  if (obj === void 0) {\n    obj = {};\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      acc = fn(acc, obj[key], key, obj);\n    }\n  }\n\n  return acc;\n});","\"use strict\";\n\nvar objectKeys = require('./keys');\n\n/**\n * Returns a list of all the enumerable own properties of the supplied object.\n * Note that the order of the output array is not guaranteed across different\n * JS platforms.\n *\n * @param {Object} obj The object to extract values from\n * @return {Array} An array of the values of the object's own properties.\n * @example\n *\n *      values({a: 1, b: 2, c: 3}); //=> [1, 2, 3]\n */\nmodule.exports = function (obj) {\n  var keys = objectKeys(obj);\n  var len = keys.length;\n  var values = new Array(len);\n\n  for (var i = 0; i < len; i++) {\n    values[i] = obj[keys[i]];\n  }\n\n  return values;\n};","\"use strict\";\n\nvar escapeRegExp = /[&<>\"']/g;\nvar htmlEscapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\n\nvar escape = function escape(char) {\n  return htmlEscapes[char];\n};\n/**\n * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n * corresponding HTML entities.\n *\n * @param {string} str The string to escape.\n * @returns {string} Returns the escaped string.\n * @example\n *\n * escape('fred, barney, & pebbles'); // => 'fred, barney, &amp; pebbles'\n */\n\n\nmodule.exports = function (str) {\n  if (str === void 0) {\n    str = '';\n  }\n\n  return str.replace(escapeRegExp, escape);\n};","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Replace a substring or regex match in a string with a replacement.\n *\n * @param {RegExp|String} pattern A regular expression or a substring to match.\n * @param {String} replacement The string to replace the matches with.\n * @param {String} str The String to do the search and replacement in.\n * @return {String} The result.\n * @example\n *\n *      replace('foo', 'bar', 'foo foo foo'); //=> 'bar foo foo'\n *      replace(/foo/, 'bar', 'foo foo foo'); //=> 'bar foo foo'\n *\n *      // Use the \"g\" (global) flag to replace all occurrences:\n *      replace(/foo/g, 'bar', 'foo foo foo'); //=> 'bar bar bar'\n */\nmodule.exports = curryN(3, function (pattern, replacement, str) {\n  if (pattern === void 0) {\n    pattern = '';\n  }\n\n  if (replacement === void 0) {\n    replacement = '';\n  }\n\n  if (str === void 0) {\n    str = '';\n  }\n\n  return str.replace(pattern, replacement);\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Splits a string into an array of strings based on the given\n * separator.\n *\n * @param {String|RegExp} delim The pattern.\n * @param {String} str The string to separate into an array.\n * @return {Array} The array of strings from `str` separated by `str`.\n * @example\n *\n *      split('.', 'a.b.c.xyz.d'); //=> ['a', 'b', 'c', 'xyz', 'd']\n */\nmodule.exports = curryN(2, function (delim, str) {\n  if (delim === void 0) {\n    delim = '';\n  }\n\n  if (str === void 0) {\n    str = '';\n  }\n\n  return str.split(delim);\n});","\"use strict\";\n\nvar curryN = require('../function/curryN');\n\n/**\n * Determines whether a given string matches a given regular expression.\n *\n * @param {RegExp} pattern\n * @param {String} str\n * @return {Boolean}\n */\nmodule.exports = curryN(2, function (pattern, str) {\n  if (pattern === void 0) {\n    pattern = /()/;\n  }\n\n  if (str === void 0) {\n    str = '';\n  }\n\n  return pattern.test(str);\n});","\"use strict\";\n\n/**\n * Returns the lower case version of a string.\n *\n * @param {String} str The string to lower case.\n * @return {String} The lower case version of `str`.\n * @example\n *\n *      toLower('XYZ'); //=> 'xyz'\n */\nmodule.exports = function (str) {\n  if (str === void 0) {\n    str = '';\n  }\n\n  return str.toLowerCase();\n};","import { createContainer, walkOfModules, getModuleParameters, isExtendedModule, MODULE_PARAMETERS, Scope } from '@tinkoff/dippy';\nexport { DI_TOKEN, IS_DI_CHILD_CONTAINER_TOKEN, MODULE_PARAMETERS, Module, Scope, createToken, declareModule, getModuleParameters, isExtendedModule, optional, provide, walkOfModules } from '@tinkoff/dippy';\nimport { COMMAND_LINE_RUNNER_TOKEN, APP_INFO_TOKEN, BUNDLE_LIST_TOKEN, ACTIONS_LIST_TOKEN, MODULES_LIST_TOKEN, ACTION_PARAMETERS } from '@tramvai/tokens-core';\nexport * from '@tramvai/tokens-core';\nimport { LOGGER_TOKEN } from '@tramvai/tokens-common';\nimport concat from '@tinkoff/utils/array/concat';\nimport mergeWith from '@tinkoff/utils/object/mergeWith';\nimport omit from '@tinkoff/utils/object/omit';\n\nfunction appProviders(name, bundles, actions, modules) {\n    return [\n        {\n            // Информация о приложении\n            provide: APP_INFO_TOKEN,\n            scope: Scope.SINGLETON,\n            useValue: {\n                appName: name,\n            },\n        },\n        {\n            // Список бандлов\n            provide: BUNDLE_LIST_TOKEN,\n            scope: Scope.SINGLETON,\n            useValue: bundles,\n        },\n        {\n            // Список переданных экшенов\n            provide: ACTIONS_LIST_TOKEN,\n            scope: Scope.SINGLETON,\n            useValue: actions,\n            multi: true,\n        },\n        {\n            // Спислок переданных модулей\n            provide: MODULES_LIST_TOKEN,\n            scope: Scope.SINGLETON,\n            useValue: modules,\n        },\n    ];\n}\nclass App {\n    constructor({ name, modules = [], bundles = {}, actions = [], providers }) {\n        this.di = createContainer();\n        this.modulesToResolve = new Set();\n        this.walkOfProviders(appProviders(name, bundles, actions, modules));\n        walkOfModules(modules).forEach((mod) => {\n            const moduleParameters = getModuleParameters(mod);\n            this.modulesToResolve.add(isExtendedModule(mod) ? mod.mainModule : mod);\n            this.walkOfProviders(moduleParameters.providers);\n        });\n        if (providers) {\n            this.walkOfProviders(providers);\n        }\n    }\n    async initialization(env, type = 'init') {\n        const logger = this.di.get({ token: LOGGER_TOKEN, optional: true });\n        const log = logger === null || logger === void 0 ? void 0 : logger('tramvai-core');\n        const commandLineRunner = this.di.get({ token: COMMAND_LINE_RUNNER_TOKEN, optional: true });\n        if (!commandLineRunner) {\n            throw new Error('`COMMAND_LINE_RUNNER_TOKEN` is not defined, have you added `@tramvai/module-common` to your dependency list?');\n        }\n        log === null || log === void 0 ? void 0 : log.warn({\n            event: 'tramvai-app-init',\n            message: 'Initializing. Run CommandLineRunner.',\n        });\n        const di = await commandLineRunner.run(env, type);\n        log === null || log === void 0 ? void 0 : log.warn({\n            event: 'tramvai-app-init',\n            message: 'CommandLineRunner executed successfully. Resolving modules.',\n        });\n        this.resolveModules();\n        log === null || log === void 0 ? void 0 : log.warn({\n            event: 'tramvai-app-init',\n            message: 'Modules resolved successfully. Tramvai App initialized',\n        });\n        return di;\n    }\n    walkOfProviders(providers) {\n        providers.forEach((provide) => {\n            this.di.register(provide);\n        });\n    }\n    resolveModules() {\n        this.modulesToResolve.forEach((ModuleToResolve) => {\n            // eslint-disable-next-line no-new\n            new ModuleToResolve(this.resolveModuleDeps(ModuleToResolve));\n        });\n    }\n    resolveModuleDeps(module) {\n        const { deps } = module[MODULE_PARAMETERS];\n        if (deps) {\n            return this.di.getOfDeps(deps);\n        }\n    }\n}\nfunction createApp(options) {\n    let app;\n    try {\n        app = new App(options);\n    }\n    catch (error) {\n        // Флаг необходим чтобы среди логов найти те которые не дали трамваю стартануть\n        error.appCreationError = true;\n        throw error;\n    }\n    return app.initialization(typeof window === 'undefined' ? 'server' : 'client').then(() => app);\n}\n\nconst mergePlan = (x, y) => {\n    if (Array.isArray(x) && Array.isArray(y)) {\n        return concat(x, y);\n    }\n    if (typeof x === 'object' && typeof y === 'object') {\n        return mergeWith(mergePlan, x, y);\n    }\n    return y;\n};\nconst mergeOptions = /* #__PURE__*/ mergeWith(mergePlan);\nconst mergePresets = (presets) => {\n    if (!presets || !presets.length) {\n        return {};\n    }\n    const result = presets.map((preset) => mergeOptions(mergePresets(preset.presets), omit(['presets'], preset)));\n    if (result.length === 1) {\n        return result[0];\n    }\n    return mergeOptions(...result);\n};\nfunction createBundle(options) {\n    let presets = {};\n    if (options.presets) {\n        presets = mergePresets(options.presets);\n    }\n    return mergeOptions(presets, options);\n}\n\n/**\n * @deprecated: use `declareAction`\n */\nfunction createAction(action) {\n    const result = Object.assign(action.fn, {\n        [ACTION_PARAMETERS]: action,\n    });\n    if (!action.conditions) {\n        // eslint-disable-next-line no-param-reassign\n        action.conditions = {};\n    }\n    return result;\n}\n\nfunction declareAction(action) {\n    return {\n        ...action,\n        tramvaiActionVersion: 2,\n    };\n}\nfunction isTramvaiAction(action) {\n    return 'tramvaiActionVersion' in action && action.tramvaiActionVersion === 2;\n}\n\nexport { App, createAction, createApp, createBundle, declareAction, isTramvaiAction };\n","import { __decorate } from 'tslib';\nimport { Module, provide, commandLineListTokens } from '@tramvai/core';\nimport { COMBINE_REDUCERS, STORE_TOKEN, CONTEXT_TOKEN } from '@tramvai/tokens-common';\nimport { COOKIE_MANAGER_TOKEN } from '@tramvai/tokens-cookie';\nimport { createToken } from '@tinkoff/dippy';\nimport debounce from '@tinkoff/utils/function/debounce';\nimport { createEvent, createReducer, useSelector } from '@tramvai/state';\nimport { CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN } from '@tramvai/tokens-child-app';\n\nconst USER_AGENT_TOKEN = createToken('userAgent');\nconst PARSER_CLIENT_HINTS_ENABLED = createToken('client-hints parserClientHints enabled');\n\nconst setMedia = createEvent('setMedia');\nconst initialState = {\n    height: 0,\n    width: 0,\n    isTouch: false,\n    retina: false,\n    synchronized: false,\n};\nconst MediaStore = createReducer('media', initialState).on(setMedia, (state, media) => {\n    return {\n        ...state,\n        ...media,\n    };\n});\n\nconst COOKIE_NAME_MEDIA_INFO = 'mediaInfo';\n\nconst mediaBreakpoints = {\n    retina: '(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)',\n};\n\nconst isTouch = !!('ontouchstart' in window ||\n    (window.DocumentTouch && document instanceof window.DocumentTouch));\nconst getMediaInfo = () => ({\n    width: window.innerWidth,\n    height: window.innerHeight,\n    isTouch,\n    retina: window.matchMedia(mediaBreakpoints.retina).matches,\n});\nconst matchMediaCommand = ({ context, cookieManager, }) => {\n    return function matchMedia() {\n        const setMediaInfo = () => {\n            const media = getMediaInfo();\n            cookieManager.set({\n                name: COOKIE_NAME_MEDIA_INFO,\n                value: JSON.stringify(media),\n            });\n            return context.dispatch(setMedia({\n                ...media,\n                supposed: false,\n            }));\n        };\n        const debouncedSetMediaInfo = debounce(300, setMediaInfo);\n        window.addEventListener('orientationchange', debouncedSetMediaInfo);\n        window.addEventListener('resize', debouncedSetMediaInfo);\n        return setMediaInfo();\n    };\n};\n\nconst setUserAgent = createEvent('setUserAgent');\nconst UserAgentStore = createReducer('userAgent', null).on(setUserAgent, (state, userAgent) => {\n    return userAgent;\n});\n\nconst providers = [\n    { provide: COMBINE_REDUCERS, multi: true, useValue: [UserAgentStore, MediaStore] },\n];\n\nfunction fromClientHints(media) {\n    return !!media.synchronized;\n}\nfunction isSupposed(media) {\n    return !!media.supposed;\n}\nfunction isRetina(media) {\n    return !!media.retina;\n}\n\nfunction useMedia() {\n    return useSelector('media', ({ media }) => media);\n}\nfunction useFromClientHints() {\n    return fromClientHints(useMedia());\n}\nfunction useIsSupposed() {\n    return isSupposed(useMedia());\n}\nfunction useIsRetina() {\n    return isRetina(useMedia());\n}\n\nlet ClientHintsChildAppModule = class ClientHintsChildAppModule {\n};\nClientHintsChildAppModule = __decorate([\n    Module({\n        providers: [\n            {\n                provide: CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN,\n                multi: true,\n                useValue: [MediaStore, UserAgentStore],\n            },\n        ],\n    })\n], ClientHintsChildAppModule);\n\nlet ClientHintsModule = class ClientHintsModule {\n};\nClientHintsModule = __decorate([\n    Module({\n        providers: [\n            ...providers,\n            provide({\n                provide: USER_AGENT_TOKEN,\n                useFactory: ({ store }) => {\n                    return store.getState(UserAgentStore);\n                },\n                deps: {\n                    store: STORE_TOKEN,\n                },\n            }),\n            provide({\n                provide: commandLineListTokens.clear,\n                multi: true,\n                useFactory: matchMediaCommand,\n                deps: {\n                    context: CONTEXT_TOKEN,\n                    cookieManager: COOKIE_MANAGER_TOKEN,\n                },\n            }),\n        ],\n    })\n], ClientHintsModule);\n\nexport { ClientHintsChildAppModule, ClientHintsModule, MediaStore, PARSER_CLIENT_HINTS_ENABLED, USER_AGENT_TOKEN, UserAgentStore, fromClientHints, isRetina, isSupposed, setMedia, setUserAgent, useFromClientHints, useIsRetina, useIsSupposed, useMedia };\n","import compose from '@tinkoff/utils/function/compose';\nimport isString from '@tinkoff/utils/is/string';\nimport identity from '@tinkoff/utils/function/identity';\nimport pick from '@tinkoff/utils/object/pick';\nimport shallowEqual from '@tinkoff/utils/is/shallowEqual';\nimport strictEqual from '@tinkoff/utils/is/strictEqual';\nimport { jsx } from 'react/jsx-runtime';\nimport noop from '@tinkoff/utils/function/noop';\nimport hoistStatics from 'hoist-non-react-statics';\nimport invariant from 'invariant';\nimport React, { createContext, useContext, useMemo, useRef, useCallback } from 'react';\nimport { isValidElementType } from 'react-is';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\nimport isArray from '@tinkoff/utils/is/array';\nimport { useShallowEqual, useIsomorphicLayoutEffect } from '@tinkoff/react-hooks';\nexport { useIsomorphicLayoutEffect } from '@tinkoff/react-hooks';\nimport toArray from '@tinkoff/utils/array/toArray';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/shim/with-selector';\nimport always from '@tinkoff/utils/function/always';\nimport mapObject from '@tinkoff/utils/object/map';\nimport isPlainObject from '@tinkoff/utils/is/plainObject';\nimport isFunction from '@tinkoff/utils/is/function';\n\n/*\n### TODO\n\nМонорепозиторий экосистемы [redux-devtools](https://github.com/reduxjs/redux-devtools)\n\nПример кастомной [интеграции redux-devtools с mobx](https://github.com/zalmoxisus/mobx-remotedev/blob/master/src/monitorActions.js)\n\nИнтегрированный в DevTools функционал:\n\n1. Лог экшенов\n2. Состояние стейта\n3. Dispatch\n4. ~~Time Traveling~~\n */\n// eslint-disable-next-line import/no-mutable-exports\nlet middleware = () => () => (next) => (event) => next(event);\nif (process.env.NODE_ENV !== 'production') {\n    middleware = require('./index_middleware.es.js').middleware;\n}\n\nvar index = {\n    __proto__: null,\n    get middleware () { return middleware; }\n};\n\nconst subscribe = (store, handler) => {\n    // подписываемся на изменения\n    store.on('change', handler);\n    // вызываем сразу, чтобы заполнить начальное состояние\n    handler();\n};\n\nclass SimpleEmitter {\n    constructor() {\n        this.listeners = [];\n    }\n    emit(name) {\n        this.listeners.forEach((listener) => {\n            listener();\n        });\n    }\n    addListener(event, fn) {\n        this.listeners.push(fn);\n    }\n    on(event, fn) {\n        this.addListener(event, fn);\n    }\n    removeListener(event, fn) {\n        const listeners = [];\n        for (let i = 0; i < this.listeners.length; i++) {\n            if (this.listeners[i] !== fn) {\n                listeners.push(this.listeners[i]);\n            }\n        }\n        this.listeners = listeners;\n    }\n    off(event, fn) {\n        this.removeListener(event, fn);\n    }\n}\n\nconst eventExecutor = (event, handlerFns) => {\n    const keys = Object.keys(handlerFns);\n    for (let index = 0; index < keys.length; index++) {\n        const storeName = keys[index];\n        const handlerFn = handlerFns[storeName];\n        if (!handlerFn) {\n            throw new Error(`${storeName} does not have a handler for action ${event.type}`);\n        }\n        handlerFn(event.payload, event.type);\n    }\n};\n// Конвертация старого типа экшенов в новый\nconst convertAction = (actionOrNameEvent, payload) => {\n    if (typeof actionOrNameEvent === 'string') {\n        return {\n            payload,\n            type: actionOrNameEvent,\n            error: false,\n        };\n    }\n    return actionOrNameEvent;\n};\n// Это форкнутый вариант dispatchr\nclass DispatcherContext extends SimpleEmitter {\n    /**\n     * @param context The context to be used for store instances\n     */\n    constructor(dispatcher, context, initialState, middlewares) {\n        super();\n        this.applyDispatch = (event) => {\n            const eventHandlers = this.dispatcher.handlers[event.type] || [];\n            if (!eventHandlers.length) {\n                if (process.env.NODE_ENV === 'development') {\n                    console.warn(`\nThe event \"${event.type}\" has been dispatched, but no reducers for this event were registered.\nHave you forgot to register reducer or add event handler in existing reducer?\n`);\n                }\n                return event.payload;\n            }\n            this.applyHandlers(event, eventHandlers);\n            return event.payload;\n        };\n        this.dispatcher = dispatcher;\n        this.storeInstances = {};\n        this.storeUnsubscribeCallbacks = {};\n        this.context = context;\n        this.dispatcherInterface = {\n            getContext: () => this.context,\n            getStore: this.getStore.bind(this),\n        };\n        this.rehydratedStoreState = {};\n        this.fullState = {};\n        // Заполняем стейт данными\n        if (initialState) {\n            this.rehydrate(initialState);\n        }\n        if (middlewares === null || middlewares === void 0 ? void 0 : middlewares.length) {\n            this.applyDispatch = this.applyMiddlewares(middlewares);\n        }\n        // Инцииализируем уже имеющиеся сторы\n        Object.keys(this.dispatcher.stores).forEach((store) => {\n            this.getStore(store);\n        });\n    }\n    applyMiddlewares(middlewares) {\n        let dispatch = (...args) => {\n            throw new Error('Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.');\n        };\n        const api = {\n            getState: this.getState.bind(this),\n            subscribe: this.subscribe.bind(this),\n            dispatch: (...args) => dispatch(...args),\n        };\n        dispatch = compose(...middlewares.map((middleware) => middleware(api)))(this.applyDispatch);\n        return dispatch;\n    }\n    storeSubscribe(storeName, storeInstance) {\n        const subscribeHandler = () => {\n            const newState = storeInstance.getState();\n            if (newState !== this.fullState[storeName]) {\n                this.fullState = {\n                    ...this.fullState,\n                    [storeName]: newState,\n                };\n                this.emit('change');\n            }\n        };\n        subscribe(storeInstance, subscribeHandler);\n        const unsubscribe = () => {\n            storeInstance.off('change', subscribeHandler);\n        };\n        this.storeUnsubscribeCallbacks[storeName] = unsubscribe;\n    }\n    // eslint-disable-next-line max-statements\n    getStore(storeClass) {\n        let storeClassPrepared;\n        let optional = false;\n        if (typeof storeClass === 'object') {\n            storeClassPrepared = storeClass.store;\n            optional = storeClass.optional;\n        }\n        else {\n            storeClassPrepared = storeClass;\n        }\n        const storeName = this.dispatcher.getStoreName(storeClassPrepared);\n        if (!this.storeInstances[storeName]) {\n            let Store = this.dispatcher.stores[storeName];\n            if (!Store) {\n                if (typeof storeClassPrepared === 'function') {\n                    this.dispatcher.registerStore(storeClassPrepared);\n                    Store = storeClassPrepared;\n                }\n                else {\n                    if (optional) {\n                        return null;\n                    }\n                    throw new Error(`Store ${storeName} was not registered.`);\n                }\n            }\n            const storeInstance = new Store(this.dispatcherInterface);\n            this.storeInstances[storeName] = storeInstance;\n            if (this.rehydratedStoreState && this.rehydratedStoreState[storeName]) {\n                const state = this.rehydratedStoreState[storeName];\n                if (storeInstance.rehydrate) {\n                    storeInstance.rehydrate(state);\n                }\n                this.rehydratedStoreState[storeName] = null;\n            }\n            this.storeSubscribe(storeName, storeInstance);\n            // TODO: убрать после того отпадёт надобность связывать сторы router и application\n            if (Store.dependencies) {\n                Store.dependencies.forEach((dependencyStoreClass) => {\n                    const dependency = this.getStore(dependencyStoreClass);\n                    subscribe(dependency, () => {\n                        storeInstance.emit('change');\n                    });\n                });\n            }\n        }\n        return this.storeInstances[storeName];\n    }\n    /**\n     * Dispatches a new action or throws if one is already in progress\n     * @param eventOrType Name of the event to be dispatched\n     * @param payload Parameters to describe the action\n     * @throws {Error} if store has handler registered that does not exist\n     */\n    dispatch(eventOrType, payload) {\n        if (!eventOrType) {\n            throw new Error(`eventOrType parameter ${eventOrType} is invalid.`);\n        }\n        // конвертим старый тип экшенов\n        const event = convertAction(eventOrType, payload);\n        return this.applyDispatch(event);\n    }\n    applyHandlers(action, handlers) {\n        const handlerFns = {};\n        const storeInstanceGet = (store) => {\n            if (handlerFns[store.name]) {\n                // Don't call the default if the store has an explicit action handler\n                return;\n            }\n            const storeInstance = this.getStore(store.name);\n            if (!storeInstance) {\n                return;\n            }\n            if (typeof store.handler === 'function') {\n                handlerFns[store.name] = store.handler.bind(storeInstance);\n            }\n            else {\n                if (process.env.NODE_ENV !== 'production') {\n                    if (!storeInstance[store.handler]) {\n                        throw new Error(`${store.name} does not have a method called ${store.handler}`);\n                    }\n                }\n                handlerFns[store.name] = storeInstance[store.handler].bind(storeInstance);\n            }\n        };\n        const handlersLength = handlers.length;\n        for (let index = 0; index < handlersLength; index++) {\n            storeInstanceGet(handlers[index]);\n        }\n        return eventExecutor(action, handlerFns);\n    }\n    /**\n     * Returns a raw data object representation of the current state of the\n     * dispatcher and all store instances. If the store implements a shouldDehdyrate\n     * function, then it will be called and only dehydrate if the method returns `true`\n     * @method dehydrate\n     * @returns dehydrated dispatcher data\n     */\n    dehydrate() {\n        const stores = {};\n        const keys = Object.keys(this.storeInstances);\n        for (let i = 0; i < keys.length; i++) {\n            const storeName = keys[i];\n            const store = this.storeInstances[storeName];\n            if (!store.dehydrate()) {\n                continue;\n            }\n            stores[storeName] = store.dehydrate();\n        }\n        return {\n            stores,\n        };\n    }\n    /**\n     * Takes a raw data object and rehydrates the dispatcher and store instances\n     * @method rehydrate\n     * @param dispatcherState raw state typically retrieved from `dehydrate` method\n     */\n    rehydrate(dispatcherState) {\n        if (dispatcherState.stores) {\n            const keys = Object.keys(dispatcherState.stores);\n            for (let index = 0; index < keys.length; index++) {\n                const storeName = keys[index];\n                this.rehydratedStoreState[storeName] = dispatcherState.stores[storeName];\n            }\n        }\n    }\n    subscribe(...args) {\n        if ('storeName' in args[0]) {\n            const reducer = args[0];\n            const callback = args[1];\n            const reducerInstance = this.getStore(reducer);\n            const listener = () => {\n                const state = this.getState(reducer);\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                callback(state);\n            };\n            reducerInstance.on('change', listener);\n            return () => {\n                reducerInstance.off('change', listener);\n            };\n        }\n        const callback = args[0];\n        const listener = () => {\n            const state = this.getState();\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            callback(state);\n        };\n        this.on('change', listener);\n        return () => {\n            this.off('change', listener);\n        };\n    }\n    getState(reducer) {\n        if (reducer) {\n            return this.fullState[reducer.storeName];\n        }\n        return this.fullState;\n    }\n    // Для отложенной инициализации контекста, в будующем нужно удалить\n    setContext(context) {\n        this.context = context;\n    }\n    hasStore(store) {\n        return store.storeName in this.storeInstances && this.dispatcher.hasStore(store);\n    }\n    registerStore(store) {\n        this.dispatcher.registerStore(store);\n        this.getStore(store);\n    }\n    unregisterStore(store) {\n        const { storeName } = store;\n        this.dispatcher.unregisterStore(store);\n        this.storeUnsubscribeCallbacks[storeName]();\n        delete this.storeUnsubscribeCallbacks[storeName];\n        delete this.rehydratedStoreState[storeName];\n        delete this.storeInstances[storeName];\n    }\n}\n\nclass Dispatcher {\n    /**\n     * @class Dispatcher\n     * @param options Dispatcher options\n     * @param options.stores Array of stores to register\n     * @constructor\n     */\n    constructor(options) {\n        // eslint-disable-next-line no-param-reassign\n        options = options || {};\n        // eslint-disable-next-line no-param-reassign\n        options.stores = options.stores || [];\n        this.stores = {};\n        this.handlers = {};\n        options.stores.forEach((store) => {\n            this.registerStore(store);\n        });\n    }\n    createContext(context, initialState, middlewares) {\n        return new DispatcherContext(this, context, initialState, middlewares);\n    }\n    hasStore(store) {\n        return !!this.stores[store.storeName];\n    }\n    /**\n     * Registers a store so that it can handle actions.ß\n     * @param store A store class to be registered. The store should have a static\n     *      `storeName` property so that it can be loaded later.\n     * @throws {Error} if store is invalid\n     * @throws {Error} if store is already registered\n     */\n    registerStore(store) {\n        const { storeName } = store;\n        if (this.stores[storeName]) {\n            if (this.stores[storeName] === store) {\n                // Store is already registered, nothing to do\n                return;\n            }\n            if (process.env.NODE_ENV !== 'production') {\n                throw new Error(`Store with name '${storeName}' has already been registered.\n                Make sure you do not have multiple copies of the store installed.\n                exist ${this.stores[storeName]}\n                try ${store}`);\n            }\n        }\n        this.stores[storeName] = store;\n        if (store.handlers) {\n            Object.keys(store.handlers).forEach((action) => {\n                const handler = store.handlers[action];\n                this.registerHandler(action, storeName, handler);\n            });\n        }\n    }\n    unregisterStore(store) {\n        const { storeName } = store;\n        if (!this.stores[storeName]) {\n            return;\n        }\n        delete this.stores[storeName];\n        if (store.handlers) {\n            Object.keys(store.handlers).forEach((action) => {\n                const handler = store.handlers[action];\n                this.unregisterHandler(action, storeName, handler);\n            });\n        }\n    }\n    /**\n     * Gets a name from a store\n     * @param {String|Object} store The store name or class from which to extract\n     */\n    // eslint-disable-next-line class-methods-use-this\n    getStoreName(store) {\n        if (typeof store === 'string') {\n            return store;\n        }\n        return store.storeName;\n    }\n    /**\n     * Adds a handler function to be called for the given action\n     * @param action Name of the action\n     * @param name Name of the store that handles the action\n     * @param handler The function or name of the method that handles the action\n     */\n    registerHandler(action, name, handler) {\n        this.handlers[action] = this.handlers[action] || [];\n        this.handlers[action].push({\n            name,\n            handler,\n        });\n    }\n    unregisterHandler(action, name, handler) {\n        if (Array.isArray(this.handlers[action])) {\n            this.handlers[action] = this.handlers[action].filter((actionHandlers) => {\n                return !(actionHandlers.name === name && actionHandlers.handler === handler);\n            });\n        }\n    }\n}\nfunction createDispatcher(options) {\n    return new Dispatcher(options);\n}\n\nclass ChildDispatcherContext extends DispatcherContext {\n    /**\n     * @param context The context to be used for store instances\n     */\n    constructor({ dispatcher, context, initialState, parentDispatcherContext, middlewares, parentAllowedStores, }) {\n        super(dispatcher, context, initialState, middlewares);\n        this.allowedParentStores = new Set();\n        this.parentDispatcherContext = parentDispatcherContext;\n        parentAllowedStores === null || parentAllowedStores === void 0 ? void 0 : parentAllowedStores.forEach((store) => {\n            const storeName = this.dispatcher.getStoreName(typeof store === 'object' ? store.store : store);\n            this.allowedParentStores.add(storeName);\n            // use just storeName to prevent store initialization on the root-app side\n            this.getStore({ store: storeName, optional: true });\n        });\n    }\n    getStore(storeClass) {\n        let storeClassPrepared;\n        if (typeof storeClass === 'object') {\n            storeClassPrepared = storeClass.store;\n        }\n        else {\n            storeClassPrepared = storeClass;\n        }\n        const storeName = this.dispatcher.getStoreName(storeClassPrepared);\n        if (this.dispatcher.stores[storeName]) {\n            return super.getStore(storeClass);\n        }\n        if (this.allowedParentStores.has(storeName)) {\n            // use just storeName to prevent store initialization on the root-app side\n            const storeInstance = this.parentDispatcherContext.getStore({\n                store: storeName,\n                optional: true,\n            });\n            if (!storeInstance) {\n                return null;\n            }\n            this.storeSubscribe(storeName, storeInstance);\n            return storeInstance;\n        }\n        return super.getStore(storeClass);\n    }\n}\n\nfunction createEvent(eventName, payloadCreator = identity) {\n    if (process.env.NODE_ENV !== 'production') {\n        if (!isString(eventName) || !eventName.length) {\n            throw new Error(`eventName should be not empty string, got '${eventName}'`);\n        }\n    }\n    const type = eventName;\n    const eventCreator = (...args) => {\n        return {\n            type,\n            payload: payloadCreator(...args),\n        };\n    };\n    eventCreator.getType = () => type;\n    eventCreator.toString = () => type;\n    return eventCreator;\n}\n\nfunction createReducer(name, initialState) {\n    var _a;\n    const reducers = {};\n    return _a = class ReducerStore extends SimpleEmitter {\n            constructor() {\n                super();\n                this.state = initialState;\n            }\n            static createEvents(model) {\n                const eventNames = Object.keys(model);\n                const events = {};\n                eventNames.forEach((eventName) => {\n                    const handler = model[eventName];\n                    const eventCreator = createEvent(`${eventName}`);\n                    events[eventName] = eventCreator;\n                    ReducerStore.on(eventCreator, handler);\n                });\n                return events;\n            }\n            static on(eventOrType, reducer) {\n                if (Array.isArray(eventOrType)) {\n                    eventOrType.forEach((event) => ReducerStore.on(event, reducer));\n                    return ReducerStore;\n                }\n                const type = eventOrType.toString();\n                ReducerStore.handlers[type] = 'handle';\n                reducers[type] = reducer;\n                return ReducerStore;\n            }\n            getState() {\n                return this.state;\n            }\n            setState(state) {\n                this.state = state;\n                // обновление необходимо, иначе state-manager не пересчитает состояние\n                this.emit('change');\n            }\n            dehydrate() {\n                return this.state;\n            }\n            rehydrate(state) {\n                this.state = state;\n            }\n            handle(payload, eventName) {\n                const reducer = reducers[eventName];\n                if (reducer) {\n                    this.state = reducer(this.state, payload);\n                    this.emit('change');\n                }\n            }\n        },\n        _a.storeName = name,\n        _a.handlers = {},\n        _a;\n}\n\n/**\n * @deprecated метод устарел, в замен этого API используй createReducer, который новее и лучше маштабируется\n */\nclass BaseStore extends SimpleEmitter {\n    constructor() {\n        super(...arguments);\n        this.state = Object.create(null);\n        this.hydrateKeys = Object.create(null);\n    }\n    getState() {\n        return this.state;\n    }\n    dehydrate() {\n        return pick(Object.keys(this.hydrateKeys), this.state);\n    }\n    rehydrate(state) {\n        this.setStateSilently(state);\n    }\n    writeHydrateKeys(state) {\n        Object.keys(state).forEach((key) => {\n            this.hydrateKeys[key] = true;\n        });\n    }\n    // eslint-disable-next-line class-methods-use-this\n    shouldStateUpdate(nextState) {\n        return !!Object.keys(nextState).length;\n    }\n    setState(state, force = false) {\n        if (force || this.shouldStateUpdate(state)) {\n            this.setStateSilently(state);\n            this.emit('change');\n        }\n    }\n    setStateSilently(state) {\n        this.state = { ...this.state, ...state };\n        this.writeHydrateKeys(state);\n    }\n    replaceState(state) {\n        this.replaceStateSilently(state);\n        this.emit('change');\n    }\n    // @deprecated нужно использовать replaceState\n    replaceStateSilently(state) {\n        this.state = state;\n        this.hydrateKeys = Object.create(null);\n        this.writeHydrateKeys(state);\n    }\n}\n\n// encapsulates the subscription logic for connecting a component to the redux store, as\n// well as nesting subscriptions of descendant components, so that we can ensure the\n// ancestor components re-render before descendants\nclass Subscription {\n    constructor(stores) {\n        this.handleStateChange = () => {\n            this.onStateChange && this.onStateChange();\n        };\n        this.stores = stores;\n        this.unsubscribe = undefined;\n    }\n    isSubscribed() {\n        return Boolean(this.unsubscribe);\n    }\n    setOnStateChange(onStateChange) {\n        this.onStateChange = onStateChange;\n    }\n    trySubscribe() {\n        if (!this.unsubscribe) {\n            this.unsubscribe = this.stores.filter(Boolean).map((store) => {\n                store.on('change', this.handleStateChange);\n                return () => {\n                    store.removeListener('change', this.handleStateChange);\n                };\n            });\n        }\n    }\n    tryUnsubscribe() {\n        if (this.unsubscribe) {\n            this.unsubscribe.forEach((f) => f());\n            this.unsubscribe = undefined;\n        }\n        this.onStateChange = undefined;\n    }\n}\n\nconst ConnectContext = /* #__PURE__*/ createContext(null);\nconst ServerStateContext = /* #__PURE__*/ createContext(null);\n\nconst useConsumerContext = () => {\n    const context = useContext(ConnectContext);\n    if (!context) {\n        throw new Error('CONSUMER_CONTEXT not found, have you added \"@tramvai/module-common\"?');\n    }\n    return context;\n};\n\nfunction useActions(actions) {\n    const context = useConsumerContext();\n    const actionsRef = useShallowEqual(actions);\n    return useMemo(() => {\n        if (isArray(actionsRef)) {\n            return actionsRef.map((action) => context.executeAction.bind(context, action));\n        }\n        return context.executeAction.bind(context, actionsRef);\n    }, [actionsRef, context]);\n}\n\nfunction useStore(reducer) {\n    const context = useConsumerContext();\n    const serverState = useContext(ServerStateContext);\n    const reducerRef = useRef(reducer);\n    const addedReducerRef = useRef(null);\n    // если текущий редьюсер не зарегистрирован в диспетчере,\n    // регистрируем его вручную, что бы гарантировать работоспособность `context.getState(reducer)`,\n    // и сохраняем в `addedReducerRef`, что бы удалить при unmount\n    if (!context.hasStore(reducer)) {\n        context.registerStore(reducer);\n        addedReducerRef.current = reducer.storeName;\n    }\n    const subscribe = useCallback((reactUpdate) => {\n        const unsubscribe = context.subscribe(reducer, reactUpdate);\n        // заменяем текущий редьюсер\n        reducerRef.current = reducer;\n        return () => {\n            // гарантируем отписку от обновлений текущего редьюсера,\n            // при анмаунте компонента\n            unsubscribe();\n            // если текущий редьюсер был зарегистрирован в диспетчере в этом хуке,\n            // удаляем его из диспетчера\n            if (addedReducerRef.current) {\n                context.unregisterStore(reducerRef.current);\n                addedReducerRef.current = null;\n            }\n        };\n    }, [reducer, context]);\n    return useSyncExternalStore(subscribe, () => context.getState(reducer), serverState ? () => serverState[reducer.storeName] : () => context.getState(reducer));\n}\n\nconst contextExecution = typeof window !== 'undefined' ? window : global;\nfunction scheduling() {\n    if ('requestAnimationFrame' in contextExecution) {\n        return requestAnimationFrame;\n    }\n    if ('setImmediate' in contextExecution) {\n        return contextExecution.setImmediate;\n    }\n    return setTimeout;\n}\n\nconst schedule = /* #__PURE__*/ scheduling();\nfunction useSelector(storesOrStore, selector, equalityFn = shallowEqual) {\n    invariant(selector, `You must pass a selector to useSelectors`);\n    const context = useConsumerContext();\n    const serverState = useContext(ServerStateContext);\n    const renderIsScheduled = useRef(false);\n    const storesRef = useShallowEqual(storesOrStore);\n    const subscription = useMemo(() => new Subscription(toArray(storesRef).map(context.getStore)), [storesRef, context]);\n    const latestSubscriptionCallbackError = useRef();\n    const subscribe = useCallback((reactUpdate) => {\n        subscription.setOnStateChange(() => {\n            if (!renderIsScheduled.current) {\n                renderIsScheduled.current = true;\n                schedule(() => {\n                    reactUpdate();\n                    renderIsScheduled.current = false;\n                });\n            }\n        });\n        subscription.trySubscribe();\n        return () => {\n            return subscription.tryUnsubscribe();\n        };\n    }, [subscription]);\n    let selectedState;\n    try {\n        selectedState = useSyncExternalStoreWithSelector(subscribe, context.getState, serverState ? () => serverState : context.getState, selector, equalityFn);\n    }\n    catch (err) {\n        let errorMessage = `An error occured while selecting the store state: ${err.message}.`;\n        if (latestSubscriptionCallbackError.current) {\n            errorMessage += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\nOriginal stack trace:`;\n        }\n        throw new Error(errorMessage);\n    }\n    useIsomorphicLayoutEffect(() => {\n        latestSubscriptionCallbackError.current = undefined;\n    });\n    return selectedState;\n}\n\nconst useStoreSelector = (store, selector) => {\n    const memoizedSelector = useCallback((stores) => {\n        return selector(stores[store.storeName]);\n    }, [store, selector]);\n    return useSelector(store, memoizedSelector);\n};\n\nconst stringifyComponent = (Comp) => {\n    try {\n        return JSON.stringify(Comp);\n    }\n    catch (err) {\n        return String(Comp);\n    }\n};\n/**\n * @deprecated\n */\nfunction connectAdvanced(\n/*\n  selectorFactory is a func that is responsible for returning the selector function used to\n  compute new props from state, props, and dispatch. For example:\n    export default connectAdvanced((dispatch, options) => (state, props) => ({\n      thing: state.things[props.thingId],\n      saveThing: fields => dispatch(actionCreators.saveThing(props.thingId, fields)),\n    }))(YourComponent)\n  Access to dispatch is provided to the factory so selectorFactories can bind actionCreators\n  outside of their selector as an optimization. Options passed to connectAdvanced are passed to\n  the selectorFactory, along with displayName and WrappedComponent, as the second argument.\n  Note that selectorFactory is responsible for all caching/memoization of inbound and outbound\n  props. Do not use connectAdvanced directly without memoizing results between calls to your\n  selector, otherwise the Connect component will re-render on every state or props change.\n*/\nselectorFactory, \n// options object:\n{ \n// the func used to compute this HOC's displayName from the wrapped component's displayName.\n// probably overridden by wrapper functions such as connect()\ngetDisplayName = (name) => `ConnectAdvanced(${name})`, \n// shown in error messages\n// probably overridden by wrapper functions such as connect()\nmethodName = 'connectAdvanced', \n// stores to connect to\nstores = [], \n// determines whether this HOC subscribes to store changes\nshouldHandleStateChanges = true, \n// use React's forwardRef to expose a ref of the wrapped component\nforwardRef = false, \n// function used to schedule updates\nschedule = (fn) => fn(), \n// is component and all toProps functions are pure, so they can be memoized\npure = true, \n// additional options are passed through to the selectorFactory\n...connectOptions } = {}) {\n    return function wrapWithConnect(WrappedComponent) {\n        if (process.env.NODE_ENV !== 'production') {\n            invariant(isValidElementType(WrappedComponent), `You must pass a component to the function returned by ` +\n                `${methodName}. Instead received ${stringifyComponent(WrappedComponent)}`);\n        }\n        const wrappedComponentName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n        const displayName = getDisplayName(wrappedComponentName);\n        const selectorFactoryOptions = {\n            ...connectOptions,\n            pure,\n            getDisplayName,\n            methodName,\n            shouldHandleStateChanges,\n            displayName,\n            wrappedComponentName,\n            WrappedComponent,\n        };\n        const ConnectFunction = (props) => {\n            const [forwardedRef, wrapperProps] = useMemo(() => {\n                // Distinguish between actual \"data\" props that were passed to the wrapper component,\n                // and values needed to control behavior (forwarded refs, alternate context instances).\n                // To maintain the wrapperProps object reference, memoize this destructuring.\n                // eslint-disable-next-line no-shadow\n                const { forwardedRef, ...wrapperProps } = props;\n                return [forwardedRef, wrapperProps];\n            }, [props]);\n            // Retrieve the store and ancestor subscription via context, if available\n            const contextValue = useConsumerContext();\n            const serverState = useContext(ServerStateContext);\n            invariant(Boolean(contextValue), `Could not find context in ` +\n                `\"${displayName}\". Either wrap the root component in a <Provider>, ` +\n                `or pass a custom React context provider to <Provider> and the corresponding ` +\n                `React context consumer to ${displayName} in connect options.`);\n            const childPropsSelector = useMemo(() => {\n                // The child props selector needs the store reference as an input.\n                // Re-create this selector whenever the store changes.\n                return selectorFactory(contextValue, selectorFactoryOptions);\n            }, [contextValue]);\n            const subscription = useMemo(() => {\n                if (!shouldHandleStateChanges)\n                    return null;\n                return new Subscription(stores.map((store) => contextValue.getStore(store)));\n            }, [contextValue]);\n            useMemo(() => {\n                if (subscription && typeof window !== 'undefined') {\n                    subscription.trySubscribe();\n                }\n            }, [subscription]);\n            const renderIsScheduled = useRef(false);\n            const actualChildPropsSelector = useCallback(() => {\n                return childPropsSelector(contextValue.getState(), wrapperProps);\n            }, [contextValue, wrapperProps, childPropsSelector]);\n            // Our re-subscribe logic only runs when the store/subscription setup changes\n            const subscribe = useCallback((reactUpdate) => {\n                if (!subscription) {\n                    return noop;\n                }\n                subscription.setOnStateChange(() => {\n                    if (!renderIsScheduled.current) {\n                        renderIsScheduled.current = true;\n                        schedule(() => {\n                            reactUpdate();\n                            renderIsScheduled.current = false;\n                        });\n                    }\n                });\n                return () => {\n                    return subscription.tryUnsubscribe();\n                };\n            }, [subscription]);\n            const actualChildProps = useSyncExternalStore(subscribe, actualChildPropsSelector, serverState ? () => childPropsSelector(serverState, wrapperProps) : actualChildPropsSelector);\n            // Now that all that's done, we can finally try to actually render the child component.\n            // We memoize the elements for the rendered child component as an optimization.\n            const renderedWrappedComponent = useMemo(\n            // eslint-disable-next-line react/jsx-props-no-spreading\n            () => jsx(WrappedComponent, { ...actualChildProps, ref: forwardedRef }), [forwardedRef, actualChildProps]);\n            return renderedWrappedComponent;\n        };\n        // If we're in \"pure\" mode, ensure our wrapper component only re-renders when incoming props have changed.\n        const Connect = pure ? React.memo(ConnectFunction) : ConnectFunction;\n        Connect.WrappedComponent = WrappedComponent;\n        Connect.displayName = displayName;\n        if (forwardRef) {\n            const forwarded = React.forwardRef(function forwardConnectRef(props, ref) {\n                // eslint-disable-next-line react/jsx-props-no-spreading\n                return jsx(Connect, { ...props, forwardedRef: ref });\n            });\n            forwarded.displayName = displayName;\n            forwarded.WrappedComponent = WrappedComponent;\n            return hoistStatics(forwarded, WrappedComponent);\n        }\n        return hoistStatics(Connect, WrappedComponent);\n    };\n}\n\nconst getLogger = () => console;\n\nfunction verifyPlainObject(value, displayName, methodName) {\n    if (!isPlainObject(value)) {\n        getLogger().debug(`${methodName}() in ${displayName} must return a plain object. Instead received ${value}.`);\n    }\n}\n\nfunction verifyFunction(value, displayName, methodName) {\n    if (!isFunction(value)) {\n        getLogger().debug(`${methodName}() in ${displayName} must be a function. Instead received ${JSON.stringify(value)}.`);\n    }\n}\n\nfunction wrapMapToPropsConstant(getConstant) {\n    return function initConstantSelector(context, options) {\n        const constantSelector = always(getConstant(context, options));\n        constantSelector.dependsOnOwnProps = false;\n        return constantSelector;\n    };\n}\n// dependsOnOwnProps is used by createMapToPropsProxy to determine whether to pass props as args\n// to the mapToProps function being wrapped. It is also used by makePurePropsSelector to determine\n// whether mapToProps needs to be invoked when props have changed.\n//\n// A length of one signals that mapToProps does not depend on props from the parent component.\n// A length of zero is assumed to mean mapToProps is getting args via arguments or ...args and\n// therefore not reporting its length accurately..\nfunction getDependsOnOwnProps(mapToProps) {\n    return mapToProps.dependsOnOwnProps !== null && mapToProps.dependsOnOwnProps !== undefined\n        ? Boolean(mapToProps.dependsOnOwnProps)\n        : mapToProps.length !== 1;\n}\n// Used by whenMapStateToPropsIsFunction and whenMapDispatchToPropsIsFunction,\n// this function wraps mapToProps in a proxy function which does several things:\n//\n//  * Detects whether the mapToProps function being called depends on props, which\n//    is used by selectorFactory to decide if it should reinvoke on props changes.\n//\n//  * On first call, handles mapToProps if returns another function, and treats that\n//    new function as the true mapToProps for subsequent calls.\n//\n//  * On first call, verifies the first result is a plain object, in order to warn\n//    the developer that their mapToProps function is not returning a valid result.\n//\nfunction wrapMapToPropsFunc(mapToProps, methodName) {\n    return function initProxySelector(context, { displayName }) {\n        const proxy = (stateOrContext, ownProps) => proxy.dependsOnOwnProps\n            ? proxy.mapToProps(stateOrContext, ownProps)\n            : proxy.mapToProps(stateOrContext, undefined);\n        // allow detectFactoryAndVerify to get ownProps\n        proxy.dependsOnOwnProps = true;\n        proxy.mapToProps = function detectFactoryAndVerify(stateOrContext, ownProps) {\n            proxy.mapToProps = mapToProps;\n            proxy.dependsOnOwnProps = getDependsOnOwnProps(mapToProps);\n            let props = proxy(stateOrContext, ownProps);\n            if (typeof props === 'function') {\n                proxy.mapToProps = props;\n                proxy.dependsOnOwnProps = getDependsOnOwnProps(props);\n                props = proxy(stateOrContext, ownProps);\n            }\n            if (process.env.NODE_ENV !== 'production') {\n                verifyPlainObject(props, displayName, methodName);\n            }\n            return props;\n        };\n        return proxy;\n    };\n}\nfunction wrapMapToPropsObject(actionsObject) {\n    function getConstant({ executeAction }, { displayName }) {\n        return mapObject((action, actionName) => {\n            if (process.env.NODE_ENV !== 'production') {\n                verifyFunction(action, displayName, actionName);\n            }\n            return (params) => executeAction(action, params);\n        }, actionsObject);\n    }\n    return wrapMapToPropsConstant(getConstant);\n}\n\nfunction whenMapContextToPropsIsFunction(mapContextToProps) {\n    return typeof mapContextToProps === 'function'\n        ? wrapMapToPropsFunc(mapContextToProps, 'mapContextToProps')\n        : undefined;\n}\nfunction whenMapContextToPropsIsMissing(mapContextToProps) {\n    return !mapContextToProps ? wrapMapToPropsConstant(always({})) : undefined;\n}\nfunction whenMapContextToPropsIsObject(mapContextToProps) {\n    return typeof mapContextToProps === 'object' && mapContextToProps !== null\n        ? wrapMapToPropsObject(mapContextToProps)\n        : undefined;\n}\nconst mapContextToPropsFactories = [\n    whenMapContextToPropsIsObject,\n    whenMapContextToPropsIsFunction,\n    whenMapContextToPropsIsMissing,\n];\n\nfunction whenMapStateToPropsIsFunction(mapStateToProps) {\n    return typeof mapStateToProps === 'function'\n        ? wrapMapToPropsFunc(mapStateToProps, 'mapStateToProps')\n        : undefined;\n}\nfunction whenMapStateToPropsIsMissing(mapStateToProps) {\n    return !mapStateToProps ? wrapMapToPropsConstant(always({})) : undefined;\n}\nconst mapStateToPropsFactories = [\n    whenMapStateToPropsIsFunction,\n    whenMapStateToPropsIsMissing,\n];\n\nconst defaultMergeProps = (stateProps, contextProps, ownProps) => {\n    return { ...ownProps, ...stateProps, ...contextProps };\n};\nfunction wrapMergePropsFunc(mergeProps) {\n    return function initMergePropsProxy(context, { displayName, pure, areMergedPropsEqual }) {\n        let hasRunOnce = false;\n        let mergedProps;\n        return function mergePropsProxy(stateProps, contextProps, ownProps) {\n            const nextMergedProps = mergeProps(stateProps, contextProps, ownProps);\n            if (hasRunOnce) {\n                if (!pure || !areMergedPropsEqual(nextMergedProps, mergedProps)) {\n                    mergedProps = nextMergedProps;\n                }\n            }\n            else {\n                hasRunOnce = true;\n                mergedProps = nextMergedProps;\n                if (process.env.NODE_ENV !== 'production') {\n                    verifyPlainObject(mergedProps, displayName, 'mergeProps');\n                }\n            }\n            return mergedProps;\n        };\n    };\n}\nfunction whenMergePropsIsFunction(mergeProps) {\n    return typeof mergeProps === 'function' ? wrapMergePropsFunc(mergeProps) : undefined;\n}\nfunction whenMergePropsIsOmitted(mergeProps) {\n    return !mergeProps ? () => defaultMergeProps : undefined;\n}\nconst mergePropsFactories = [whenMergePropsIsFunction, whenMergePropsIsOmitted];\n\nconst verifyMapToProps = (mapStateToProps, name) => {\n    function verify(state, props) {\n        const firstStateProps = mapStateToProps(state, props);\n        const secondStateProps = mapStateToProps(state, props);\n        if (!shallowEqual(firstStateProps, secondStateProps)) {\n            getLogger().warn('Component \"%s\" recreate equal props %s', name, Object.keys(firstStateProps)\n                .filter((key) => firstStateProps[key] !== secondStateProps[key])\n                .map((key) => `\"${key}\"`)\n                .join(', '));\n        }\n        verify.dependsOnOwnProps = mapStateToProps.dependsOnOwnProps;\n        return secondStateProps;\n    }\n    return verify;\n};\n\nfunction impureFinalPropsSelectorFactory(mapStateToProps, mapContextToProps, mergeProps, context) {\n    return function impureFinalPropsSelector(state, ownProps) {\n        return mergeProps(mapStateToProps(state, ownProps), mapContextToProps(context, ownProps), ownProps);\n    };\n}\n// eslint-disable-next-line max-params\nfunction pureFinalPropsSelectorFactory(mapStateToProps, mapContextToProps, mergeProps, context, { areStatesEqual, areOwnPropsEqual, areStatePropsEqual, WrappedComponent: { defaultProps } }) {\n    let hasRunAtLeastOnce = false;\n    let state;\n    let ownProps;\n    let ownPropsWithDefault;\n    let stateProps;\n    let contextProps;\n    let mergedProps;\n    function handleFirstCall(firstState, firstOwnProps) {\n        state = firstState;\n        ownProps = firstOwnProps;\n        ownPropsWithDefault = { ...defaultProps, ...firstOwnProps }; // TODO проверить зачем мержить пропсы с defaultProps, взято из старого connect, иначе падают некоторые тесты\n        stateProps = mapStateToProps(state, ownPropsWithDefault);\n        contextProps = mapContextToProps(context, ownPropsWithDefault);\n        mergedProps = mergeProps(stateProps, contextProps, ownProps);\n        hasRunAtLeastOnce = true;\n        return mergedProps;\n    }\n    function handleNewPropsAndNewState() {\n        stateProps = mapStateToProps(state, ownPropsWithDefault);\n        if (mapContextToProps.dependsOnOwnProps) {\n            contextProps = mapContextToProps(context, ownPropsWithDefault);\n        }\n        mergedProps = mergeProps(stateProps, contextProps, ownProps);\n        return mergedProps;\n    }\n    function handleNewProps() {\n        if (mapStateToProps.dependsOnOwnProps) {\n            stateProps = mapStateToProps(state, ownPropsWithDefault);\n        }\n        if (mapContextToProps.dependsOnOwnProps) {\n            contextProps = mapContextToProps(context, ownPropsWithDefault);\n        }\n        mergedProps = mergeProps(stateProps, contextProps, ownProps);\n        return mergedProps;\n    }\n    function handleNewState() {\n        const nextStateProps = mapStateToProps(state, ownPropsWithDefault);\n        const statePropsChanged = !areStatePropsEqual(nextStateProps, stateProps);\n        stateProps = nextStateProps;\n        if (statePropsChanged) {\n            mergedProps = mergeProps(stateProps, contextProps, ownProps);\n        }\n        return mergedProps;\n    }\n    function handleSubsequentCalls(nextState, nextOwnProps) {\n        const propsChanged = !areOwnPropsEqual(nextOwnProps, ownProps);\n        const stateChanged = !areStatesEqual(nextState, state);\n        state = nextState;\n        ownProps = nextOwnProps;\n        ownPropsWithDefault = { ...defaultProps, ...nextOwnProps };\n        if (propsChanged && stateChanged) {\n            return handleNewPropsAndNewState();\n        }\n        if (propsChanged) {\n            return handleNewProps();\n        }\n        if (stateChanged) {\n            return handleNewState();\n        }\n        return mergedProps;\n    }\n    return function pureFinalPropsSelector(nextState, nextOwnProps) {\n        return hasRunAtLeastOnce\n            ? handleSubsequentCalls(nextState, nextOwnProps)\n            : handleFirstCall(nextState, nextOwnProps);\n    };\n}\n// TODO: Add more comments\n// If pure is true, the selector returned by selectorFactory will memoize its results,\n// allowing connectAdvanced's shouldComponentUpdate to return false if final\n// props have not changed. If false, the selector will always return a new\n// object and shouldComponentUpdate will always return true.\nfunction finalPropsSelectorFactory(context, { initMapStateToProps, initMapContextToProps, initMergeProps, ...options }) {\n    let mapStateToProps = initMapStateToProps(context, options);\n    const mapContextToProps = initMapContextToProps(context, options);\n    const mergeProps = initMergeProps(context, options);\n    if (process.env.NODE_ENV !== 'production') {\n        mapStateToProps = verifyMapToProps(mapStateToProps, options.WrappedComponent.name);\n    }\n    const selectorFactory = options.pure\n        ? pureFinalPropsSelectorFactory\n        : impureFinalPropsSelectorFactory;\n    return selectorFactory(mapStateToProps, mapContextToProps, mergeProps, context, options);\n}\n\nconst Provider = ({ context, children, serverState, }) => {\n    return (jsx(ConnectContext.Provider, { value: context, children: jsx(ServerStateContext.Provider, { value: serverState, children: children }) }));\n};\n\n/*\n  connect is a facade over connectAdvanced. It turns its args into a compatible\n  selectorFactory, which has the signature:\n    (dispatch, options) => (nextState, nextOwnProps) => nextFinalProps\n\n  connect passes its args to connectAdvanced as options, which will in turn pass them to\n  selectorFactory each time a Connect component instance is instantiated or hot reloaded.\n  selectorFactory returns a final props selector from its mapStateToProps,\n  mapStateToPropsFactories, mapContextToProps, mapContextToPropsFactories, mergeProps,\n  mergePropsFactories, and pure args.\n  The resulting final props selector is called by the Connect component instance whenever\n  it receives new props or store state.\n */\nfunction match(arg, factories, name) {\n    for (let i = factories.length - 1; i >= 0; i--) {\n        const result = factories[i](arg);\n        if (result) {\n            return result;\n        }\n    }\n    return (context, options) => {\n        throw new Error(`Invalid value of type ${typeof arg} for ${name} argument when connecting component ${options.wrappedComponentName}.`);\n    };\n}\n// createConnect with default args builds the 'official' connect behavior. Calling it with\n// different options opens up some testing and extensibility scenarios\n/**\n * @deprecated\n */\nfunction createConnect({ connectHOC = connectAdvanced, mapStateToPropsFactories: mapStateToPropsFactories$1 = mapStateToPropsFactories, mapContextToPropsFactories: mapContextToPropsFactories$1 = mapContextToPropsFactories, mergePropsFactories: mergePropsFactories$1 = mergePropsFactories, selectorFactory = finalPropsSelectorFactory, schedule = scheduling(), } = {}) {\n    return (stores, mapStateToProps, mapContextToProps, mergeProps, { pure = true, areStatesEqual = strictEqual, areOwnPropsEqual = shallowEqual, areStatePropsEqual = shallowEqual, areMergedPropsEqual = shallowEqual, ...extraOptions } = {}\n    // eslint-disable-next-line max-params\n    ) => {\n        // @ts-ignore\n        const initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories$1, 'mapStateToProps');\n        // @ts-ignore\n        const initMapContextToProps = match(mapContextToProps, \n        // @ts-ignore\n        mapContextToPropsFactories$1, 'mapContextToProps');\n        // @ts-ignore\n        const initMergeProps = match(mergeProps, mergePropsFactories$1, 'mergeProps');\n        return connectHOC(selectorFactory, {\n            // @ts-ignore\n            stores,\n            // passed through to selectorFactory 2\n            // @ts-ignore\n            initMapStateToProps,\n            initMapContextToProps,\n            initMergeProps,\n            pure,\n            areStatesEqual,\n            areOwnPropsEqual,\n            areStatePropsEqual,\n            areMergedPropsEqual,\n            schedule,\n            // used in error messages\n            methodName: 'connect',\n            // used to compute Connect's displayName from the wrapped component's displayName.\n            getDisplayName: (name) => `Connect(${name})`,\n            // if mapStateToProps is falsy, the Connect component doesn't subscribe to store state changes\n            shouldHandleStateChanges: stores && stores.length > 0,\n            // any extra options args can override defaults of connect or connectAdvanced\n            ...extraOptions,\n        });\n    };\n}\n/**\n * @deprecated\n */\nconst connect = /* @__PURE__ */ createConnect();\nconst { Consumer } = ConnectContext;\n\nexport { BaseStore, ChildDispatcherContext, Consumer, Dispatcher, DispatcherContext, Provider, Subscription, connect, convertAction, createConnect, createDispatcher, createEvent, createReducer, index as devTools, useActions, useConsumerContext, useSelector, useStore, useStoreSelector };\n","import { createToken } from '@tinkoff/dippy';\n\nconst multiOptions = { multi: true };\n/**\n * @public\n * @description CommandLineRunner steps specific for child app\n */\nconst commandLineListTokens = {\n    // section: client processing\n    customerStart: createToken('child-app customer_start', multiOptions),\n    resolveUserDeps: createToken('child-app resolve_user_deps', multiOptions),\n    resolvePageDeps: createToken('child-app resolve_page_deps', multiOptions),\n    // section: clear data\n    clear: createToken('child-app clear', multiOptions),\n    // section: spa transitions\n    spaTransition: createToken('child-app spa_transition', multiOptions),\n    // section: after spa transitions\n    afterSpaTransition: createToken('child-app after_spa_transition', multiOptions),\n};\n/**\n * @public\n * @description Contains child app configs that was used to figure out how to load child apps\n */\nconst CHILD_APP_RESOLUTION_CONFIGS_TOKEN = createToken('child-app resolve configs', multiOptions);\n/**\n * @public\n * @description Used to resolve and extend resolution configs for child-apps\n */\nconst CHILD_APP_RESOLUTION_CONFIG_MANAGER_TOKEN = createToken('child-app resolution config manager');\n/**\n * @public\n * @description Used to resolve external config with urls to external code entries\n */\nconst CHILD_APP_RESOLVE_CONFIG_TOKEN = createToken('child-app resolve external config');\n/**\n * @public\n * @description Base url for external urls for child apps on client\n */\nconst CHILD_APP_RESOLVE_BASE_URL_TOKEN = createToken('child-app resolve external base url');\n/**\n * @public\n * @description Allows to preload child app for the specific page\n */\nconst CHILD_APP_PRELOAD_MANAGER_TOKEN = createToken('child-app preload manager');\n/**\n * @public\n * @description Contains child app config that was used to load current child app\n */\nconst CHILD_APP_INTERNAL_CONFIG_TOKEN = createToken('child-app current config');\n/**\n * @public\n * @description Actions of child app\n */\nconst CHILD_APP_INTERNAL_ACTION_TOKEN = createToken('child-app action', multiOptions);\n/**\n * @deprecated use CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN\n * @public\n * @description Subscription on a root state updates\n */\nconst CHILD_APP_INTERNAL_ROOT_STATE_SUBSCRIPTION_TOKEN = createToken('child-app root state subscription', multiOptions);\n/**\n * @public\n * @description Root-app stores that might be used inside child-app\n */\nconst CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN = createToken('child-app root state allowed store', multiOptions);\n/**\n * @public\n * @description Allows to recreate token implementation the same way as in root di, but specific to child-app di\n */\nconst CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN = createToken('child-app root di borrow', multiOptions);\n/**\n * @private\n * @description boolean flag indicating that current di if for a child-app\n */\nconst IS_CHILD_APP_DI_TOKEN = createToken('child-app isChildApp Di');\n/**\n * @private\n * @description Manages Singleton-Scope DIs for every child app\n */\nconst CHILD_APP_SINGLETON_DI_MANAGER_TOKEN = createToken('child-app singleton di manager');\n/**\n * @private\n * @description Manages Request-Scope DIs for every child app\n */\nconst CHILD_APP_DI_MANAGER_TOKEN = createToken('child-app di manager');\n/**\n * @private\n * @description Bridge from React render to di providers for child apps\n */\nconst CHILD_APP_RENDER_MANAGER_TOKEN = createToken('child-app render manager');\n/**\n * @private\n * @description Manages state dehydration for child-app\n */\nconst CHILD_APP_STATE_MANAGER_TOKEN = createToken('child-app state manager');\n/**\n * @private\n * @description Manages loading child-app resources from the external place\n */\nconst CHILD_APP_LOADER_TOKEN = createToken('child-app loader');\n/**\n * @private\n * @description Implements CommandLineRunner for child apps\n */\nconst CHILD_APP_COMMAND_LINE_RUNNER_TOKEN = createToken('child-app command runner');\n/**\n * @private\n * @description Stores the common server-dehydrated state for all of child apps\n */\nconst CHILD_APP_COMMON_INITIAL_STATE_TOKEN = createToken('child-app initialAppState');\n/**\n * @private\n * @description Used as render function for a child app. Usually implemented as a wrapper over child app render itself with an additional logic for di and connections to root app\n */\nconst CHILD_APP_INTERNAL_RENDER_TOKEN = createToken('child-app render');\n\nexport { CHILD_APP_COMMAND_LINE_RUNNER_TOKEN, CHILD_APP_COMMON_INITIAL_STATE_TOKEN, CHILD_APP_DI_MANAGER_TOKEN, CHILD_APP_INTERNAL_ACTION_TOKEN, CHILD_APP_INTERNAL_CONFIG_TOKEN, CHILD_APP_INTERNAL_RENDER_TOKEN, CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN, CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN, CHILD_APP_INTERNAL_ROOT_STATE_SUBSCRIPTION_TOKEN, CHILD_APP_LOADER_TOKEN, CHILD_APP_PRELOAD_MANAGER_TOKEN, CHILD_APP_RENDER_MANAGER_TOKEN, CHILD_APP_RESOLUTION_CONFIGS_TOKEN, CHILD_APP_RESOLUTION_CONFIG_MANAGER_TOKEN, CHILD_APP_RESOLVE_BASE_URL_TOKEN, CHILD_APP_RESOLVE_CONFIG_TOKEN, CHILD_APP_SINGLETON_DI_MANAGER_TOKEN, CHILD_APP_STATE_MANAGER_TOKEN, IS_CHILD_APP_DI_TOKEN, commandLineListTokens };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Bundle Storage. When getting bundle additionally adds actions and components from bundle to according storages\n */\nconst BUNDLE_MANAGER_TOKEN = createToken('bundleManager');\n/**\n * @description\n * Provides additional bundles to the app.\n * Important! This token doesn't overrides already existing bundles.\n */\nconst ADDITIONAL_BUNDLE_TOKEN = createToken('additional bundle', {\n    multi: true,\n});\n\n/**\n * @description\n * Context implementation\n */\nconst CONTEXT_TOKEN = createToken('context');\n\n/**\n * @description\n * Registry for storing actions based on their type\n */\nconst ACTION_REGISTRY_TOKEN = createToken('actionRegistry');\n/**\n * @description\n * Instance that executes actions\n */\nconst ACTION_EXECUTION_TOKEN = createToken('actionExecution');\n/**\n * @description\n * Instance that executes actions on navigations\n */\nconst ACTION_PAGE_RUNNER_TOKEN = createToken('actionPageRunner');\n/**\n * @description\n * Conditions that specify should action be executing or not\n */\nconst ACTION_CONDITIONALS = createToken('actionConditionals', {\n    multi: true,\n});\n\n/**\n * @description\n * [Hooks documentation](https://tramvai.dev/docs/references/libs/hooks)\n */\nconst HOOK_TOKEN = createToken('hooks');\n\n/**\n * @description\n * Factory for creating pubsub instances\n */\nconst PUBSUB_FACTORY_TOKEN = createToken('pubsubFactory');\n/**\n * @description\n * Singleton pubsub instance\n */\nconst PUBSUB_TOKEN = createToken('pubsub');\n/**\n * @description\n * Request pubsub instance that is created for every client\n */\nconst ROOT_PUBSUB_TOKEN = createToken('rootPubsub');\n\n/**\n * @description\n * Function for creating a new cache\n *\n * *Note*: currently only memory cache with `@tinkoff/lru-cache-nano` is supported\n */\nconst CREATE_CACHE_TOKEN = createToken('createCache');\n/**\n * @description\n * Function that us called on force cache clean up in the app\n */\nconst REGISTER_CLEAR_CACHE_TOKEN = createToken('registerClearCache', { multi: true });\n/**\n * @description\n * Force cleaning up all caches in the app\n */\nconst CLEAR_CACHE_TOKEN = createToken('clearCache');\n\n/**\n * @description\n * React components storage.\n * Components in the repository are divided into groups, e.g. you can specify a bundle or a page component as a group key.\n * The entity also allows you to get static component parameters through the `getComponentParam` method (will not work with `lazy` components)\n */\nconst COMPONENT_REGISTRY_TOKEN = createToken('componentRegistry');\n\n/**\n * @description\n * dispatcher implementation\n * Реализация dispatcher\n */\nconst DISPATCHER_TOKEN = createToken('dispatcher');\n/**\n * @description\n * dispatcher context implementation\n */\nconst DISPATCHER_CONTEXT_TOKEN = createToken('dispatcherContext');\n/**\n * @description\n * Token for adding stores that were created with createReducer\n */\nconst COMBINE_REDUCERS = createToken('combineReducers', { multi: true });\n/**\n * @description\n * Common app store\n */\nconst STORE_TOKEN = createToken('store');\n/**\n * @description\n * Custom middlewares for working with store state\n */\nconst STORE_MIDDLEWARE = createToken('storeMiddleware', { multi: true });\n/**\n * @description\n * Начальное состояние для клиента\n */\nconst INITIAL_APP_STATE_TOKEN = createToken('initialAppState');\n\n/**\n * @description\n * Logger implementation\n */\nconst LOGGER_TOKEN = createToken('logger');\n/**\n * @description\n * Hook to be able to modify logger on initialization\n */\nconst LOGGER_INIT_HOOK = createToken('loggerHook');\n\n/**\n * @description\n * Instance for managing client requests (request headers, query-parameters, cookies etc).\n * Mostly used on server, but has partial functional for browser for simplification build isomorphic app\n */\nconst REQUEST_MANAGER_TOKEN = createToken('requestManager');\n\n/**\n * @description\n * Instance for managing client response (response headers, cookies, response body).\n * Mostly used on server, but has partial functional for browser for simplification build isomorphic app\n */\nconst RESPONSE_MANAGER_TOKEN = createToken('responseManager');\n\n/**\n * @description\n * Instance that used for managing env data on the server and on the client\n */\nconst ENV_MANAGER_TOKEN = createToken('environmentManager');\nconst ENV_USED_TOKEN = createToken('envUsed', { multi: true });\n\nconst EXECUTION_CONTEXT_MANAGER_TOKEN = createToken('common ExecutionContextManager');\nconst ROOT_EXECUTION_CONTEXT_TOKEN = createToken('common rootExecutionContext');\nconst COMMAND_LINE_EXECUTION_CONTEXT_TOKEN = createToken('common commandLineExecutionContext');\n\nexport { ACTION_CONDITIONALS, ACTION_EXECUTION_TOKEN, ACTION_PAGE_RUNNER_TOKEN, ACTION_REGISTRY_TOKEN, ADDITIONAL_BUNDLE_TOKEN, BUNDLE_MANAGER_TOKEN, CLEAR_CACHE_TOKEN, COMBINE_REDUCERS, COMMAND_LINE_EXECUTION_CONTEXT_TOKEN, COMPONENT_REGISTRY_TOKEN, CONTEXT_TOKEN, CREATE_CACHE_TOKEN, DISPATCHER_CONTEXT_TOKEN, DISPATCHER_TOKEN, ENV_MANAGER_TOKEN, ENV_USED_TOKEN, EXECUTION_CONTEXT_MANAGER_TOKEN, HOOK_TOKEN, INITIAL_APP_STATE_TOKEN, LOGGER_INIT_HOOK, LOGGER_TOKEN, PUBSUB_FACTORY_TOKEN, PUBSUB_TOKEN, REGISTER_CLEAR_CACHE_TOKEN, REQUEST_MANAGER_TOKEN, RESPONSE_MANAGER_TOKEN, ROOT_EXECUTION_CONTEXT_TOKEN, ROOT_PUBSUB_TOKEN, STORE_MIDDLEWARE, STORE_TOKEN };\n","import { createToken } from '@tinkoff/dippy';\n\nconst COOKIE_MANAGER_TOKEN = createToken('cookieManager');\n\nexport { COOKIE_MANAGER_TOKEN };\n","import { createToken } from '@tinkoff/dippy';\nexport { ACTION_PARAMETERS } from '@tramvai/types-actions-state-context';\n\nconst multiOptions = { multi: true };\nconst COMMAND_LINE_RUNNER_TOKEN = createToken('commandLineRunner');\nconst COMMAND_LINES_TOKEN = createToken('commandLines');\nconst commandLineListTokens = {\n    // Block: Initializing\n    init: createToken('init', multiOptions),\n    listen: createToken('listen', multiOptions),\n    // Block: Request handling\n    customerStart: createToken('customer_start', multiOptions),\n    resolveUserDeps: createToken('resolve_user_deps', multiOptions),\n    resolvePageDeps: createToken('resolve_page_deps', multiOptions),\n    generatePage: createToken('generate_page', multiOptions),\n    clear: createToken('clear', multiOptions),\n    // Block: Client navigations\n    spaTransition: createToken('spa_transition', multiOptions),\n    afterSpaTransition: createToken('after_spa_transition', multiOptions),\n    // Block: Server stop\n    close: createToken('close', multiOptions),\n};\n\nconst BUNDLE_LIST_TOKEN = createToken('bundleList');\nconst ACTIONS_LIST_TOKEN = createToken('actionsList');\nconst MODULES_LIST_TOKEN = createToken('modulesList');\nconst APP_INFO_TOKEN = createToken('appInfo');\n\nexport { ACTIONS_LIST_TOKEN, APP_INFO_TOKEN, BUNDLE_LIST_TOKEN, COMMAND_LINES_TOKEN, COMMAND_LINE_RUNNER_TOKEN, MODULES_LIST_TOKEN, commandLineListTokens };\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.push(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.push(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","const ACTION_PARAMETERS = '__action_parameters__';\n\nexport { ACTION_PARAMETERS };\n","import { __decorate } from 'tslib';\nimport { Module, Scope } from '@tramvai/core';\nimport { ENV_MANAGER_TOKEN, STORE_TOKEN, COMBINE_REDUCERS } from '@tramvai/tokens-common';\nexport { ENV_MANAGER_TOKEN, ENV_USED_TOKEN } from '@tramvai/tokens-common';\nimport { createReducer } from '@tramvai/state';\n\nclass EnvironmentManager {\n    constructor() {\n        this.parameters = {};\n    }\n    get(name) {\n        return this.parameters[name];\n    }\n    getInt(name, def) {\n        const value = Number(name in this.parameters ? this.parameters[name] : def);\n        return Number.isFinite(value) ? value : def;\n    }\n    getAll() {\n        return this.parameters;\n    }\n    update(result) {\n        this.parameters = Object.assign(this.parameters, result);\n    }\n    clientUsed() {\n        return this.getAll();\n    }\n    updateClientUsed(result) {\n        this.update(result);\n    }\n}\n\nconst EnvironmentStore = createReducer('environment', {});\n\nlet EnvironmentModule = class EnvironmentModule {\n};\nEnvironmentModule = __decorate([\n    Module({\n        providers: [\n            {\n                provide: ENV_MANAGER_TOKEN,\n                useFactory: ({ store }) => {\n                    const env = new EnvironmentManager();\n                    env.update(store.getState(EnvironmentStore));\n                    return env;\n                },\n                scope: Scope.SINGLETON,\n                deps: {\n                    store: STORE_TOKEN,\n                },\n            },\n            {\n                provide: COMBINE_REDUCERS,\n                useValue: EnvironmentStore,\n                multi: true,\n            },\n        ],\n    })\n], EnvironmentModule);\n\nexport { EnvironmentModule };\n","const DEFAULT_PATH = '/';\nconst MS_IN_DAY = 864e5;\n/**\n * Apply default value for unspecified options\n */\nfunction applyDefaults(options = {}, defaults = {}) {\n    var _a, _b, _c, _d, _e;\n    const expires = options.expires || defaults.expires;\n    const domain = options.domain || defaults.domain;\n    const path = (_b = (_a = options.path) !== null && _a !== void 0 ? _a : defaults.path) !== null && _b !== void 0 ? _b : DEFAULT_PATH;\n    const secure = (_c = options.secure) !== null && _c !== void 0 ? _c : defaults.secure;\n    const httpOnly = (_d = options.httpOnly) !== null && _d !== void 0 ? _d : defaults.httpOnly;\n    const sameSite = (_e = options.sameSite) !== null && _e !== void 0 ? _e : defaults.sameSite;\n    return {\n        expires,\n        domain,\n        path,\n        secure,\n        httpOnly,\n        sameSite,\n    };\n}\n/**\n * Determine cookie expiration date\n * If succesful the result will be a valid Date, otherwise it will be an invalid Date or false(ish)\n */\nfunction getExpireDate(expires) {\n    const expireDate = expires\n        ? new Date(\n        // in case expires is an integer, it should specify the number of days till the cookie expires\n        typeof expires === 'number'\n            ? new Date().getTime() + expires * MS_IN_DAY\n            : // else expires should be either a Date object or in a format recognized by Date.parse()\n                expires)\n        : null;\n    return expireDate;\n}\n\nclass Cookies {\n    constructor(defaults = {}) {\n        this.defaults = defaults;\n    }\n    // eslint-disable-next-line class-methods-use-this\n    get(name) {\n        const cookies = document.cookie.split(';');\n        // Iterate all cookies\n        while (cookies.length) {\n            const cookie = cookies.pop();\n            if (!cookie) {\n                break;\n            }\n            // Determine separator index (\"name=value\")\n            let separatorIndex = cookie.indexOf('=');\n            // IE<11 emits the equal sign when the cookie value is empty\n            separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\n            const cookieName = cookie.slice(0, separatorIndex).replace(/^\\s+/, '');\n            const cookieValue = cookie.slice(separatorIndex + 1);\n            let cookieDecodedName;\n            try {\n                cookieDecodedName = decodeURIComponent(cookieName);\n            }\n            catch (e) {\n                // eslint-disable-next-line no-console\n                console.warn('Decode cookie name error', e);\n            }\n            // Return cookie value if the name matches\n            if (cookieDecodedName === name || cookieName === name) {\n                try {\n                    return decodeURIComponent(cookieValue);\n                }\n                catch (e) {\n                    // eslint-disable-next-line no-console\n                    console.warn('Decode cookie value error', e);\n                    // use original cookie value, if decoding failed\n                    return cookieValue;\n                }\n            }\n        }\n        // Return `undefined` as the cookie was not found\n        return undefined;\n    }\n    set(name, value, options) {\n        if (!name) {\n            return;\n        }\n        const { domain, path, expires, secure, httpOnly, sameSite } = applyDefaults(options, this.defaults);\n        const expireDate = getExpireDate(expires);\n        // Encode cookie name\n        const cookieName = name\n            .replace(/[^+#$&^`|]/g, encodeURIComponent)\n            .replace('(', '%28')\n            .replace(')', '%29');\n        // Encode cookie value (RFC6265)\n        const cookieValue = (typeof value === 'string' ? value : '').replace(\n        // eslint-disable-next-line no-useless-escape\n        /[^+#$&/:<-\\[\\]-}]/g, encodeURIComponent);\n        const cookieExpires = expireDate && expireDate.getTime() >= 0 ? `;expires=${expireDate.toUTCString()}` : '';\n        const cookieDomain = domain ? `;domain=${domain}` : '';\n        const cookiePath = path ? `;path=${path}` : '';\n        const cookieSecure = secure ? ';secure' : '';\n        const cookieHttpOnly = httpOnly ? ';httponly' : '';\n        const cookieSameSite = sameSite ? `;samesite=${sameSite}` : '';\n        document.cookie = `${cookieName}=${cookieValue}${cookieExpires}${cookieDomain}${cookiePath}${cookieSecure}${cookieHttpOnly}${cookieSameSite}`;\n    }\n    erase(name, options = {}) {\n        this.set(name, '', {\n            expires: -1,\n            domain: options.domain,\n            path: options.path,\n            secure: false,\n            httpOnly: false,\n        });\n    }\n    // eslint-disable-next-line class-methods-use-this\n    all() {\n        const all = {};\n        const cookies = document.cookie.split(';');\n        // Iterate all cookies\n        while (cookies.length) {\n            const cookie = cookies.pop();\n            if (!cookie) {\n                break;\n            }\n            // Determine separator index (\"name=value\")\n            let separatorIndex = cookie.indexOf('=');\n            // IE<11 emits the equal sign when the cookie value is empty\n            separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\n            const cookieName = cookie.slice(0, separatorIndex).replace(/^\\s+/, '');\n            const cookieValue = cookie.slice(separatorIndex + 1);\n            let cookieDecodedName;\n            let cookieDecodedValue;\n            try {\n                cookieDecodedName = decodeURIComponent(cookieName);\n            }\n            catch (e) {\n                // eslint-disable-next-line no-console\n                console.warn('Decode cookie name error', e);\n            }\n            try {\n                cookieDecodedValue = decodeURIComponent(cookieValue);\n            }\n            catch (e) {\n                // eslint-disable-next-line no-console\n                console.warn('Decode cookie value error', e);\n            }\n            // use original cookie name and value, if decoding failed\n            all[cookieDecodedName !== null && cookieDecodedName !== void 0 ? cookieDecodedName : cookieName] = cookieDecodedValue !== null && cookieDecodedValue !== void 0 ? cookieDecodedValue : cookieValue;\n        }\n        return all;\n    }\n}\n\nexport { Cookies };\n","import { __decorate } from 'tslib';\nimport { Module, provide, Scope } from '@tramvai/core';\nimport { ClientHintsModule, USER_AGENT_TOKEN } from '@tramvai/module-client-hints';\nimport { Cookies } from '@tinkoff/browser-cookies';\nimport { COOKIE_MANAGER_TOKEN } from '@tramvai/tokens-cookie';\nexport { COOKIE_MANAGER_TOKEN } from '@tramvai/tokens-cookie';\n\n// ipv4 + IPv4-mapped IPv6 addresses and IPv4-translated addresses\nconst reIpWithDots = /^(?:::(?:ffff:(0:)?)?)?(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/; // IPv4-Embedded IPv6 Address\nconst reIpv4Embedded = /^([0-9a-fA-F]{1,4}:){1,4}:(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$/;\nconst calculateExpires = (expires) => {\n    // if expires is number than treat it as seconds\n    if (!expires) {\n        return;\n    }\n    return new Date(typeof expires === 'number' ? +new Date() + expires * 1000 : expires);\n};\nconst isIpWithDots = (host) => {\n    return reIpWithDots.test(host) || reIpv4Embedded.test(host);\n};\nconst trimPort = (host) => {\n    return host.replace(/:\\d+$/, '');\n};\nconst trimSubdomains = (host) => {\n    if (isIpWithDots(host)) {\n        return host;\n    }\n    return trimPort(host.indexOf('localhost') >= 0 ? host : `.${host.split('.').slice(-2).join('.')}`);\n};\nconst prepareCookieOptions = ({ userAgent: { sameSiteNoneCompatible }, defaultHost, secureProtocol }, { sameSite, noSubdomains, ...options }) => ({\n    ...options,\n    ...(sameSite === 'none' && (!sameSiteNoneCompatible || !secureProtocol) ? {} : { sameSite }),\n    ...(secureProtocol && sameSite === 'none' && sameSiteNoneCompatible ? { secure: true } : {}),\n    expires: calculateExpires(options.expires),\n    domain: noSubdomains ? trimSubdomains(options.domain || defaultHost) : options.domain,\n});\n\nconst checkCookieEnabled = () => {\n    const testCookieName = 'testcookiesenabled';\n    document.cookie = testCookieName;\n    if (document.cookie.indexOf(testCookieName) > -1) {\n        document.cookie = `${testCookieName}; expires=Thu, 01 Jan 1970 00:00:01 GMT'`;\n        return true;\n    }\n    return false;\n};\nclass CookiesFallback {\n    constructor() {\n        this.cache = Object.create(null);\n    }\n    get(name) {\n        return this.cache[name] || undefined;\n    }\n    set(name, value) {\n        this.cache[name] = value;\n    }\n    erase(name) {\n        delete this.cache[name];\n    }\n    all() {\n        return this.cache;\n    }\n}\nclass CookieManager {\n    constructor({ cookieOptions = {}, userAgent, }) {\n        const isSecure = window.location.protocol === 'https:';\n        this.cookies = checkCookieEnabled()\n            ? new Cookies({\n                sameSite: userAgent.sameSiteNoneCompatible && isSecure ? 'none' : 'lax',\n                secure: isSecure,\n                ...cookieOptions,\n            })\n            : new CookiesFallback();\n        this.userAgent = userAgent;\n    }\n    // eslint-disable-next-line class-methods-use-this\n    get(name) {\n        return this.cookies.get(name) || undefined;\n    }\n    // eslint-disable-next-line class-methods-use-this\n    set({ name, value, ...options }) {\n        this.cookies.set(name, value, prepareCookieOptions({\n            userAgent: this.userAgent,\n            defaultHost: window.location.hostname,\n            secureProtocol: window.location.protocol === 'https:',\n        }, options));\n    }\n    // eslint-disable-next-line class-methods-use-this\n    all() {\n        return this.cookies.all();\n    }\n    // eslint-disable-next-line class-methods-use-this\n    remove(name, options) {\n        return this.cookies.erase(name, options);\n    }\n}\n\nlet CookieModule = class CookieModule {\n};\nCookieModule = __decorate([\n    Module({\n        imports: [ClientHintsModule],\n        providers: [\n            provide({\n                // Управление куками в приложении\n                provide: COOKIE_MANAGER_TOKEN,\n                useClass: CookieManager,\n                scope: Scope.SINGLETON,\n                deps: {\n                    // cookieOptions позволяет переопределить SameSite=Lax на None для фикса проблем с iframe\n                    // TODO после успешного тестирования в приложении paymentsext, убрать прокидывание cookieOptions\n                    //  и установить SameSite=None по умолчанию\n                    cookieOptions: {\n                        token: 'temporary cookieOptions',\n                        optional: true,\n                    },\n                    userAgent: USER_AGENT_TOKEN,\n                },\n            }),\n        ],\n    })\n], CookieModule);\n\nexport { CookieModule };\n","import reduce from '@tinkoff/utils/array/reduce';\n\n// source https://github.com/preactjs/preact-render-to-string/blob/60075a5a7389d638d535c85f3706739e9ba932bc/src/util.js\n// perf https://esbench.com/bench/5f88af6cb4632100a7dcd414\nconst ENCODED_ENTITIES = /[<\\u2028\\u2029]/;\n/**\n * Stringify object to safe for evaluation json string\n *\n * @param {*} json\n * @return {String} safe for evaluation json string\n * @example\n *\n *      safeStringify({ s:'test string' }) // => '{ \"s\":\"test string\" }'\n *      safeStringify({ s:'some\\u2028 test\\u2029' }) // => '{ \"s\": \"some\\\\u2028 test\\\\u2029\" }'\n */\nfunction encodeEntities(str) {\n    // Skip all work for strings with no entities needing encoding:\n    if (str.length === 0 || ENCODED_ENTITIES.test(str) === false)\n        return str;\n    let last = 0;\n    let i = 0;\n    let out = '';\n    let ch = '';\n    // Seek forward in str until the next entity char:\n    for (; i < str.length; i++) {\n        switch (str.charCodeAt(i)) {\n            case 60: // <\n                ch = '\\\\u003C';\n                break;\n            case 8232: // u2028 symbol (line separator)\n                ch = '\\\\u2028';\n                break;\n            case 8233: // u2029 symbol (paragraph separator)\n                ch = '\\\\u2029';\n                break;\n            default:\n                continue;\n        }\n        // Append skipped/buffered characters and the encoded entity:\n        if (i !== last)\n            out += str.slice(last, i);\n        out += ch;\n        // Start the next seek/buffer after the entity's offset:\n        last = i + 1;\n    }\n    if (i !== last)\n        out += str.slice(last, i);\n    return out;\n}\nconst safeStringify$1 = (json) => {\n    return encodeEntities(JSON.stringify(json));\n};\n\nconst safeParseJSON = (str, defaultValue = null) => {\n    // old version of node has memory leak if use json.parse with undefined value https://github.com/nodejs/node/issues/33266#issuecomment-638532113\n    if (str === undefined) {\n        return defaultValue;\n    }\n    try {\n        return JSON.parse(str);\n    }\n    catch (error) {\n        return defaultValue;\n    }\n};\n\nconst safeStringify = (value, replacer, space) => {\n    const seen = new Set();\n    const replace = replacer || ((val) => val);\n    return JSON.stringify(value, (_, val) => {\n        if (!val || typeof val !== 'object') {\n            return replace(val);\n        }\n        if (seen.has(val)) {\n            return '[~Circular~]';\n        }\n        seen.add(val);\n        return replace(val);\n    }, space);\n};\nconst safeStringifyJSON = (value, replacer, space) => {\n    try {\n        return JSON.stringify(value, replacer, space);\n    }\n    catch (err) {\n        return safeStringify(value, replacer, space);\n    }\n};\n\nconst xssPossibleTags = [/<link[^>]+>/gi, /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script\\s*>/gi];\nconst removeXss = (referrer = '') => reduce((newReferrer, regexp) => newReferrer.replace(regexp, ''), referrer, xssPossibleTags);\n\nexport { removeXss, safeParseJSON, safeStringify$1 as safeStringify, safeStringifyJSON };\n","import toLower from '@tinkoff/utils/string/toLower';\nimport eachObj from '@tinkoff/utils/object/each';\nimport toArray from '@tinkoff/utils/array/toArray';\nimport noop from '@tinkoff/utils/function/noop';\nimport pathEq from '@tinkoff/utils/object/pathEq';\nimport isString from '@tinkoff/utils/is/string';\nimport isObject from '@tinkoff/utils/is/object';\nimport isArray from '@tinkoff/utils/is/array';\nimport { safeStringifyJSON } from '@tramvai/safe-strings';\n\nconst LEVELS = {\n    trace: 50,\n    debug: 40,\n    info: 30,\n    warn: 20,\n    error: 10,\n    fatal: 0,\n    silent: -Infinity,\n};\nconst LEVEL_NAMES = {\n    50: 'trace',\n    40: 'debug',\n    30: 'info',\n    20: 'warn',\n    10: 'error',\n    0: 'fatal',\n};\n\nconst createRegexpFromNamespace = (namespace) => {\n    return new RegExp(`^${namespace.replace(/\\*/g, '.*?')}$`);\n};\nclass Logger {\n    // eslint-disable-next-line sort-class-members/sort-class-members\n    constructor(options = { name: '' }) {\n        this.name = toLower(options.name);\n        this.key = options.key || this.name;\n        if (Logger.instances[this.key]) {\n            return Logger.instances[this.key];\n        }\n        this.beforeReporters = options.beforeReporters || [];\n        this.reporters = options.reporters || [];\n        this.filters = options.filters || [];\n        this.extensions = options.extensions || [];\n        this.defaults = options.defaults || {};\n        if (options.level) {\n            this.setLevel(LEVELS[options.level]);\n        }\n        if (options.enabled) {\n            this.setLevel(LEVELS.trace);\n        }\n        this.checkEnabled();\n        Logger.instances[this.key] = this;\n        eachObj((level, levelName) => {\n            this[levelName] = (...args) => {\n                return this.log(level, args);\n            };\n        }, LEVELS);\n    }\n    static save() {\n        var _a;\n        (_a = Logger.onChange) === null || _a === void 0 ? void 0 : _a.call(Logger, {\n            level: Logger.level,\n            enabledName: this.enabledName,\n            enabledLevel: this.enabledLevel,\n        });\n    }\n    static load(state) {\n        Logger.level = state.level;\n        Logger.enabledName = state.enabledName;\n        Logger.enabledLevel = state.enabledLevel;\n    }\n    static setLevel(newLevel) {\n        var _a;\n        Logger.level = (_a = LEVELS[newLevel]) !== null && _a !== void 0 ? _a : Logger.level;\n        Logger.save();\n    }\n    static setOnChange(onChange) {\n        Logger.onChange = onChange;\n    }\n    static enable(level, namespace) {\n        const [lvl, ns] = namespace ? [LEVELS[level], namespace] : [LEVELS.trace, level];\n        Logger.enabledName.push(ns);\n        Logger.enabledLevel.push(lvl);\n        Logger.save();\n        const regexp = createRegexpFromNamespace(ns);\n        eachObj((instance) => {\n            const { name } = instance;\n            if (regexp.test(name)) {\n                instance.setLevel(lvl);\n            }\n        }, Logger.instances);\n    }\n    static disable(level, namespace) {\n        const [lvl, ns] = namespace ? [LEVELS[level], namespace] : [LEVELS.silent, level];\n        const index = Logger.enabledName.indexOf(ns);\n        if (index > -1) {\n            Logger.enabledName.splice(index, 1);\n            Logger.enabledLevel.splice(index, 1);\n        }\n        else {\n            Logger.enabledName.push(ns);\n            Logger.enabledLevel.push(lvl);\n        }\n        Logger.save();\n        const regexp = createRegexpFromNamespace(ns);\n        eachObj((instance) => {\n            const { name } = instance;\n            if (regexp.test(name)) {\n                instance.setLevel(lvl);\n            }\n        }, Logger.instances);\n    }\n    static clear() {\n        Logger.level = LEVELS.silent;\n        Logger.enabledName = [];\n        Logger.enabledLevel = [];\n        Logger.save();\n        eachObj((instance) => {\n            instance.setLevel(undefined);\n        }, Logger.instances);\n    }\n    static setGlobalReporters(reporters) {\n        const reportersArr = toArray(reporters);\n        eachObj((instance) => {\n            // eslint-disable-next-line no-param-reassign\n            instance.reporters = reportersArr;\n        }, Logger.instances);\n    }\n    child(options) {\n        const opts = typeof options === 'string' ? { name: options } : options;\n        const childKey = opts.key || opts.name;\n        const name = this.name ? `${this.name}.${opts.name}` : opts.name;\n        const key = this.key ? `${this.key}.${childKey}` : childKey;\n        return new Logger({\n            beforeReporters: this.beforeReporters,\n            reporters: this.reporters,\n            filters: this.filters,\n            extensions: this.extensions,\n            defaults: this.defaults,\n            ...opts,\n            name,\n            key,\n        });\n    }\n    addBeforeReporter(reporter) {\n        this.beforeReporters = this.beforeReporters.concat(reporter);\n    }\n    setBeforeReporters(reporters) {\n        this.beforeReporters = toArray(reporters);\n    }\n    addReporter(reporter) {\n        this.reporters = this.reporters.concat(reporter);\n    }\n    setReporters(reporters) {\n        this.reporters = toArray(reporters);\n    }\n    addFilter(filter) {\n        this.filters = this.filters.concat(filter);\n    }\n    setFilters(filters) {\n        this.filters = toArray(filters);\n    }\n    addExtension(extension) {\n        this.extensions = this.extensions.concat(extension);\n        this.extensions.push(extension);\n    }\n    setExtensions(extensions) {\n        this.extensions = toArray(extensions);\n    }\n    setLevel(level) {\n        this.level = level;\n    }\n    checkEnabled() {\n        const len = Logger.enabledName.length;\n        for (let i = len - 1; i >= 0; i--) {\n            const namespace = Logger.enabledName[i];\n            const regexp = createRegexpFromNamespace(namespace);\n            if (regexp.test(this.name)) {\n                this.setLevel(Logger.enabledLevel[i]);\n                return;\n            }\n        }\n    }\n    createLogObj(level, args) {\n        return {\n            date: new Date(),\n            ...this.defaults,\n            name: this.name,\n            type: LEVEL_NAMES[level],\n            level,\n            args,\n        };\n    }\n    log(level, args) {\n        let logObj;\n        if (this.beforeReporters.length) {\n            logObj = this.createLogObj(level, args);\n        }\n        for (const reporter of this.beforeReporters) {\n            reporter.log(logObj);\n        }\n        if (typeof this.level === 'undefined') {\n            if (level > Logger.level) {\n                return false;\n            }\n        }\n        else if (level > this.level) {\n            return false;\n        }\n        if (!logObj) {\n            logObj = this.createLogObj(level, args);\n        }\n        for (const filter of this.filters) {\n            if (filter.filter(logObj) === false) {\n                return false;\n            }\n        }\n        for (const extension of this.extensions) {\n            logObj = extension.extend(logObj);\n        }\n        for (const reporter of this.reporters) {\n            reporter.log(logObj);\n        }\n        return true;\n    }\n}\nLogger.level = LEVELS.silent;\nLogger.instances = {};\nLogger.enabledName = [];\nLogger.enabledLevel = [];\n\nconst bindMethods = [\n    'addBeforeReporter',\n    'setBeforeReporters',\n    'addReporter',\n    'setReporters',\n    'addFilter',\n    'setFilters',\n    'addExtension',\n    'setExtensions',\n    ...Object.keys(LEVELS),\n];\nconst createLoggerFactory = (options) => {\n    const instance = new Logger(options);\n    return Object.assign((opts) => {\n        return instance.child(opts);\n    }, bindMethods.reduce((acc, method) => {\n        if (instance[method]) {\n            acc[method] = instance[method].bind(instance);\n        }\n        return acc;\n    }, {}), {\n        setLevel: Logger.setLevel,\n        setGlobalReporters: Logger.setGlobalReporters,\n        enable: Logger.enable,\n        disable: Logger.disable,\n        clear: Logger.clear,\n    });\n};\n\nclass BrowserReporter {\n    constructor() {\n        this.defaultColor = '#7f8c8d'; // Gray\n        this.levelColorMap = {\n            0: '#c00046',\n            10: '#c0392b',\n            20: '#f39c12',\n            30: '#00BCD4', // Cyan\n        };\n    }\n    log(logObj) {\n        const consoleLogFn = \n        // eslint-disable-next-line no-nested-ternary, no-console\n        logObj.level < 20 ? console.error : logObj.level === 20 ? console.warn : console.log;\n        // Styles\n        const color = this.levelColorMap[logObj.level] || this.defaultColor;\n        const style = `\n      background: ${color};\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    `;\n        const badge = `%c${[logObj.name, logObj.type].filter(Boolean).join(':')}`;\n        // Log to the console\n        if (typeof logObj.args[0] === 'string') {\n            consoleLogFn.call(console, `${badge}%c ${logObj.args[0]}`, style, \n            // Empty string as style resets to default console style\n            '', ...logObj.args.slice(1));\n        }\n        else {\n            consoleLogFn.call(console, badge, style, ...logObj.args);\n        }\n    }\n}\n\nconst parseState = (value) => {\n    if (!value) {\n        return;\n    }\n    const names = value.split(',');\n    return {\n        level: LEVELS.silent,\n        enabledLevel: Array(names.length).fill(LEVELS.trace),\n        enabledName: names,\n    };\n};\n\nconst debugGetState = () => {\n    try {\n        return parseState(window.localStorage.getItem('debug'));\n    }\n    catch (e) { }\n};\n\nconst NAME = '_t_logger';\nconst DEFAULT_STATE = { level: LEVELS.error, enabledLevel: [], enabledName: [] };\nlet ls;\nlet state;\ntry {\n    ls = window.localStorage;\n    state = JSON.parse(ls.getItem(NAME));\n}\ncatch (e) { }\nif (!state) {\n    state = debugGetState();\n}\nif (process.env.NODE_ENV === 'development' && !state) {\n    state = DEFAULT_STATE;\n}\nLogger.setOnChange((cfg) => {\n    try {\n        ls.setItem(NAME, JSON.stringify(cfg));\n    }\n    catch (e) { }\n});\nstate && Logger.load(state);\nconst logger = createLoggerFactory({\n    name: '',\n    reporters: [new BrowserReporter()],\n});\nwindow.logger = logger;\n\n/* eslint-disable prefer-destructuring */\nconst formatError = (error) => {\n    if (isString(error)) {\n        // eslint-disable-next-line no-param-reassign\n        error = new Error(error);\n    }\n    return {\n        ...error,\n        // @ts-ignore\n        // хотим чтобы всегда был единый формат для error.body и error.code [text]\n        // игнор потому что в error нет поля body и code\n        body: safeStringifyJSON(error.body),\n        // @ts-ignore\n        code: safeStringifyJSON(error.code),\n        message: error.message,\n        stack: error.stack,\n    };\n};\nconst formatJson = (logObj) => {\n    let fields = null;\n    let message;\n    let error;\n    const { args } = logObj;\n    if (args[0] instanceof Error) {\n        error = formatError(args[0]);\n        if (isString(args[1])) {\n            message = args[1];\n        }\n        else {\n            message = args[0].message;\n        }\n    }\n    else if (isObject(args[0]) && !isArray(args[0])) {\n        fields = args[0];\n        error = fields.error && formatError(fields.error);\n        if (args[0].message) {\n            message = args[0].message;\n        }\n        else if (isString(args[1])) {\n            message = args[1];\n        }\n    }\n    else {\n        message = args[0];\n    }\n    const otherArgs = args.slice(message === args[1] ? 2 : 1).map((arg) => {\n        if (arg instanceof Error) {\n            return { error: formatError(arg) };\n        }\n        return arg;\n    });\n    return {\n        ...logObj,\n        args: otherArgs.length ? otherArgs : undefined,\n        ...fields,\n        error,\n        message,\n    };\n};\n/* eslint-enable prefer-destructuring */\n\nclass RemoteReporter {\n    constructor({ requestCount, makeRequest, emitLevels, }) {\n        this.reqCount = 0;\n        this.queue = [];\n        this.requestCount = requestCount || 1;\n        this.makeRequest = makeRequest;\n        this.emitLevels = emitLevels || { fatal: true };\n    }\n    checkQueue() {\n        if (this.queue.length && this.reqCount < this.requestCount) {\n            this.sendRequest();\n        }\n    }\n    sendRequest() {\n        const logObj = this.queue.shift();\n        // eslint-disable-next-line no-plusplus\n        this.reqCount++;\n        // eslint-disable-next-line promise/catch-or-return\n        this.makeRequest(formatJson(logObj))\n            .catch(noop)\n            .then(() => {\n            // eslint-disable-next-line no-plusplus\n            this.reqCount--;\n            this.checkQueue();\n        });\n    }\n    remote(logObj) {\n        this.queue.push(logObj);\n        this.checkQueue();\n    }\n    log(logObj) {\n        const { type, remote } = logObj;\n        if (remote != null) {\n            if (remote === true || pathEq(['emitLevels', type], true, remote)) {\n                this.remote({ ...logObj, remote: undefined });\n            }\n            return;\n        }\n        if (this.emitLevels[type]) {\n            this.remote(logObj);\n        }\n    }\n}\n\nexport { BrowserReporter, LEVELS, LEVEL_NAMES, RemoteReporter, createLoggerFactory, logger as default, formatJson, logger };\n","const DEFAULT_TIMEOUT = 10000;\nconst PAPI_PARAMETERS = '__papi_parameters__';\nconst createPapiMethod = (papi) => {\n    const result = Object.assign(papi.handler, {\n        [PAPI_PARAMETERS]: {\n            ...papi,\n            options: {\n                timeout: DEFAULT_TIMEOUT,\n                ...papi.options,\n            },\n            method: papi.method || 'all',\n        },\n    });\n    return result;\n};\nconst getPapiParameters = (papi) => {\n    return papi[PAPI_PARAMETERS];\n};\nconst isPapiMethod = (papi) => {\n    return papi && !!getPapiParameters(papi);\n};\n\nexport { PAPI_PARAMETERS, createPapiMethod, getPapiParameters, isPapiMethod };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Specifies base url for public papi handlers. By default equals to `/[appName]/papi`\n */\nconst SERVER_MODULE_PAPI_PUBLIC_URL = createToken('serverModulePapiPublicUrl');\n/**\n * @description\n * Specifies base url for private papi handlers. By default equals `/[appName]/private/papi`\n */\nconst SERVER_MODULE_PAPI_PRIVATE_URL = createToken('serverModulePapiPrivateUrl');\n/**\n * @description\n * Add private papi route\n */\nconst SERVER_MODULE_PAPI_PRIVATE_ROUTE = createToken('serverModulePapiPrivateRoute', {\n    multi: true,\n});\n/**\n * @description\n * Add public papi route\n */\nconst SERVER_MODULE_PAPI_PUBLIC_ROUTE = createToken('serverModulePapiPublicRoute', {\n    multi: true,\n});\n/**\n * @description\n * Settings for the static server\n */\nconst SERVER_MODULE_STATICS_OPTIONS = createToken('serverModuleStaticsOptions');\n/**\n * @description\n * Instance of nodejs `http.Server`.\n * Can be used for adding custom logic on server, like error handling, connection settings\n *\n * @example\n  ```tsx\n  {\n    provide: commandLineListTokens.init,\n    multi: true,\n    useFactory: ({ server }) => {\n      return function serverListen() {\n        createTerminus(server, {});\n      };\n    },\n    deps: {\n      SERVER_TOKEN,\n    },\n  },\n  ```\n */\nconst SERVER_TOKEN = createToken('server');\n/**\n * @description\n * Add resources for request proxying  to the app through `http-proxy-middleware`\n */\nconst PROXY_CONFIG_TOKEN = createToken('proxyConfigToken', {\n    multi: true,\n});\n/**\n * @description\n * Override filter function when accessing papi route `/dependenciesVersion`\n */\nconst DEPENDENCIES_VERSION_FILTER_TOKEN = createToken('dependenciesVersionFilter');\n/**\n * @description\n * List of the utility URLs on server (e.g. healthz and readyz)\n * Url matching is happens with a library `path-to-regexp`.\n */\nconst UTILITY_SERVER_PATHS = createToken('server utility paths', { multi: true });\n/**\n * @description\n * Defines port to listen for utility routes\n */\nconst UTILITY_SERVER_PORT_TOKEN = createToken('server utility server port');\n/**\n * @description\n * Custom path for liveness probe\n */\nconst LIVENESS_PATH_TOKEN = createToken('liveness path');\n/**\n * @description\n * Custom path for readiness probe\n */\nconst READINESS_PATH_TOKEN = createToken('readiness path');\n/**\n * @description\n * Custom function for k8s readiness, you might want to wait for something before allowing traffic to your app\\\n * https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/\n */\nconst READINESS_PROBE_TOKEN = createToken('readiness-probe-fn');\n/**\n * @description\n * Custom function for k8s liveness, a function accepting a state and returning a promise indicating service health\\\n * https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/\n */\nconst LIVENESS_PROBE_TOKEN = createToken('liveness-probe-fn');\n\nexport { DEPENDENCIES_VERSION_FILTER_TOKEN, LIVENESS_PATH_TOKEN, LIVENESS_PROBE_TOKEN, PROXY_CONFIG_TOKEN, READINESS_PATH_TOKEN, READINESS_PROBE_TOKEN, SERVER_MODULE_PAPI_PRIVATE_ROUTE, SERVER_MODULE_PAPI_PRIVATE_URL, SERVER_MODULE_PAPI_PUBLIC_ROUTE, SERVER_MODULE_PAPI_PUBLIC_URL, SERVER_MODULE_STATICS_OPTIONS, SERVER_TOKEN, UTILITY_SERVER_PATHS, UTILITY_SERVER_PORT_TOKEN };\n","import { __decorate } from 'tslib';\nimport { logger as logger$1, BrowserReporter, createLoggerFactory } from '@tinkoff/logger';\nimport { provide, Scope, commandLineListTokens, Module } from '@tramvai/core';\nimport { LOGGER_INIT_HOOK, COMBINE_REDUCERS, CONTEXT_TOKEN, LOGGER_TOKEN, STORE_TOKEN } from '@tramvai/tokens-common';\nexport { LOGGER_TOKEN } from '@tramvai/tokens-common';\nimport { createPapiMethod } from '@tramvai/papi';\nimport { SERVER_MODULE_PAPI_PRIVATE_ROUTE } from '@tramvai/tokens-server';\nimport { ENV_MANAGER_TOKEN } from '@tramvai/module-environment';\nimport each from '@tinkoff/utils/array/each';\nimport split from '@tinkoff/utils/string/split';\nimport { createEvent, createReducer } from '@tramvai/state';\n\nconst LOGGER_NAME = '';\nconst LOGGER_KEY = 'tramvai';\n\nconst setLogs = createEvent('setLogs');\nconst LogStore = createReducer('devLogs', []).on(setLogs, (_, logs) => logs);\n\nclass DevLogsReporter {\n    constructor() {\n        this.logs = [];\n    }\n    log(logObj) {\n        this.logs.push(logObj);\n    }\n    start() {\n        this.reset();\n    }\n    reset() {\n        this.logs = [];\n    }\n    flush() {\n        const flushed = this.logs;\n        this.reset();\n        return flushed;\n    }\n}\nclass DevLogsExtension {\n    constructor(logs) {\n        this.logs = [];\n        this.logs = logs;\n    }\n    extend(logObj) {\n        const [index] = logObj.args;\n        // @ts-ignore\n        return this.logs[index];\n    }\n}\n[\n    provide({\n        provide: LOGGER_INIT_HOOK,\n        multi: true,\n        useFactory({ reporter }) {\n            return (loggerInstance) => {\n                loggerInstance.addReporter(reporter);\n            };\n        },\n        deps: {\n            reporter: 'ssrDevReporter',\n        },\n    }),\n    provide({\n        provide: 'ssrDevReporter',\n        scope: Scope.SINGLETON,\n        useClass: DevLogsReporter,\n    }),\n    provide({\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: LogStore,\n    }),\n    provide({\n        provide: commandLineListTokens.customerStart,\n        multi: true,\n        useFactory: ({ reporter }) => {\n            return function startSsrLogs() {\n                reporter.start();\n            };\n        },\n        deps: {\n            reporter: 'ssrDevReporter',\n        },\n    }),\n    provide({\n        provide: commandLineListTokens.generatePage,\n        multi: true,\n        useFactory: ({ context, reporter }) => {\n            const logs = reporter.flush();\n            return function endSsrLogs() {\n                return context.dispatch(setLogs(logs));\n            };\n        },\n        deps: {\n            context: CONTEXT_TOKEN,\n            reporter: 'ssrDevReporter',\n        },\n    }),\n    provide({\n        provide: SERVER_MODULE_PAPI_PRIVATE_ROUTE,\n        multi: true,\n        useFactory: ({ environmentManager }) => {\n            return createPapiMethod({\n                method: 'get',\n                path: '/logger',\n                async handler({ parsedUrl: { query } }) {\n                    const { mode, level, enable } = query;\n                    const applyDefaultConfig = mode === 'default';\n                    const clearCurrentConfig = mode || level || enable;\n                    let debugLevel;\n                    let debugEnable;\n                    if (applyDefaultConfig) {\n                        debugLevel = environmentManager.get('DEBUG_LEVEL');\n                        debugEnable = environmentManager.get('DEBUG_ENABLE');\n                    }\n                    if (level) {\n                        debugLevel = level;\n                    }\n                    if (enable) {\n                        debugEnable = enable;\n                    }\n                    if (clearCurrentConfig) {\n                        logger$1.clear();\n                    }\n                    if (debugLevel) {\n                        logger$1.setLevel(debugLevel);\n                    }\n                    if (debugEnable) {\n                        each((val) => {\n                            const [lvl, name] = val.split(':');\n                            logger$1.enable(lvl, name);\n                        }, split(',', debugEnable));\n                    }\n                },\n            });\n        },\n        deps: {\n            environmentManager: ENV_MANAGER_TOKEN,\n        },\n    }),\n];\nconst flushLogs = (ssrLogger, logs) => {\n    if (logs && logs.length) {\n        // eslint-disable-next-line no-console\n        console.groupCollapsed('%c🚀 Tramvai SSR Logs', 'font-size: 110%');\n        logs.forEach((logObj, index) => ssrLogger[logObj.type](index));\n        // eslint-disable-next-line no-console\n        console.groupEnd();\n    }\n};\nconst clientProviders = [\n    provide({\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: LogStore,\n    }),\n    provide({\n        provide: commandLineListTokens.customerStart,\n        multi: true,\n        useFactory: ({ logger, store }) => {\n            return function rehydrateSsrDevLogs() {\n                const logs = store.getState(LogStore);\n                const ssrLogger = logger({\n                    name: 'ssr-logger',\n                    // сетим пустой массив в beforeReporters, чтобы не подтягивать настройки рутового логгера с RemoteReporter\n                    beforeReporters: [],\n                    reporters: [new BrowserReporter()],\n                    extensions: [new DevLogsExtension(logs)],\n                });\n                flushLogs(ssrLogger, logs);\n            };\n        },\n        deps: {\n            logger: LOGGER_TOKEN,\n            store: STORE_TOKEN,\n        },\n    }),\n];\n\nconst logger = createLoggerFactory({\n    name: LOGGER_NAME,\n    key: LOGGER_KEY,\n    reporters: [new BrowserReporter()],\n});\nlet LogModule = class LogModule {\n};\nLogModule = __decorate([\n    Module({\n        providers: [\n            ...(process.env.NODE_ENV === 'development' ? clientProviders : []),\n            {\n                provide: LOGGER_TOKEN,\n                useFactory({ loggerInitHooks }) {\n                    if (loggerInitHooks) {\n                        for (const hookFn of loggerInitHooks) {\n                            hookFn(logger);\n                        }\n                    }\n                    return logger;\n                },\n                deps: {\n                    loggerInitHooks: { token: LOGGER_INIT_HOOK, multi: true, optional: true },\n                },\n            },\n        ],\n    })\n], LogModule);\n\nexport { LogModule, LogStore, logger, setLogs };\n","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import React from 'react';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport { isValidElementType } from 'react-is';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\n\n/* eslint-disable import/prefer-default-export */\nfunction invariant(condition, message) {\n  if (condition) return;\n  var error = new Error(\"loadable: \" + message);\n  error.framesToPop = 1;\n  error.name = 'Invariant Violation';\n  throw error;\n}\nfunction warn(message) {\n  // eslint-disable-next-line no-console\n  console.warn(\"loadable: \" + message);\n}\n\nvar Context = /*#__PURE__*/\nReact.createContext();\n\nvar LOADABLE_REQUIRED_CHUNKS_KEY = '__LOADABLE_REQUIRED_CHUNKS__';\nfunction getRequiredChunkKey(namespace) {\n  return \"\" + namespace + LOADABLE_REQUIRED_CHUNKS_KEY;\n}\n\nvar sharedInternals = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  getRequiredChunkKey: getRequiredChunkKey,\n  invariant: invariant,\n  Context: Context\n});\n\nvar LOADABLE_SHARED = {\n  initialChunks: {}\n};\n\nvar STATUS_PENDING = 'PENDING';\nvar STATUS_RESOLVED = 'RESOLVED';\nvar STATUS_REJECTED = 'REJECTED';\n\nfunction resolveConstructor(ctor) {\n  if (typeof ctor === 'function') {\n    return {\n      requireAsync: ctor,\n      resolve: function resolve() {\n        return undefined;\n      },\n      chunkName: function chunkName() {\n        return undefined;\n      }\n    };\n  }\n\n  return ctor;\n}\n\nvar withChunkExtractor = function withChunkExtractor(Component) {\n  var LoadableWithChunkExtractor = function LoadableWithChunkExtractor(props) {\n    return React.createElement(Context.Consumer, null, function (extractor) {\n      return React.createElement(Component, Object.assign({\n        __chunkExtractor: extractor\n      }, props));\n    });\n  };\n\n  if (Component.displayName) {\n    LoadableWithChunkExtractor.displayName = Component.displayName + \"WithChunkExtractor\";\n  }\n\n  return LoadableWithChunkExtractor;\n};\n\nvar identity = function identity(v) {\n  return v;\n};\n\nfunction createLoadable(_ref) {\n  var _ref$defaultResolveCo = _ref.defaultResolveComponent,\n      defaultResolveComponent = _ref$defaultResolveCo === void 0 ? identity : _ref$defaultResolveCo,\n      _render = _ref.render,\n      onLoad = _ref.onLoad;\n\n  function loadable(loadableConstructor, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var ctor = resolveConstructor(loadableConstructor);\n    var cache = {};\n    /**\n     * Cachekey represents the component to be loaded\n     * if key changes - component has to be reloaded\n     * @param props\n     * @returns {null|Component}\n     */\n\n    function _getCacheKey(props) {\n      if (options.cacheKey) {\n        return options.cacheKey(props);\n      }\n\n      if (ctor.resolve) {\n        return ctor.resolve(props);\n      }\n\n      return 'static';\n    }\n    /**\n     * Resolves loaded `module` to a specific `Component\n     * @param module\n     * @param props\n     * @param Loadable\n     * @returns Component\n     */\n\n\n    function resolve(module, props, Loadable) {\n      var Component = options.resolveComponent ? options.resolveComponent(module, props) : defaultResolveComponent(module);\n\n      if (options.resolveComponent && !isValidElementType(Component)) {\n        throw new Error(\"resolveComponent returned something that is not a React component!\");\n      }\n\n      hoistNonReactStatics(Loadable, Component, {\n        preload: true\n      });\n      return Component;\n    }\n\n    var cachedLoad = function cachedLoad(props) {\n      var cacheKey = _getCacheKey(props);\n\n      var promise = cache[cacheKey];\n\n      if (!promise || promise.status === STATUS_REJECTED) {\n        promise = ctor.requireAsync(props);\n        promise.status = STATUS_PENDING;\n        cache[cacheKey] = promise;\n        promise.then(function () {\n          promise.status = STATUS_RESOLVED;\n        }, function (error) {\n          console.error('loadable-components: failed to asynchronously load component', {\n            fileName: ctor.resolve(props),\n            chunkName: ctor.chunkName(props),\n            error: error ? error.message : error\n          });\n          promise.status = STATUS_REJECTED;\n        });\n      }\n\n      return promise;\n    };\n\n    var InnerLoadable =\n    /*#__PURE__*/\n    function (_React$Component) {\n      _inheritsLoose(InnerLoadable, _React$Component);\n\n      InnerLoadable.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {\n        var cacheKey = _getCacheKey(props);\n\n        return _extends({}, state, {\n          cacheKey: cacheKey,\n          // change of a key triggers loading state automatically\n          loading: state.loading || state.cacheKey !== cacheKey\n        });\n      };\n\n      function InnerLoadable(props) {\n        var _this;\n\n        _this = _React$Component.call(this, props) || this;\n        _this.state = {\n          result: null,\n          error: null,\n          loading: true,\n          cacheKey: _getCacheKey(props)\n        };\n        invariant(!props.__chunkExtractor || ctor.requireSync, 'SSR requires `@loadable/babel-plugin`, please install it'); // Server-side\n\n        if (props.__chunkExtractor) {\n          // This module has been marked with no SSR\n          if (options.ssr === false) {\n            return _assertThisInitialized(_this);\n          } // We run load function, we assume that it won't fail and that it\n          // triggers a synchronous loading of the module\n\n\n          ctor.requireAsync(props)[\"catch\"](function () {\n            return null;\n          }); // So we can require now the module synchronously\n\n          _this.loadSync();\n\n          props.__chunkExtractor.addChunk(ctor.chunkName(props));\n\n          return _assertThisInitialized(_this);\n        } // Client-side with `isReady` method present (SSR probably)\n        // If module is already loaded, we use a synchronous loading\n        // Only perform this synchronous loading if the component has not\n        // been marked with no SSR, else we risk hydration mismatches\n\n\n        if (options.ssr !== false && ( // is ready - was loaded in this session\n        ctor.isReady && ctor.isReady(props) || // is ready - was loaded during SSR process\n        ctor.chunkName && LOADABLE_SHARED.initialChunks[ctor.chunkName(props)])) {\n          _this.loadSync();\n        }\n\n        return _this;\n      }\n\n      var _proto = InnerLoadable.prototype;\n\n      _proto.componentDidMount = function componentDidMount() {\n        this.mounted = true; // retrieve loading promise from a global cache\n\n        var cachedPromise = this.getCache(); // if promise exists, but rejected - clear cache\n\n        if (cachedPromise && cachedPromise.status === STATUS_REJECTED) {\n          this.setCache();\n        } // component might be resolved synchronously in the constructor\n\n\n        if (this.state.loading) {\n          this.loadAsync();\n        }\n      };\n\n      _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n        // Component has to be reloaded on cacheKey change\n        if (prevState.cacheKey !== this.state.cacheKey) {\n          this.loadAsync();\n        }\n      };\n\n      _proto.componentWillUnmount = function componentWillUnmount() {\n        this.mounted = false;\n      };\n\n      _proto.safeSetState = function safeSetState(nextState, callback) {\n        if (this.mounted) {\n          this.setState(nextState, callback);\n        }\n      }\n      /**\n       * returns a cache key for the current props\n       * @returns {Component|string}\n       */\n      ;\n\n      _proto.getCacheKey = function getCacheKey() {\n        return _getCacheKey(this.props);\n      }\n      /**\n       * access the persistent cache\n       */\n      ;\n\n      _proto.getCache = function getCache() {\n        return cache[this.getCacheKey()];\n      }\n      /**\n       * sets the cache value. If called without value sets it as undefined\n       */\n      ;\n\n      _proto.setCache = function setCache(value) {\n        if (value === void 0) {\n          value = undefined;\n        }\n\n        cache[this.getCacheKey()] = value;\n      };\n\n      _proto.triggerOnLoad = function triggerOnLoad() {\n        var _this2 = this;\n\n        if (onLoad) {\n          setTimeout(function () {\n            onLoad(_this2.state.result, _this2.props);\n          });\n        }\n      }\n      /**\n       * Synchronously loads component\n       * target module is expected to already exists in the module cache\n       * or be capable to resolve synchronously (webpack target=node)\n       */\n      ;\n\n      _proto.loadSync = function loadSync() {\n        // load sync is expecting component to be in the \"loading\" state already\n        // sounds weird, but loading=true is the initial state of InnerLoadable\n        if (!this.state.loading) return;\n\n        try {\n          var loadedModule = ctor.requireSync(this.props);\n          var result = resolve(loadedModule, this.props, Loadable);\n          this.state.result = result;\n          this.state.loading = false;\n        } catch (error) {\n          console.error('loadable-components: failed to synchronously load component, which expected to be available', {\n            fileName: ctor.resolve(this.props),\n            chunkName: ctor.chunkName(this.props),\n            error: error ? error.message : error\n          });\n          this.state.error = error;\n        }\n      }\n      /**\n       * Asynchronously loads a component.\n       */\n      ;\n\n      _proto.loadAsync = function loadAsync() {\n        var _this3 = this;\n\n        var promise = this.resolveAsync();\n        promise.then(function (loadedModule) {\n          var result = resolve(loadedModule, _this3.props, Loadable);\n\n          _this3.safeSetState({\n            result: result,\n            loading: false\n          }, function () {\n            return _this3.triggerOnLoad();\n          });\n        })[\"catch\"](function (error) {\n          return _this3.safeSetState({\n            error: error,\n            loading: false\n          });\n        });\n        return promise;\n      }\n      /**\n       * Asynchronously resolves(not loads) a component.\n       * Note - this function does not change the state\n       */\n      ;\n\n      _proto.resolveAsync = function resolveAsync() {\n        var _this$props = this.props,\n            __chunkExtractor = _this$props.__chunkExtractor,\n            forwardedRef = _this$props.forwardedRef,\n            props = _objectWithoutPropertiesLoose(_this$props, [\"__chunkExtractor\", \"forwardedRef\"]);\n\n        return cachedLoad(props);\n      };\n\n      _proto.render = function render() {\n        var _this$props2 = this.props,\n            forwardedRef = _this$props2.forwardedRef,\n            propFallback = _this$props2.fallback,\n            __chunkExtractor = _this$props2.__chunkExtractor,\n            props = _objectWithoutPropertiesLoose(_this$props2, [\"forwardedRef\", \"fallback\", \"__chunkExtractor\"]);\n\n        var _this$state = this.state,\n            error = _this$state.error,\n            loading = _this$state.loading,\n            result = _this$state.result;\n\n        if (options.suspense) {\n          var cachedPromise = this.getCache() || this.loadAsync();\n\n          if (cachedPromise.status === STATUS_PENDING) {\n            throw this.loadAsync();\n          }\n        }\n\n        if (error) {\n          throw error;\n        }\n\n        var fallback = propFallback || options.fallback || null;\n\n        if (loading) {\n          return fallback;\n        }\n\n        return _render({\n          fallback: fallback,\n          result: result,\n          options: options,\n          props: _extends({}, props, {\n            ref: forwardedRef\n          })\n        });\n      };\n\n      return InnerLoadable;\n    }(React.Component);\n\n    var EnhancedInnerLoadable = withChunkExtractor(InnerLoadable);\n    var Loadable = React.forwardRef(function (props, ref) {\n      return React.createElement(EnhancedInnerLoadable, Object.assign({\n        forwardedRef: ref\n      }, props));\n    });\n    Loadable.displayName = 'Loadable'; // In future, preload could use `<link rel=\"preload\">`\n\n    Loadable.preload = function (props) {\n      Loadable.load(props);\n    };\n\n    Loadable.load = function (props) {\n      return cachedLoad(props);\n    };\n\n    return Loadable;\n  }\n\n  function lazy(ctor, options) {\n    return loadable(ctor, _extends({}, options, {\n      suspense: true\n    }));\n  }\n\n  return {\n    loadable: loadable,\n    lazy: lazy\n  };\n}\n\nfunction defaultResolveComponent(loadedModule) {\n  // eslint-disable-next-line no-underscore-dangle\n  return loadedModule.__esModule ? loadedModule[\"default\"] : loadedModule[\"default\"] || loadedModule;\n}\n\n/* eslint-disable no-use-before-define, react/no-multi-comp */\n\nvar _createLoadable =\n/*#__PURE__*/\ncreateLoadable({\n  defaultResolveComponent: defaultResolveComponent,\n  render: function render(_ref) {\n    var Component = _ref.result,\n        props = _ref.props;\n    return React.createElement(Component, props);\n  }\n}),\n    loadable = _createLoadable.loadable,\n    lazy = _createLoadable.lazy;\n\n/* eslint-disable no-use-before-define, react/no-multi-comp */\n\nvar _createLoadable$1 =\n/*#__PURE__*/\ncreateLoadable({\n  onLoad: function onLoad(result, props) {\n    if (result && props.forwardedRef) {\n      if (typeof props.forwardedRef === 'function') {\n        props.forwardedRef(result);\n      } else {\n        props.forwardedRef.current = result;\n      }\n    }\n  },\n  render: function render(_ref) {\n    var result = _ref.result,\n        props = _ref.props;\n\n    if (props.children) {\n      return props.children(result);\n    }\n\n    return null;\n  }\n}),\n    loadable$1 = _createLoadable$1.loadable,\n    lazy$1 = _createLoadable$1.lazy;\n\n/* eslint-disable no-underscore-dangle, camelcase */\nvar BROWSER = typeof window !== 'undefined';\nfunction loadableReady(done, _temp) {\n  if (done === void 0) {\n    done = function done() {};\n  }\n\n  var _ref = _temp === void 0 ? {} : _temp,\n      _ref$namespace = _ref.namespace,\n      namespace = _ref$namespace === void 0 ? '' : _ref$namespace,\n      _ref$chunkLoadingGlob = _ref.chunkLoadingGlobal,\n      chunkLoadingGlobal = _ref$chunkLoadingGlob === void 0 ? '__LOADABLE_LOADED_CHUNKS__' : _ref$chunkLoadingGlob;\n\n  if (!BROWSER) {\n    warn('`loadableReady()` must be called in browser only');\n    done();\n    return Promise.resolve();\n  }\n\n  var requiredChunks = null;\n\n  if (BROWSER) {\n    var id = getRequiredChunkKey(namespace);\n    var dataElement = document.getElementById(id);\n\n    if (dataElement) {\n      requiredChunks = JSON.parse(dataElement.textContent);\n      var extElement = document.getElementById(id + \"_ext\");\n\n      if (extElement) {\n        var _JSON$parse = JSON.parse(extElement.textContent),\n            namedChunks = _JSON$parse.namedChunks;\n\n        namedChunks.forEach(function (chunkName) {\n          LOADABLE_SHARED.initialChunks[chunkName] = true;\n        });\n      } else {\n        // version mismatch\n        throw new Error('loadable-component: @loadable/server does not match @loadable/component');\n      }\n    }\n  }\n\n  if (!requiredChunks) {\n    warn('`loadableReady()` requires state, please use `getScriptTags` or `getScriptElements` server-side');\n    done();\n    return Promise.resolve();\n  }\n\n  var resolved = false;\n  return new Promise(function (resolve) {\n    window[chunkLoadingGlobal] = window[chunkLoadingGlobal] || [];\n    var loadedChunks = window[chunkLoadingGlobal];\n    var originalPush = loadedChunks.push.bind(loadedChunks);\n\n    function checkReadyState() {\n      if (requiredChunks.every(function (chunk) {\n        return loadedChunks.some(function (_ref2) {\n          var chunks = _ref2[0];\n          return chunks.indexOf(chunk) > -1;\n        });\n      })) {\n        if (!resolved) {\n          resolved = true;\n          resolve();\n        }\n      }\n    }\n\n    loadedChunks.push = function () {\n      originalPush.apply(void 0, arguments);\n      checkReadyState();\n    };\n\n    checkReadyState();\n  }).then(done);\n}\n\n/* eslint-disable no-underscore-dangle */\nvar loadable$2 = loadable;\nloadable$2.lib = loadable$1;\nvar lazy$2 = lazy;\nlazy$2.lib = lazy$1;\nvar __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED = sharedInternals;\n\nexport default loadable$2;\nexport { __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED, lazy$2 as lazy, loadableReady };\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","import { createContext, useContext, useMemo, Component } from 'react';\nimport { jsx, jsxs } from 'react/jsx-runtime';\nimport hoistStatics from 'hoist-non-react-statics';\nimport mapObj from '@tinkoff/utils/object/map';\nimport { __decorate } from 'tslib';\nimport { createToken } from '@tinkoff/dippy';\nimport loadable from '@loadable/component';\n\nconst DIContext = createContext(null);\n\nconst useDiContainer = () => {\n    const di = useContext(DIContext);\n    if (!di) {\n        if (process.env.NODE_ENV !== 'production') {\n            throw new Error(`DI container not found, make sure that the application uses 'DIContext.Provider' from '@tramvai/react'\n      (in a tramvai application this is usually done by '@tramvai/module-render', otherwise 'DIContext.Provider' from '@tramvai/react' must be explicitly defined somewhere)\n      If the above is correct, make sure that the '@tramvai/react' module is not duplicated in the application dependencies, because then the di versions would be incompatible`);\n        }\n        throw new Error('DI container not found');\n    }\n    return di;\n};\nconst isTokenObject = (token) => {\n    return ('token' in token &&\n        (Object.keys(token).length === 1 ||\n            typeof token.optional === 'boolean' ||\n            typeof token.multi === 'boolean'));\n};\nfunction useDi(deps) {\n    const di = useDiContainer();\n    return useMemo(() => {\n        if (deps.toString() !== '[object Object]' || isTokenObject(deps)) {\n            return di.get(deps);\n        }\n        return mapObj((dep) => di.get(dep), deps);\n    }, [deps, di]);\n}\n\nconst withDi = (deps) => (WrappedComponent) => {\n    function WrapperWithPropsFromDi(props) {\n        const depsInstance = useDi(deps);\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        return jsx(WrappedComponent, { ...props, ...depsInstance });\n    }\n    return hoistStatics(WrapperWithPropsFromDi, WrappedComponent);\n};\n\nconst FallbackError = () => {\n    return (jsxs(\"div\", { children: [jsx(\"div\", { style: {\n                    textAlign: 'center',\n                    marginBottom: 11,\n                    paddingTop: 26,\n                    fontSize: 30,\n                    lineHeight: '36px',\n                    fontWeight: 200,\n                }, children: \"An error occurred :(\" }), jsxs(\"div\", { style: {\n                    textAlign: 'center',\n                    marginBottom: 17,\n                    color: '#9299a2',\n                    fontSize: 20,\n                    lineHeight: '24px',\n                }, children: [\"Try\", ' ', jsx(\"a\", { href: \"\", onClick: () => window.location.reload(), children: \"reloading the page\" })] })] }));\n};\nFallbackError.displayName = 'FallbackError';\n\nclass UniversalErrorBoundary extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            error: props.error || null,\n            url: props.url,\n        };\n    }\n    // Reference and explanation here - https://github.com/remix-run/remix/blob/main/packages/remix-react/errorBoundaries.tsx#L35\n    static getDerivedStateFromProps(props, state) {\n        if (props.url !== state.url) {\n            return { error: props.error || null, url: props.url };\n        }\n        return { error: props.error || state.error, url: state.url };\n    }\n    static getDerivedStateFromError(error) {\n        return { error };\n    }\n    componentDidCatch(error, errorInfo) {\n        const { errorHandlers } = this.props;\n        if (errorHandlers) {\n            errorHandlers.forEach((handler) => {\n                handler(error, errorInfo);\n            });\n        }\n    }\n    render() {\n        const { children, fallback: Fallback, fallbackFromDi } = this.props;\n        const { url, error } = this.state;\n        if (!error) {\n            return children;\n        }\n        if (Fallback) {\n            return jsx(Fallback, { url: url, error: error });\n        }\n        if (fallbackFromDi) {\n            return fallbackFromDi;\n        }\n        return jsx(FallbackError, {});\n    }\n}\nUniversalErrorBoundary.displayName = 'UniversalErrorBoundary';\n\nconst ERROR_BOUNDARY_TOKEN = createToken('reactErrorBoundaryHandlers', {\n    multi: true,\n});\nconst ROOT_ERROR_BOUNDARY_COMPONENT_TOKEN = createToken('rootErrorBoundaryComponent');\n/**\n * @deprecated\n */\nconst ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN = createToken('errorBoundaryFallbackComponent');\n\n/**\n * @deprecated Use UniversalErrorBoundary component\n */\nlet ErrorBoundary = class ErrorBoundary extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            hasError: false,\n        };\n    }\n    static getDerivedStateFromError() {\n        return { hasError: true };\n    }\n    componentDidCatch(error, errorInfo) {\n        const { errorHandlers } = this.props;\n        if (errorHandlers) {\n            errorHandlers.forEach((handler) => {\n                handler(error, errorInfo);\n            });\n        }\n    }\n    render() {\n        const { children, fallbackComponent, fallbackComponentFromDi } = this.props;\n        const { hasError } = this.state;\n        if (!hasError) {\n            return children;\n        }\n        return fallbackComponent || fallbackComponentFromDi || jsx(FallbackError, {});\n    }\n};\nErrorBoundary.displayName = 'ErrorBoundary';\nErrorBoundary = __decorate([\n    withDi({\n        errorHandlers: { token: ERROR_BOUNDARY_TOKEN, optional: true },\n        fallbackComponentFromDi: { token: ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN, optional: true },\n    })\n], ErrorBoundary);\n\n/**\n * @deprecated Use UniversalErrorBoundary component\n */\nconst withError = ({ fallbackComponent } = {}) => (WrappedComponent) => {\n    function WrapperWithError(props) {\n        return (jsx(ErrorBoundary, { fallbackComponent: fallbackComponent, children: jsx(WrappedComponent, { ...props }) }));\n    }\n    return hoistStatics(WrapperWithError, WrappedComponent);\n};\n\nconst resolveLazyComponent = async (componentOrLoader) => {\n    if (!componentOrLoader) {\n        return;\n    }\n    if ('load' in componentOrLoader && typeof componentOrLoader.load === 'function') {\n        const mod = await componentOrLoader.load();\n        let component;\n        if (mod.__esModule) {\n            component = mod.default;\n        }\n        else {\n            component = mod.default || mod;\n        }\n        // manually hoist static properties from preloaded component to loadable wrapper,\n        // this open access to current page component static properties outside before rendering\n        hoistStatics(componentOrLoader, component);\n        return component;\n    }\n    return componentOrLoader;\n};\n/**\n * @private Only for internal usage!\n * The method is intended to make it possible to wait for retries to synchronously load unsuccessful CSS assets\n */\nconst __lazyErrorHandler = (error, load) => {\n    // This error from `mini-css-extract-plugin` fired, when a file loading initiated by this plugin failed.\n    // By default, this error will cancel the loading of the component via `loadable`.\n    // Now, we can add `__lazyErrorHandler` to catch block of any dynamic import,\n    // and if failed assets was loaded again, `loadable` will not fail\n    if ((error === null || error === void 0 ? void 0 : error.code) === 'CSS_CHUNK_LOAD_FAILED') {\n        const failedLinkUrl = error.request;\n        // `mini-css-extract-plugin` instantly removes failed link tags,\n        // so we can expect only link tag from our recovery mechanism\n        const fallbackLinkTag = document.querySelector(`link[href=\"${failedLinkUrl}\"]`) ||\n            document.querySelector(`link[data-href=\"${failedLinkUrl}\"]`);\n        if (fallbackLinkTag) {\n            return load();\n        }\n    }\n    throw error;\n};\nconst lazy = (load, options = {}) => {\n    if (process.env.NODE_ENV === 'development') {\n        if (!('requireAsync' in load)) {\n            console.error(`Lazy import was not processed by lazy-component babel plugin.\nCheck lazy helper usage, expected signature is \"lazy(() => import('./path/to/component'))\",\nthe first argument should be transformed into a special object, but the current value is\n\"${load.toString()}\"`);\n        }\n    }\n    // @ts-expect-error\n    const originalImportAsync = load.importAsync;\n    // @ts-expect-error\n    // eslint-disable-next-line no-param-reassign\n    load.importAsync = () => originalImportAsync().catch((e) => __lazyErrorHandler(e, originalImportAsync));\n    return loadable(load, {\n        fallback: options.loading,\n    });\n};\n\nexport { DIContext, ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN, ERROR_BOUNDARY_TOKEN, ErrorBoundary, FallbackError, ROOT_ERROR_BOUNDARY_COMPONENT_TOKEN, UniversalErrorBoundary, __lazyErrorHandler, lazy, resolveLazyComponent, useDi, useDiContainer, withDi, withError };\n","import { lazy } from '@tramvai/react';\n\n  export default {\n    routes: {\n      '@/routes/index': lazy(() => import(/* webpackChunkName: \"@_routes_index\" */ '/Users/m.zvenigorodskiy/Dev/sketch/src/routes/index'))\n    },\n    pages: {\n      \n    },\n    layouts: {\n      \n    },\n    errorBoundaries: {\n      \n    },\n  }","import { getParts } from '@tinkoff/router';\nimport fsPagesAndRoutes from '@tramvai/cli/lib/external/pages';\n\nconst FILE_SYSTEM_PAGES_PREFIX = '@/';\nconst fileSystemPagesEnabled = () => !!process.env.__TRAMVAI_EXPERIMENTAL_ENABLE_FILE_SYSTEM_PAGES;\nconst getStaticFileSystemPages = () => {\n    return fsPagesAndRoutes.routes;\n};\nconst getExternalFileSystemPages = () => {\n    return fsPagesAndRoutes.pages;\n};\nconst getAllFileSystemPages = () => {\n    return { ...fsPagesAndRoutes.routes, ...fsPagesAndRoutes.pages };\n};\nconst getAllFileSystemLayouts = () => {\n    return fsPagesAndRoutes.layouts;\n};\nconst getAllFileSystemErrorBoundaries = () => {\n    return fsPagesAndRoutes.errorBoundaries;\n};\nconst isFileSystemPageComponent = (pageComponent) => {\n    return (fileSystemPagesEnabled() &&\n        !!pageComponent &&\n        pageComponent.indexOf(FILE_SYSTEM_PAGES_PREFIX) === 0);\n};\n/**\n * @example\n * @/pages/index to /\n * @/pages/foo/bar/[id]/index to /foo/bar/:id/\n */\nconst staticFileSystemPageToPath = (pageComponent) => {\n    return `/${pageComponent\n        .replace(`${FILE_SYSTEM_PAGES_PREFIX}${process.env.__TRAMVAI_EXPERIMENTAL_FILE_SYSTEM_ROUTES_DIR}/`, '')\n        .replace(/\\[(.+)\\]/g, ':$1')\n        .replace(/index$/g, '')}`;\n};\n/**\n * @example\n * / to @/pages/index\n * /sub/route/:id/ to @/pages/sub/route/[id]/index\n */\nconst pathToExternalFileSystemPage = (path) => {\n    const urlParts = getParts(path);\n    const pageComponentParts = urlParts.map((part) => {\n        // @example :id to [id]\n        if (part.startsWith(':')) {\n            return `[${part.replace(':', '')}]`;\n        }\n        return part;\n    });\n    return [\n        `${FILE_SYSTEM_PAGES_PREFIX}${process.env.__TRAMVAI_EXPERIMENTAL_FILE_SYSTEM_PAGES_DIR}`,\n        ...pageComponentParts,\n        'index',\n    ]\n        .filter(Boolean)\n        .join('/');\n};\n/**\n * @example\n * @/routes/index to @/routes/index__layout\n */\nconst fileSystemPageToLayoutKey = (pageComponent) => {\n    return `${pageComponent}__layout`;\n};\n/**\n * @example\n * @/routes/index to @/routes/index__errorBoundary\n */\nconst fileSystemPageToErrorBoundaryKey = (pageComponent) => {\n    return `${pageComponent}__errorBoundary`;\n};\nconst fileSystemPageToRoute = (pageComponent) => {\n    const name = pageComponent;\n    const path = staticFileSystemPageToPath(pageComponent);\n    const layouts = getAllFileSystemLayouts();\n    const errorBoundaries = getAllFileSystemErrorBoundaries();\n    const route = {\n        name,\n        path,\n        config: {\n            pageComponent,\n        },\n    };\n    if (pageComponent in layouts) {\n        route.config.nestedLayoutComponent = fileSystemPageToLayoutKey(pageComponent);\n    }\n    if (pageComponent in errorBoundaries) {\n        route.config.errorBoundaryComponent = fileSystemPageToErrorBoundaryKey(pageComponent);\n    }\n    return route;\n};\nconst fileSystemPageComponentExists = (pageComponent) => {\n    return !!(getStaticFileSystemPages()[pageComponent] || getExternalFileSystemPages()[pageComponent]);\n};\n/**\n * @example\n * @/routes/index to @_routes_index\n */\nconst fileSystemPageToWebpackChunkName = (pageComponent) => {\n    return pageComponent.replace(/\\//g, '_');\n};\n\nexport { FILE_SYSTEM_PAGES_PREFIX, fileSystemPageComponentExists, fileSystemPageToErrorBoundaryKey, fileSystemPageToLayoutKey, fileSystemPageToRoute, fileSystemPageToWebpackChunkName, fileSystemPagesEnabled, getAllFileSystemErrorBoundaries, getAllFileSystemLayouts, getAllFileSystemPages, getExternalFileSystemPages, getStaticFileSystemPages, isFileSystemPageComponent, pathToExternalFileSystemPage, staticFileSystemPageToPath };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Direct reference to request object\n */\nconst FASTIFY_REQUEST = createToken('fastify request');\n/**\n * @description\n * Direct reference to response object\n */\nconst FASTIFY_RESPONSE = createToken('fastify response');\n/**\n * @description\n * Creates new server instance\n */\nconst SERVER_FACTORY_TOKEN = createToken('server serverFactory');\n/**\n * @description\n * Creates web-app instance\n */\nconst WEB_FASTIFY_APP_FACTORY_TOKEN = createToken('webApp fastifyFactory');\n/**\n * @description\n * Instance of the current fastify app that handles requests.\n * Can be used to setup custom request handler and add custom routes\n */\nconst WEB_FASTIFY_APP_TOKEN = createToken('webApp fastify');\n/**\n * @description\n * Subscription to before web-app initialization. It is called before any standard handlers.\n */\nconst WEB_FASTIFY_APP_BEFORE_INIT_TOKEN = createToken('webApp fastify beforeInit', { multi: true });\n/**\n * @description\n * Subscription to web-app initialization.\n * It is called after global request handlers but before handlers for page rendering\n */\nconst WEB_FASTIFY_APP_INIT_TOKEN = createToken('webApp fastify init', { multi: true });\n/**\n * @description\n * You can measure application requests duration.\n */\nconst WEB_FASTIFY_APP_METRICS_TOKEN = createToken('webApp fastify metrics', { multi: true });\n/**\n * @description\n * You can limit requests of application.\n */\nconst WEB_FASTIFY_APP_LIMITER_TOKEN = createToken('webApp fastify limiter', { multi: true });\n/**\n * @description\n * Subscription to after web-app initialization.\n * It is called after any other handlers\n */\nconst WEB_FASTIFY_APP_AFTER_INIT_TOKEN = createToken('webApp fastify afterInit', { multi: true });\n/**\n * @description\n * Subscription to error handler before any default handlers.\n */\nconst WEB_FASTIFY_APP_BEFORE_ERROR_TOKEN = createToken('webApp fastify beforeError', { multi: true });\n/**\n * @description\n * Subscription to error handler.\n */\nconst WEB_FASTIFY_APP_PROCESS_ERROR_TOKEN = createToken('webApp fastify error', { multi: true });\n/**\n * @description\n * Subscription to error handler after default handlers.\n */\nconst WEB_FASTIFY_APP_AFTER_ERROR_TOKEN = createToken('webApp fastify afterError', { multi: true });\n/**\n * @description\n * Http server for utility routes\n */\nconst UTILITY_SERVER_TOKEN = createToken('server utilityServer');\n/**\n * @description\n * Web app for utility routes\n */\nconst UTILITY_WEB_FASTIFY_APP_TOKEN = createToken('webApp utilityServer');\nconst PAPI_EXECUTOR = createToken('papi executor');\n\nexport { FASTIFY_REQUEST, FASTIFY_RESPONSE, PAPI_EXECUTOR, SERVER_FACTORY_TOKEN, UTILITY_SERVER_TOKEN, UTILITY_WEB_FASTIFY_APP_TOKEN, WEB_FASTIFY_APP_AFTER_ERROR_TOKEN, WEB_FASTIFY_APP_AFTER_INIT_TOKEN, WEB_FASTIFY_APP_BEFORE_ERROR_TOKEN, WEB_FASTIFY_APP_BEFORE_INIT_TOKEN, WEB_FASTIFY_APP_FACTORY_TOKEN, WEB_FASTIFY_APP_INIT_TOKEN, WEB_FASTIFY_APP_LIMITER_TOKEN, WEB_FASTIFY_APP_METRICS_TOKEN, WEB_FASTIFY_APP_PROCESS_ERROR_TOKEN, WEB_FASTIFY_APP_TOKEN };\n","import testString from '@tinkoff/utils/string/test';\nimport eachObj from '@tinkoff/utils/object/each';\nimport each from '@tinkoff/utils/array/each';\n\nconst isAbsoluteUrl = testString(/^(?:[a-z]+:)?\\/\\//i);\nconst isInvalidUrl = (url) => {\n    if (url.length < 2) {\n        return false;\n    }\n    for (let index = 0; index < url.length; index++) {\n        switch (url[index]) {\n            case '?':\n                return true;\n            case '/':\n                break;\n            default:\n                return false;\n        }\n    }\n    return true;\n};\nconst getDefaultBaseUrl = () => typeof window === 'undefined' ? 'http://localhost/' : window.location.href;\nconst getPath = (url) => {\n    return url.pathname + url.search + url.hash;\n};\nconst convertRawUrl = (url) => {\n    const query = Object.create(null);\n    url.searchParams.forEach((value, key) => {\n        // eslint-disable-next-line no-prototype-builtins\n        if (!Object.prototype.hasOwnProperty.call(query, key)) {\n            query[key] = value;\n        }\n        else if (Array.isArray(query[key])) {\n            query[key].push(value);\n        }\n        else {\n            query[key] = [query[key], value];\n        }\n    });\n    const str = url.toString();\n    const path = getPath(url);\n    const result = {\n        href: path,\n        origin: url.origin,\n        protocol: url.protocol,\n        username: url.username,\n        password: url.password,\n        port: url.port,\n        pathname: url.pathname,\n        path,\n        search: url.search,\n        hash: url.hash,\n        query,\n    };\n    if (url.host !== 'localhost') {\n        Object.assign(result, {\n            href: url.href,\n            host: url.host,\n            hostname: url.hostname,\n        });\n    }\n    Object.defineProperty(result, 'toString', {\n        value: () => str,\n        enumerable: false,\n    });\n    return result;\n};\nconst rawParse = (url, baseUrl = getDefaultBaseUrl()) => {\n    return new URL(isInvalidUrl(url) ? url.replace(/^\\/+/, '/') : url, baseUrl);\n};\nconst parse = (url) => {\n    return convertRawUrl(rawParse(url));\n};\nconst rawResolveUrl = (baseUrl, url) => {\n    const absoluteBaseUrl = rawParse(baseUrl.toString());\n    return rawParse(url, absoluteBaseUrl);\n};\nconst resolveUrl = (baseUrl, url) => {\n    return convertRawUrl(rawResolveUrl(baseUrl, url));\n};\nconst resolve = (baseUrl, url) => {\n    const absoluteBaseUrl = rawParse(baseUrl);\n    const parsed = rawParse(url, absoluteBaseUrl);\n    if (isAbsoluteUrl(baseUrl)) {\n        return parsed.href;\n    }\n    return getPath(parsed);\n};\nconst pathPattern = /^(\\/[^?\\s]*)(\\?[^\\s]*)?(#[^s]*)?$/;\nconst fromPath = (path) => {\n    const exec = pathPattern.exec(path);\n    if (exec) {\n        const [_, pathname, search = '', hash = ''] = exec;\n        return {\n            pathname,\n            search,\n            hash,\n        };\n    }\n};\nconst fillSearchParamsWithQuery = (searchParams, query) => {\n    eachObj((vs, k) => {\n        if (Array.isArray(vs)) {\n            searchParams.delete(k);\n            each((v) => searchParams.append(k, v), vs);\n        }\n        else if (typeof vs === 'undefined') {\n            searchParams.delete(k);\n        }\n        else {\n            searchParams.set(k, vs);\n        }\n    }, query);\n};\nconst addQuery = (url, query) => {\n    const parsed = rawParse(url.toString());\n    fillSearchParamsWithQuery(parsed.searchParams, query);\n    return convertRawUrl(parsed);\n};\n/* eslint-disable no-param-reassign */\nconst rawAssignUrl = (url, params) => {\n    const { href, path, query, origin, port, username, password, ...rest } = params;\n    if (path) {\n        const parsedPath = fromPath(path);\n        if (parsedPath) {\n            Object.assign(url, parsedPath);\n        }\n    }\n    //\n    // проблема в Edge:\n    //\n    // даже если в `username` или `password` пустая строка,\n    // `Object.assign(url, rest)` обновляет эти свойства в url,\n    // и браузер запрещает доступ к некоторым полям,\n    // что вызывает ошибку при чтении данных через `url.toString()`\n    //\n    // пример похожей проблемы - https://stackoverflow.com/questions/52737606/why-do-i-get-permission-denied-on-constructing-url-in-edge\n    //\n    if (username) {\n        url.username = username;\n    }\n    if (password) {\n        url.password = password;\n    }\n    // убираем на всякий случай все параметры которые могут вызвать ошибку при присваивании\n    // в объект Url, например, чтобы явно не скрывать их при работе с результатом вызова parse\n    Object.assign(url, rest);\n    if (typeof port !== 'undefined') {\n        url.port = port;\n        // в некоторых браузерах встречается баг, что если port === '0', то в порте выставляется \"0\" что в итоге приводит к невалидному урлу\n        // выставляем порт по умолчанию в зависимости от протокола https://url.spec.whatwg.org/#default-port\n        if (url.port === '0') {\n            url.port = url.protocol === 'http:' ? '80' : '443';\n        }\n    }\n    if (query) {\n        const searchParams = new URLSearchParams(params.search);\n        fillSearchParamsWithQuery(searchParams, query);\n        url.search = searchParams.toString();\n    }\n    return url;\n};\n/* eslint-enable no-param-reassign */\nconst format = (params) => {\n    const url = rawParse('');\n    return convertRawUrl(rawAssignUrl(url, params)).href;\n};\n\nexport { addQuery, convertRawUrl, format, fromPath, getPath, isAbsoluteUrl, isInvalidUrl, parse, rawAssignUrl, rawParse, rawResolveUrl, resolve, resolveUrl };\n","import { createToken } from '@tinkoff/dippy';\n\nconst COMMAND_LINE_TIMING_INFO_TOKEN = createToken('commandLineRunner timingInfo');\nconst COMMAND_LINE_EXECUTION_END_TOKEN = createToken('commandLineRunner executionEnd', { multi: true });\n\nexport { COMMAND_LINE_EXECUTION_END_TOKEN, COMMAND_LINE_TIMING_INFO_TOKEN };\n","class SilentError extends Error {\n    constructor(message) {\n        super(message);\n        this.isSilent = true;\n        this.name = SilentError.errorName;\n    }\n}\nSilentError.errorName = 'SilentError';\nconst isSilentError = (err) => {\n    return !!err.isSilent;\n};\nconst makeErrorSilent = (err) => {\n    // eslint-disable-next-line no-param-reassign\n    err.isSilent = true;\n    return err;\n};\n\nclass HttpError extends Error {\n    constructor({ message = 'Http Error', httpStatus, ...additionalFields }) {\n        super(message);\n        this.name = HttpError.errorName;\n        this.httpStatus = httpStatus;\n        Object.assign(this, additionalFields);\n    }\n}\nHttpError.errorName = 'HttpError';\n\nclass NotFoundError extends HttpError {\n    constructor({ message = 'Not Found', ...additionalFields } = {}) {\n        super({ message, httpStatus: 404 });\n        this.name = NotFoundError.errorName;\n        Object.assign(this, additionalFields);\n    }\n}\nNotFoundError.errorName = 'NotFoundError';\n\nclass RedirectFoundError extends HttpError {\n    constructor({ message = 'Redirect Found', nextUrl, httpStatus = 307, ...additionalFields }) {\n        super({ message, httpStatus });\n        this.name = RedirectFoundError.errorName;\n        this.nextUrl = nextUrl;\n        this.httpStatus = httpStatus;\n        Object.assign(this, additionalFields);\n    }\n}\nRedirectFoundError.errorName = 'RedirectFoundError';\n\nconst throwNotFoundError = (parameters) => {\n    throw new NotFoundError(parameters);\n};\nconst isNotFoundError = (err) => {\n    return err.name === NotFoundError.errorName;\n};\nconst throwRedirectFoundError = (parameters) => {\n    throw new RedirectFoundError(parameters);\n};\nconst isRedirectFoundError = (err) => {\n    return err.name === RedirectFoundError.errorName;\n};\nconst throwHttpError = (parameters) => {\n    throw new HttpError(parameters);\n};\nconst isHttpError = (err) => {\n    return err.name === HttpError.errorName || isNotFoundError(err) || isRedirectFoundError(err);\n};\n\nclass ExecutionError extends Error {\n    constructor({ message = 'Execution Error', cause, contextName, ...additionalFields } = {}) {\n        super(message);\n        this.name = ExecutionError.errorName;\n        this.cause = cause;\n        this.contextName = contextName;\n        Object.assign(this, additionalFields);\n    }\n}\nExecutionError.errorName = 'ExecutionError';\n\nclass ExecutionAbortError extends Error {\n    constructor({ message = 'Execution Abort', contextName, ...additionalFields } = {}) {\n        super(message);\n        this.name = ExecutionAbortError.errorName;\n        this.contextName = contextName;\n        Object.assign(this, additionalFields);\n    }\n}\nExecutionAbortError.errorName = 'ExecutionAbortError';\n\nclass ExecutionTimeoutError extends Error {\n    constructor({ message = 'Execution Timeout', contextName, ...additionalFields } = {}) {\n        super(message);\n        this.name = ExecutionTimeoutError.errorName;\n        this.contextName = contextName;\n        Object.assign(this, additionalFields);\n    }\n}\nExecutionTimeoutError.errorName = 'ExecutionTimeoutError';\n\nconst isExecutionError = (err) => {\n    return err.name === ExecutionError.errorName;\n};\nconst isExecutionAbortError = (err) => {\n    return err.name === ExecutionAbortError.errorName || err.name === ExecutionTimeoutError.errorName;\n};\nconst isExecutionTimeoutError = (err) => {\n    return err.name === ExecutionTimeoutError.errorName;\n};\n\nclass ConditionFailError extends Error {\n    constructor({ message = 'Condition failed', conditionName, targetName, ...additionalFields }) {\n        super(message);\n        this.name = ConditionFailError.errorName;\n        this.conditionName = conditionName;\n        this.targetName = targetName;\n        this.isSilent = true;\n        Object.assign(this, additionalFields);\n    }\n}\nConditionFailError.errorName = 'ConditionFailError';\nconst isConditionFailError = (err) => {\n    return err.name === ConditionFailError.errorName;\n};\n\nexport { ConditionFailError, ExecutionAbortError, ExecutionError, HttpError, NotFoundError, RedirectFoundError, SilentError, isConditionFailError, isExecutionAbortError, isExecutionError, isExecutionTimeoutError, isHttpError, isNotFoundError, isRedirectFoundError, isSilentError, makeErrorSilent, throwHttpError, throwNotFoundError, throwRedirectFoundError };\n","import noop from '@tinkoff/utils/function/noop';\n\nconst mockLogger = {\n    debug: noop,\n    info: noop,\n    error: noop,\n};\nconst defaultOptions = {\n    logger: mockLogger,\n    resultTransform: (res) => {\n        if (res.length === 1) {\n            return res[0];\n        }\n        return res;\n    },\n};\nclass PubSub {\n    constructor(options) {\n        this.subscribers = new Map();\n        const opts = { ...defaultOptions, ...options };\n        this.logger = opts.logger;\n        this.resultTransform = opts.resultTransform;\n    }\n    subscribe(event, fn) {\n        this.logger.debug('subscribe', event, fn);\n        let subs = this.subscribers.get(event);\n        if (subs) {\n            subs.add(fn);\n        }\n        else {\n            subs = new Set([fn]);\n            this.subscribers.set(event, subs);\n        }\n        return () => subs.delete(fn);\n    }\n    publish(event, ...args) {\n        this.logger.debug('publish', event, args);\n        const subs = this.subscribers.get(event);\n        if (subs && subs.size) {\n            const promises = [];\n            subs.forEach((sub) => promises.push(Promise.resolve(sub(...args))));\n            return Promise.all(promises).then(this.resultTransform);\n        }\n        return Promise.resolve();\n    }\n}\n\nexport { PubSub };\n","import { createToken } from '@tinkoff/dippy';\nexport { StorageRecord as ResourceType } from '@tinkoff/htmlpagebuilder';\n\nconst HEAD_META = 'head:meta';\nconst HEAD_PERFORMANCE = 'head:performance';\nconst HEAD_CORE_STYLES = 'head:core-styles';\nconst HEAD_POLYFILLS = 'head:polyfills';\nconst HEAD_CORE_SCRIPTS = 'head:core-scripts';\nconst HEAD_DYNAMIC_SCRIPTS = 'head:dynamic-scripts';\nconst HEAD_ANALYTICS = 'head:analytics';\nconst HEAD_ICONS = 'head:icons';\nconst BODY_START = 'body:start';\nconst REACT_RENDER = 'react:render';\nconst BODY_END = 'body:end';\nconst BODY_TAIL_ANALYTICS = 'body:tail:analytics';\nconst BODY_TAIL = 'body:tail';\n\nvar slots = {\n  __proto__: null,\n  HEAD_META: HEAD_META,\n  HEAD_PERFORMANCE: HEAD_PERFORMANCE,\n  HEAD_CORE_STYLES: HEAD_CORE_STYLES,\n  HEAD_POLYFILLS: HEAD_POLYFILLS,\n  HEAD_CORE_SCRIPTS: HEAD_CORE_SCRIPTS,\n  HEAD_DYNAMIC_SCRIPTS: HEAD_DYNAMIC_SCRIPTS,\n  HEAD_ANALYTICS: HEAD_ANALYTICS,\n  HEAD_ICONS: HEAD_ICONS,\n  BODY_START: BODY_START,\n  REACT_RENDER: REACT_RENDER,\n  BODY_END: BODY_END,\n  BODY_TAIL_ANALYTICS: BODY_TAIL_ANALYTICS,\n  BODY_TAIL: BODY_TAIL\n};\n\n/**\n * @description\n * Token adding resources to specific render slots.\n * Used only on server and it is equivalent to usage of RESOURCES_REGISTRY.\n *\n * [Usage example](https://tramvai.dev/docs/how-to/render-add-resources)\n */\nconst RENDER_SLOTS = createToken('RENDER_SLOTS', {\n    multi: true,\n});\n/**\n * @description\n * Token for defining additional attributes for html, body and app container. Keep in mind that:\n *  - only raw html attributes are allowed (not react or anything else, e.g. do not use className use class)\n *  - new attributes overrides old one\n *  - only text values are supported\n *\n * @example\n  ```tsx\n  {\n    provide: HTML_ATTRS,\n    useValue: {\n      target: 'body',\n      attrs: {\n        class: 'custom-class',\n      },\n    },\n    multi: true,\n  },\n  ```\n */\nconst HTML_ATTRS = createToken('HTML_ATTRS', { multi: true });\n/**\n * @description\n * Add node-style callback on render event in browser.\n * Passes error instance as first argument if there was an error\n */\nconst RENDERER_CALLBACK = createToken('RENDERER_CALLBACK', {\n    multi: true,\n});\n/**\n * @description\n * Used as async function which overrides app render. This function may define render parameters or override render result.\n */\nconst CUSTOM_RENDER = createToken('CUSTOM_RENDER');\n/**\n * @description\n * Resources registry is used only on server for registering any additional assets for browser (scripts, styles, html) which should be added to response html page\n */\nconst RESOURCES_REGISTRY = createToken('resourcesRegistry');\n/**\n * @description\n * A string used for check of need to loading polyfills in the client browser.\n * Polyfills are always loading for browsers without module support and if browser do support modules\n * this check will called in order to find out the need of loading polyfills\n * (by default checks for Promise.prototype.finally and implementations for URL and URLSearchParams)\n *\n * [Polyfill documentation](https://tramvai.dev/docs/how-to/how-to-enable-polyfills)\n */\nconst POLYFILL_CONDITION = createToken('POLYFILL_CONDITION');\n/**\n * @deprecated tramvai will automatically detect React version, and use hydrateRoot API for 18+ version\n * For Strict Mode, use token `USE_REACT_STRICT_MODE`\n */\nconst RENDER_MODE = createToken('RENDER_MODE');\n/**\n * @description add Strict Mode wrapper, more info available in documentation https://reactjs.org/docs/strict-mode.html\n */\nconst USE_REACT_STRICT_MODE = createToken('useReactStrictMode');\n/**\n * @description\n * A wrapper for app render.\n * Through that token is possible to specify for example React.Context.Provider for the app\n */\nconst EXTEND_RENDER = createToken('EXTEND_RENDER', {\n    multi: true,\n});\n/**\n * @description\n * Token for default layout for all pages - root layout\n */\nconst DEFAULT_LAYOUT_COMPONENT = createToken('defaultLayoutComponent');\n/**\n * @description\n * Token for default header for page\n */\nconst DEFAULT_HEADER_COMPONENT = createToken('defaultHeaderComponent');\n/**\n * @description\n * Token for default footer for page\n */\nconst DEFAULT_FOOTER_COMPONENT = createToken('defaultFooterComponent');\n/**\n * @description\n * Token for default Error Boundary for page\n */\nconst DEFAULT_ERROR_BOUNDARY_COMPONENT = createToken('defaultErrorBoundaryComponent');\n/**\n * @description\n * Token for passing parameters for page layout\n */\nconst LAYOUT_OPTIONS = createToken('layoutOptions', {\n    multi: true,\n});\n/**\n * @description\n * Settings for HTML resources inlining\n * * threshold Maximum value (in bytes) of the file which are getting inlined in HTML page\n * * types Types of resources which should be inlined\n */\nconst RESOURCE_INLINE_OPTIONS = createToken('resourceInlineThreshold');\n/**\n * @description\n * Experimental switcher from ssr to client-side rendering mode\n */\nconst TRAMVAI_RENDER_MODE = createToken('tramvaiRenderMode');\nconst RENDER_FLOW_AFTER_TOKEN = createToken('render flow after', {\n    multi: true,\n});\nconst MODERN_SATISFIES_TOKEN = createToken('modernSatisfies');\nconst REACT_SERVER_RENDER_MODE = createToken('reactServerRenderMode');\n\nexport { CUSTOM_RENDER, DEFAULT_ERROR_BOUNDARY_COMPONENT, DEFAULT_FOOTER_COMPONENT, DEFAULT_HEADER_COMPONENT, DEFAULT_LAYOUT_COMPONENT, EXTEND_RENDER, HTML_ATTRS, LAYOUT_OPTIONS, MODERN_SATISFIES_TOKEN, POLYFILL_CONDITION, REACT_SERVER_RENDER_MODE, RENDERER_CALLBACK, RENDER_FLOW_AFTER_TOKEN, RENDER_MODE, RENDER_SLOTS, RESOURCES_REGISTRY, RESOURCE_INLINE_OPTIONS, slots as ResourceSlot, TRAMVAI_RENDER_MODE, USE_REACT_STRICT_MODE };\n","import { __decorate } from 'tslib';\nimport eachObj from '@tinkoff/utils/object/each';\nimport { createBundle, provide, Scope, Module, commandLineListTokens, COMMAND_LINE_RUNNER_TOKEN, COMMAND_LINES_TOKEN, DI_TOKEN, isTramvaiAction, ACTION_PARAMETERS, createToken, ACTIONS_LIST_TOKEN, IS_DI_CHILD_CONTAINER_TOKEN, BUNDLE_LIST_TOKEN } from '@tramvai/core';\nimport { EnvironmentModule } from '@tramvai/module-environment';\nimport { CookieModule } from '@tramvai/module-cookie';\nexport { COOKIE_MANAGER_TOKEN } from '@tramvai/module-cookie';\nimport { LogModule } from '@tramvai/module-log';\nimport { Hooks } from '@tinkoff/hook-runner';\nimport { REQUEST_MANAGER_TOKEN, COMBINE_REDUCERS, STORE_TOKEN, RESPONSE_MANAGER_TOKEN, ACTION_EXECUTION_TOKEN, ROOT_EXECUTION_CONTEXT_TOKEN, LOGGER_TOKEN, EXECUTION_CONTEXT_MANAGER_TOKEN, COMMAND_LINE_EXECUTION_CONTEXT_TOKEN, PUBSUB_FACTORY_TOKEN, PUBSUB_TOKEN, ROOT_PUBSUB_TOKEN, INITIAL_APP_STATE_TOKEN, ACTION_REGISTRY_TOKEN, ACTION_CONDITIONALS, CONTEXT_TOKEN, ACTION_PAGE_RUNNER_TOKEN, DISPATCHER_TOKEN, DISPATCHER_CONTEXT_TOKEN, STORE_MIDDLEWARE, CREATE_CACHE_TOKEN, CLEAR_CACHE_TOKEN, REGISTER_CLEAR_CACHE_TOKEN, HOOK_TOKEN, COMPONENT_REGISTRY_TOKEN, BUNDLE_MANAGER_TOKEN, ADDITIONAL_BUNDLE_TOKEN } from '@tramvai/tokens-common';\nexport * from '@tramvai/tokens-common';\nimport isObject from '@tinkoff/utils/is/object';\nimport isArray from '@tinkoff/utils/is/array';\nimport { resolveLazyComponent, __lazyErrorHandler } from '@tramvai/react';\nimport { fileSystemPagesEnabled, getAllFileSystemPages, getAllFileSystemLayouts, getAllFileSystemErrorBoundaries, isFileSystemPageComponent, fileSystemPageToLayoutKey, fileSystemPageToErrorBoundaryKey } from '@tramvai/experiments';\nimport pathOr from '@tinkoff/utils/object/pathOr';\nimport flatten from '@tinkoff/utils/array/flatten';\nimport { FASTIFY_REQUEST, FASTIFY_RESPONSE } from '@tramvai/tokens-server-private';\nimport { createEvent, createReducer, convertAction, createDispatcher, devTools, Provider } from '@tramvai/state';\nimport { format, parse } from '@tinkoff/url';\nimport isEmpty from '@tinkoff/utils/is/empty';\nimport values from '@tinkoff/utils/object/values';\nimport { COMMAND_LINE_TIMING_INFO_TOKEN, COMMAND_LINE_EXECUTION_END_TOKEN } from '@tramvai/tokens-core-private';\nimport { createChildContainer, provide as provide$1, Scope as Scope$1, createToken as createToken$1 } from '@tinkoff/dippy';\nimport { isSilentError, ConditionFailError, ExecutionAbortError } from '@tinkoff/errors';\nimport { PubSub } from '@tinkoff/pubsub';\nimport identity from '@tinkoff/utils/function/identity';\nimport objectMap from '@tinkoff/utils/object/map';\nimport uniq from '@tinkoff/utils/array/uniq';\nimport difference from '@tinkoff/utils/array/difference';\nimport toArray from '@tinkoff/utils/array/toArray';\nimport LRU from '@tinkoff/lru-cache-nano';\nimport { AbortController } from 'node-abort-controller';\nimport { jsx } from 'react/jsx-runtime';\nimport { EXTEND_RENDER } from '@tramvai/tokens-render';\nimport { CHILD_APP_COMMON_INITIAL_STATE_TOKEN, CHILD_APP_INTERNAL_CONFIG_TOKEN, CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN, commandLineListTokens as commandLineListTokens$1 } from '@tramvai/tokens-child-app';\n\nconst FS_PAGES_DEFAULT_BUNDLE = '__default';\nclass BundleManager {\n    constructor({ bundleList, componentRegistry, actionRegistry, dispatcher, logger }) {\n        this.bundles = bundleList;\n        this.componentRegistry = componentRegistry;\n        this.actionRegistry = actionRegistry;\n        this.dispatcher = dispatcher;\n        if (fileSystemPagesEnabled()) {\n            const log = logger('file-system-pages:bundle-manager');\n            const components = getAllFileSystemPages();\n            const layouts = getAllFileSystemLayouts();\n            const errorBoundaries = getAllFileSystemErrorBoundaries();\n            const getComponentsFor = (mapping, getKey) => Object.keys(mapping).reduce((result, key) => {\n                // eslint-disable-next-line no-param-reassign\n                result[getKey(key)] = mapping[key];\n                return result;\n            }, {});\n            const componentsDefaultBundle = createBundle({\n                name: FS_PAGES_DEFAULT_BUNDLE,\n                components: {\n                    ...getComponentsFor(layouts, fileSystemPageToLayoutKey),\n                    ...getComponentsFor(errorBoundaries, fileSystemPageToErrorBoundaryKey),\n                    ...components,\n                },\n            });\n            this.bundles[FS_PAGES_DEFAULT_BUNDLE] = () => Promise.resolve({\n                default: componentsDefaultBundle,\n            });\n            for (const key in componentsDefaultBundle.components) {\n                this.componentRegistry.add(key, componentsDefaultBundle.components[key], FS_PAGES_DEFAULT_BUNDLE);\n            }\n            log.debug({\n                event: 'create default bundle with file-system pages',\n                components: Object.keys(components),\n            });\n        }\n    }\n    get(name, pageComponent) {\n        // use fake bundle with file-system pages\n        if (isFileSystemPageComponent(pageComponent)) {\n            // eslint-disable-next-line no-param-reassign\n            name = FS_PAGES_DEFAULT_BUNDLE;\n        }\n        return this.loadBundle(name, pageComponent).then((bundle) => this.resolve(bundle.default, pageComponent));\n    }\n    has(name, pageComponent) {\n        // use fake bundle with file-system pages\n        if (isFileSystemPageComponent(pageComponent)) {\n            // eslint-disable-next-line no-param-reassign\n            name = FS_PAGES_DEFAULT_BUNDLE;\n        }\n        return !!this.bundles[name];\n    }\n    async resolve(bundle, pageComponent) {\n        // preload `lazy` components then register actions and reducers\n        if (pageComponent && bundle.components[pageComponent]) {\n            const componentOrLoader = bundle.components[pageComponent];\n            const component = await resolveLazyComponent(componentOrLoader);\n            if (!component) {\n                return;\n            }\n            // allow page components to register any other components\n            if ('components' in component && isObject(component.components)) {\n                eachObj((cmp, name) => {\n                    this.componentRegistry.add(name, cmp, pageComponent);\n                }, component.components);\n            }\n            if ('actions' in component && isArray(component.actions)) {\n                this.actionRegistry.add(pageComponent, component.actions);\n            }\n            if ('reducers' in component && isArray(component.reducers)) {\n                component.reducers.forEach((reducer) => {\n                    this.dispatcher.registerStore(reducer);\n                });\n            }\n        }\n        eachObj((component, name) => {\n            this.componentRegistry.add(name, component, bundle.name);\n        }, bundle.components);\n        if (bundle.actions) {\n            this.actionRegistry.add(bundle.name, bundle.actions);\n        }\n        if (bundle.reducers) {\n            bundle.reducers.forEach((reducer) => {\n                this.dispatcher.registerStore(reducer);\n            });\n        }\n        return bundle;\n    }\n    loadBundle(name, pageComponent) {\n        if (!this.has(name, pageComponent)) {\n            return Promise.reject(new Error(`Bundle \"${name}\" not found`));\n        }\n        return this.bundles[name]().catch((e) => __lazyErrorHandler(e, this.bundles[name]));\n    }\n}\n\nconst DEFAULT_GROUP = '__default';\nclass ComponentRegistry {\n    constructor({ componentList } = {}) {\n        this.components = {\n            [DEFAULT_GROUP]: Object.assign({}, ...flatten(componentList !== null && componentList !== void 0 ? componentList : [])),\n        };\n    }\n    add(name, component, group = DEFAULT_GROUP) {\n        const groupComponents = this.components[group] || {};\n        groupComponents[name] = component;\n        this.components[group] = groupComponents;\n    }\n    get(name, group = DEFAULT_GROUP) {\n        const groupComponents = this.components[group] || {};\n        return groupComponents[name] || this.components[DEFAULT_GROUP][name];\n    }\n    getComponentParam(param, defaultValue, component, group) {\n        return pathOr([param], defaultValue, this.get(component, group));\n    }\n}\n\nconst setRequest = createEvent('setRequest');\nconst RequestManagerStore = createReducer('requestManager', {}).on(setRequest, (_, state) => {\n    return state;\n});\n\nclass RequestManager {\n    constructor({ request }) {\n        this.request = request || {};\n        if (typeof window === 'undefined') {\n            this.url = format({\n                protocol: this.getHeader('x-forwarded-proto') || this.request.protocol,\n                host: this.getHost(),\n                path: this.request.url,\n            });\n        }\n        else {\n            this.url = window.location.href;\n        }\n    }\n    getBody() {\n        return this.request.body;\n    }\n    getUrl() {\n        return this.url;\n    }\n    getParsedUrl() {\n        if (!this.parsedUrl) {\n            this.parsedUrl = parse(this.url);\n        }\n        return this.parsedUrl;\n    }\n    getMethod() {\n        return this.request.method;\n    }\n    getHeader(key) {\n        var _a;\n        return (_a = this.request.headers) === null || _a === void 0 ? void 0 : _a[key];\n    }\n    getHeaders() {\n        return this.request.headers;\n    }\n    getCookie(key) {\n        return this.request.cookies[key];\n    }\n    getCookies() {\n        return this.request.cookies;\n    }\n    getClientIp() {\n        var _a, _b;\n        return this.getHeader('x-real-ip') || ((_b = (_a = this.request) === null || _a === void 0 ? void 0 : _a.socket) === null || _b === void 0 ? void 0 : _b.remoteAddress) || '';\n    }\n    getHost() {\n        if (typeof window === 'undefined') {\n            return (this.getHeader('x-original-host') || this.getHeader('host'));\n        }\n        return window.location.host;\n    }\n}\n\nconst sharedProviders$1 = [\n    provide({\n        provide: REQUEST_MANAGER_TOKEN,\n        scope: Scope.REQUEST,\n        useClass: RequestManager,\n        deps: {\n            request: FASTIFY_REQUEST,\n        },\n    }),\n    provide({\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: RequestManagerStore,\n    }),\n];\n\nlet RequestManagerModule = class RequestManagerModule {\n};\nRequestManagerModule = __decorate([\n    Module({\n        providers: [\n            ...sharedProviders$1,\n            provide({\n                provide: FASTIFY_REQUEST,\n                useFactory: ({ store }) => {\n                    const fromServer = store.getState(RequestManagerStore);\n                    return {\n                        ...fromServer,\n                        headers: {\n                            ...fromServer === null || fromServer === void 0 ? void 0 : fromServer.headers,\n                            'user-agent': navigator.userAgent,\n                            cookie: document.cookie,\n                        },\n                        // the type is not actually the same and is only partially compatible with actual request object\n                        // but provide it as a backup for some of the isomorphic code\n                        // anyway it is better not to use request/response on client\n                    };\n                },\n                deps: {\n                    store: STORE_TOKEN,\n                },\n            }),\n        ],\n    })\n], RequestManagerModule);\n\nclass ResponseManager {\n    constructor() {\n        this.body = '';\n        this.headers = {};\n        this.cookies = {};\n        this.status = 200;\n    }\n    getBody() {\n        return this.body;\n    }\n    setBody(value) {\n        this.body = value;\n    }\n    getHeader(key) {\n        if (key === 'set-cookie') {\n            return values(this.cookies);\n        }\n        return this.headers[key];\n    }\n    getHeaders() {\n        if (isEmpty(this.cookies)) {\n            return this.headers;\n        }\n        return {\n            ...this.headers,\n            'Set-Cookie': values(this.cookies),\n        };\n    }\n    setHeader(key, value) {\n        this.headers[key] = value;\n    }\n    getCookie(key) {\n        return this.cookies[key];\n    }\n    getCookies() {\n        return this.cookies;\n    }\n    setCookie(key, value) {\n        this.cookies[key] = value;\n    }\n    setStatus(status) {\n        this.status = status;\n    }\n    getStatus() {\n        return this.status;\n    }\n}\n\nconst sharedProviders = [\n    provide({\n        provide: RESPONSE_MANAGER_TOKEN,\n        scope: Scope.REQUEST,\n        useClass: ResponseManager,\n    }),\n];\n\nlet ResponseManagerModule = class ResponseManagerModule {\n};\nResponseManagerModule = __decorate([\n    Module({\n        providers: [\n            ...sharedProviders,\n            provide({\n                provide: FASTIFY_RESPONSE,\n                // @ts-expect-error\n                useValue: {},\n            }),\n        ],\n    })\n], ResponseManagerModule);\n\nclass ConsumerContext {\n    constructor({ di, dispatcherContext, pubsub, store }) {\n        /* Side Effects */\n        this.executeAction = (action, payload) => {\n            return this.di.get(ACTION_EXECUTION_TOKEN).run(action, payload);\n        };\n        /* State manager */\n        this.dispatch = (actionOrNameEvent, payload) => {\n            return new Promise((resolve, reject) => {\n                try {\n                    resolve(this.store.dispatch(convertAction(actionOrNameEvent, payload)));\n                }\n                catch (err) {\n                    reject(err);\n                }\n            });\n        };\n        this.dispatchWith = (createActionOrType, options) => {\n            return typeof createActionOrType === 'function'\n                ? (...args) => this.dispatch(createActionOrType(...args), options)\n                : (payload) => this.dispatch(createActionOrType, payload);\n        };\n        /**\n         * @deprecated\n         */\n        this.getStore = (store) => {\n            return this.dispatcher.getStore(store);\n        };\n        this.dehydrate = () => ({\n            dispatcher: this.dispatcher.dehydrate(),\n        });\n        this.getState = (...args) => {\n            return this.store.getState(args[0]);\n        };\n        this.subscribe = (...args) => {\n            return this.store.subscribe(args[0], args[1]);\n        };\n        this.hasStore = (store) => this.dispatcher.hasStore(store);\n        this.registerStore = (store) => this.dispatcher.registerStore(store);\n        this.unregisterStore = (store) => this.dispatcher.unregisterStore(store);\n        this.store = store;\n        // @ts-expect-error\n        this.dispatcher = dispatcherContext;\n        // TODO убрать, нужно для некоторых старых сторов на платформе\n        this.dispatcher.setContext(this);\n        this.di = di; // кажется этого здесь не  должно быть\n        this.pubsub = pubsub;\n    }\n}\nfunction createConsumerContext({ di, dispatcherContext, pubsub, store }) {\n    return new ConsumerContext({\n        di,\n        dispatcherContext,\n        pubsub,\n        store,\n    });\n}\n\nconst resolveDi = (type, status, diContainer, providers) => {\n    let di = diContainer;\n    if (status === 'customer' && type !== 'client') {\n        di = createChildContainer(di);\n    }\n    if (providers) {\n        providers.forEach((item) => {\n            return di.register(item);\n        });\n    }\n    return di;\n};\nclass CommandLineRunner {\n    constructor({ lines, rootDi, logger, executionContextManager, executionEndHandlers }) {\n        this.executionContextByDi = new WeakMap();\n        this.abortControllerByDi = new WeakMap();\n        this.lines = lines;\n        this.rootDi = rootDi;\n        this.log = logger('command:command-line-runner');\n        this.executionContextManager = executionContextManager;\n        this.executionEndHandlers = executionEndHandlers;\n    }\n    run(type, status, providers, customDi) {\n        const di = customDi !== null && customDi !== void 0 ? customDi : resolveDi(type, status, this.rootDi, providers);\n        const rootExecutionContext = di.get({ token: ROOT_EXECUTION_CONTEXT_TOKEN, optional: true });\n        this.log.debug({\n            event: 'command-run',\n            type,\n            status,\n        });\n        const timingInfo = {};\n        di.register({ provide: COMMAND_LINE_TIMING_INFO_TOKEN, useValue: timingInfo });\n        return (this.lines[type][status]\n            .reduce((chain, line) => {\n            return chain.then(() => {\n                const lineName = line.toString();\n                timingInfo[lineName] = { start: performance.now() };\n                // eslint-disable-next-line promise/no-nesting\n                return Promise.resolve()\n                    .then(() => {\n                    return this.executionContextManager.withContext(rootExecutionContext, `command-line:${lineName}`, async (executionContext, abortController) => {\n                        this.executionContextByDi.set(di, executionContext);\n                        this.abortControllerByDi.set(di, abortController);\n                        await this.createLineChain(di, line);\n                    });\n                })\n                    .finally(() => {\n                    timingInfo[lineName].end = performance.now();\n                });\n            });\n        }, Promise.resolve())\n            // После завершения цепочки отдаем context выполнения\n            .finally(() => {\n            this.executionContextByDi.delete(di);\n            this.abortControllerByDi.delete(di);\n            if (this.executionEndHandlers) {\n                for (const executionEndHandler of this.executionEndHandlers) {\n                    executionEndHandler(di, type, status, timingInfo);\n                }\n            }\n        })\n            .then(() => di));\n    }\n    resolveExecutionContextFromDi(di) {\n        var _a;\n        return (_a = this.executionContextByDi.get(di)) !== null && _a !== void 0 ? _a : null;\n    }\n    createLineChain(di, line) {\n        let lineInstance;\n        try {\n            lineInstance = di.get({ token: line, optional: true });\n            // Пропускаем step. Так как нет действий\n            if (lineInstance === null) {\n                return Promise.resolve();\n            }\n        }\n        catch (e) {\n            // Логируем ошибку и дальше падаем\n            this.log.error(e);\n            return this.throwError(e, di);\n        }\n        if (!Array.isArray(lineInstance)) {\n            return this.instanceExecute(lineInstance, line, di);\n        }\n        return Promise.all(lineInstance.map((instance) => {\n            return this.instanceExecute(instance, line, di);\n        }));\n    }\n    instanceExecute(instance, line, di) {\n        if (!(instance instanceof Function)) {\n            const error = new TypeError(`Expected function in line processing \"commandLineListTokens.${line.toString()}\", received \"${instance}\".\n      Check that all commandLineListTokens subscribers return functions`);\n            if (process.env.NODE_ENV !== 'production') {\n                const instances = di.get(line);\n                const record = di.getRecord(line.toString());\n                // пробегаемся по всем инстансам и для текущего получаем его запись, из которой можно получить стек\n                for (let i = 0; i < instances.length; i++) {\n                    if (instances[i] === instance) {\n                        // @ts-expect-error\n                        error.stack = `${error.stack}\\n---- caused by: ----\\n${record.multi[i].stack || ''}`;\n                    }\n                }\n            }\n            this.log.error({\n                event: 'line-error',\n                error,\n                line: line.toString(),\n            });\n            return;\n        }\n        const { name = '' } = instance;\n        this.log.debug({\n            event: 'line-run',\n            line: line.toString(),\n            command: name,\n        });\n        return Promise.resolve()\n            .then(() => instance())\n            .catch((err) => {\n            var _a;\n            this.log[isSilentError(err) ? 'debug' : 'error']({\n                event: 'line-error',\n                error: err,\n                line: line.toString(),\n                command: name,\n            });\n            // in case if any error happens during line execution results from other line handlers will not be used anyway\n            (_a = this.abortControllerByDi.get(di)) === null || _a === void 0 ? void 0 : _a.abort();\n            this.throwError(err, di);\n        });\n    }\n    // eslint-disable-next-line class-methods-use-this\n    throwError(err, di) {\n        if (typeof err === 'object') {\n            // eslint-disable-next-line no-param-reassign\n            err.di = di;\n        }\n        throw err;\n    }\n}\n\nconst command$1 = {\n    init: [commandLineListTokens.init, commandLineListTokens.listen],\n    close: [commandLineListTokens.close],\n    customer: [\n        commandLineListTokens.customerStart,\n        commandLineListTokens.resolveUserDeps,\n        commandLineListTokens.resolvePageDeps,\n        commandLineListTokens.generatePage,\n        commandLineListTokens.clear,\n    ],\n    spa: [\n        commandLineListTokens.resolveUserDeps,\n        commandLineListTokens.resolvePageDeps,\n        commandLineListTokens.spaTransition,\n    ],\n    afterSpa: [commandLineListTokens.afterSpaTransition],\n};\nconst lines$1 = {\n    server: command$1,\n    client: command$1,\n};\n\nlet CommandModule = class CommandModule {\n};\nCommandModule = __decorate([\n    Module({\n        providers: [\n            provide$1({\n                // Раннер процессов\n                provide: COMMAND_LINE_RUNNER_TOKEN,\n                scope: Scope$1.SINGLETON,\n                useClass: CommandLineRunner,\n                deps: {\n                    lines: COMMAND_LINES_TOKEN,\n                    rootDi: DI_TOKEN,\n                    logger: LOGGER_TOKEN,\n                    executionContextManager: EXECUTION_CONTEXT_MANAGER_TOKEN,\n                    executionEndHandlers: {\n                        token: COMMAND_LINE_EXECUTION_END_TOKEN,\n                        optional: true,\n                    },\n                },\n            }),\n            provide$1({\n                provide: COMMAND_LINE_EXECUTION_CONTEXT_TOKEN,\n                useFactory: ({ di, commandLineRunner }) => {\n                    return () => {\n                        return commandLineRunner.resolveExecutionContextFromDi(di);\n                    };\n                },\n                deps: {\n                    di: DI_TOKEN,\n                    commandLineRunner: COMMAND_LINE_RUNNER_TOKEN,\n                },\n            }),\n            provide$1({\n                // Дефолтный список команл\n                provide: COMMAND_LINES_TOKEN,\n                scope: Scope$1.SINGLETON,\n                useValue: lines$1,\n            }),\n        ],\n    })\n], CommandModule);\n\nlet PubSubModule = class PubSubModule {\n};\nPubSubModule = __decorate([\n    Module({\n        providers: [\n            provide({\n                // Фабрика для создания pubsub\n                provide: PUBSUB_FACTORY_TOKEN,\n                scope: Scope.SINGLETON,\n                useFactory: (deps) => () => {\n                    return new PubSub({\n                        logger: deps.logger('pubsub'),\n                    });\n                },\n                deps: {\n                    logger: LOGGER_TOKEN,\n                },\n            }),\n            provide({\n                provide: PUBSUB_TOKEN,\n                scope: Scope.REQUEST,\n                useFactory: ({ createPubsub }) => createPubsub(),\n                deps: {\n                    createPubsub: PUBSUB_FACTORY_TOKEN,\n                },\n            }),\n            provide({\n                provide: ROOT_PUBSUB_TOKEN,\n                scope: Scope.SINGLETON,\n                useFactory: ({ createPubsub }) => createPubsub(),\n                deps: {\n                    createPubsub: PUBSUB_FACTORY_TOKEN,\n                },\n            }),\n        ],\n    })\n], PubSubModule);\n\nconst providers$2 = [\n    provide({\n        provide: INITIAL_APP_STATE_TOKEN,\n        useFactory: () => { var _a, _b; return JSON.parse((_b = (_a = document.getElementById('__TRAMVAI_STATE__')) === null || _a === void 0 ? void 0 : _a.textContent) !== null && _b !== void 0 ? _b : '{}'); },\n        scope: Scope.REQUEST,\n    }),\n    provide({\n        provide: commandLineListTokens.listen,\n        useFactory: ({ commandLineRunner, }) => {\n            return function initClientCommand() {\n                return commandLineRunner.run('client', 'customer');\n            };\n        },\n        deps: { commandLineRunner: COMMAND_LINE_RUNNER_TOKEN },\n        multi: true,\n    }),\n];\n\nconst actionServerStateEvent = createEvent('action state execution in server');\nconst initalState = { serverState: {} };\nconst actionTramvaiReducer = createReducer('actionTramvai', initalState).on(actionServerStateEvent, (state, payload) => ({\n    ...state,\n    serverState: payload,\n}));\n\n/**\n * @deprecated only for compatibility with legacy createAction\n */\nconst actionType = {\n    global: 'global',\n    local: 'local',\n};\n\nconst DEFAULT_CONDITIONS = {};\nclass ActionChecker {\n    // eslint-disable-next-line max-params\n    constructor(globalConditionals, payload, parameters, executionState, type) {\n        var _a;\n        this.globalConditionals = globalConditionals;\n        this.payload = payload;\n        this.parameters = parameters;\n        this.executionState = executionState;\n        this.type = type;\n        this.status = true;\n        this.forbiddenMarker = false;\n        this.key = null;\n        // для глобальных экшенов мы должны дедублицировать выполнение и меньше выполнять\n        if (type === actionType.global) {\n            // если экшен был уже выполнен, то считаем, что его не нужно больше выполнять\n            this.status = executionState.status !== 'success';\n        }\n        this.conditions = (_a = parameters.conditions) !== null && _a !== void 0 ? _a : DEFAULT_CONDITIONS;\n    }\n    check() {\n        this.globalConditionals.forEach((filter) => {\n            this.key = filter.key;\n            filter.fn(this);\n        });\n        return this.getStatus();\n    }\n    setState(value) {\n        this.executionState.state[this.key] = value;\n    }\n    getState() {\n        return this.executionState.state[this.key];\n    }\n    forbid() {\n        this.executionState.status = 'forbidden';\n        this.executionState.forbiddenBy = this.key;\n        this.forbiddenMarker = true;\n    }\n    allow() {\n        this.status = true;\n    }\n    getStatus() {\n        if (this.forbiddenMarker) {\n            return false;\n        }\n        return this.status;\n    }\n}\n\nconst EMPTY_DEPS = {};\nconst DEFAULT_PAYLOAD = {};\nconst getParameters = (action) => action[ACTION_PARAMETERS];\nclass ActionExecution {\n    constructor({ store, context, di, executionContextManager, actionConditionals, transformAction, }) {\n        this.actionConditionals = flatten(actionConditionals !== null && actionConditionals !== void 0 ? actionConditionals : []);\n        this.context = context;\n        this.store = store;\n        this.di = di;\n        this.executionContextManager = executionContextManager;\n        this.execution = new Map();\n        this.transformAction = transformAction || identity;\n        const initialState = store.getState(actionTramvaiReducer);\n        if (initialState && initialState.serverState) {\n            objectMap((value, key) => {\n                this.execution.set(key, value);\n            }, initialState.serverState);\n        }\n    }\n    async runInContext(executionContext, action, ...params) {\n        var _a, _b;\n        let parameters;\n        const payload = (_a = params[0]) !== null && _a !== void 0 ? _a : DEFAULT_PAYLOAD;\n        // TODO: replace type with pure context usage\n        const type = (executionContext === null || executionContext === void 0 ? void 0 : executionContext.values.pageActions) === true ? actionType.global : actionType.local;\n        // TODO: remove else branch after migration to new declareAction\n        if (isTramvaiAction(action)) {\n            parameters = action;\n        }\n        else {\n            this.transformAction(action);\n            parameters = getParameters(action);\n        }\n        const executionState = this.getExecutionState(parameters.name);\n        if (!this.canExecuteAction(payload, parameters, executionState, type)) {\n            switch (parameters.conditionsFailResult) {\n                case 'reject':\n                    return Promise.reject(new ConditionFailError({\n                        conditionName: (_b = executionState.forbiddenBy) !== null && _b !== void 0 ? _b : 'unknown',\n                        targetName: parameters.name,\n                    }));\n                default:\n                    return Promise.resolve();\n            }\n        }\n        executionState.status = 'pending';\n        return this.executionContextManager.withContext(executionContext, {\n            name: parameters.name,\n            values: (executionContext === null || executionContext === void 0 ? void 0 : executionContext.values.pageActions) === true ? { pageActions: false } : undefined,\n        }, (executionActionContext, abortController) => {\n            const context = this.createActionContext(executionContext, executionActionContext, abortController, parameters);\n            return Promise.resolve()\n                .then(() => {\n                if (isTramvaiAction(action)) {\n                    return action.fn.apply(context, params);\n                }\n                return action(this.context, payload, context.deps);\n            })\n                .then((data) => {\n                executionState.status = 'success';\n                return data;\n            })\n                .catch((err) => {\n                executionState.status = 'failed';\n                throw err;\n            });\n        });\n    }\n    async run(action, ...params) {\n        return this.runInContext(null, action, ...params);\n    }\n    getExecutionState(name) {\n        let executionState = this.execution.get(name);\n        // TODO: probably do not need to create executionState on client as it is not used\n        if (!executionState) {\n            executionState = { status: 'pending', state: {} };\n            this.execution.set(name, executionState);\n        }\n        return executionState;\n    }\n    canExecuteAction(payload, parameters, executionState, type) {\n        const actionChecker = new ActionChecker(this.actionConditionals, payload, parameters, executionState, type);\n        return actionChecker.check();\n    }\n    createActionContext(parentExecutionContext, actionExecutionContext, abortController, parameters) {\n        return {\n            abortController,\n            abortSignal: actionExecutionContext === null || actionExecutionContext === void 0 ? void 0 : actionExecutionContext.abortSignal,\n            executeAction: this.runInContext.bind(this, actionExecutionContext),\n            deps: parameters.deps ? this.di.getOfDeps(parameters.deps) : EMPTY_DEPS,\n            actionType: (parentExecutionContext === null || parentExecutionContext === void 0 ? void 0 : parentExecutionContext.values.pageActions) ? 'page' : 'standalone',\n            dispatch: this.store.dispatch,\n            getState: this.store.getState,\n        };\n    }\n}\n\nconst GLOBAL_PARAMETER = '@@global';\nclass ActionRegistry {\n    constructor({ actionsList }) {\n        this.actions = new Map([[GLOBAL_PARAMETER, flatten(actionsList)]]);\n    }\n    add(type, actions) {\n        const normalized = toArray(actions);\n        this.actions.set(type, uniq(this.actions.has(type) ? [...this.actions.get(type), ...normalized] : normalized));\n    }\n    get(type, addingActions) {\n        return uniq([...(this.actions.get(type) || []), ...(addingActions || [])]);\n    }\n    getGlobal() {\n        return this.actions.get(GLOBAL_PARAMETER);\n    }\n    remove(type, actions) {\n        if (!actions) {\n            this.actions.delete(type);\n            return;\n        }\n        const normalized = toArray(actions);\n        if (this.actions.has(type)) {\n            this.actions.set(type, difference(this.actions.get(type), normalized));\n        }\n    }\n}\n\nclass ActionPageRunner {\n    constructor(deps) {\n        this.deps = deps;\n        this.log = deps.logger('action:action-page-runner');\n    }\n    runActions(actions, stopRunAtError = () => false) {\n        return this.deps.executionContextManager.withContext(this.deps.commandLineExecutionContext(), { name: 'pageActions', values: { pageActions: true } }, async (executionContext) => {\n            const actionMapper = (action) => {\n                return Promise.resolve()\n                    .then(() => this.deps.actionExecution.runInContext(executionContext, action))\n                    .catch((error) => {\n                    if (!isSilentError(error)) {\n                        const parameters = isTramvaiAction(action) ? action : action[ACTION_PARAMETERS];\n                        this.log.error({\n                            error,\n                            event: `action-execution-error`,\n                            message: `${parameters.name} execution error`,\n                        });\n                    }\n                    if (stopRunAtError(error)) {\n                        throw error;\n                    }\n                });\n            };\n            await Promise.all(actions.map(actionMapper));\n        });\n    }\n}\n\nconst alwaysCondition = {\n    key: 'alwaysCondition',\n    fn: (checker) => {\n        if (checker.conditions.always) {\n            checker.allow();\n        }\n    },\n};\n\nconst isServer = typeof window === 'undefined';\nconst isBrowser = !isServer;\n\nconst onlyServer = {\n    key: 'onlyServer',\n    fn: (checker) => {\n        if (checker.conditions.onlyServer && isBrowser) {\n            checker.forbid();\n        }\n    },\n};\n\nconst onlyBrowser = {\n    key: 'onlyBrowser',\n    fn: (checker) => {\n        if (checker.conditions.onlyBrowser && isServer) {\n            checker.forbid();\n        }\n    },\n};\n\nconst pageServer = {\n    key: 'pageServer',\n    fn: (checker) => {\n        if (checker.conditions.pageServer && checker.type === actionType.global && isBrowser) {\n            checker.forbid();\n        }\n    },\n};\n\nconst pageBrowser = {\n    key: 'pageBrowser',\n    fn: (checker) => {\n        if (checker.conditions.pageBrowser && checker.type === actionType.global && isServer) {\n            checker.forbid();\n        }\n    },\n};\n\nconst LIMIT_ACTION_GLOBAL_TIME_RUN = createToken('limitActionGlobalTimeRun');\nlet ActionModule = class ActionModule {\n};\nActionModule = __decorate([\n    Module({\n        providers: [\n            provide({\n                provide: COMBINE_REDUCERS,\n                multi: true,\n                useValue: actionTramvaiReducer,\n            }),\n            provide({\n                // Регистер глобальных экшенов\n                provide: ACTION_REGISTRY_TOKEN,\n                scope: Scope.SINGLETON,\n                useClass: ActionRegistry,\n                deps: { actionsList: ACTIONS_LIST_TOKEN },\n            }),\n            provide({\n                provide: ACTION_EXECUTION_TOKEN,\n                scope: Scope.REQUEST,\n                useClass: ActionExecution,\n                deps: {\n                    actionConditionals: { token: ACTION_CONDITIONALS, optional: true },\n                    context: CONTEXT_TOKEN,\n                    store: STORE_TOKEN,\n                    di: DI_TOKEN,\n                    executionContextManager: EXECUTION_CONTEXT_MANAGER_TOKEN,\n                    transformAction: {\n                        token: 'actionTransformAction',\n                        optional: true,\n                    },\n                },\n            }),\n            provide({\n                provide: ACTION_PAGE_RUNNER_TOKEN,\n                scope: Scope.REQUEST,\n                useClass: ActionPageRunner,\n                deps: {\n                    actionExecution: ACTION_EXECUTION_TOKEN,\n                    executionContextManager: EXECUTION_CONTEXT_MANAGER_TOKEN,\n                    commandLineExecutionContext: COMMAND_LINE_EXECUTION_CONTEXT_TOKEN,\n                    store: STORE_TOKEN,\n                    limitTime: LIMIT_ACTION_GLOBAL_TIME_RUN,\n                    logger: LOGGER_TOKEN,\n                },\n            }),\n            provide({\n                provide: LIMIT_ACTION_GLOBAL_TIME_RUN,\n                useValue: 500,\n            }),\n            provide({\n                provide: ACTION_CONDITIONALS,\n                multi: true,\n                useValue: [alwaysCondition, onlyServer, onlyBrowser, pageServer, pageBrowser],\n            }),\n        ],\n    })\n], ActionModule);\n\nlet StateModule = class StateModule {\n};\nStateModule = __decorate([\n    Module({\n        providers: [\n            provide({\n                provide: DISPATCHER_TOKEN,\n                scope: Scope.SINGLETON,\n                useFactory: ({ stores }) => createDispatcher({ stores: stores && flatten(stores) }),\n                deps: {\n                    stores: {\n                        token: COMBINE_REDUCERS,\n                        optional: true,\n                    },\n                },\n            }),\n            provide({\n                provide: DISPATCHER_CONTEXT_TOKEN,\n                scope: Scope.REQUEST,\n                useFactory: ({ dispatcher, initialState, middlewares }) => {\n                    return dispatcher.createContext({}, initialState, [\n                        devTools.middleware(),\n                        ...flatten(middlewares || []),\n                    ]);\n                },\n                deps: {\n                    dispatcher: DISPATCHER_TOKEN,\n                    middlewares: { token: STORE_MIDDLEWARE, optional: true },\n                    initialState: { token: INITIAL_APP_STATE_TOKEN, optional: true },\n                },\n            }),\n            provide({\n                provide: STORE_TOKEN,\n                scope: Scope.REQUEST,\n                useFactory: ({ dispatcherContext }) => ({\n                    getState: dispatcherContext.getState.bind(dispatcherContext),\n                    dispatch: dispatcherContext.dispatch.bind(dispatcherContext),\n                    subscribe: dispatcherContext.subscribe.bind(dispatcherContext),\n                }),\n                deps: {\n                    dispatcherContext: DISPATCHER_CONTEXT_TOKEN,\n                },\n            }),\n        ],\n    })\n], StateModule);\n\nconst cacheFactory = (type, options = { max: 100 }) => {\n    return new LRU(options);\n};\n\nconst providers$1 = [];\n\nconst cachesToken = createToken$1('_cachesList');\nlet CacheModule = class CacheModule {\n};\nCacheModule = __decorate([\n    Module({\n        providers: [\n            ...providers$1,\n            {\n                provide: cachesToken,\n                scope: Scope.SINGLETON,\n                useValue: [],\n            },\n            {\n                provide: CREATE_CACHE_TOKEN,\n                useFactory: ({ caches, isChildDi }) => {\n                    if (isChildDi) {\n                        return cacheFactory;\n                    }\n                    return (type, ...args) => {\n                        const cache = cacheFactory(type, ...args);\n                        caches.push(cache);\n                        return cache;\n                    };\n                },\n                deps: {\n                    caches: cachesToken,\n                    isChildDi: { token: IS_DI_CHILD_CONTAINER_TOKEN, optional: true },\n                },\n            },\n            {\n                provide: CLEAR_CACHE_TOKEN,\n                scope: Scope.SINGLETON,\n                useFactory: ({ caches, cachesClear }) => {\n                    return (type) => {\n                        caches.forEach((cache) => cache.clear());\n                        if (cachesClear) {\n                            return Promise.all(cachesClear.map((clear) => clear(type)));\n                        }\n                        return Promise.resolve();\n                    };\n                },\n                deps: {\n                    caches: cachesToken,\n                    cachesClear: { token: REGISTER_CLEAR_CACHE_TOKEN, optional: true },\n                },\n            },\n        ],\n    })\n], CacheModule);\n\nconst EMPTY_VALUES = {};\nconst normalizeOptions = (nameOrOptions) => {\n    return typeof nameOrOptions === 'string' ? { name: nameOrOptions } : nameOrOptions;\n};\nclass ExecutionContextManager {\n    async withContext(parentContext, nameOrOptions, cb) {\n        const options = normalizeOptions(nameOrOptions);\n        const { name, values: selfValues = EMPTY_VALUES } = options;\n        const contextName = parentContext ? `${parentContext.name}.${name}` : name;\n        if (parentContext === null || parentContext === void 0 ? void 0 : parentContext.abortSignal.aborted) {\n            throw new ExecutionAbortError({\n                message: `Execution aborted in context \"${contextName}\"`,\n                contextName,\n            });\n        }\n        const abortController = new AbortController();\n        let abortListener;\n        let values = selfValues;\n        if (parentContext) {\n            values = {\n                ...parentContext.values,\n                ...selfValues,\n            };\n            abortListener = () => {\n                abortController.abort();\n            };\n            // abort child context AbortController if parent AbortController was aborted\n            parentContext.abortSignal.addEventListener('abort', abortListener);\n        }\n        const context = {\n            name: contextName,\n            abortSignal: abortController.signal,\n            values,\n        };\n        try {\n            const result = await cb(context, abortController);\n            return result;\n        }\n        catch (error) {\n            if (typeof error === 'object' && !error.executionContextName) {\n                error.executionContextName = context.name;\n            }\n            throw error;\n        }\n        finally {\n            // @ts-expect-error\n            if (abortListener && parentContext) {\n                parentContext.abortSignal.removeEventListener('abort', abortListener);\n            }\n        }\n    }\n}\n\nlet CommonModule = class CommonModule {\n};\nCommonModule = __decorate([\n    Module({\n        imports: [\n            CommandModule,\n            EnvironmentModule,\n            PubSubModule,\n            LogModule,\n            CookieModule,\n            ActionModule,\n            StateModule,\n            RequestManagerModule,\n            ResponseManagerModule,\n            CacheModule,\n        ],\n        providers: [\n            provide({\n                // Инстанс хук системы\n                provide: HOOK_TOKEN,\n                scope: Scope.SINGLETON,\n                useClass: Hooks,\n            }),\n            provide({\n                // Регистр ui компонентов\n                provide: COMPONENT_REGISTRY_TOKEN,\n                scope: Scope.SINGLETON,\n                useClass: ComponentRegistry,\n                deps: {\n                    componentList: { token: 'componentDefaultList', optional: true },\n                },\n            }),\n            provide({\n                // Управление бандлами, хранение и получение\n                provide: BUNDLE_MANAGER_TOKEN,\n                scope: Scope.SINGLETON,\n                useFactory: ({ additionalBundleList, ...bundleManagerDeps }) => {\n                    additionalBundleList === null || additionalBundleList === void 0 ? void 0 : additionalBundleList.forEach((bundles) => {\n                        eachObj((bundle, name) => {\n                            const bundleAlreadyExists = name in bundleManagerDeps.bundleList;\n                            if (!bundleAlreadyExists) {\n                                // eslint-disable-next-line no-param-reassign\n                                bundleManagerDeps.bundleList[name] = () => Promise.resolve({ default: bundle });\n                            }\n                        }, bundles);\n                    });\n                    return new BundleManager(bundleManagerDeps);\n                },\n                deps: {\n                    bundleList: BUNDLE_LIST_TOKEN,\n                    additionalBundleList: { token: ADDITIONAL_BUNDLE_TOKEN, optional: true },\n                    componentRegistry: COMPONENT_REGISTRY_TOKEN,\n                    actionRegistry: ACTION_REGISTRY_TOKEN,\n                    dispatcher: DISPATCHER_TOKEN,\n                    logger: LOGGER_TOKEN,\n                },\n            }),\n            provide({\n                //  Клиентский контекст исполнения\n                provide: CONTEXT_TOKEN,\n                scope: Scope.REQUEST,\n                useFactory: createConsumerContext,\n                deps: {\n                    di: DI_TOKEN,\n                    pubsub: PUBSUB_TOKEN,\n                    dispatcherContext: DISPATCHER_CONTEXT_TOKEN,\n                    store: STORE_TOKEN,\n                },\n            }),\n            provide({\n                provide: EXECUTION_CONTEXT_MANAGER_TOKEN,\n                useClass: ExecutionContextManager,\n            }),\n            ...providers$2,\n        ],\n    })\n], CommonModule);\n\nconst providers = [\n    provide({\n        provide: INITIAL_APP_STATE_TOKEN,\n        useFactory: ({ commonState, config }) => {\n            return commonState[`${config.key}`];\n        },\n        deps: {\n            commonState: CHILD_APP_COMMON_INITIAL_STATE_TOKEN,\n            config: CHILD_APP_INTERNAL_CONFIG_TOKEN,\n        },\n    }),\n];\n\nconst stateProviders = [\n    provide({\n        provide: CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN,\n        multi: true,\n        useValue: [DISPATCHER_TOKEN, STORE_TOKEN, CONTEXT_TOKEN],\n    }),\n];\n\nconst command = {\n    customer: [\n        commandLineListTokens$1.customerStart,\n        commandLineListTokens$1.resolveUserDeps,\n        commandLineListTokens$1.resolvePageDeps,\n    ],\n    clear: [commandLineListTokens$1.clear],\n    spa: [\n        commandLineListTokens$1.resolveUserDeps,\n        commandLineListTokens$1.resolvePageDeps,\n        commandLineListTokens$1.spaTransition,\n    ],\n    afterSpa: [commandLineListTokens$1.afterSpaTransition],\n};\nconst lines = {\n    server: command,\n    client: command,\n};\nconst commandProviders = [\n    provide({\n        provide: CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN,\n        multi: true,\n        useValue: COMMAND_LINE_RUNNER_TOKEN,\n    }),\n    provide({\n        provide: COMMAND_LINES_TOKEN,\n        scope: Scope.SINGLETON,\n        useValue: lines,\n    }),\n];\n\nconst actionsProviders = [\n    provide({\n        provide: CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN,\n        multi: true,\n        useValue: [ACTION_EXECUTION_TOKEN, ACTION_PAGE_RUNNER_TOKEN],\n    }),\n    provide({\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: actionTramvaiReducer,\n    }),\n];\n\nlet CommonChildAppModule = class CommonChildAppModule {\n};\nCommonChildAppModule = __decorate([\n    Module({\n        providers: [\n            ...providers,\n            ...stateProviders,\n            ...commandProviders,\n            ...actionsProviders,\n            provide({\n                provide: EXTEND_RENDER,\n                multi: true,\n                useFactory: ({ context }) => {\n                    const serverState = typeof window !== 'undefined' ? context.getState() : undefined;\n                    return (render) => {\n                        return (jsx(Provider, { context: context, serverState: serverState, children: render }));\n                    };\n                },\n                deps: {\n                    context: CONTEXT_TOKEN,\n                },\n            }),\n        ],\n    })\n], CommonChildAppModule);\n\nexport { ActionExecution, CommandModule, CommonChildAppModule, CommonModule, ExecutionContextManager, alwaysCondition, createConsumerContext, onlyBrowser, onlyServer, pageBrowser, pageServer };\n","import uniq from '@tinkoff/utils/array/uniq';\n\nclass Hooks {\n    constructor() {\n        this.hooks = Object.create(null);\n    }\n    /**\n     * Регистрация хуков\n     */\n    registerHooks(name, list) {\n        if (!this.hooks[name]) {\n            this.hooks[name] = [];\n        }\n        this.hooks[name] = uniq(this.hooks[name].concat(list));\n    }\n    /**\n     * Запуск синхронных хуков, payload проходит через все хуки и будет результатом выполнения\n     */\n    // eslint-disable-next-line max-params\n    runHooks(name, context, payload, options) {\n        const plugins = this.hooks[name];\n        if (!plugins) {\n            return payload;\n        }\n        let current = payload;\n        for (let i = 0; i < plugins.length; i++) {\n            current = plugins[i](context, current, options);\n        }\n        return current;\n    }\n    /**\n     * Запуск ассихронных хуков\n     */\n    runAsyncHooks(name, context, payload, options) {\n        const plugins = this.hooks[name];\n        if (!plugins) {\n            return payload;\n        }\n        for (let i = 0; i < plugins.length; i++) {\n            const plugin = plugins[i];\n            setTimeout(() => {\n                plugin(context, payload, options);\n            });\n        }\n        return payload;\n    }\n    /**\n     * Запуск проммис хуков\n     */\n    runPromiseHooks(name, context, options) {\n        const plugins = this.hooks[name];\n        return (payload) => {\n            if (!plugins) {\n                return Promise.resolve(payload);\n            }\n            let currentId = 0;\n            return Promise.resolve(payload).then(function resolver(data) {\n                // eslint-disable-next-line no-plusplus\n                const plugin = plugins[currentId++];\n                if (!plugin) {\n                    return data;\n                }\n                // eslint-disable-next-line promise/no-nesting\n                return Promise.resolve(plugin(context, data, options)).then(resolver);\n            });\n        };\n    }\n}\n\nexport { Hooks };\n","import { parse as parse$1, rawResolveUrl, rawParse, convertRawUrl, rawAssignUrl } from '@tinkoff/url';\nimport isString from '@tinkoff/utils/is/string';\nimport isObject from '@tinkoff/utils/is/object';\nimport map from '@tinkoff/utils/array/map';\nimport T from '@tinkoff/utils/function/T';\nimport noop from '@tinkoff/utils/function/noop';\nimport each from '@tinkoff/utils/array/each';\nimport find from '@tinkoff/utils/array/find';\nimport findIndex from '@tinkoff/utils/array/findIndex';\nimport { jsx } from 'react/jsx-runtime';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\nimport { createContext, useContext, useCallback } from 'react';\nimport { useShallowEqual } from '@tinkoff/react-hooks';\n\nconst PARAMETER_DELIMITER = ':';\nconst WILDCARD_REGEXP = /\\*/;\nconst HISTORY_FALLBACK_REGEXP = /<history-fallback>/;\nconst PARAM_PARSER_REGEXP = /([^(?]+)(?:\\((.+)\\))?(\\?)?/;\n\nconst isFilePath = (pathname) => {\n    return /\\/.+\\.[^/]+$/.test(pathname);\n};\nconst normalizeTrailingSlash = (pathname, trailingSlash = false) => {\n    const hasTrailingSlash = pathname.endsWith('/');\n    if (trailingSlash) {\n        return hasTrailingSlash || isFilePath(pathname) ? pathname : `${pathname}/`;\n    }\n    return pathname.length > 1 && hasTrailingSlash ? pathname.slice(0, -1) : pathname;\n};\nconst normalizeManySlashes = (hrefOrPath) => {\n    const [href, ...search] = hrefOrPath.split('?');\n    return [href.replace(/\\/+/g, '/').replace(/^(\\w+):\\//, '$1://'), ...search].join('?');\n};\nconst isSameHost = typeof window === 'undefined'\n    ? T\n    : (url) => {\n        return !url.host || url.host === window.location.host;\n    };\nconst makeNavigateOptions = (options) => {\n    if (typeof options === 'string') {\n        return { url: options };\n    }\n    return options;\n};\nconst registerHook = (hooksSet, hook) => {\n    hooksSet.add(hook);\n    return () => {\n        hooksSet.delete(hook);\n    };\n};\n\nconst getParts = (pathname) => pathname\n    .split('/')\n    .slice(pathname.startsWith('/') ? 1 : 0, pathname.endsWith('/') ? -1 : Infinity);\nconst isHistoryFallback = (part) => {\n    return HISTORY_FALLBACK_REGEXP.test(part);\n};\nconst isWildcard = (part) => {\n    return WILDCARD_REGEXP.test(part);\n};\nconst isParameterized = (part) => {\n    return part.includes(PARAMETER_DELIMITER);\n};\nconst parseParameter = (part) => {\n    const [prefix = '', param, postfix = ''] = part.split(PARAMETER_DELIMITER);\n    const match = PARAM_PARSER_REGEXP.exec(param);\n    if (!match) {\n        throw new Error('parameters should satisfy pattern \"prefix:paramName(regexp)\\\\?:postfix\"');\n    }\n    const [, paramName, regexp, optional] = match;\n    const useRegexp = prefix || postfix || regexp;\n    return {\n        type: 3 /* PartType.parameter */,\n        paramName,\n        regexp: useRegexp\n            ? new RegExp(`^${prefix}(${regexp || '.+'})${optional ? '?' : ''}${postfix}$`)\n            : undefined,\n        optional: !!optional && !prefix && !postfix,\n    };\n};\nconst parse = (part) => {\n    if (isHistoryFallback(part)) {\n        return { type: 1 /* PartType.historyFallback */ };\n    }\n    if (isWildcard(part)) {\n        return { type: 2 /* PartType.wildcard */ };\n    }\n    if (isParameterized(part)) {\n        return parseParameter(part);\n    }\n    return { type: 0 /* PartType.literal */, value: part };\n};\nconst makePath = (pathname, params) => {\n    const parts = getParts(pathname);\n    const result = map((part) => {\n        var _a;\n        if (isHistoryFallback(part) || isWildcard(part)) {\n            throw new Error(`Pathname should be only a string with dynamic parameters, not a special string, got ${pathname}`);\n        }\n        if (isParameterized(part)) {\n            const [prefix = '', param = '', postfix = ''] = part.split(PARAMETER_DELIMITER);\n            const match = PARAM_PARSER_REGEXP.exec(param);\n            if (!match) {\n                throw new Error('parameters should satisfy pattern \"prefix:paramName(regexp)\\\\?:postfix\"');\n            }\n            const [, paramName, regexp, optional] = match;\n            const value = (_a = params[paramName]) === null || _a === void 0 ? void 0 : _a.toString();\n            if (optional && !value) {\n                return '';\n            }\n            if (!value) {\n                throw new Error(`value for parameter for ${paramName} should be defined in params`);\n            }\n            if (regexp && !new RegExp(regexp).test(value)) {\n                throw new Error(`passed parameter for ${paramName} should satisfy regxep: ${regexp}, got: ${value}`);\n            }\n            return prefix + value + postfix || part;\n        }\n        return part;\n    }, parts).join('/');\n    return normalizeTrailingSlash(`/${result}`, pathname.endsWith('/'));\n};\n\n// eslint-disable-next-line import/no-mutable-exports\nlet logger = {\n    trace: noop,\n    debug: noop,\n    info: noop,\n    warn: noop,\n    error: noop,\n};\nconst setLogger = (newLogger) => {\n    logger = newLogger;\n};\n\nclass AbstractRouter {\n    constructor({ trailingSlash, mergeSlashes, beforeResolve = [], beforeNavigate = [], afterNavigate = [], beforeUpdateCurrent = [], afterUpdateCurrent = [], guards = [], onChange = [], onRedirect, onNotFound, onBlock, }) {\n        this.started = false;\n        this.trailingSlash = false;\n        this.strictTrailingSlash = true;\n        this.mergeSlashes = false;\n        this.trailingSlash = trailingSlash !== null && trailingSlash !== void 0 ? trailingSlash : false;\n        this.strictTrailingSlash = typeof trailingSlash === 'undefined';\n        this.mergeSlashes = mergeSlashes !== null && mergeSlashes !== void 0 ? mergeSlashes : false;\n        this.hooks = new Map([\n            ['beforeResolve', new Set(beforeResolve)],\n            ['beforeNavigate', new Set(beforeNavigate)],\n            ['afterNavigate', new Set(afterNavigate)],\n            ['beforeUpdateCurrent', new Set(beforeUpdateCurrent)],\n            ['afterUpdateCurrent', new Set(afterUpdateCurrent)],\n        ]);\n        this.guards = new Set(guards);\n        this.syncHooks = new Map([['change', new Set(onChange)]]);\n        this.onRedirect = onRedirect;\n        this.onNotFound = onNotFound;\n        this.onBlock = onBlock;\n    }\n    // start is using as marker that any preparation for proper work has done in the app\n    // and now router can manage any navigations\n    async start() {\n        logger.debug({\n            event: 'start',\n        });\n        this.started = true;\n    }\n    getCurrentRoute() {\n        var _a, _b, _c;\n        // when something will try to get currentRoute while navigating, it will get route which router currently navigating\n        // in case some handler supposed to load data of route or similar\n        return (_b = (_a = this.currentNavigation) === null || _a === void 0 ? void 0 : _a.to) !== null && _b !== void 0 ? _b : (_c = this.lastNavigation) === null || _c === void 0 ? void 0 : _c.to;\n    }\n    getCurrentUrl() {\n        var _a, _b, _c;\n        // same as getCurrentRoute\n        return (_b = (_a = this.currentNavigation) === null || _a === void 0 ? void 0 : _a.url) !== null && _b !== void 0 ? _b : (_c = this.lastNavigation) === null || _c === void 0 ? void 0 : _c.url;\n    }\n    getLastRoute() {\n        var _a;\n        return (_a = this.lastNavigation) === null || _a === void 0 ? void 0 : _a.to;\n    }\n    getLastUrl() {\n        var _a;\n        return (_a = this.lastNavigation) === null || _a === void 0 ? void 0 : _a.url;\n    }\n    commitNavigation(navigation) {\n        logger.debug({\n            event: 'commit-navigation',\n            navigation,\n        });\n        if (!navigation.history) {\n            // in case we came from history do not history back to prevent infinity recursive calls\n            this.history.save(navigation);\n        }\n        this.lastNavigation = navigation;\n        this.currentNavigation = null;\n        this.runSyncHooks('change', navigation);\n    }\n    async updateCurrentRoute(updateRouteOptions) {\n        return this.internalUpdateCurrentRoute(updateRouteOptions, {});\n    }\n    async internalUpdateCurrentRoute(updateRouteOptions, { history }) {\n        var _a;\n        const prevNavigation = (_a = this.currentNavigation) !== null && _a !== void 0 ? _a : this.lastNavigation;\n        if (!prevNavigation) {\n            throw new Error('updateCurrentRoute should only be called after navigate to some route');\n        }\n        const { replace, params, navigateState } = updateRouteOptions;\n        const { to: from, url: fromUrl } = prevNavigation;\n        const navigation = {\n            type: 'updateCurrentRoute',\n            from,\n            to: this.resolveRoute({ params, navigateState }, { wildcard: true }),\n            url: this.resolveUrl(updateRouteOptions),\n            fromUrl,\n            replace,\n            history,\n            navigateState,\n            code: updateRouteOptions.code,\n        };\n        logger.debug({\n            event: 'update-current-route',\n            updateRouteOptions,\n            navigation,\n        });\n        await this.run(navigation);\n    }\n    async runUpdateCurrentRoute(navigation) {\n        await this.runHooks('beforeUpdateCurrent', navigation);\n        this.commitNavigation(navigation);\n        await this.runHooks('afterUpdateCurrent', navigation);\n    }\n    async navigate(navigateOptions) {\n        return this.internalNavigate(makeNavigateOptions(navigateOptions), {});\n    }\n    async internalNavigate(navigateOptions, { history, redirect }) {\n        var _a;\n        const { url, replace, params, navigateState, code } = navigateOptions;\n        const prevNavigation = redirect\n            ? this.lastNavigation\n            : (_a = this.currentNavigation) !== null && _a !== void 0 ? _a : this.lastNavigation;\n        if (!url && !prevNavigation) {\n            throw new Error('Navigate url should be specified and cannot be omitted for first navigation');\n        }\n        const resolvedUrl = this.resolveUrl(navigateOptions);\n        const { to: from, url: fromUrl } = prevNavigation !== null && prevNavigation !== void 0 ? prevNavigation : {};\n        const redirectFrom = redirect ? this.currentNavigation.to : undefined;\n        let navigation = {\n            type: 'navigate',\n            from,\n            url: resolvedUrl,\n            fromUrl,\n            replace,\n            history,\n            navigateState,\n            code,\n            redirect,\n            redirectFrom,\n        };\n        await this.runHooks('beforeResolve', navigation);\n        const to = this.resolveRoute({ url: resolvedUrl, params, navigateState }, { wildcard: true });\n        if (to) {\n            navigation = {\n                ...navigation,\n                to,\n            };\n        }\n        logger.debug({\n            event: 'navigation',\n            navigation,\n        });\n        if (!navigation.to) {\n            return this.notfound(navigation);\n        }\n        await this.run(navigation);\n    }\n    async runNavigate(navigation) {\n        // check for redirect in new route description\n        if (navigation.to.redirect) {\n            return this.redirect(navigation, makeNavigateOptions(navigation.to.redirect));\n        }\n        await this.runGuards(navigation);\n        await this.runHooks('beforeNavigate', navigation);\n        this.commitNavigation(navigation);\n        await this.runHooks('afterNavigate', navigation);\n    }\n    async run(navigation) {\n        this.currentNavigation = navigation;\n        if (navigation.type === 'navigate') {\n            await this.runNavigate(navigation);\n        }\n        if (navigation.type === 'updateCurrentRoute') {\n            await this.runUpdateCurrentRoute(navigation);\n        }\n    }\n    resolve(resolveOptions, options) {\n        const opts = typeof resolveOptions === 'string' ? { url: resolveOptions } : resolveOptions;\n        return this.resolveRoute({ ...opts, url: parse$1(opts.url) }, options);\n    }\n    back(options) {\n        return this.go(-1, options);\n    }\n    forward() {\n        return this.go(1);\n    }\n    async go(to, options) {\n        logger.debug({\n            event: 'history.go',\n            to,\n        });\n        return this.history.go(to, options);\n    }\n    isNavigating() {\n        return !!this.currentNavigation;\n    }\n    async dehydrate() {\n        throw new Error('Not implemented');\n    }\n    async rehydrate(navigation) {\n        throw new Error('Not implemented');\n    }\n    addRoute(route) {\n        var _a;\n        (_a = this.tree) === null || _a === void 0 ? void 0 : _a.addRoute(route);\n    }\n    async redirect(navigation, target) {\n        var _a;\n        logger.debug({\n            event: 'redirect',\n            navigation,\n            target,\n        });\n        return (_a = this.onRedirect) === null || _a === void 0 ? void 0 : _a.call(this, {\n            ...navigation,\n            from: navigation.to,\n            fromUrl: navigation.url,\n            to: null,\n            url: this.resolveUrl(target),\n        });\n    }\n    async notfound(navigation) {\n        var _a;\n        logger.debug({\n            event: 'not-found',\n            navigation,\n        });\n        return (_a = this.onNotFound) === null || _a === void 0 ? void 0 : _a.call(this, navigation);\n    }\n    async block(navigation) {\n        logger.debug({\n            event: 'blocked',\n            navigation,\n        });\n        this.currentNavigation = null;\n        if (this.onBlock) {\n            return this.onBlock(navigation);\n        }\n        throw new Error('Navigation blocked');\n    }\n    normalizePathname(pathname) {\n        let normalized = pathname;\n        if (this.mergeSlashes) {\n            normalized = normalizeManySlashes(normalized);\n        }\n        if (!this.strictTrailingSlash) {\n            normalized = normalizeTrailingSlash(normalized, this.trailingSlash);\n        }\n        return normalized;\n    }\n    resolveUrl({ url, query = {}, params, preserveQuery, hash }) {\n        var _a;\n        const currentRoute = this.getCurrentRoute();\n        const currentUrl = this.getCurrentUrl();\n        const resultUrl = url ? rawResolveUrl((_a = currentUrl === null || currentUrl === void 0 ? void 0 : currentUrl.href) !== null && _a !== void 0 ? _a : '', url) : rawParse(currentUrl.href);\n        let { pathname } = resultUrl;\n        if (params) {\n            if (url) {\n                pathname = makePath(resultUrl.pathname, params);\n            }\n            else if (currentRoute) {\n                pathname = makePath(currentRoute.path, { ...currentRoute.params, ...params });\n            }\n        }\n        if (isSameHost(resultUrl)) {\n            pathname = this.normalizePathname(pathname);\n        }\n        return convertRawUrl(rawAssignUrl(resultUrl, {\n            pathname,\n            search: url ? resultUrl.search : '',\n            query: {\n                ...(preserveQuery ? this.getCurrentUrl().query : {}),\n                ...query,\n            },\n            hash: hash !== null && hash !== void 0 ? hash : resultUrl.hash,\n        }));\n    }\n    resolveRoute({ url, params, navigateState }, { wildcard } = {}) {\n        var _a, _b;\n        let route = url ? (_a = this.tree) === null || _a === void 0 ? void 0 : _a.getRoute(url.pathname) : this.getCurrentRoute();\n        if (wildcard && !route && url) {\n            // if ordinary route not found look for a wildcard route\n            route = (_b = this.tree) === null || _b === void 0 ? void 0 : _b.getWildcard(url.pathname);\n        }\n        if (!route) {\n            return;\n        }\n        // if condition is true route data not changed, so no need to create new reference for route object\n        if (!params && navigateState === route.navigateState) {\n            return route;\n        }\n        return {\n            ...route,\n            params: { ...route.params, ...params },\n            navigateState,\n        };\n    }\n    async runGuards(navigation) {\n        logger.debug({\n            event: 'guards.run',\n            navigation,\n        });\n        if (!this.guards) {\n            logger.debug({\n                event: 'guards.empty',\n                navigation,\n            });\n            return;\n        }\n        const results = await Promise.all(Array.from(this.guards).map((guard) => Promise.resolve(guard(navigation)).catch((error) => {\n            logger.warn({\n                event: 'guard.error',\n                error,\n            });\n        })));\n        logger.debug({\n            event: 'guards.done',\n            navigation,\n            results,\n        });\n        for (const result of results) {\n            if (result === false) {\n                return this.block(navigation);\n            }\n            if (isString(result) || isObject(result)) {\n                return this.redirect(navigation, makeNavigateOptions(result));\n            }\n        }\n    }\n    registerGuard(guard) {\n        return registerHook(this.guards, guard);\n    }\n    runSyncHooks(hookName, navigation) {\n        logger.debug({\n            event: 'sync-hooks.run',\n            hookName,\n            navigation,\n        });\n        const hooks = this.syncHooks.get(hookName);\n        if (!hooks) {\n            logger.debug({\n                event: 'sync-hooks.empty',\n                hookName,\n                navigation,\n            });\n            return;\n        }\n        for (const hook of hooks) {\n            try {\n                hook(navigation);\n            }\n            catch (error) {\n                logger.warn({\n                    event: 'sync-hooks.error',\n                    error,\n                });\n            }\n        }\n        logger.debug({\n            event: 'sync-hooks.done',\n            hookName,\n            navigation,\n        });\n    }\n    registerSyncHook(hookName, hook) {\n        return registerHook(this.syncHooks.get(hookName), hook);\n    }\n    async runHooks(hookName, navigation) {\n        logger.debug({\n            event: 'hooks.run',\n            hookName,\n            navigation,\n        });\n        const hooks = this.hooks.get(hookName);\n        if (!hooks) {\n            logger.debug({\n                event: 'hooks.empty',\n                hookName,\n                navigation,\n            });\n            return;\n        }\n        await Promise.all(Array.from(hooks).map((hook) => Promise.resolve(hook(navigation)).catch((error) => {\n            logger.warn({\n                event: 'hook.error',\n                error,\n            });\n            // rethrow error for beforeResolve to prevent showing not found page\n            // if app has problems while loading info about routes\n            if (hookName === 'beforeResolve') {\n                throw error;\n            }\n        })));\n        logger.debug({\n            event: 'hooks.done',\n            hookName,\n            navigation,\n        });\n    }\n    registerHook(hookName, hook) {\n        return registerHook(this.hooks.get(hookName), hook);\n    }\n}\n\nclass History {\n    init(navigation) { }\n    listen(listener) {\n        this.listener = listener;\n    }\n    setTree(tree) {\n        this.tree = tree;\n    }\n}\n\nconst supportsHtml5History = typeof window !== 'undefined' && window.history && window.history.pushState;\nconst wrapHistory = ({ onNavigate }) => {\n    if (!supportsHtml5History) {\n        const navigate = (data, title, url) => {\n            window.location.href = url.toString();\n        };\n        window.history.pushState = navigate;\n        window.history.replaceState = navigate;\n        return {\n            navigate: ({ path }) => navigate({}, '', path),\n            history: () => {\n                throw new Error('Method not implemented');\n            },\n            init: noop,\n            subscribe: noop,\n        };\n    }\n    let browserHistory = window.history;\n    if ('__originalHistory' in window.history) {\n        browserHistory = window.history.__originalHistory;\n    }\n    else {\n        window.history.__originalHistory = {\n            pushState: browserHistory.pushState.bind(window.history),\n            replaceState: browserHistory.replaceState.bind(window.history),\n            go: browserHistory.go.bind(window.history),\n        };\n    }\n    const pushState = browserHistory.pushState.bind(window.history);\n    const replaceState = browserHistory.replaceState.bind(window.history);\n    const go = browserHistory.go.bind(window.history);\n    const navigate = ({ path, replace, state }) => {\n        if (replace) {\n            replaceState(state, '', path);\n        }\n        else {\n            pushState(state, '', path);\n        }\n    };\n    const history = (delta) => {\n        go(delta);\n    };\n    const browserNavigate = (replace = false) => {\n        return (navigateState, title, url) => {\n            onNavigate({ url: url.toString(), replace, navigateState });\n        };\n    };\n    window.history.pushState = browserNavigate(false);\n    window.history.replaceState = browserNavigate(true);\n    window.history.go = history;\n    window.history.back = () => history(-1);\n    window.history.forward = () => history(1);\n    return {\n        navigate,\n        history,\n        init: (state) => {\n            replaceState(state, '');\n        },\n        subscribe: (handler) => {\n            window.addEventListener('popstate', ({ state }) => {\n                handler({\n                    path: window.location.pathname + window.location.search + window.location.hash,\n                    state,\n                });\n            });\n        },\n    };\n};\n\nconst isHistoryState = (state) => {\n    return state && typeof state.key === 'string';\n};\nconst generateKey = (navigation) => {\n    const { to } = navigation;\n    if (to) {\n        return `${to.name}_${to.path}`;\n    }\n};\nconst generateState = (navigation, currentState) => {\n    const key = generateKey(navigation);\n    let { type } = navigation;\n    if (navigation.replace && currentState) {\n        type = currentState.type === type ? type : 'navigate';\n    }\n    return {\n        key,\n        type,\n        navigateState: navigation.navigateState,\n    };\n};\nclass ClientHistory extends History {\n    constructor() {\n        super();\n        this.currentIndex = 0;\n        this.historyWrapper = wrapHistory({\n            onNavigate: ({ url, replace, navigateState }) => {\n                this.listener({\n                    url,\n                    replace,\n                    navigateState,\n                });\n            },\n        });\n    }\n    init(navigation) {\n        var _a;\n        this.currentState = isHistoryState((_a = window.history) === null || _a === void 0 ? void 0 : _a.state)\n            ? window.history.state\n            : generateState(navigation);\n        this.historyWrapper.init(this.currentState);\n        this.historyWrapper.subscribe(async ({ path, state }) => {\n            var _a, _b;\n            try {\n                let navigationType;\n                let navigateState;\n                if (isHistoryState(state)) {\n                    const { key: prevKey, type: prevType } = this.currentState;\n                    const { key, type } = state;\n                    this.currentState = state;\n                    navigateState = state.navigateState;\n                    if (key === prevKey &&\n                        (type === 'updateCurrentRoute' || prevType === 'updateCurrentRoute')) {\n                        navigationType = 'updateCurrentRoute';\n                    }\n                    else {\n                        navigationType = 'navigate';\n                    }\n                }\n                else {\n                    // if it is not HistoryState than it is probably not a state from @tinkoff/router so reset it\n                    this.currentIndex = 0;\n                }\n                await this.listener({\n                    type: navigationType,\n                    history: true,\n                    url: path,\n                    navigateState,\n                });\n                (_a = this.goPromiseResolve) === null || _a === void 0 ? void 0 : _a.call(this);\n            }\n            catch (err) {\n                (_b = this.goPromiseReject) === null || _b === void 0 ? void 0 : _b.call(this, err);\n            }\n        });\n    }\n    save(navigation) {\n        const { replace, url } = navigation;\n        if (!replace) {\n            this.currentIndex++;\n        }\n        this.currentState = generateState(navigation, this.currentState);\n        this.historyWrapper.navigate({\n            path: url.path,\n            replace,\n            state: this.currentState,\n        });\n    }\n    go(to, options) {\n        var _a;\n        const index = this.currentIndex + to;\n        if (index < 0) {\n            if (options === null || options === void 0 ? void 0 : options.historyFallback) {\n                return this.listener({\n                    url: options.historyFallback,\n                    type: 'navigate',\n                    history: false,\n                });\n            }\n            const historyFallbackRoute = (_a = this.tree) === null || _a === void 0 ? void 0 : _a.getHistoryFallback(window.location.pathname);\n            if (historyFallbackRoute) {\n                return this.listener({\n                    url: historyFallbackRoute.actualPath,\n                    type: 'navigate',\n                    history: false,\n                });\n            }\n        }\n        const promise = new Promise((resolve, reject) => {\n            this.goPromiseResolve = resolve;\n            this.goPromiseReject = reject;\n        });\n        this.historyWrapper.history(to);\n        return promise;\n    }\n}\n\nclass ClientRouter extends AbstractRouter {\n    constructor(options) {\n        super(options);\n        this.history = new ClientHistory();\n        this.history.listen(async ({ type, url, navigateState, replace, history }) => {\n            var _a;\n            const currentUrl = this.getCurrentUrl();\n            const { pathname, query } = this.resolveUrl({ url });\n            const isSameUrlNavigation = currentUrl.pathname === pathname;\n            if (type === 'updateCurrentRoute' || (!type && isSameUrlNavigation)) {\n                const route = (_a = this.tree) === null || _a === void 0 ? void 0 : _a.getRoute(pathname);\n                await this.internalUpdateCurrentRoute({\n                    params: route === null || route === void 0 ? void 0 : route.params,\n                    query,\n                    replace,\n                    navigateState,\n                }, { history });\n            }\n            else {\n                await this.internalNavigate({\n                    url,\n                    replace,\n                    navigateState,\n                }, { history });\n            }\n        });\n    }\n    async rehydrate(navigation) {\n        logger.debug({\n            event: 'rehydrate',\n            navigation,\n        });\n        const url = parse$1(window.location.href);\n        this.currentNavigation = {\n            ...navigation,\n            type: 'navigate',\n            url,\n        };\n        this.lastNavigation = this.currentNavigation;\n        // rerun guard check in case it differs from server side\n        await this.runGuards(this.currentNavigation);\n        // and init any history listeners\n        this.history.init(this.currentNavigation);\n        this.currentNavigation = null;\n        // add dehydrated route to tree to prevent its loading\n        if (navigation.to) {\n            this.addRoute({\n                name: navigation.to.name,\n                path: navigation.to.path,\n                config: navigation.to.config,\n                // in case we have loaded page from some path-changing proxy\n                // save this actual path as alias\n                alias: url.pathname,\n            });\n        }\n    }\n    resolveRoute(...options) {\n        const { url } = options[0];\n        // navigation for other hosts should be considered as external navigation\n        if (url && !isSameHost(url)) {\n            return;\n        }\n        return super.resolveRoute(...options);\n    }\n    async notfound(navigation) {\n        var _a, _b;\n        await super.notfound(navigation);\n        // in case we didn't find any matched route just force hard page navigation\n        const prevUrl = (_b = (_a = navigation.fromUrl) === null || _a === void 0 ? void 0 : _a.href) !== null && _b !== void 0 ? _b : window.location.href;\n        const nextUrl = navigation.url.href;\n        const isNoSpaNavigation = navigation.from && !navigation.to;\n        // prevent redirect cycle on the same page,\n        // except cases when we run no-spa navigations,\n        // because we need hard reload in this cases\n        if (isNoSpaNavigation ? true : prevUrl !== nextUrl) {\n            if (navigation.replace) {\n                window.location.replace(nextUrl);\n            }\n            else {\n                window.location.assign(nextUrl);\n            }\n        }\n        // prevent routing from any continues navigation returning promise which will be not resolved\n        return new Promise(() => { });\n    }\n    async block(navigation) {\n        return this.notfound(navigation);\n    }\n    async redirect(navigation, target) {\n        await super.redirect(navigation, target);\n        return this.internalNavigate({\n            ...target,\n            replace: target.replace || navigation.replace,\n        }, {\n            redirect: true,\n        });\n    }\n}\n\nconst createTree = (route) => {\n    return {\n        route,\n        children: Object.create(null),\n        parameters: [],\n    };\n};\nconst createNavigationRoute = (route, pathname, params) => {\n    return {\n        ...route,\n        actualPath: pathname,\n        params: params !== null && params !== void 0 ? params : {},\n    };\n};\nclass RouteTree {\n    constructor(routes) {\n        this.tree = createTree();\n        each((route) => this.addRoute(route), routes);\n    }\n    // eslint-disable-next-line max-statements\n    addRoute(route) {\n        const parts = getParts(route.path);\n        let currentTree = this.tree;\n        for (let i = 0; i < parts.length; i++) {\n            const part = parts[i];\n            const parsed = parse(part);\n            if (parsed.type === 1 /* PartType.historyFallback */) {\n                currentTree.historyFallbackRoute = route;\n                return;\n            }\n            if (parsed.type === 2 /* PartType.wildcard */) {\n                currentTree.wildcardRoute = route;\n                return;\n            }\n            if (parsed.type === 3 /* PartType.parameter */) {\n                const { paramName, regexp, optional } = parsed;\n                // prevent from creating new entries for same route\n                const found = find((par) => par.key === part, currentTree.parameters);\n                if (found) {\n                    currentTree = found.tree;\n                }\n                else {\n                    const parameter = {\n                        key: part,\n                        paramName,\n                        regexp,\n                        optional,\n                        tree: createTree(),\n                    };\n                    if (regexp && !optional) {\n                        // insert parameters with regexp before\n                        const index = findIndex((par) => !par.regexp, currentTree.parameters);\n                        currentTree.parameters.splice(index, 0, parameter);\n                    }\n                    else {\n                        currentTree.parameters.push(parameter);\n                    }\n                    currentTree = parameter.tree;\n                }\n            }\n            else {\n                if (!currentTree.children[part]) {\n                    currentTree.children[part] = createTree();\n                }\n                currentTree = currentTree.children[part];\n            }\n        }\n        currentTree.route = route;\n    }\n    getRoute(pathname) {\n        return this.findRoute(pathname, 'route');\n    }\n    getWildcard(pathname) {\n        return this.findRoute(pathname, 'wildcardRoute');\n    }\n    getHistoryFallback(pathname) {\n        const route = this.findRoute(pathname, 'historyFallbackRoute');\n        return (route && {\n            ...route,\n            // remove <history-fallback> from path\n            actualPath: route.path.replace(HISTORY_FALLBACK_REGEXP, '') || '/',\n        });\n    }\n    // eslint-disable-next-line max-statements\n    findRoute(pathname, propertyName) {\n        // we should use exact match only for classic route\n        // as special routes (for not-found and history-fallback) are defined for whole subtree\n        const exactMatch = propertyName === 'route';\n        const parts = getParts(pathname);\n        const queue = [\n            [this.tree, 0],\n        ];\n        while (queue.length) {\n            const [currentTree, index, params] = queue.pop();\n            const { children, parameters } = currentTree;\n            // this flag mean we can only check for optional parameters\n            // as we didn't find static route for this path, but still may find\n            // some inner route inside optional branch\n            // the value of parameter will be empty in this case ofc\n            let optionalOnly = false;\n            if (index >= parts.length) {\n                if (currentTree[propertyName]) {\n                    return createNavigationRoute(currentTree[propertyName], pathname, params);\n                }\n                // here we cant check any options except for optional parameters\n                optionalOnly = true;\n            }\n            // first add to queue special routes (not-found or history-fallback) to check it after other cases, as it will be processed last\n            if (!exactMatch && currentTree[propertyName]) {\n                queue.push([currentTree, parts.length, params]);\n            }\n            const part = parts[index];\n            const child = children[part];\n            // then add checks for only optional\n            for (const param of parameters) {\n                const { optional, tree } = param;\n                if (optional) {\n                    queue.push([tree, index, params]);\n                }\n            }\n            if (optionalOnly) {\n                continue;\n            }\n            // for non-optional cases\n            for (let i = parameters.length - 1; i >= 0; i--) {\n                const param = parameters[i];\n                const { paramName, tree, regexp } = param;\n                const match = regexp === null || regexp === void 0 ? void 0 : regexp.exec(part);\n                const paramValue = regexp ? match === null || match === void 0 ? void 0 : match[1] : part;\n                if (paramValue) {\n                    queue.push([tree, index + 1, { ...params, [paramName]: paramValue }]);\n                }\n            }\n            if (child) {\n                // add checks for static child subtree last as it will be processed first after queue.pop\n                queue.push([child, index + 1, params]);\n            }\n        }\n    }\n}\n\nconst DELAY_CHECK_INTERVAL = 50;\nclass Router extends ClientRouter {\n    constructor(options) {\n        super(options);\n        this.tree = new RouteTree(options.routes);\n        this.history.setTree(this.tree);\n    }\n    async rehydrate(navigation) {\n        return this.resolveIfDelayFound(super.rehydrate(navigation));\n    }\n    async start() {\n        await super.start();\n        if (this.delayedNavigation) {\n            const { delayedNavigation } = this;\n            this.delayedNavigation = null;\n            return this.flattenDelayedNavigation(delayedNavigation);\n        }\n    }\n    async run(navigation) {\n        // if router is not started yet delay current navigation without blocking promise resolving\n        if (!this.started) {\n            this.delayNavigation(navigation);\n            return;\n        }\n        // if we have already running navigation delay current one and call it later\n        if (this.currentNavigation) {\n            return this.delayNavigation(navigation);\n        }\n        // ignore previous navigations that were put in delayedNavigation as we have more fresh navigation to execute\n        if (this.delayedNavigation) {\n            logger.info({\n                event: 'delay-navigation-drop',\n                delayedNavigation: this.delayedNavigation,\n                navigation,\n            });\n            this.delayedNavigation = null;\n        }\n        return this.flattenDelayedNavigation(navigation);\n    }\n    delayNavigation(navigation) {\n        this.delayedNavigation = navigation;\n        logger.info({\n            event: 'delay-navigation',\n            navigation,\n        });\n        if (this.delayedPromise) {\n            return this.delayedPromise;\n        }\n        // resolve promise only after latest navigation has been executed\n        this.delayedPromise = new Promise((resolve, reject) => {\n            this.delayedResolve = resolve;\n            this.delayedReject = reject;\n        });\n        return this.delayedPromise;\n    }\n    commitNavigation(navigation) {\n        // if we have parallel navigation do not update current url, as it outdated anyway\n        if (navigation.cancelled) {\n            logger.debug({\n                event: 'delay-ignore-commit',\n                navigation,\n            });\n            return;\n        }\n        return super.commitNavigation(navigation);\n    }\n    async runGuards(navigation) {\n        // drop checking guards if we have delayed navigation\n        if (navigation.cancelled) {\n            logger.debug({\n                event: 'delay-ignore-guards',\n                navigation,\n            });\n            return;\n        }\n        return super.runGuards(navigation);\n    }\n    async runHooks(hookName, navigation) {\n        // drop hook calls if we have an other navigation delayed\n        // except only for case when current navigation already happened\n        // and we should synchronize this update with app\n        // (in case app has some logic for currently showing url on afterNavigate or afterRouteUpdate)\n        if (navigation.cancelled && this.lastNavigation !== navigation) {\n            logger.debug({\n                event: 'delay-ignore-hooks',\n                navigation,\n            });\n            return;\n        }\n        try {\n            await super.runHooks(hookName, navigation);\n        }\n        catch (error) {\n            return this.notfound(navigation);\n        }\n    }\n    async resolveIfDelayFound(task) {\n        let delayResolve;\n        const timer = setInterval(() => {\n            var _a;\n            if (this.delayedNavigation) {\n                if (this.delayedNavigation.type === 'navigate' ||\n                    this.delayedNavigation.type === ((_a = this.currentNavigation) === null || _a === void 0 ? void 0 : _a.type)) {\n                    logger.info({\n                        event: 'delay-navigation-found',\n                        navigation: this.delayedNavigation,\n                    });\n                    // set cancelled flag\n                    if (this.currentNavigation) {\n                        this.currentNavigation.cancelled = true;\n                        this.currentNavigation = null;\n                    }\n                    // resolve current navigation to start new navigation asap\n                    delayResolve();\n                }\n                else {\n                    // updateCurrentRoute should happen only after currentNavigation, so resolve it first to prevent dead-lock\n                    this.delayedResolve();\n                }\n            }\n        }, DELAY_CHECK_INTERVAL);\n        await Promise.race([\n            task,\n            new Promise((resolve) => {\n                delayResolve = resolve;\n            }),\n        ]);\n        clearInterval(timer);\n        delayResolve();\n    }\n    async flattenDelayedNavigation(navigation) {\n        const flatten = async (nav) => {\n            await this.resolveIfDelayFound(super.run(nav));\n            // if new navigation has been called while this navigation lasts\n            // call new navigation execution\n            if (this.delayedNavigation) {\n                const { delayedNavigation } = this;\n                logger.info({\n                    event: 'delay-navigation-run',\n                    navigation: delayedNavigation,\n                });\n                this.delayedNavigation = null;\n                return flatten(delayedNavigation);\n            }\n        };\n        return flatten(navigation)\n            .then(() => {\n            var _a;\n            (_a = this.delayedResolve) === null || _a === void 0 ? void 0 : _a.call(this);\n        }, (err) => {\n            var _a;\n            (_a = this.delayedReject) === null || _a === void 0 ? void 0 : _a.call(this, err);\n        })\n            .finally(() => {\n            this.delayedPromise = null;\n            this.delayedResolve = null;\n            this.delayedReject = null;\n        });\n    }\n}\n\nconst omitHash = (url) => url.href.replace(/#.*$/, '');\nclass NoSpaRouter extends ClientRouter {\n    run(navigation) {\n        const { type, fromUrl, url } = navigation;\n        // support only updateCurrentRoute or hash navigations\n        if (type === 'updateCurrentRoute' || omitHash(url) === omitHash(fromUrl)) {\n            return super.run(navigation);\n        }\n        return this.notfound(navigation);\n    }\n    // do not call any hooks as it is only supports url updates with hash\n    async runHooks() { }\n}\n\nconst RouterContext = createContext(null);\nconst RouteContext = createContext(null);\nconst UrlContext = createContext(null);\n\nconst Provider = ({ router, serverState, children }) => {\n    const route = useSyncExternalStore((cb) => router.registerSyncHook('change', cb), () => router.getLastRoute(), serverState ? () => serverState.currentRoute : () => router.getLastRoute());\n    const url = useSyncExternalStore((cb) => router.registerSyncHook('change', cb), () => router.getLastUrl(), serverState ? () => serverState.currentUrl : () => router.getLastUrl());\n    return (jsx(RouterContext.Provider, { value: router, children: jsx(RouteContext.Provider, { value: route, children: jsx(UrlContext.Provider, { value: url, children: children }) }) }));\n};\nProvider.displayName = 'Provider';\n\nconst useRouter = () => {\n    return useContext(RouterContext);\n};\n\nconst useRoute = () => {\n    return useContext(RouteContext);\n};\n\nconst useUrl = () => {\n    return useContext(UrlContext);\n};\n\nconst convertToNavigateOptions = (options) => {\n    return typeof options === 'string' ? { url: options } : options;\n};\nconst useNavigate = (rootOptions) => {\n    const router = useRouter();\n    const rootOpts = useShallowEqual(convertToNavigateOptions(rootOptions));\n    return useCallback((specificOptions) => {\n        const opts = rootOpts !== null && rootOpts !== void 0 ? rootOpts : convertToNavigateOptions(specificOptions);\n        return router.navigate(opts);\n    }, [rootOpts, router]);\n};\n\nexport { AbstractRouter, History, NoSpaRouter, Provider, RouteTree, Router, getParts, isHistoryFallback, isParameterized, isWildcard, logger, makePath, parse, setLogger, useNavigate, useRoute, useRouter, useUrl };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Token to access the router instance\n */\nconst ROUTER_TOKEN = createToken('router router');\n/**\n * @description\n * Token for defining static routes\n */\nconst ROUTES_TOKEN = createToken('router routes', { multi: true });\n/**\n * @description\n * Token for providing guard handlers for page transitions\n */\nconst ROUTER_GUARD_TOKEN = createToken('router guard', { multi: true });\n/**\n * @description\n * Encapsulates the logic of working with the router - contains methods for getting the configuration of the route and performing navigation\n */\nconst PAGE_SERVICE_TOKEN = createToken('router pageService');\n/**\n * @description\n * Hook to resolve route dynamically\n */\nconst ROUTE_RESOLVE_TOKEN = createToken('router routeResolve');\n/**\n * @description\n * Hook to transform route config\n */\nconst ROUTE_TRANSFORM_TOKEN = createToken('router routeTransform', {\n    multi: true,\n});\n/**\n * @description\n * Flag for SPA-transitions, indicating that actions must be executed before or after a route update in the stor\n */\nconst ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN = createToken('router spaRunMode');\nconst LINK_PREFETCH_MANAGER_TOKEN = createToken('link prefetch manager');\n\nexport { LINK_PREFETCH_MANAGER_TOKEN, PAGE_SERVICE_TOKEN, ROUTER_GUARD_TOKEN, ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN, ROUTER_TOKEN, ROUTES_TOKEN, ROUTE_RESOLVE_TOKEN, ROUTE_TRANSFORM_TOKEN };\n","import { provide, commandLineListTokens, createToken as createToken$1, Module, DI_TOKEN, COMMAND_LINE_RUNNER_TOKEN } from '@tramvai/core';\nimport { Provider, setLogger, NoSpaRouter, Router, useNavigate, useRoute } from '@tinkoff/router';\nexport { Provider, useNavigate, useRoute, useRouter, useUrl } from '@tinkoff/router';\nimport noop from '@tinkoff/utils/function/noop';\nimport { LOGGER_TOKEN, BUNDLE_MANAGER_TOKEN, ACTION_REGISTRY_TOKEN, RESPONSE_MANAGER_TOKEN, DISPATCHER_TOKEN, DISPATCHER_CONTEXT_TOKEN, CONTEXT_TOKEN, COMPONENT_REGISTRY_TOKEN, COMBINE_REDUCERS, STORE_TOKEN, ACTION_PAGE_RUNNER_TOKEN } from '@tramvai/tokens-common';\nimport { ROUTER_GUARD_TOKEN, PAGE_SERVICE_TOKEN, ROUTE_TRANSFORM_TOKEN, ROUTER_TOKEN, ROUTES_TOKEN, ROUTE_RESOLVE_TOKEN, ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN, LINK_PREFETCH_MANAGER_TOKEN } from '@tramvai/tokens-router';\nexport * from '@tramvai/tokens-router';\nimport { EXTEND_RENDER, TRAMVAI_RENDER_MODE } from '@tramvai/tokens-render';\nimport { createEvent, createReducer } from '@tramvai/state';\nimport flatten from '@tinkoff/utils/array/flatten';\nimport { createToken, optional } from '@tinkoff/dippy';\nimport isArray from '@tinkoff/utils/is/array';\nimport { resolveLazyComponent, useDi } from '@tramvai/react';\nimport identity from '@tinkoff/utils/function/identity';\nimport compose from '@tinkoff/utils/function/compose';\nimport replace from '@tinkoff/utils/string/replace';\nimport { jsx } from 'react/jsx-runtime';\nimport { isFileSystemPageComponent, fileSystemPagesEnabled, getStaticFileSystemPages, fileSystemPageToRoute } from '@tramvai/experiments';\nimport { addQuery } from '@tinkoff/url';\nimport uniq from '@tinkoff/utils/array/uniq';\nimport { isRedirectFoundError, isNotFoundError } from '@tinkoff/errors';\nimport { __decorate } from 'tslib';\nimport { CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN } from '@tramvai/tokens-child-app';\nimport { useEffect, useState, useCallback, isValidElement, cloneElement } from 'react';\n\nconst setCurrentNavigation = createEvent('SET_CURRENT_ROUTE');\nconst setUrlOnRehydrate = createEvent('SET_URL_ON_REHYDRATE');\nconst initialState = {\n    currentRoute: null,\n    previousRoute: null,\n    currentUrl: null,\n    previousUrl: null,\n};\nconst RouterStore = createReducer('router', initialState)\n    .on(setCurrentNavigation, (state, { to, from, url, fromUrl, replace }) => {\n    // TODO: убедиться что все данные нам нужны из роутинга,\n    // возможно всякие meta, content не нужны при дегидрации\n    return {\n        currentRoute: to,\n        previousRoute: replace ? state.previousRoute : from,\n        currentUrl: url,\n        previousUrl: replace ? state.previousUrl : fromUrl,\n    };\n})\n    .on(setUrlOnRehydrate, (state, url) => {\n    return {\n        ...state,\n        currentUrl: url,\n    };\n});\n\nconst routerClassToken = createToken('router routerClassToken');\nconst additionalRouterParameters = createToken('router additionalParameters');\nconst onChangeHooksToken = createToken('router onChangeHooks', {\n    multi: true,\n});\nconst beforeResolveHooksToken = createToken('router beforeResolveHooks', {\n    multi: true,\n});\nconst beforeNavigateHooksToken = createToken('router beforeNavigateHooks', {\n    multi: true,\n});\nconst afterNavigateHooksToken = createToken('router afterNavigateHooks', {\n    multi: true,\n});\nconst beforeUpdateCurrentHooksToken = createToken('router beforeUpdateCurrentHooks', { multi: true });\nconst afterUpdateCurrentHooksToken = createToken('router afterUpdateCurrentHooks', { multi: true });\nconst routeTransformToken = createToken('router finalRouteTransform');\ncreateToken('router bundleInfoAdditional');\n\nconst loadBundle = ({ bundleManager, logger, actionRegistry, responseManager, dispatcher, dispatcherContext, pageService, }) => {\n    const log = logger('route:load-bundles');\n    return async ({ to }) => {\n        var _a;\n        log.debug({\n            event: 'load-bundle',\n            route: to,\n        });\n        const { bundle, pageComponent, nestedLayoutComponent } = to.config;\n        if (!bundleManager.has(bundle, pageComponent)) {\n            log.info({\n                event: 'load-bundle-not-found',\n                bundle,\n                pageComponent,\n            });\n            // если бандл не найден, то всё ок и мы должны вернуть 404 на сервере,\n            // а на клиенте просто загрузить новую страницу\n            responseManager.setStatus(404);\n            return false;\n        }\n        // Пытаемся загрузить и в случае инициализации на клиенте, т.к.\n        // несмотря на наличие бандла в разметке, все равно мы должны дождаться\n        // его загрузки перед рендером\n        try {\n            const promises = [];\n            // for file-system pages bundle is virtual, so it will be loaded in parallel with nested layout\n            // for classic bundles, page component will be loaded after bundle loading\n            promises.push(bundleManager.get(bundle, pageComponent));\n            if (nestedLayoutComponent) {\n                promises.push(resolveLazyComponent(pageService.resolveComponentFromConfig('nestedLayout')));\n            }\n            const [resolvedBundle, resolvedLayout] = await Promise.all(promises);\n            const { components, reducers } = resolvedBundle;\n            const component = components[pageComponent];\n            // pageComponent should have required fields even if it is lazy,\n            // thanks to `git log 9466cb32bfb71ba49144ef839d3d5bce246e213c -L90,103:packages/modules/common/src/bundleManager/bundleManager.ts`\n            (_a = component === null || component === void 0 ? void 0 : component.reducers) === null || _a === void 0 ? void 0 : _a.forEach((reducer) => dispatcherContext.getStore(reducer));\n            reducers === null || reducers === void 0 ? void 0 : reducers.forEach((reducer) => dispatcherContext.getStore(reducer));\n            // @todo: reuse logic from bundleManager?\n            // register nested layout actions and reducers for current page\n            if (resolvedLayout) {\n                if ('actions' in resolvedLayout && isArray(resolvedLayout.actions)) {\n                    actionRegistry.add(pageComponent, resolvedLayout.actions);\n                }\n                if ('reducers' in resolvedLayout && isArray(resolvedLayout.reducers)) {\n                    resolvedLayout.reducers.forEach((reducer) => {\n                        dispatcher.registerStore(reducer);\n                        dispatcherContext.getStore(reducer);\n                    });\n                }\n            }\n        }\n        catch (error) {\n            log.error({\n                event: 'load-bundle-failed',\n                error,\n            });\n            // блокируем переход если не удалось загрузить бандл\n            return false;\n        }\n    };\n};\n\nconst internalError = ({ responseManager, logger, }) => {\n    const log = logger('route:guard-check-error');\n    return async () => {\n        if (responseManager.getStatus() >= 500) {\n            log.error({\n                event: 'status-is-error',\n                status: responseManager.getStatus(),\n            });\n            return false;\n        }\n    };\n};\n\nconst commonGuards = [\n    {\n        provide: ROUTER_GUARD_TOKEN,\n        multi: true,\n        useFactory: loadBundle,\n        deps: {\n            logger: LOGGER_TOKEN,\n            bundleManager: BUNDLE_MANAGER_TOKEN,\n            actionRegistry: ACTION_REGISTRY_TOKEN,\n            responseManager: RESPONSE_MANAGER_TOKEN,\n            dispatcher: DISPATCHER_TOKEN,\n            dispatcherContext: DISPATCHER_CONTEXT_TOKEN,\n            pageService: PAGE_SERVICE_TOKEN,\n        },\n    },\n    {\n        provide: ROUTER_GUARD_TOKEN,\n        multi: true,\n        useFactory: internalError,\n        deps: {\n            logger: LOGGER_TOKEN,\n            responseManager: RESPONSE_MANAGER_TOKEN,\n        },\n    },\n];\n\nconst fillRouterStore = ({ context, }) => {\n    return (navigation) => {\n        context.dispatch(setCurrentNavigation(navigation));\n    };\n};\n\nconst commonHooks = [\n    {\n        provide: onChangeHooksToken,\n        multi: true,\n        useFactory: fillRouterStore,\n        deps: {\n            context: CONTEXT_TOKEN,\n        },\n    },\n];\n\nconst routeTransform = ({ transformers, }) => {\n    if (!transformers || transformers.length === 0) {\n        return identity;\n    }\n    return compose(...flatten(transformers));\n};\n\nconst routeSetDefaults = (route) => {\n    const config = {\n        bundle: 'mainDefault',\n        pageComponent: 'pageDefault',\n        ...route.config,\n    };\n    return {\n        ...route,\n        config,\n    };\n};\n\nconst routeNormalize = (route) => {\n    return {\n        ...route,\n        path: replace(/\\/?$/, '/', route.path),\n    };\n};\n\nconst provideRouter = ({ router }) => {\n    const serverState = {\n        currentRoute: router.getCurrentRoute(),\n        currentUrl: router.getCurrentUrl(),\n    };\n    return (render) => {\n        return (jsx(Provider, { router: router, serverState: serverState, children: render }));\n    };\n};\n\nconst commonTokens = [\n    {\n        provide: routeTransformToken,\n        useFactory: routeTransform,\n        deps: {\n            transformers: {\n                token: ROUTE_TRANSFORM_TOKEN,\n                optional: true,\n            },\n        },\n    },\n    {\n        provide: ROUTE_TRANSFORM_TOKEN,\n        multi: true,\n        useValue: routeSetDefaults,\n    },\n    {\n        provide: ROUTE_TRANSFORM_TOKEN,\n        multi: true,\n        useValue: routeNormalize,\n    },\n    {\n        provide: EXTEND_RENDER,\n        multi: true,\n        useFactory: provideRouter,\n        deps: {\n            router: ROUTER_TOKEN,\n        },\n    },\n];\n\nclass PageService {\n    constructor({ router, componentRegistry }) {\n        this.router = router;\n        this.componentRegistry = componentRegistry;\n    }\n    getCurrentRoute() {\n        return this.router.getCurrentRoute();\n    }\n    getCurrentUrl() {\n        return this.router.getCurrentUrl();\n    }\n    getConfig() {\n        var _a, _b;\n        return (_b = (_a = this.getCurrentRoute()) === null || _a === void 0 ? void 0 : _a.config) !== null && _b !== void 0 ? _b : {};\n    }\n    getContent() {\n        var _a;\n        return (_a = this.getConfig().content) !== null && _a !== void 0 ? _a : {};\n    }\n    getMeta() {\n        var _a;\n        return (_a = this.getConfig().meta) !== null && _a !== void 0 ? _a : {};\n    }\n    navigate(options) {\n        return this.router.navigate(options);\n    }\n    updateCurrentRoute(options) {\n        return this.router.updateCurrentRoute(options);\n    }\n    back(options) {\n        return this.router.back(options);\n    }\n    forward() {\n        return this.router.forward();\n    }\n    go(to, options) {\n        return this.router.go(to, options);\n    }\n    addComponent(name, component) {\n        const group = this.getComponentsGroupName();\n        return this.componentRegistry.add(name, component, group);\n    }\n    getComponent(name) {\n        const group = this.getComponentsGroupName();\n        return this.componentRegistry.get(name, group);\n    }\n    resolveComponentFromConfig(property) {\n        var _a;\n        const configName = `${property}Component`;\n        const defaultComponent = `${property}Default`;\n        const componentName = (_a = this.getConfig()[configName]) !== null && _a !== void 0 ? _a : defaultComponent;\n        return this.getComponent(componentName) || this.getComponent(defaultComponent);\n    }\n    getComponentsGroupName() {\n        const { bundle, pageComponent } = this.getConfig();\n        const group = isFileSystemPageComponent(pageComponent) ? pageComponent : bundle;\n        return group;\n    }\n}\n\nconst providers$2 = [\n    fileSystemPagesEnabled() &&\n        provide({\n            provide: ROUTES_TOKEN,\n            multi: true,\n            useFactory: ({ logger }) => {\n                const log = logger('file-system-pages:route');\n                const pagesNames = Object.keys(getStaticFileSystemPages());\n                const routes = pagesNames.map(fileSystemPageToRoute);\n                log.debug({\n                    event: 'create static routes from file-system pages',\n                    routes,\n                });\n                return routes;\n            },\n            deps: {\n                logger: LOGGER_TOKEN,\n            },\n        }),\n].filter(Boolean);\n\nconst providers$1 = [\n    ...commonGuards,\n    ...commonHooks,\n    ...commonTokens,\n    ...providers$2,\n    {\n        provide: ROUTER_TOKEN,\n        useFactory: ({ RouterClass, routes, routeTransform, routeResolve, additionalParameters, }) => {\n            const router = new RouterClass({\n                ...additionalParameters,\n                trailingSlash: true,\n                mergeSlashes: true,\n                routes: flatten(routes !== null && routes !== void 0 ? routes : []).map(routeTransform),\n            });\n            if (routeResolve) {\n                router.registerHook('beforeResolve', async (navigation) => {\n                    if (!router.resolve(navigation.url.href)) {\n                        const route = await routeResolve(navigation);\n                        if (route) {\n                            router.addRoute(routeTransform(route));\n                        }\n                    }\n                });\n            }\n            return router;\n        },\n        deps: {\n            RouterClass: routerClassToken,\n            additionalParameters: {\n                token: additionalRouterParameters,\n                optional: true,\n            },\n            routes: {\n                token: ROUTES_TOKEN,\n                optional: true,\n            },\n            routeTransform: routeTransformToken,\n            routeResolve: {\n                token: ROUTE_RESOLVE_TOKEN,\n                optional: true,\n            },\n        },\n    },\n    {\n        provide: commandLineListTokens.customerStart,\n        multi: true,\n        useFactory: ({ router, guards, onChange, beforeResolve, beforeNavigate, afterNavigate, beforeUpdateCurrent, afterUpdateCurrent, }) => {\n            return function routerInit() {\n                flatten(guards !== null && guards !== void 0 ? guards : []).forEach((guard) => router.registerGuard(guard));\n                flatten(onChange !== null && onChange !== void 0 ? onChange : []).forEach((hook) => router.registerSyncHook('change', hook));\n                flatten(beforeResolve !== null && beforeResolve !== void 0 ? beforeResolve : []).forEach((hook) => router.registerHook('beforeResolve', hook));\n                flatten(beforeNavigate !== null && beforeNavigate !== void 0 ? beforeNavigate : []).forEach((hook) => router.registerHook('beforeNavigate', hook));\n                flatten(afterNavigate !== null && afterNavigate !== void 0 ? afterNavigate : []).forEach((hook) => router.registerHook('afterNavigate', hook));\n                flatten(beforeUpdateCurrent !== null && beforeUpdateCurrent !== void 0 ? beforeUpdateCurrent : []).forEach((hook) => router.registerHook('beforeUpdateCurrent', hook));\n                flatten(afterUpdateCurrent !== null && afterUpdateCurrent !== void 0 ? afterUpdateCurrent : []).forEach((hook) => router.registerHook('afterUpdateCurrent', hook));\n            };\n        },\n        deps: {\n            router: ROUTER_TOKEN,\n            guards: {\n                token: ROUTER_GUARD_TOKEN,\n                optional: true,\n            },\n            onChange: {\n                token: onChangeHooksToken,\n                optional: true,\n            },\n            beforeResolve: {\n                token: beforeResolveHooksToken,\n                optional: true,\n            },\n            beforeNavigate: {\n                token: beforeNavigateHooksToken,\n                optional: true,\n            },\n            afterNavigate: {\n                token: afterNavigateHooksToken,\n                optional: true,\n            },\n            beforeUpdateCurrent: {\n                token: beforeUpdateCurrentHooksToken,\n                optional: true,\n            },\n            afterUpdateCurrent: {\n                token: afterUpdateCurrentHooksToken,\n                optional: true,\n            },\n        },\n    },\n    {\n        provide: commandLineListTokens.init,\n        multi: true,\n        useFactory: ({ logger }) => {\n            return function routerSetLogger() {\n                setLogger(logger('route:router'));\n            };\n        },\n        deps: {\n            logger: LOGGER_TOKEN,\n        },\n    },\n    {\n        provide: ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN,\n        // TODO: пока делаем after т.к. на это рассчитывает большинство приложений и у нас пока нет механизма контроля выполнения экшенов, чтобы\n        // избежать случаев зависания перехода из-за долгих экшенов\n        // рассмотреть возможность замены после доработок экшенов\n        useValue: 'after',\n    },\n    provide({\n        provide: PAGE_SERVICE_TOKEN,\n        useClass: PageService,\n        deps: {\n            router: ROUTER_TOKEN,\n            componentRegistry: COMPONENT_REGISTRY_TOKEN,\n        },\n    }),\n    {\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: RouterStore,\n    },\n];\n\nconst PREFETCHED_LINKS_CACHE_TOKEN = createToken$1();\nconst PREFETCHED_LINKS_QUEUE_TOKEN = createToken$1();\nconst prefetchProviders = [\n    provide({\n        provide: PREFETCHED_LINKS_CACHE_TOKEN,\n        useValue: new Set(),\n    }),\n    provide({\n        provide: PREFETCHED_LINKS_QUEUE_TOKEN,\n        useFactory: () => {\n            let queue = Promise.resolve();\n            return {\n                add(run) {\n                    queue = queue.then(run);\n                    return queue;\n                },\n            };\n        },\n    }),\n    provide({\n        provide: LINK_PREFETCH_MANAGER_TOKEN,\n        useFactory: ({ router, routeTransform, routeResolve, componentRegistry, bundleManager, logger, prefetchedLinksCache, prefetchedLinksQueue, }) => {\n            const log = logger('link-prefetch-manager');\n            const prefetch = async (url) => {\n                // prefetch needed for cache assets by browser, so we want to prefetch resources for any page only once.\n                // cache will work only for SPA-router, but anyway resources loading deduplication logic already included in @loadable\n                if (prefetchedLinksCache.has(url)) {\n                    return;\n                }\n                prefetchedLinksCache.add(url);\n                log.info({ event: 'prefetch-route-init', url });\n                // first, try to find static or resolved dynamic route\n                let route = router.resolve(url);\n                // if route not found, try to resolve dynamic route,\n                // logic from `ROUTER_TOKEN` provider factory, without `router.addRoute` method call\n                if (!route && routeResolve) {\n                    // add query `prefetchRoute` to indicate to any `routeResolve` implementation\n                    // that this route request no need to be cached or have any personalization\n                    const parsedUrl = addQuery(url, { prefetchRoute: 'true' });\n                    route = await routeResolve({\n                        url: parsedUrl,\n                        type: 'navigate',\n                    });\n                    if (route) {\n                        route = routeTransform(route);\n                    }\n                }\n                if (!route) {\n                    log.info({ event: 'prefetch-route-not-found', url });\n                    return;\n                }\n                // @todo: очередь запросов!\n                // get name of everything what we need to prefetch,\n                // @loadable will load all scripts and styles for us\n                const { config: { pageComponent, bundle, nestedLayoutComponent }, } = route;\n                const promises = [];\n                // no need for bundle and page component actions amd reducers initialization,\n                // so copy only part of `modules/guards/common/loadBundle.ts` logic,\n                // all relative assets will be fetched\n                if (bundleManager.has(bundle, pageComponent)) {\n                    promises.push(bundleManager.get(bundle, pageComponent));\n                }\n                // no need for nestedLayoutComponent actions amd reducers initialization,\n                // so copy only part of `modules/guards/common/loadBundle.ts` logic,\n                // all relative assets will be fetched\n                if (nestedLayoutComponent) {\n                    promises.push(resolveLazyComponent(componentRegistry.get(nestedLayoutComponent, isFileSystemPageComponent(pageComponent) ? '__default' : bundle)));\n                }\n                await Promise.all(promises)\n                    .then(() => {\n                    log.info({ event: 'prefetch-route-success', url });\n                })\n                    .catch((error) => {\n                    log.warn({\n                        event: 'prefetch-fail',\n                        url,\n                        error,\n                    });\n                });\n            };\n            return {\n                prefetch: (url) => {\n                    // fetch assets sequentially\n                    return prefetchedLinksQueue.add(() => prefetch(url));\n                },\n            };\n        },\n        deps: {\n            router: ROUTER_TOKEN,\n            routeTransform: routeTransformToken,\n            routeResolve: {\n                token: ROUTE_RESOLVE_TOKEN,\n                optional: true,\n            },\n            componentRegistry: COMPONENT_REGISTRY_TOKEN,\n            bundleManager: BUNDLE_MANAGER_TOKEN,\n            logger: LOGGER_TOKEN,\n            prefetchedLinksCache: PREFETCHED_LINKS_CACHE_TOKEN,\n            prefetchedLinksQueue: PREFETCHED_LINKS_QUEUE_TOKEN,\n        },\n    }),\n];\n\nconst clientTokens = [...prefetchProviders];\n\nconst stopRunAtError = (error) => {\n    if (isNotFoundError(error) || isRedirectFoundError(error)) {\n        return true;\n    }\n};\nconst runActionsFactory = ({ store, router, actionRegistry, actionPageRunner, }) => {\n    return function runActions() {\n        const route = router.getCurrentRoute();\n        const { config: { bundle, pageComponent } = {} } = route;\n        if (!bundle || !pageComponent) {\n            throw new Error(`bundle and pageComponent should be defined, but got ${route}`);\n        }\n        const actions = uniq([\n            ...(actionRegistry.getGlobal() || []),\n            ...(actionRegistry.get(bundle) || []),\n            ...(actionRegistry.get(pageComponent) || []),\n        ]);\n        return actionPageRunner.runActions(actions, stopRunAtError).catch((err) => {\n            if (isRedirectFoundError(err)) {\n                return router.navigate({\n                    url: err.nextUrl,\n                    replace: true,\n                    code: err.httpStatus,\n                });\n            }\n            throw err.error || err;\n        });\n    };\n};\n\nconst providers = [\n    ...clientTokens,\n    ...providers$1,\n    provide({\n        provide: commandLineListTokens.customerStart,\n        multi: true,\n        useFactory: ({ router, store }) => {\n            return async function routerInit() {\n                const currentRoute = store.getState(RouterStore).currentRoute;\n                return router.rehydrate({\n                    to: currentRoute,\n                });\n            };\n        },\n        deps: {\n            router: ROUTER_TOKEN,\n            store: STORE_TOKEN,\n        },\n    }),\n    provide({\n        // после выполнения надо включить исполнение роутинга, чтобы регидрация рендера реакта прошла успешно\n        // после этого уже можно будет делать переходы и т.д.\n        provide: commandLineListTokens.clear,\n        multi: true,\n        useFactory: ({ router, store }) => {\n            return function routerStart() {\n                const routerState = store.getState().router;\n                if (routerState.currentUrl.href !== window.location.href) {\n                    store.dispatch(setUrlOnRehydrate(router.getCurrentUrl()));\n                }\n                return router.start();\n            };\n        },\n        deps: {\n            router: ROUTER_TOKEN,\n            store: STORE_TOKEN,\n        },\n    }),\n    provide({\n        // при первой загрузке страницы мы должны выполнить экшены уже после того произошла регидрация\n        // рендера реакта, т.к. экшены могут повлиять на рендер\n        provide: commandLineListTokens.clear,\n        multi: true,\n        useFactory: (deps) => {\n            const currentRoute = deps.store.getState(RouterStore).currentRoute;\n            // in client-side rendering mode, action will be executed on first navigation\n            if (deps.renderMode === 'client' &&\n                (!currentRoute || (currentRoute && currentRoute.actualPath !== window.location.pathname))) {\n                return noop;\n            }\n            return runActionsFactory(deps);\n        },\n        deps: {\n            store: STORE_TOKEN,\n            router: ROUTER_TOKEN,\n            actionRegistry: ACTION_REGISTRY_TOKEN,\n            actionPageRunner: ACTION_PAGE_RUNNER_TOKEN,\n            renderMode: TRAMVAI_RENDER_MODE,\n        },\n    }),\n    provide({\n        provide: commandLineListTokens.clear,\n        multi: true,\n        useFactory: ({ store, router, renderMode }) => {\n            return async function csrFirstNavigation() {\n                const currentRoute = store.getState(RouterStore).currentRoute;\n                // in client-side rendering mode, if current route inconsistent with current location,\n                // run navigation to current location.\n                if (renderMode === 'client' &&\n                    (!currentRoute || (currentRoute && currentRoute.actualPath !== window.location.pathname))) {\n                    // replace because otherwice we will push in the history the same url twice,\n                    // and history.back will return to the same url\n                    return router.navigate({ url: window.location.href, replace: true });\n                }\n            };\n        },\n        deps: {\n            store: STORE_TOKEN,\n            router: ROUTER_TOKEN,\n            renderMode: TRAMVAI_RENDER_MODE,\n        },\n    }),\n];\n\nconst generateForRoot = (mainModule) => {\n    return (routes, options = {}) => {\n        return {\n            mainModule,\n            providers: [\n                {\n                    provide: ROUTES_TOKEN,\n                    multi: true,\n                    useValue: routes,\n                },\n                options.spaActionsMode && {\n                    provide: ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN,\n                    useValue: options.spaActionsMode,\n                },\n            ].filter(Boolean),\n        };\n    };\n};\n\nvar _a$1;\nconst NoSpaRouterModule = /* @__PURE__ */ Module({\n    providers: [\n        ...providers,\n        {\n            provide: routerClassToken,\n            useValue: NoSpaRouter,\n        },\n    ],\n})((_a$1 = class NoSpaRouterModule {\n    },\n    _a$1.forRoot = generateForRoot(_a$1),\n    _a$1));\n\nconst runCommandsSpa = ({ commandLineRunner, di, }) => {\n    return async () => {\n        await commandLineRunner.run('client', 'spa', [], di);\n    };\n};\nconst runCommandsAfterSpa = ({ commandLineRunner, di, }) => {\n    return async () => {\n        await commandLineRunner.run('client', 'afterSpa', [], di);\n    };\n};\n\nconst spaHooks = [\n    {\n        provide: beforeNavigateHooksToken,\n        multi: true,\n        useFactory: runCommandsSpa,\n        deps: {\n            di: DI_TOKEN,\n            commandLineRunner: COMMAND_LINE_RUNNER_TOKEN,\n        },\n    },\n    {\n        provide: afterNavigateHooksToken,\n        multi: true,\n        useFactory: runCommandsAfterSpa,\n        deps: {\n            di: DI_TOKEN,\n            commandLineRunner: COMMAND_LINE_RUNNER_TOKEN,\n        },\n    },\n    {\n        provide: commandLineListTokens.spaTransition,\n        multi: true,\n        useFactory: ({ spaMode, ...deps }) => {\n            if (spaMode !== 'after') {\n                return runActionsFactory(deps);\n            }\n            return noop;\n        },\n        deps: {\n            store: STORE_TOKEN,\n            router: ROUTER_TOKEN,\n            actionRegistry: ACTION_REGISTRY_TOKEN,\n            actionPageRunner: ACTION_PAGE_RUNNER_TOKEN,\n            spaMode: {\n                token: ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN,\n                optional: true,\n            },\n        },\n    },\n    {\n        provide: commandLineListTokens.afterSpaTransition,\n        multi: true,\n        useFactory: ({ spaMode, ...deps }) => {\n            if (spaMode === 'after') {\n                return runActionsFactory(deps);\n            }\n            return noop;\n        },\n        deps: {\n            store: STORE_TOKEN,\n            router: ROUTER_TOKEN,\n            actionRegistry: ACTION_REGISTRY_TOKEN,\n            actionPageRunner: ACTION_PAGE_RUNNER_TOKEN,\n            spaMode: {\n                token: ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN,\n                optional: true,\n            },\n        },\n    },\n];\n\nvar _a;\nconst SpaRouterModule = /* @__PURE__ */ Module({\n    providers: [\n        ...providers,\n        ...spaHooks,\n        {\n            provide: routerClassToken,\n            useValue: Router,\n        },\n    ],\n})((_a = class SpaRouterModule {\n    },\n    _a.forRoot = generateForRoot(_a),\n    _a));\n\nlet RouterChildAppModule = class RouterChildAppModule {\n};\nRouterChildAppModule = __decorate([\n    Module({\n        providers: [\n            provide({\n                provide: EXTEND_RENDER,\n                multi: true,\n                useFactory: provideRouter,\n                deps: {\n                    router: ROUTER_TOKEN,\n                },\n            }),\n            {\n                provide: CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN,\n                multi: true,\n                useValue: RouterStore,\n            },\n        ],\n    })\n], RouterChildAppModule);\n\nconst requestIdleCallback = window.requestIdleCallback ||\n    function (callback) {\n        return window.setTimeout(callback, 1);\n    };\nconst cancelIdleCallback = window.cancelIdleCallback ||\n    function (timer) {\n        return window.clearTimeout(timer);\n    };\n\nconst isUserNetworkConditionsSuitableForPrefetch = () => {\n    var _a;\n    const { saveData, effectiveType = '' } = (_a = navigator.connection) !== null && _a !== void 0 ? _a : {};\n    return !saveData && !(effectiveType === '2g' || effectiveType === 'slow-2g');\n};\nconst usePrefetch = ({ url, target, prefetch, }) => {\n    const linkPrefetchManager = useDi(optional(LINK_PREFETCH_MANAGER_TOKEN));\n    useEffect(() => {\n        if (!target || !prefetch || !linkPrefetchManager) {\n            return;\n        }\n        let idleId = null;\n        const observer = new IntersectionObserver((entries) => {\n            entries.forEach((entry) => {\n                // when `Link` element in viewport\n                if (entry.isIntersecting && entry.intersectionRatio > 0) {\n                    // only once\n                    observer.disconnect();\n                    if (isUserNetworkConditionsSuitableForPrefetch()) {\n                        // trigger prefetching when browser is idle\n                        idleId = requestIdleCallback(() => {\n                            linkPrefetchManager.prefetch(url);\n                        });\n                    }\n                }\n            });\n        });\n        observer.observe(target);\n        return () => {\n            observer.disconnect();\n            cancelIdleCallback(idleId);\n        };\n    }, [url, target, prefetch, linkPrefetchManager]);\n};\n\nfunction Link(props) {\n    const { children, onClick, url, query, replace, target, navigateOptions, prefetch = true, ...otherProps } = props;\n    const navigate = useNavigate({ url, query, replace, ...navigateOptions });\n    const [linkElement, setLinkElement] = useState(null);\n    usePrefetch({\n        url,\n        prefetch,\n        target: linkElement,\n    });\n    const handleClick = useCallback((event) => {\n        // ignores the navigation when clicked using right mouse button or\n        // by holding a special modifier key: ctrl, command, win, alt, shift\n        if (target ||\n            event.ctrlKey ||\n            event.metaKey ||\n            event.altKey ||\n            event.shiftKey ||\n            event.button !== 0) {\n            return;\n        }\n        event.preventDefault();\n        navigate();\n        onClick && onClick(event);\n    }, [navigate, target, onClick]);\n    const extraProps = { href: url, onClick: handleClick, target };\n    if (isValidElement(children)) {\n        return cloneElement(children, {\n            // @ts-expect-error\n            ref: (element) => {\n                // @ts-expect-error\n                const { ref } = children;\n                // preserve original ref\n                if (typeof ref === 'function') {\n                    ref(element);\n                }\n                else if (typeof ref === 'object' && ref !== null) {\n                    ref.current = element;\n                }\n                setLinkElement(element);\n            },\n            ...extraProps,\n        });\n    }\n    return (\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    jsx(\"a\", { ref: (element) => setLinkElement(element), ...otherProps, ...extraProps, children: children }));\n}\nLink.displayName = 'Link';\n\nconst usePageService = () => {\n    useRoute();\n    return useDi(PAGE_SERVICE_TOKEN);\n};\n\nexport { Link, NoSpaRouterModule, RouterChildAppModule, RouterStore, SpaRouterModule, generateForRoot, setCurrentNavigation, setUrlOnRehydrate, usePageService };\n","import { jsxs, jsx } from 'react/jsx-runtime';\nimport flatten from '@tinkoff/utils/array/flatten';\n\nconst toArray = (arr) => (Array.isArray(arr) ? arr : [arr]);\nconst composeComponent = (Component, wrappers) => {\n    return toArray(wrappers !== null && wrappers !== void 0 ? wrappers : []).reduce((Wrapped, wrapper) => wrapper(Wrapped), Component);\n};\nconst composeLayoutOptions = (list) => {\n    return flatten(list !== null && list !== void 0 ? list : []).reduce((acc, item) => {\n        const { components, wrappers } = acc;\n        if (item.components) {\n            Object.assign(components, item.components);\n        }\n        if (item.wrappers) {\n            Object.keys(item.wrappers).forEach((component) => {\n                if (!wrappers[component]) {\n                    wrappers[component] = [];\n                }\n                wrappers[component].push(...toArray(item.wrappers[component]));\n            });\n        }\n        return acc;\n    }, {\n        components: {},\n        wrappers: {},\n    });\n};\n\nconst RenderChildren = ({ children }) => children;\nconst RenderProp = ({ children, ...props }) => children(props);\nconst createLayout = ({ components = {}, wrappers = {} } = {}) => {\n    const { header: BaseHeader = RenderProp, footer: BaseFooter = RenderProp, layout: BaseLayout = RenderChildren, content: BaseContent = RenderChildren, page: BasePage = RenderChildren, ...globalComponents } = components;\n    const LayoutWrapper = composeComponent(BaseLayout, wrappers.layout);\n    const ContentWrapper = composeComponent(BaseContent, wrappers.content);\n    const PageWrapper = composeComponent(BasePage, wrappers.page);\n    const HeaderWrapper = composeComponent(BaseHeader, wrappers.header);\n    const FooterWrapper = composeComponent(BaseFooter, wrappers.footer);\n    const componentsList = Object.keys(globalComponents).map((name) => {\n        const Component = composeComponent(globalComponents[name], wrappers[name]);\n        return { name, Component };\n    });\n    const Layout = ({ children, Header, Footer }) => {\n        return (jsxs(LayoutWrapper, { children: [componentsList.map(({ Component, name }) => (jsx(Component, {}, name))), jsxs(ContentWrapper, { children: [Header ? jsx(HeaderWrapper, { children: (props) => jsx(Header, { ...props }) }) : null, jsx(PageWrapper, { children: children }), Footer ? jsx(FooterWrapper, { children: (props) => jsx(Footer, { ...props }) }) : null] })] }));\n    };\n    Layout.displayName = 'Layout';\n    return Layout;\n};\n\nexport { composeLayoutOptions, createLayout };\n","import { __decorate } from 'tslib';\nimport { Module, provide, commandLineListTokens, DI_TOKEN } from '@tramvai/core';\nimport { COMBINE_REDUCERS, STORE_TOKEN, LOGGER_TOKEN, CONTEXT_TOKEN } from '@tramvai/tokens-common';\nimport { DEFAULT_LAYOUT_COMPONENT, LAYOUT_OPTIONS, DEFAULT_FOOTER_COMPONENT, DEFAULT_HEADER_COMPONENT, DEFAULT_ERROR_BOUNDARY_COMPONENT, TRAMVAI_RENDER_MODE, RESOURCES_REGISTRY, CUSTOM_RENDER, EXTEND_RENDER, RENDERER_CALLBACK, USE_REACT_STRICT_MODE, RENDER_MODE } from '@tramvai/tokens-render';\nexport * from '@tramvai/tokens-render';\nimport { PAGE_SERVICE_TOKEN, ROUTER_TOKEN } from '@tramvai/tokens-router';\nimport each from '@tinkoff/utils/array/each';\nimport { useMemo, createElement, StrictMode } from 'react';\nimport { jsx } from 'react/jsx-runtime';\nimport { createEvent, createReducer, useStore, Provider } from '@tramvai/state';\nimport { useDi, ERROR_BOUNDARY_TOKEN, ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN, UniversalErrorBoundary, DIContext } from '@tramvai/react';\nimport { useUrl, usePageService } from '@tramvai/module-router';\nimport debounce from '@tinkoff/utils/function/debounce';\nimport { useIsomorphicLayoutEffect } from '@tinkoff/react-hooks';\nimport { composeLayoutOptions, createLayout } from '@tinkoff/layout-factory';\n\nfunction serializeError(error) {\n    return {\n        ...error,\n        message: error.message,\n        stack: error.stack,\n    };\n}\nfunction deserializeError(serializedError) {\n    const error = new Error(serializedError.message);\n    Object.assign(error, serializedError);\n    return error;\n}\nconst setPageErrorEvent = createEvent('setPageError');\nconst initialState = null;\nconst PageErrorStore = createReducer('pageError', initialState).on(setPageErrorEvent, (state, error) => error && serializeError(error));\n\nconst PageErrorBoundary = (props) => {\n    const { children } = props;\n    const pageService = useDi(PAGE_SERVICE_TOKEN);\n    const url = useUrl();\n    const serializedError = useStore(PageErrorStore);\n    const error = useMemo(() => {\n        return serializedError && deserializeError(serializedError);\n    }, [serializedError]);\n    const errorHandlers = useDi({ token: ERROR_BOUNDARY_TOKEN, optional: true });\n    const fallbackFromDi = useDi({ token: ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN, optional: true });\n    const fallback = pageService.resolveComponentFromConfig('errorBoundary');\n    return (jsx(UniversalErrorBoundary, { url: url, error: error, errorHandlers: errorHandlers, fallback: fallback, fallbackFromDi: fallbackFromDi, children: children }));\n};\n\n/**\n * Result component structure:\n *\n * <Root>\n *   <RootComponent>\n *    <LayoutComponent>\n *      <NestedLayoutComponent>\n *        <ErrorBoundaryComponent>\n *          <PageComponent />\n *        </ErrorBoundaryComponent>\n *      </NestedLayoutComponent>\n *    </LayoutComponent>\n *  </RootComponent>\n * </Root>\n *\n * All components separated for a few reasons:\n * - Page subtree can be rendered independently when Layout and Nested Layout the same\n * - Nested Layout can be rerendered only on its changes\n * - Layout can be rendered only on its changes\n */\nconst LayoutRenderComponent = ({ children }) => {\n    const pageService = usePageService();\n    const LayoutComponent = pageService.resolveComponentFromConfig('layout');\n    const HeaderComponent = pageService.resolveComponentFromConfig('header');\n    const FooterComponent = pageService.resolveComponentFromConfig('footer');\n    const layout = useMemo(() => (jsx(LayoutComponent, { Header: HeaderComponent, Footer: FooterComponent, children: children })), [LayoutComponent, HeaderComponent, FooterComponent, children]);\n    return layout;\n};\nconst NestedLayoutRenderComponent = ({ children }) => {\n    const pageService = usePageService();\n    const NestedLayoutComponent = pageService.resolveComponentFromConfig('nestedLayout');\n    const nestedLayout = useMemo(() => jsx(NestedLayoutComponent, { children: children }), [NestedLayoutComponent, children]);\n    return nestedLayout;\n};\nconst PageRenderComponent = () => {\n    const pageService = usePageService();\n    const { pageComponent } = pageService.getConfig();\n    let PageComponent = pageService.getComponent(pageComponent);\n    if (!PageComponent) {\n        PageComponent = () => {\n            throw new Error(`Page component '${pageComponent}' not found`);\n        };\n    }\n    const page = useMemo(() => (jsx(PageErrorBoundary, { children: jsx(PageComponent, {}) })), [PageComponent]);\n    return page;\n};\nconst Root = () => {\n    const pageRenderComponent = useMemo(() => jsx(PageRenderComponent, {}), []);\n    const nestedLayoutRenderComponent = useMemo(() => jsx(NestedLayoutRenderComponent, { children: pageRenderComponent }), [pageRenderComponent]);\n    return jsx(LayoutRenderComponent, { children: nestedLayoutRenderComponent });\n};\n\nfunction renderReact({ di }, context) {\n    const serverState = typeof window !== 'undefined' ? context.getState() : undefined;\n    return (jsx(Provider, { context: context, serverState: serverState, children: jsx(DIContext.Provider, { value: di, children: jsx(Root, {}) }) }));\n}\n\nlet hydrateRoot;\nlet startTransition;\ntry {\n    // eslint-disable-next-line import/no-unresolved, import/extensions\n    hydrateRoot = require('react-dom/client').hydrateRoot;\n    startTransition = require('react').startTransition;\n}\ncatch { }\nconst ExecuteRenderCallback = ({ children, callback, }) => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    useIsomorphicLayoutEffect(callback, []);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return children;\n};\nconst renderer = ({ element, container, callback, log }) => {\n    if (process.env.__TRAMVAI_CONCURRENT_FEATURES && typeof hydrateRoot === 'function') {\n        const wrappedElement = createElement(ExecuteRenderCallback, { callback }, element);\n        let allErrors = new Map();\n        const logHydrateRecoverableError = debounce(50, () => {\n            if (allErrors.size === 0) {\n                return;\n            }\n            const [{ error, errorInfo }, ...otherErrors] = Array.from(allErrors.values());\n            allErrors = new Map();\n            log.error({\n                event: 'hydrate:recover-after-error',\n                error,\n                errorInfo,\n                otherErrors,\n            });\n        });\n        return startTransition(() => {\n            hydrateRoot(container, wrappedElement, {\n                onRecoverableError: (error, errorInfo) => {\n                    // deduplicate by unique important string values\n                    allErrors.set((error === null || error === void 0 ? void 0 : error.message) + (errorInfo === null || errorInfo === void 0 ? void 0 : errorInfo.componentStack), { error, errorInfo });\n                    logHydrateRecoverableError();\n                },\n            });\n        });\n    }\n    const { hydrate } = require('react-dom');\n    return hydrate(element, container, callback);\n};\n\nfunction rendering({ logger, consumerContext, customRender, extendRender, di, useStrictMode, rendererCallback, }) {\n    const log = logger('module-render');\n    return new Promise((resolve, reject) => {\n        let renderResult = renderReact({ di }, consumerContext);\n        if (extendRender) {\n            each((render) => {\n                renderResult = render(renderResult);\n            }, extendRender);\n        }\n        if (customRender) {\n            return customRender(renderResult);\n        }\n        if (useStrictMode) {\n            renderResult = createElement(StrictMode, null, renderResult);\n        }\n        const container = document.querySelector('.application');\n        const executeRendererCallbacks = (renderErr) => rendererCallback === null || rendererCallback === void 0 ? void 0 : rendererCallback.forEach((cb) => {\n            try {\n                cb(renderErr);\n            }\n            catch (cbError) {\n                // eslint-disable-next-line no-console\n                console.error(cbError);\n            }\n        });\n        const callback = () => {\n            log.debug('App rendering');\n            document.querySelector('html').classList.remove('no-js');\n            executeRendererCallbacks();\n            resolve();\n        };\n        const params = { element: renderResult, container, callback, log };\n        try {\n            renderer(params);\n        }\n        catch (e) {\n            executeRendererCallbacks(e);\n            reject(e);\n        }\n    });\n}\n\nconst RenderChildrenComponent = ({ children }) => children;\nlet LayoutModule = class LayoutModule {\n};\nLayoutModule = __decorate([\n    Module({\n        providers: [\n            {\n                provide: DEFAULT_LAYOUT_COMPONENT,\n                useFactory: ({ layoutOptions }) => {\n                    const options = composeLayoutOptions(layoutOptions);\n                    return createLayout(options);\n                },\n                deps: {\n                    layoutOptions: { token: LAYOUT_OPTIONS, optional: true },\n                },\n            },\n            {\n                provide: 'componentDefaultList',\n                multi: true,\n                useFactory: (components) => ({\n                    ...components,\n                    nestedLayoutDefault: RenderChildrenComponent,\n                }),\n                deps: {\n                    layoutDefault: DEFAULT_LAYOUT_COMPONENT,\n                    footerDefault: { token: DEFAULT_FOOTER_COMPONENT, optional: true },\n                    headerDefault: { token: DEFAULT_HEADER_COMPONENT, optional: true },\n                    errorBoundaryDefault: { token: DEFAULT_ERROR_BOUNDARY_COMPONENT, optional: true },\n                },\n            },\n        ],\n    })\n], LayoutModule);\n\nconst providers = [\n    provide({\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: PageErrorStore,\n    }),\n    provide({\n        provide: TRAMVAI_RENDER_MODE,\n        useValue: 'ssr',\n    }),\n];\n\nvar RenderModule_1;\nconst DEFAULT_POLYFILL_CONDITION = '';\nconst throwErrorInDev = (logger) => {\n    if (process.env.NODE_ENV === 'development') {\n        logger.error(`${RESOURCES_REGISTRY} следует использовать только при SSR`);\n    }\n};\nlet RenderModule = RenderModule_1 = class RenderModule {\n    static forRoot({ mode, useStrictMode }) {\n        const providers = [];\n        if (typeof mode === 'string' || typeof useStrictMode === 'boolean') {\n            providers.push({\n                provide: USE_REACT_STRICT_MODE,\n                useValue: useStrictMode !== null && useStrictMode !== void 0 ? useStrictMode : mode === 'strict',\n            });\n        }\n        return {\n            mainModule: RenderModule_1,\n            providers,\n        };\n    }\n};\nRenderModule = RenderModule_1 = __decorate([\n    Module({\n        imports: [LayoutModule],\n        providers: [\n            ...providers,\n            provide({\n                provide: commandLineListTokens.customerStart,\n                multi: true,\n                useFactory: ({ router, store }) => {\n                    return function clearPageError() {\n                        router.registerHook('beforeResolve', async () => {\n                            if (store.getState(PageErrorStore)) {\n                                store.dispatch(setPageErrorEvent(null));\n                            }\n                        });\n                    };\n                },\n                deps: {\n                    router: ROUTER_TOKEN,\n                    store: STORE_TOKEN,\n                },\n            }),\n            provide({\n                provide: RESOURCES_REGISTRY,\n                useFactory: ({ logger }) => ({\n                    getPageResources: () => {\n                        throwErrorInDev(logger);\n                        return [];\n                    },\n                    register: () => throwErrorInDev(logger),\n                }),\n                deps: {\n                    logger: LOGGER_TOKEN,\n                },\n            }),\n            provide({\n                provide: commandLineListTokens.generatePage,\n                useFactory: (deps) => {\n                    return function renderClientCommand() {\n                        window.contextExternal = deps.consumerContext;\n                        return rendering(deps);\n                    };\n                },\n                deps: {\n                    logger: LOGGER_TOKEN,\n                    customRender: { token: CUSTOM_RENDER, optional: true },\n                    extendRender: { token: EXTEND_RENDER, optional: true },\n                    rendererCallback: { token: RENDERER_CALLBACK, optional: true },\n                    consumerContext: CONTEXT_TOKEN,\n                    di: DI_TOKEN,\n                    useStrictMode: USE_REACT_STRICT_MODE,\n                },\n                multi: true,\n            }),\n            provide({\n                provide: RENDERER_CALLBACK,\n                useFactory: ({ consumerContext }) => () => {\n                    consumerContext.di.register({ provide: '__TRAMVAI_HYDRATED', useValue: true });\n                },\n                deps: {\n                    consumerContext: CONTEXT_TOKEN,\n                },\n            }),\n            provide({\n                provide: USE_REACT_STRICT_MODE,\n                useFactory: ({ deprecatedMode }) => {\n                    if (deprecatedMode === 'strict') {\n                        return true;\n                    }\n                    return false;\n                },\n                deps: {\n                    deprecatedMode: RENDER_MODE,\n                },\n            }),\n            provide({\n                provide: RENDER_MODE,\n                useValue: 'legacy',\n            }),\n        ],\n    })\n], RenderModule);\n\nexport { DEFAULT_POLYFILL_CONDITION, PageErrorStore, RenderModule, deserializeError, serializeError, setPageErrorEvent };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Metric module implementation\n */\nconst METRICS_MODULE_TOKEN = createToken('metricsModule');\n/**\n * @description\n * Utility for pointing out to metric module which service name to set for different requests\n */\nconst METRICS_SERVICES_REGISTRY_TOKEN = createToken('metricsServicesRegistry');\n/**\n * @description\n * Token for registering counter metric which can be incremented with POST papi request\n */\nconst REGISTER_INSTANT_METRIC_TOKEN = createToken('registerInstantMetric');\n/**\n * @description\n * Configuration for the metrics\n */\nconst METRICS_MODULE_CONFIG_TOKEN = createToken('metrics-module-config');\n\nexport { METRICS_MODULE_CONFIG_TOKEN, METRICS_MODULE_TOKEN, METRICS_SERVICES_REGISTRY_TOKEN, REGISTER_INSTANT_METRIC_TOKEN };\n","const toSecond = (timeStamp) => Math.round(timeStamp) / 1000;\nconst testString = (pattern) => (text) => pattern.test(text);\nconst isJs = testString(/\\.js$/);\nconst isCSS = testString(/\\.css$/);\nconst isImg = testString(/\\.(?:svg|png|jpeg|webp|jpg)$/);\nconst isFont = testString(/\\.(?:woff|eot|woff2|ttf)/);\nvar resourceType;\n(function (resourceType) {\n    resourceType[\"html\"] = \"html\";\n    resourceType[\"js\"] = \"js\";\n    resourceType[\"css\"] = \"css\";\n    resourceType[\"img\"] = \"img\";\n    resourceType[\"font\"] = \"font\";\n    resourceType[\"other\"] = \"other\";\n})(resourceType || (resourceType = {}));\nconst getType = (name) => {\n    switch (true) {\n        case isCSS(name):\n            return resourceType.css;\n        case isJs(name):\n            return resourceType.js;\n        case isImg(name):\n            return resourceType.img;\n        case isFont(name):\n            return resourceType.font;\n        default:\n            return resourceType.other;\n    }\n};\nconst getEntriesByType = (performance, type) => {\n    if (performance.getEntriesByType) {\n        return performance.getEntriesByType(type);\n    }\n};\nconst getPaintMetric = (performance) => {\n    const paint = getEntriesByType(performance, 'paint');\n    if (paint && paint[0]) {\n        return paint[0].startTime;\n    }\n    return 0;\n};\nconst getTimingResourceValue = (tr, key) => {\n    return (tr && tr[key]) || 0;\n};\nconst calculateMetric = (prev, next) => {\n    return {\n        duration: getTimingResourceValue(prev, 'duration') + toSecond(next.duration),\n        transferSize: getTimingResourceValue(prev, 'transferSize') + next.transferSize,\n        encodedBodySize: getTimingResourceValue(prev, 'encodedBodySize') + next.encodedBodySize,\n    };\n};\nconst getResourceMetrics = (performance) => {\n    const result = {};\n    const entries = getEntriesByType(performance, 'resource');\n    if (entries && entries.length > 0) {\n        const countByType = {};\n        entries.forEach((entry) => {\n            const name = getType(entry.name.split('?', 1)[0]);\n            if (resourceType[name]) {\n                if (!countByType[name]) {\n                    countByType[name] = 0;\n                }\n                countByType[name]++;\n                result[name] = calculateMetric(result[name], entry);\n                result[name].count = countByType[name];\n            }\n        });\n    }\n    const pageNav = getEntriesByType(performance, 'navigation');\n    if (pageNav && pageNav.length > 0) {\n        result[resourceType.html] = calculateMetric({}, pageNav[0]);\n    }\n    return result;\n};\nfunction browserTimings() {\n    let performance;\n    try {\n        // Провряем, есть ли имплементация timing\n        performance = window.performance;\n        if (!performance.timing || !performance.timing.loadEventEnd) {\n            // Если loadEventEnd равен 0, то библиотеку запустили раньше, чем нужно\n            if (performance.timing.loadEventEnd === 0) {\n                // eslint-disable-next-line no-console\n                console.error('Library used at browser initialization page. Reed docs');\n            }\n            throw new Error('Not implemented timing api');\n        }\n    }\n    catch (e) {\n        return {};\n    }\n    const { requestStart, responseStart, responseEnd, domComplete, loadEventEnd, domInteractive, navigationStart, } = performance.timing;\n    const timingCandidates = [\n        {\n            key: 'connection',\n            start: navigationStart,\n            end: requestStart,\n        },\n        {\n            key: 'backend',\n            start: requestStart,\n            end: responseStart,\n        },\n        {\n            key: 'pageDownload',\n            start: responseStart,\n            end: responseEnd,\n        },\n        {\n            key: 'first-paint',\n            start: 0,\n            end: getPaintMetric(performance),\n        },\n        {\n            key: 'domInteractive',\n            start: navigationStart,\n            end: domInteractive,\n        },\n        {\n            key: 'domComplete',\n            start: navigationStart,\n            end: domComplete,\n        },\n        {\n            key: 'pageLoadTime',\n            start: navigationStart,\n            end: loadEventEnd,\n        },\n    ];\n    const timings = {};\n    timingCandidates.forEach((el) => {\n        const time = toSecond(el.end - el.start);\n        // Отсеиваем не стандартные значения меньше 0 секунд и больше 33 минут\n        timings[el.key] = time > 0 || time < 2000 ? time : undefined;\n    });\n    timings.download = getResourceMetrics(performance);\n    return timings;\n}\n\nexport { browserTimings };\n","/* eslint-disable max-classes-per-file */\nclass Counter {\n    constructor(configurator) { }\n    inc() { }\n    reset() { }\n    remove() { }\n    labels() {\n        return {\n            inc() { },\n        };\n    }\n}\nclass Gauge {\n    constructor(configurator) { }\n    inc() { }\n    dec() { }\n    set() { }\n    setToCurrentTime() { }\n    reset() { }\n    remove() { }\n    startTimer(labels) {\n        return (endLabels) => { };\n    }\n    labels() {\n        return {\n            inc() { },\n            dec() { },\n            set() { },\n            setToCurrentTime() { },\n            startTimer() {\n                return (endLabels) => { };\n            },\n        };\n    }\n}\nclass Histogram {\n    constructor(configurator) { }\n    observe() { }\n    startTimer(labels) {\n        return (endLabels) => { };\n    }\n    reset() { }\n    remove() { }\n    labels() {\n        return {\n            observe() { },\n            startTimer() {\n                return () => { };\n            },\n        };\n    }\n}\nclass Summary {\n    constructor(configurator) { }\n    observe() { }\n    startTimer() {\n        return (labels) => { };\n    }\n    reset() { }\n    labels(labels) {\n        return {\n            observe() { },\n            startTimer() {\n                return (endLabels) => { };\n            },\n        };\n    }\n    remove() { }\n}\n/* eslint-enable max-classes-per-file */\n\nexport { Counter, Gauge, Histogram, Summary };\n","import { createToken } from '@tinkoff/dippy';\n\n/**\n * @description\n * Factory of HTTP clients with minimal base settings\n */\nconst HTTP_CLIENT_FACTORY = createToken('HTTP_CLIENT_FACTORY');\n/**\n * @description\n * Default options for factory of HTTP clients\n */\nconst DEFAULT_HTTP_CLIENT_FACTORY_OPTIONS = createToken('DEFAULT_HTTP_CLIENT_FACTORY_OPTIONS');\n/**\n * @description\n * Universal HTTP client for arbitrary requests\n */\nconst HTTP_CLIENT = createToken('HTTP_CLIENT');\n/**\n * @description\n * Global HTTP and HTTPS agents for all clients\n * https://nodejs.org/dist/latest-v16.x/docs/api/http.html#class-httpagent\n */\nconst HTTP_CLIENT_AGENT = createToken('HTTP_CLIENT_AGENT');\n/**\n * @description\n * List of HTTP headers that are proxied from app request to all of the backend API\n */\nconst API_CLIENT_PASS_HEADERS = createToken('apiClientPassHeaders', {\n    multi: true,\n});\n/**\n * @description\n * Internal api for app server.\n * Uses the value of `APP_INFO_TOKEN` from di for constructing the request address\n */\nconst PAPI_SERVICE = createToken('papi service');\n/**\n * @description\n * Enable or disable circuit breaker\n */\nconst DISABLE_CIRCUIT_BREAKER = createToken('disable circuit breaker');\n\nexport { API_CLIENT_PASS_HEADERS, DEFAULT_HTTP_CLIENT_FACTORY_OPTIONS, DISABLE_CIRCUIT_BREAKER, HTTP_CLIENT, HTTP_CLIENT_AGENT, HTTP_CLIENT_FACTORY, PAPI_SERVICE };\n","import { __decorate } from 'tslib';\nimport { Module, commandLineListTokens, Scope } from '@tramvai/core';\nimport { COMBINE_REDUCERS, CONTEXT_TOKEN, LOGGER_TOKEN } from '@tramvai/tokens-common';\nimport { METRICS_MODULE_TOKEN } from '@tramvai/tokens-metrics';\nexport * from '@tramvai/tokens-metrics';\nimport { browserTimings } from '@tinkoff/browser-timings';\nimport { Histogram, Summary, Gauge, Counter } from '@tinkoff/metrics-noop';\nimport { PAGE_SERVICE_TOKEN } from '@tramvai/tokens-router';\nimport { PAPI_SERVICE } from '@tramvai/tokens-http-client';\nimport { RemoteReporter } from '@tinkoff/logger';\nimport { createEvent, createReducer } from '@tramvai/state';\n\nconst setInstantMetrics = createEvent('set instant metrics map');\nconst MetricsStore = createReducer('instantMetrics', { instantMetricsMap: {} }).on(setInstantMetrics, (_prevState, nextState) => {\n    return nextState;\n});\n\nconst sharedProviders = [\n    {\n        provide: COMBINE_REDUCERS,\n        multi: true,\n        useValue: [MetricsStore],\n    },\n];\n\nlet InstantMetricsModule = class InstantMetricsModule {\n};\nInstantMetricsModule = __decorate([\n    Module({\n        providers: [\n            ...sharedProviders,\n            {\n                // При такой схеме подключения отправка instant метрик заработает только после этого\n                // провайдера, но подлючить через LOGGER_INIT_HOOK не представляется возможным потому что\n                // возникает циклическая зависимость контекст -> логгер -> хук метрик -> контекст\n                provide: commandLineListTokens.init,\n                scope: Scope.SINGLETON,\n                multi: true,\n                useFactory({ logger, papiService, context, }) {\n                    if (!papiService) {\n                        return () => { };\n                    }\n                    const validMetricsMap = context.getStore('instantMetrics').getState().instantMetricsMap;\n                    const instantMetricsReporter = new RemoteReporter({\n                        requestCount: 1,\n                        emitLevels: {\n                            trace: true,\n                            debug: true,\n                            info: true,\n                            warn: true,\n                            error: true,\n                            fatal: true,\n                        },\n                        makeRequest(logObject) {\n                            if (validMetricsMap[logObject.event]) {\n                                return papiService\n                                    .request({\n                                    path: `metrics/${logObject.event}`,\n                                    method: 'post',\n                                    payload: logObject.value\n                                        ? {\n                                            value: logObject.value,\n                                        }\n                                        : {},\n                                })\n                                    .then(({ payload }) => payload);\n                            }\n                            return Promise.resolve();\n                        },\n                    });\n                    return () => {\n                        logger.addBeforeReporter(instantMetricsReporter);\n                    };\n                },\n                deps: {\n                    papiService: {\n                        token: PAPI_SERVICE,\n                        optional: true,\n                    },\n                    context: CONTEXT_TOKEN,\n                    logger: LOGGER_TOKEN,\n                },\n            },\n        ],\n    })\n], InstantMetricsModule);\n\nfunction startMeasure(markName, uniqueMarkId) {\n    const uniqueMarkName = `${markName}:${uniqueMarkId}`;\n    performance.mark(uniqueMarkName);\n    function endMeasure(measureName) {\n        try {\n            performance.measure(measureName || markName, uniqueMarkName);\n        }\n        catch (e) { }\n        performance.clearMarks(uniqueMarkName);\n    }\n    return endMeasure;\n}\n\nconst supportsUserTiming = typeof performance !== 'undefined' &&\n    typeof performance.mark === 'function' &&\n    typeof performance.clearMarks === 'function' &&\n    typeof performance.measure === 'function' &&\n    typeof performance.clearMeasures === 'function';\n\nlet idCounter = 0;\nfunction uniqueId() {\n    // eslint-disable-next-line no-plusplus\n    return ++idCounter;\n}\n\nfunction startMeasurePerformance(name, startLabels = {}) {\n    if (!supportsUserTiming) {\n        return () => { };\n    }\n    const endMeasure = startMeasure(name, uniqueId());\n    return (endLabels = {}) => {\n        const labels = { ...startLabels, ...endLabels };\n        const labelsNames = Object.keys(labels)\n            .map((key) => `${key}=\"${labels[key]}\"`)\n            .join(',');\n        endMeasure(labelsNames && `${name}{${labelsNames}}`);\n    };\n}\nclass PerfHistogram extends Histogram {\n    constructor(configurator) {\n        super(configurator);\n        this.name = configurator.name;\n    }\n    startTimer(startLabels) {\n        const endMeasure = startMeasurePerformance(this.name, startLabels);\n        return (endLabels) => {\n            endMeasure(endLabels);\n        };\n    }\n}\nclass PerfSummary extends Summary {\n    constructor(configurator) {\n        super(configurator);\n        this.name = configurator.name;\n    }\n    startTimer() {\n        const endMeasure = startMeasurePerformance(this.name);\n        return (endLabels) => {\n            endMeasure(endLabels);\n        };\n    }\n}\nclass PerfGauge extends Gauge {\n    constructor(configurator) {\n        super(configurator);\n        this.name = configurator.name;\n    }\n    startTimer(startLabels) {\n        const endMeasure = startMeasurePerformance(this.name, startLabels);\n        return (endLabels) => {\n            endMeasure(endLabels);\n        };\n    }\n}\n\nlet MetricsModule = class MetricsModule {\n};\nMetricsModule = __decorate([\n    Module({\n        imports: [InstantMetricsModule],\n        providers: [\n            {\n                provide: METRICS_MODULE_TOKEN,\n                useFactory: () => {\n                    if (process.env.NODE_ENV === 'development') {\n                        return {\n                            counter: (opt) => new Counter({ ...opt }),\n                            gauge: (opt) => new PerfGauge({ ...opt }),\n                            histogram: (opt) => new PerfHistogram({ ...opt }),\n                            summary: (opt) => new PerfSummary({ ...opt }),\n                        };\n                    }\n                    return {\n                        counter: (opt) => new Counter({ ...opt }),\n                        gauge: (opt) => new Gauge({ ...opt }),\n                        histogram: (opt) => new Histogram({ ...opt }),\n                        summary: (opt) => new Summary({ ...opt }),\n                    };\n                },\n                scope: Scope.SINGLETON,\n            },\n            {\n                provide: commandLineListTokens.init,\n                useFactory: ({ logger, pageService }) => () => {\n                    window.addEventListener('load', () => {\n                        setTimeout(() => {\n                            var _a, _b;\n                            const timings = browserTimings();\n                            const log = logger({\n                                name: 'metrics:perf',\n                                defaults: {\n                                    remote: {\n                                        emitLevels: {\n                                            info: true,\n                                        },\n                                    },\n                                },\n                            });\n                            log.info({\n                                ...timings,\n                                event: 'perf-timings',\n                                deviceType: ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.indexOf('Mobi')) !== -1 ? 'mobile' : 'desktop',\n                                urlMask: (_b = pageService.getCurrentRoute()) === null || _b === void 0 ? void 0 : _b.path,\n                            });\n                        }, 0);\n                    });\n                },\n                multi: true,\n                deps: {\n                    logger: LOGGER_TOKEN,\n                    pageService: PAGE_SERVICE_TOKEN,\n                },\n            },\n        ],\n    })\n], MetricsModule);\n\nexport { MetricsModule };\n","import { __decorate } from 'tslib';\nimport { APP_INFO_TOKEN, Module } from '@tramvai/core';\nimport { MetricsModule } from '@tramvai/module-metrics';\nimport { SERVER_MODULE_PAPI_PUBLIC_URL, SERVER_MODULE_PAPI_PRIVATE_URL } from '@tramvai/tokens-server';\nexport * from '@tramvai/tokens-server';\n\nconst sharedProviders = [\n    {\n        provide: SERVER_MODULE_PAPI_PUBLIC_URL,\n        useFactory: ({ appInfo }) => {\n            return `/${appInfo.appName}/papi`;\n        },\n        deps: {\n            appInfo: APP_INFO_TOKEN,\n        },\n    },\n    {\n        provide: SERVER_MODULE_PAPI_PRIVATE_URL,\n        useFactory: ({ appInfo }) => {\n            return `/${appInfo.appName}/private/papi`;\n        },\n        deps: {\n            appInfo: APP_INFO_TOKEN,\n        },\n    },\n];\n\nlet BrowserPapiModule = class BrowserPapiModule {\n};\nBrowserPapiModule = __decorate([\n    Module({\n        providers: [...sharedProviders],\n    })\n], BrowserPapiModule);\n\nlet ServerModule = class ServerModule {\n};\nServerModule = __decorate([\n    Module({\n        imports: [MetricsModule, BrowserPapiModule],\n        providers: [],\n    })\n], ServerModule);\n\nexport { ServerModule };\n","import { __decorate } from 'tslib';\nimport { provide, Module } from '@tramvai/core';\nimport { LOGGER_TOKEN } from '@tramvai/module-common';\nimport { ERROR_BOUNDARY_TOKEN } from '@tramvai/react';\n\nconst sharedProviders = [\n    provide({\n        provide: ERROR_BOUNDARY_TOKEN,\n        useFactory: ({ logger }) => {\n            const log = logger('error-interceptor:error-boundary');\n            return function logErrorBoundary(error, info) {\n                log.error({\n                    event: 'component-did-catch',\n                    error,\n                    info,\n                });\n            };\n        },\n        deps: {\n            logger: LOGGER_TOKEN,\n        },\n        multi: true,\n    }),\n];\n\nlet ErrorInterceptorModule = class ErrorInterceptorModule {\n};\nErrorInterceptorModule = __decorate([\n    Module({\n        providers: [...sharedProviders],\n    })\n], ErrorInterceptorModule);\n\nexport { ErrorInterceptorModule };\n","import identity from '@tinkoff/utils/function/identity';\nimport isArray from '@tinkoff/utils/is/array';\nimport has from '@tinkoff/utils/object/has';\nimport eachObj from '@tinkoff/utils/object/each';\nimport reduceObj from '@tinkoff/utils/object/reduce';\n\nclass MetaWalk {\n    constructor() {\n        this.state = new Map();\n    }\n    eachMeta(func) {\n        this.state.forEach((value, key) => func(value, key));\n    }\n    updateMeta(priority, metaObj) {\n        var _a;\n        eachObj((value, name) => {\n            if (!value && value !== null) {\n                return;\n            }\n            const stateMeta = this.state.get(name);\n            if (!stateMeta || priority >= stateMeta.priority) {\n                if (value === null) {\n                    this.state.delete(name);\n                }\n                else {\n                    this.state.set(name, { value, priority });\n                }\n            }\n        }, metaObj);\n        (_a = this.onChange) === null || _a === void 0 ? void 0 : _a.call(this);\n        return this;\n    }\n    get(key) {\n        return this.state.get(key);\n    }\n    reset() {\n        this.state.clear();\n    }\n    subscribe(listener) {\n        this.onChange = listener;\n    }\n}\n\nconst defaultConverter = (value) => has('tag', value) ? value : null;\nclass Meta {\n    constructor({ list, transformValue = identity, converters = {}, metaWalk, }) {\n        this.listSources = list;\n        this.transformValue = transformValue;\n        this.converters = converters;\n        this.metaWalk = metaWalk;\n    }\n    dataCollection(...args) {\n        var _a;\n        const metaWalk = (_a = this.metaWalk) !== null && _a !== void 0 ? _a : new MetaWalk();\n        this.listSources.map((fn) => fn(metaWalk, ...args));\n        let result = [];\n        metaWalk.eachMeta((val, key) => {\n            const value = this.transformValue(val);\n            const converter = this.converters[key];\n            const res = (converter || defaultConverter)(value.value);\n            if (res) {\n                result = result.concat(isArray(res) ? res.filter(identity) : res);\n            }\n        });\n        return result;\n    }\n}\n\nconst META_DATA_ATTR = 'data-meta-dynamic';\n\nconst formatAttr = reduceObj((acc, value, key) => `${acc} ${key}=\"${value}\"`, '');\nconst htmlConverter = ({ tag, attributes, innerHtml }) => {\n    const attr = `${formatAttr(attributes)} ${META_DATA_ATTR}=\"true\"`;\n    if (innerHtml) {\n        return `<${tag}${attr}>${innerHtml}</${tag}>`;\n    }\n    return `<${tag}${attr}>`;\n};\nclass Render {\n    constructor(meta) {\n        this.meta = meta;\n    }\n    render() {\n        return this.meta.dataCollection().map(htmlConverter).join('\\n');\n    }\n}\n\nconst create = ({ tag, attributes, innerHtml }) => {\n    const newElement = document.createElement(tag);\n    if (innerHtml) {\n        newElement.innerHTML = innerHtml;\n    }\n    attributes &&\n        eachObj((value, key) => {\n            newElement.setAttribute(key, value || '');\n        }, attributes);\n    newElement.setAttribute(META_DATA_ATTR, 'true');\n    return newElement;\n};\nclass Update {\n    constructor(meta) {\n        this.meta = meta;\n    }\n    update() {\n        const head = document.head || document.querySelector('head');\n        const addTags = this.meta.dataCollection().map(create);\n        const removeTags = head.querySelectorAll(`[${META_DATA_ATTR}]`);\n        const fragment = document.createDocumentFragment();\n        [].slice.call(removeTags).forEach((tag) => head.removeChild(tag));\n        addTags.forEach((tag) => fragment.appendChild(tag));\n        head.insertBefore(fragment, head.firstChild);\n    }\n}\n\nexport { META_DATA_ATTR, Meta, MetaWalk, Render, Update };\n","import { __decorate } from 'tslib';\nimport flatten from '@tinkoff/utils/array/flatten';\nimport isArray from '@tinkoff/utils/is/array';\nimport debounce from '@tinkoff/utils/function/debounce';\nimport { Module, provide, commandLineListTokens } from '@tramvai/core';\nimport { MetaWalk, Meta, Update } from '@tinkoff/meta-tags-generate';\nimport ifElse from '@tinkoff/utils/function/ifElse';\nimport isString from '@tinkoff/utils/is/string';\nimport escape from '@tinkoff/utils/string/escape';\nimport identity from '@tinkoff/utils/function/identity';\nimport mergeDeep from '@tinkoff/utils/object/mergeDeep';\nimport { PAGE_SERVICE_TOKEN } from '@tramvai/tokens-router';\nimport { CONTEXT_TOKEN } from '@tramvai/module-common';\nimport { createToken } from '@tinkoff/dippy';\nimport curryN from '@tinkoff/utils/function/curryN';\n\n// Уровень, с которого мы перестаем доверять meta тегам и их необходимо очищать от лишнего\nconst META_PRIORITY_MIN_SAFE = 10;\nconst escapeMeta = ifElse(isString, escape, identity);\n// Эскейпим пользовательские значения. Возможно XSS атака\nconst transformValue = (item) => {\n    if (item.priority > META_PRIORITY_MIN_SAFE) {\n        return { priority: item.priority, value: escapeMeta(item.value) };\n    }\n    return item;\n};\n\nconst META_PRIORITY_DEFAULT = 0;\nconst META_PRIORITY_ROUTE = 10;\nconst META_PRIORITY_APP = 20;\n\nconst defaultPack = {\n    title: 'Tramvai',\n};\nconst metaDefaultPack = (data) => (walker) => {\n    walker.updateMeta(META_PRIORITY_DEFAULT, data);\n};\n\nconst META_DEFAULT_TOKEN = createToken('metaDefaultPack');\nconst META_WALK_TOKEN = createToken('metaWalk');\nconst META_UPDATER_TOKEN = createToken('metaUpdater', { multi: true });\n\nconst capitalize = (str) => {\n    return `${str.charAt(0).toUpperCase()}${str.slice(1)}`;\n};\nconst convertWithPrefix = (key, record = {}) => {\n    const result = {};\n    Object.keys(record).forEach((item) => {\n        result[key + capitalize(item)] = record[item];\n    });\n    return result;\n};\nconst sharedProviders = [\n    {\n        provide: META_WALK_TOKEN,\n        useClass: MetaWalk,\n    },\n    // дефолтный пак metaList\n    {\n        provide: META_DEFAULT_TOKEN,\n        useValue: defaultPack,\n    },\n    {\n        provide: META_UPDATER_TOKEN,\n        multi: true,\n        useFactory: ({ defaultMeta }) => metaDefaultPack(defaultMeta),\n        deps: {\n            defaultMeta: META_DEFAULT_TOKEN,\n        },\n    },\n    {\n        // получение из админки мета тегов\n        provide: META_UPDATER_TOKEN,\n        useFactory: ({ pageService }) => {\n            return (walker) => {\n                const routeSeo = pageService.getMeta().seo || {};\n                // @todo: only for file-system routes?\n                const { pageComponent } = pageService.getConfig() || {};\n                const PageComponent = pageService.getComponent(pageComponent) || {};\n                const pageComponentSeo = PageComponent.seo || {};\n                const seo = mergeDeep({}, routeSeo, pageComponentSeo);\n                const shareSchema = seo.shareSchema || {};\n                const metaTags = {\n                    ...seo.metaTags,\n                    ...convertWithPrefix('twitter', shareSchema.twitterCard),\n                    ...convertWithPrefix('og', shareSchema.openGraph), // преобразование тегов с opengraph\n                };\n                walker.updateMeta(META_PRIORITY_ROUTE, metaTags);\n            };\n        },\n        multi: true,\n        deps: {\n            pageService: PAGE_SERVICE_TOKEN,\n        },\n    },\n    {\n        // преобразовыет логику старого токена metaList к новому META_UPDATER_TOKEN\n        // TODO: убрать, легаси\n        provide: META_UPDATER_TOKEN,\n        multi: true,\n        useFactory: ({ context, metaList }) => {\n            const list = flatten(metaList || []);\n            return (walker) => {\n                list.forEach((fn) => fn(context, walker));\n            };\n        },\n        deps: {\n            context: CONTEXT_TOKEN,\n            metaList: { token: 'metaList', optional: true },\n        },\n    },\n];\n\nconst metaInnerHtml = curryN(2, (tag, innerHtml) => innerHtml && { tag, innerHtml });\nconst metaName = curryN(2, (name, content) => content && { tag: 'meta', attributes: { name, content } });\nconst metaProperty = curryN(2, (property, content) => content && { tag: 'meta', attributes: { property, content } });\nconst metaLink = curryN(2, (rel, href) => href && { tag: 'link', attributes: { rel, href } });\n\nconst robotsNoIndex = [metaName('robots', 'noindex, follow'), metaName('robots', 'noarchive')];\nconst robotsNoFollow = [metaName('robots', 'index, nofollow'), metaName('robots', 'noarchive')];\nconst robotsNone = [\n    metaName('robots', 'none'),\n    metaName('robots', 'noindex, nofollow'),\n    metaName('robots', 'noarchive'),\n];\nconst metaRobotsContent = {\n    all: [\n        metaName('robots', 'all'),\n        metaName('robots', 'index, follow'),\n        metaName('robots', 'noarchive'),\n    ],\n    noindex: robotsNoIndex,\n    'noindex, follow': robotsNoIndex,\n    nofollow: robotsNoFollow,\n    'index, nofollow': robotsNoFollow,\n    none: robotsNone,\n    'noindex, nofollow': robotsNone,\n};\nconst converters = {\n    title: metaInnerHtml('title'),\n    description: metaName('description'),\n    keywords: metaName('keywords'),\n    canonical: metaLink('canonical'),\n    viewport: metaName('viewport'),\n    ogTitle: metaProperty('og:title'),\n    ogDescription: metaProperty('og:description'),\n    ogSiteName: metaProperty('og:site_name'),\n    ogUrl: metaProperty('og:url'),\n    ogType: metaProperty('og:type'),\n    ogImage: metaProperty('og:image'),\n    ogImageSecure: metaProperty('og:image:secure_url'),\n    ogImageType: metaProperty('og:image:type'),\n    ogImageAlt: metaProperty('og:image:alt'),\n    ogImageWidth: metaProperty('og:image:width'),\n    ogImageHeight: metaProperty('og:image:height'),\n    ogLocale: metaProperty('og:locale'),\n    twitterTitle: metaName('twitter:title'),\n    twitterDescription: metaName('twitter:description'),\n    twitterCard: metaName('twitter:card'),\n    twitterSite: metaName('twitter:site'),\n    twitterCreator: metaName('twitter:creator'),\n    twitterImage: metaName('twitter:image'),\n    twitterImageAlt: metaName('twitter:image:alt'),\n    robots: (x) => metaRobotsContent[x],\n};\n\nvar SeoModule_1;\nlet SeoModule = SeoModule_1 = class SeoModule {\n    static forRoot(options) {\n        // легаси ветка для старого формата\n        // TODO: убрать\n        if (isArray(options)) {\n            return {\n                mainModule: SeoModule_1,\n                providers: [\n                    {\n                        provide: 'metaList',\n                        useValue: options,\n                        multi: true,\n                    },\n                ],\n            };\n        }\n        const { metaUpdaters, metaDefault } = options;\n        const providers = [];\n        if (metaDefault) {\n            providers.push({\n                provide: META_DEFAULT_TOKEN,\n                useValue: metaDefault,\n            });\n        }\n        if (metaUpdaters) {\n            providers.push({\n                provide: META_UPDATER_TOKEN,\n                useValue: metaUpdaters,\n                multi: true,\n            });\n        }\n        return {\n            providers,\n            mainModule: SeoModule_1,\n        };\n    }\n};\nSeoModule = SeoModule_1 = __decorate([\n    Module({\n        providers: [\n            ...sharedProviders,\n            provide({\n                provide: commandLineListTokens.spaTransition,\n                multi: true,\n                useFactory: ({ metaWalk, metaUpdaters }) => {\n                    const meta = new Meta({\n                        list: flatten(metaUpdaters || []),\n                        transformValue,\n                        converters,\n                        metaWalk,\n                    });\n                    let ignore = false;\n                    const update = () => {\n                        ignore = true;\n                        new Update(meta).update();\n                        ignore = false;\n                    };\n                    const debounced = debounce(500, update);\n                    // TODO: костыль для MetaWalk, чтобы можно было обновлять мету в экшенах\n                    // надо сделать нормально на уровне самой меты или типо того\n                    metaWalk.subscribe(\n                    // если произошло изменение в metaWalk мы должны отреагировать на него\n                    // и обновить мету на странице\n                    () => {\n                        if (!ignore) {\n                            debounced();\n                        }\n                    });\n                    return function updateMeta() {\n                        metaWalk.reset();\n                        update();\n                    };\n                },\n                deps: {\n                    metaWalk: META_WALK_TOKEN,\n                    metaUpdaters: { token: META_UPDATER_TOKEN, optional: true, multi: true },\n                },\n            }),\n        ],\n    })\n], SeoModule);\n\nexport { META_DEFAULT_TOKEN, META_PRIORITY_APP, META_PRIORITY_DEFAULT, META_PRIORITY_ROUTE, META_UPDATER_TOKEN, META_WALK_TOKEN, SeoModule };\n","import each from '@tinkoff/utils/object/each';\nimport flatten from '@tinkoff/utils/array/flatten';\nimport toArray from '@tinkoff/utils/array/toArray';\nimport applyOrReturn from '@tinkoff/utils/function/applyOrReturn';\nimport reduceObj from '@tinkoff/utils/object/reduce';\nimport mapObj from '@tinkoff/utils/object/map';\nimport prop from '@tinkoff/utils/object/prop';\n\nvar Descriptions;\n(function (Descriptions) {\n    Descriptions[\"static\"] = \"static\";\n    Descriptions[\"dynamic\"] = \"dynamic\";\n})(Descriptions || (Descriptions = {}));\nconst STATIC = Descriptions.static;\nconst DYNAMIC = Descriptions.dynamic;\nconst staticRender = (payload) => ({\n    payload,\n    type: Descriptions.static,\n});\nconst dynamicRender = (slot) => ({\n    slot,\n    type: Descriptions.dynamic,\n});\nfunction isStatic(descriptor) {\n    return descriptor.type === Descriptions.static;\n}\nfunction isDynamic(descriptor) {\n    return descriptor.type === Descriptions.dynamic;\n}\n\nclass HtmlPageStorage {\n    constructor() {\n        this.slots = new Map();\n        this.slotsHandlers = new Map();\n    }\n    registerSlotHandler(slot, handler) {\n        const { slotsHandlers } = this;\n        const currentSlotHandlers = slotsHandlers.get(slot);\n        currentSlotHandlers\n            ? currentSlotHandlers.add(handler)\n            : slotsHandlers.set(slot, new Set([handler]));\n    }\n    runSlotHandlers(slot, { cspToken }) {\n        const handlers = this.slotsHandlers.get(slot);\n        const slotsState = this.slots;\n        const slotState = slotsState.get(slot) || slotsState.set(slot, new Set()).get(slot);\n        return (handlers &&\n            handlers.forEach((handler) => {\n                const options = { cspToken };\n                const result = applyOrReturn([options], handler);\n                const records = toArray(result);\n                return records.forEach((entry) => slotState === null || slotState === void 0 ? void 0 : slotState.add(entry));\n            }));\n    }\n    getRecord(slot) {\n        return this.slots.get(slot);\n    }\n}\n\nvar StorageRecord;\n(function (StorageRecord) {\n    StorageRecord[\"iconLink\"] = \"iconLink\";\n    StorageRecord[\"meta\"] = \"meta\";\n    StorageRecord[\"inlineScript\"] = \"inlineScript\";\n    StorageRecord[\"script\"] = \"script\";\n    StorageRecord[\"asIs\"] = \"asIs\";\n    StorageRecord[\"preconnectLink\"] = \"preconnectLink\";\n    StorageRecord[\"preloadLink\"] = \"preloadLink\";\n    StorageRecord[\"inlineStyle\"] = \"inlineStyle\";\n    StorageRecord[\"style\"] = \"style\";\n})(StorageRecord || (StorageRecord = {}));\nconst ICON_LINK = StorageRecord.iconLink;\nconst META = StorageRecord.meta;\nconst INLINE_SCRIPT = StorageRecord.inlineScript;\nconst SCRIPT = StorageRecord.script;\nconst AS_IS = StorageRecord.asIs;\nconst PRECONNECT_LINK = StorageRecord.preconnectLink;\nconst PRELOAD_LINK = StorageRecord.preloadLink;\nconst INLINE_STYLE = StorageRecord.inlineStyle;\nconst STYLE = StorageRecord.style;\n\nconst VOID_TAGS = new Set(['link']);\nconst formatAttr = reduceObj((acc, value, key) => {\n    if (key && value) {\n        return `${acc} ${key}=\"${value}\"`;\n    }\n    if (value === null) {\n        return acc;\n    }\n    return `${acc} ${key}`;\n}, '');\nconst format = ({ tag, attributes, innerHtml, }) => {\n    const attr = `${formatAttr(attributes)}`;\n    if (VOID_TAGS.has(tag)) {\n        return `<${tag}${attr}>`;\n    }\n    if (innerHtml) {\n        return `<${tag}${attr}>${innerHtml}</${tag}>`;\n    }\n    return `<${tag}${attr}></${tag}>`;\n};\nconst converters = {\n    [StorageRecord.asIs]: prop('payload'),\n    [StorageRecord.iconLink]: ({ payload, attrs }) => ({\n        tag: 'link',\n        attributes: {\n            ...attrs,\n            href: payload,\n        },\n    }),\n    [StorageRecord.meta]: prop('payload'),\n    [StorageRecord.inlineScript]: ({ payload, attrs }) => {\n        // проверям инлайновые скрипты на es5 т.к. пока поддерживаем старые браузеры\n        if (process.env.NODE_ENV === 'development' && typeof window === 'undefined' && payload) {\n            try {\n                require('acorn').parse(payload, { ecmaVersion: 5 });\n            }\n            catch (e) {\n                console.error('ES5 incompatibility in inline script!', '\\n', payload, '\\n', e);\n            }\n        }\n        return {\n            tag: 'script',\n            innerHtml: payload,\n            attributes: attrs,\n        };\n    },\n    [StorageRecord.script]: ({ payload, attrs }) => ({\n        tag: 'script',\n        attributes: {\n            defer: 'defer',\n            charset: 'utf-8',\n            crossorigin: 'anonymous',\n            ...attrs,\n            src: payload,\n        },\n    }),\n    [StorageRecord.preconnectLink]: ({ payload, attrs }) => ({\n        tag: 'link',\n        attributes: {\n            ...attrs,\n            rel: 'preconnect',\n            href: payload,\n        },\n    }),\n    [StorageRecord.preloadLink]: ({ payload, attrs }) => ({\n        tag: 'link',\n        attributes: {\n            charset: 'utf-8',\n            ...attrs,\n            rel: 'preload',\n            href: payload,\n        },\n    }),\n    [StorageRecord.inlineStyle]: ({ payload }) => ({\n        tag: 'style',\n        attributes: {\n            type: 'text/css',\n        },\n        innerHtml: payload,\n    }),\n    [StorageRecord.style]: ({ payload, attrs }) => ({\n        tag: 'link',\n        attributes: {\n            ...attrs,\n            rel: 'stylesheet',\n            href: payload,\n        },\n    }),\n};\nconst recordToTagConverters = mapObj((converter) => (...args) => {\n    const result = converter(...args);\n    return typeof result === 'string' ? result : format(result);\n}, converters);\n\nfunction transformArrayToString(array) {\n    let result = '';\n    for (const item of array) {\n        result += item;\n    }\n    return result;\n}\nconst buildPage = ({ description, slotHandlers, options = {} }) => {\n    const storage = new HtmlPageStorage();\n    // register slot handlers\n    each((handlers, slot) => handlers.forEach((handler) => storage.registerSlotHandler(slot, handler)), slotHandlers);\n    const renderedSlots = description.map((descriptor) => {\n        if (isDynamic(descriptor)) {\n            const { slot } = descriptor;\n            storage.runSlotHandlers(slot, options);\n            const records = storage.getRecord(slot) || [];\n            const convertedRecords = Array.from(records).map((record) => {\n                const converter = recordToTagConverters[record.type];\n                return converter(record);\n            });\n            if (process.env.NODE_ENV === 'development') {\n                // Add html comments for debug reasons\n                return [\n                    `\\n<!-- START OF SLOT ${slot} -->\\n`,\n                    ...convertedRecords,\n                    `\\n<!-- END OF SLOT ${slot} -->\\n`,\n                ];\n            }\n            return convertedRecords;\n        }\n        if (isStatic(descriptor)) {\n            return descriptor.payload;\n        }\n        return null;\n    });\n    return transformArrayToString(flatten(renderedSlots));\n};\n\nexport { AS_IS, DYNAMIC, ICON_LINK, INLINE_SCRIPT, INLINE_STYLE, META, PRECONNECT_LINK, PRELOAD_LINK, SCRIPT, STATIC, STYLE, StorageRecord, buildPage, dynamicRender, isDynamic, isStatic, staticRender };\n","import { createApp } from '@tramvai/core';\nimport { CommonModule } from '@tramvai/module-common';\nimport { SpaRouterModule } from '@tramvai/module-router';\nimport { RenderModule } from '@tramvai/module-render';\nimport { ServerModule } from '@tramvai/module-server';\nimport { ErrorInterceptorModule } from '@tramvai/module-error-interceptor';\nimport { SeoModule } from '@tramvai/module-seo';\nimport {\n  RENDER_SLOTS,\n  ResourceType,\n  ResourceSlot,\n} from '@tramvai/tokens-render';\nimport { SketchModule } from '~/shared/sketch';\n\ncreateApp({\n  name: 'sketch',\n  modules: [\n    CommonModule,\n    SpaRouterModule,\n    RenderModule.forRoot({ mode: 'strict' }),\n    SeoModule,\n    ServerModule,\n    ErrorInterceptorModule,\n    SketchModule,\n  ],\n  providers: [\n    {\n      provide: RENDER_SLOTS,\n      multi: true,\n      useValue: {\n        type: ResourceType.asIs,\n        slot: ResourceSlot.HEAD_META,\n        payload:\n          '<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">',\n      },\n    },\n  ],\n});\n","import { createEvent } from '@tramvai/state';\nimport type { SketchStoreState } from './store';\n\nexport const undo = createEvent<void>('UNDO');\nexport const redo = createEvent<void>('REDO');\nexport const pushToHistory = createEvent<string>('PUSH_TO_HISTORY');\n\nexport const setCanvas = createEvent<HTMLCanvasElement>('SET_CANVAS');\n\nexport const setTool = createEvent<SketchStoreState['tool']>('SET_TOOL');\n\nexport const incrementCurrentIndexFrame = createEvent<void>(\n  'INCREMENT_CURRENT_INDEX_FRAME'\n);\n\nexport const decrementCurrentIndexFrame = createEvent<void>(\n  'DECREMENT_CURRENT_INDEX_FRAME'\n);\n\nexport const setCurrentIndexFrame = createEvent<number>(\n  'SET_CURRENT_INDEX_FRAME'\n);\n\nexport const setHistory = createEvent<string[]>('SET_HISTORY');\n\nexport const sliceStory = createEvent<void>('SLICE_STORY');\n\nexport const setIsLastBrowse = createEvent<boolean>('SET_IS_LAST_BROWSE');\n\nexport const setLineWidth = createEvent<number>('SET_LINE_WIDTH');\nexport const setFillColor = createEvent<string>('SET_FILL_COLOR');\nexport const setStrokeColor = createEvent<string>('SET_STROKE_COLOR');\n","import { createReducer } from '@tramvai/state';\nimport {\n  setCanvas,\n  setTool,\n  pushToHistory,\n  incrementCurrentIndexFrame,\n  decrementCurrentIndexFrame,\n  setCurrentIndexFrame,\n  sliceStory,\n  setIsLastBrowse,\n  setHistory,\n  setLineWidth,\n  setFillColor,\n  setStrokeColor,\n} from './events';\n\nconst initialState = {\n  canvasStore: {\n    canvas: null,\n    browser: {\n      history: [],\n      currentIndexFrame: -1,\n      isLastBrowse: false,\n    },\n  },\n  tool: null,\n};\n\nexport type SketchStoreState = {\n  canvasStore: {\n    canvas: HTMLCanvasElement | null;\n    browser: {\n      history: string[];\n      currentIndexFrame: number;\n      isLastBrowse: boolean;\n    };\n  };\n  tool: any;\n};\n\nexport const SketchStore = createReducer<SketchStoreState>(\n  'sketchStore',\n  initialState\n)\n  .on(setCanvas, (state, canvas) => {\n    return { ...state, canvasStore: { ...state.canvasStore, canvas } };\n  })\n\n  .on(setTool, (state, tool) => {\n    return { ...state, tool };\n  })\n\n  .on(pushToHistory, (state, dataUrl) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          history: [...state.canvasStore.browser.history, dataUrl],\n        },\n      },\n    };\n  })\n  .on(incrementCurrentIndexFrame, (state) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          currentIndexFrame: state.canvasStore.browser.currentIndexFrame + 1,\n        },\n      },\n    };\n  })\n  .on(decrementCurrentIndexFrame, (state) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          currentIndexFrame: state.canvasStore.browser.currentIndexFrame - 1,\n        },\n      },\n    };\n  })\n  .on(setCurrentIndexFrame, (state, index) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          currentIndexFrame: index,\n        },\n      },\n    };\n  })\n  .on(setHistory, (state, history) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          history,\n        },\n      },\n    };\n  })\n  .on(sliceStory, (state) => {\n    const { browser } = state.canvasStore;\n\n    const currentIndex = browser.currentIndexFrame;\n    const newHistory = browser.history.slice(0, currentIndex + 1);\n\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          history: newHistory,\n        },\n      },\n    };\n  })\n  .on(setIsLastBrowse, (state, isLastBrowse) => {\n    return {\n      ...state,\n      canvasStore: {\n        ...state.canvasStore,\n        browser: {\n          ...state.canvasStore.browser,\n          isLastBrowse,\n        },\n      },\n    };\n  })\n  .on(setLineWidth, (state, width) => {\n    if (state.tool) {\n      // eslint-disable-next-line no-param-reassign\n      state.tool.lineWidth = width;\n    }\n    return state;\n  })\n  .on(setFillColor, (state, color) => {\n    if (state.tool) {\n      // eslint-disable-next-line no-param-reassign\n      state.tool.fillColor = color;\n    }\n    return state;\n  })\n  .on(setStrokeColor, (state, color) => {\n    if (state.tool) {\n      // eslint-disable-next-line no-param-reassign\n      state.tool.strokeColor = color;\n    }\n    return state;\n  });\n","import { declareAction } from '@tramvai/core';\nimport {\n  undo,\n  redo,\n  setCanvas,\n  setTool,\n  incrementCurrentIndexFrame,\n  pushToHistory,\n  decrementCurrentIndexFrame,\n  setCurrentIndexFrame,\n  sliceStory,\n  setIsLastBrowse,\n  setHistory,\n  setLineWidth,\n  setFillColor,\n  setStrokeColor,\n} from './events';\n\nexport const setCanvasAction = declareAction({\n  name: 'setCanvas',\n  async fn(canvas: HTMLCanvasElement) {\n    this.dispatch(setCanvas(canvas));\n  },\n});\n\nexport const setToolAction = declareAction({\n  name: 'setTool',\n  async fn(tool) {\n    this.dispatch(setTool(tool));\n  },\n});\n\nexport const setLineWidthAction = declareAction({\n  name: 'setLineWidth',\n  async fn(width) {\n    this.dispatch(setLineWidth(width));\n  },\n});\n\nexport const setFillColorAction = declareAction({\n  name: 'setFillColor',\n  async fn(color) {\n    this.dispatch(setFillColor(color));\n  },\n});\n\nexport const setStrokeColorAction = declareAction({\n  name: 'setStrokeColor',\n  async fn(color) {\n    this.dispatch(setStrokeColor(color));\n  },\n});\n\nexport const undoAction = declareAction({\n  name: 'undo',\n  async fn() {\n    this.dispatch(undo());\n  },\n});\n\nexport const redoAction = declareAction({\n  name: 'redo',\n  async fn() {\n    this.dispatch(redo());\n  },\n});\n\nexport const pushToHistoryAction = declareAction({\n  name: 'pushToHistory',\n  async fn(dataUrl) {\n    const index = Number(localStorage.getItem('currentIndexFrame'));\n    localStorage.setItem('currentIndexFrame', `${index + 1}`);\n\n    const history = JSON.parse(localStorage.getItem('history')!);\n\n    localStorage.setItem('history', JSON.stringify([...history, dataUrl]));\n\n    await this.dispatch(pushToHistory(dataUrl));\n    await this.dispatch(incrementCurrentIndexFrame());\n    await this.dispatch(setIsLastBrowse(false));\n  },\n});\n\nexport const incrementCurrentIndexFrameAction = declareAction({\n  name: 'incrementCurrentIndexFrame',\n  async fn() {\n    this.dispatch(incrementCurrentIndexFrame());\n  },\n});\n\nexport const decrementCurrentIndexFrameAction = declareAction({\n  name: 'decrementCurrentIndexFrame',\n  async fn() {\n    this.dispatch(decrementCurrentIndexFrame());\n  },\n});\n\nexport const setCurrentIndexFrameAction = declareAction({\n  name: 'setCurrentIndexFrame',\n  async fn(index) {\n    this.dispatch(setCurrentIndexFrame(index));\n  },\n});\n\nexport const setHistoryAction = declareAction({\n  name: 'setHistory',\n  async fn(history) {\n    this.dispatch(setHistory(history));\n  },\n});\n\nexport const sliceStoryAction = declareAction({\n  name: 'sliceStory',\n  async fn() {\n    this.dispatch(sliceStory());\n  },\n});\n\nexport const setIsLastBrowseAction = declareAction({\n  name: 'setIsLastBrowse',\n  async fn(isLastBrowse) {\n    this.dispatch(setIsLastBrowse(isLastBrowse));\n  },\n});\n","import { useActions, useSelector } from '@tramvai/state';\nimport type { MutableRefObject } from 'react';\nimport React, { useEffect, useRef } from 'react';\nimport {\n  setCanvasAction,\n  pushToHistoryAction,\n  sliceStoryAction,\n  setIsLastBrowseAction,\n  setHistoryAction,\n  setCurrentIndexFrameAction,\n} from '../../store/actions';\nimport { SketchStore } from '../../store/store';\nimport s from './canvas.module.css';\n\nconst setDefaultStorage = () => {\n  localStorage.setItem('history', `[]`);\n  localStorage.setItem('currentIndexFrame', '-1');\n  localStorage.setItem('isLastBrowse', '0');\n};\n\ntype CanvasProps = {\n  width: number;\n  height: number;\n};\n\nconst Canvas = ({ width, height }: CanvasProps) => {\n  const canvasRef = useRef() as MutableRefObject<HTMLCanvasElement>;\n  const setCanvas = useActions(setCanvasAction);\n\n  const pushToHistory = useActions(pushToHistoryAction);\n  const sliceStory = useActions(sliceStoryAction);\n\n  const setHistory = useActions(setHistoryAction);\n  const setCurrentINdexFrame = useActions(setCurrentIndexFrameAction);\n\n  const isLastBrowse = useSelector(\n    SketchStore,\n    ({ sketchStore }) => sketchStore.canvasStore.browser.isLastBrowse\n  );\n  const setIsLastBrowse = useActions(setIsLastBrowseAction);\n\n  useEffect(() => {\n    setCanvas(canvasRef.current); // TODO: фикс дабл рендера\n\n    let dataUrl;\n\n    const historyStorage = localStorage.getItem('history');\n    const currentIndexFrameStorage = localStorage.getItem('currentIndexFrame');\n    const isLastBrowseStorage = localStorage.getItem('isLastBrowse');\n\n    if (historyStorage && typeof currentIndexFrameStorage === 'string') {\n      const historyStorageParsed = JSON.parse(historyStorage);\n      const index = Number(currentIndexFrameStorage);\n\n      setHistory(historyStorageParsed);\n      setCurrentINdexFrame(index);\n\n      dataUrl = historyStorageParsed[index];\n    } else {\n      setDefaultStorage();\n    }\n\n    if (isLastBrowseStorage) {\n      setIsLastBrowse(Boolean(isLastBrowseStorage));\n    }\n\n    const ctx = canvasRef.current.getContext('2d');\n\n    if (dataUrl && ctx) {\n      const img = new Image();\n\n      img.src = dataUrl;\n      img.onload = () => {\n        ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n        ctx.drawImage(\n          img,\n          0,\n          0,\n          canvasRef.current.width,\n          canvasRef.current.height\n        );\n      };\n    }\n  }, [setCanvas, setCurrentINdexFrame, setHistory, setIsLastBrowse]);\n\n  const mouseUpHandler = async () => {\n    if (isLastBrowse) {\n      await sliceStory();\n      await setIsLastBrowse(false);\n      localStorage.setItem('isLastBrowse', '0');\n    }\n\n    const dataUrl = canvasRef.current.toDataURL();\n\n    await pushToHistory(dataUrl);\n    const historyStorage = localStorage.getItem('history')!;\n\n    if (Array.from(JSON.parse(historyStorage)).length === 0) {\n      localStorage.setItem('history', JSON.stringify([dataUrl]));\n    }\n  };\n\n  return (\n    <canvas\n      className={s.canvas}\n      width={width}\n      height={height}\n      ref={canvasRef}\n      onMouseUp={() => mouseUpHandler()}\n    />\n  );\n};\n\nexport default Canvas;\n","const path = __webpack_public_path__ + \"ab3aa2ed88b172bdd568d5ca1a311c52.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"ab3aa2ed88b172bdd568d5ca1a311c52.png\",\n  width: 512,\n  height: 512,\n};","const path = __webpack_public_path__ + \"4d54b29b10e37da7ff7dd8ea40ae1ea6.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"4d54b29b10e37da7ff7dd8ea40ae1ea6.png\",\n  width: 512,\n  height: 512,\n};","import { useActions } from '@tramvai/state';\nimport React from 'react';\nimport {\n  setFillColorAction,\n  setStrokeColorAction,\n} from '../../../../store/actions';\nimport icon from './img/color-circle.png';\nimport s from './color.module.css';\nimport sidebar from '../../../sidebar/sidebar.module.css';\n\nconst Color = () => {\n  const [setFillColor, setStrokeColor] = useActions([\n    setFillColorAction,\n    setStrokeColorAction,\n  ]);\n\n  const changeColor = (e: any) => {\n    setFillColor(e.target.value);\n    setStrokeColor(e.target.value);\n  };\n  return (\n    <>\n      <img className={sidebar.tool} src={icon} alt=\"\" />\n      <div className={s.colorContainer}>\n        <input\n          className={s.color}\n          type=\"color\"\n          onChange={(e) => changeColor(e)}\n        />\n      </div>\n    </>\n  );\n};\n\nexport default Color;\n","import { useActions } from '@tramvai/state';\nimport React from 'react';\nimport cn from 'classnames';\nimport { setLineWidthAction } from '../../store/actions';\nimport s from './sidebar.module.css';\nimport icon from './img/line-adjustment.png';\nimport type { IsToolActive } from '../toolbar/Toolbar';\nimport Color from '../toolbar/tools/color/Color';\n\nconst Sidebar = ({ isActive }: { isActive: IsToolActive }) => {\n  const setLineWidth = useActions(setLineWidthAction);\n\n  return (\n    <ul\n      className={cn(\n        s.sidebar,\n        (isActive.tool === 'brush' || isActive.tool === 'rect') && s.isActive\n      )}\n    >\n      <li>\n        <img className={s.tool} src={icon} alt=\"Толщина\" />\n        <input\n          onChange={(e) => setLineWidth(e.target.value)}\n          id=\"line-width\"\n          type=\"range\"\n          min={1}\n          max={50}\n          defaultValue={1}\n        />\n      </li>\n      <li>\n        <Color />\n      </li>\n    </ul>\n  );\n};\n\nexport default Sidebar;\n","const path = __webpack_public_path__ + \"35510ec03b70c36d7d03ffa7bdb8d285.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"35510ec03b70c36d7d03ffa7bdb8d285.png\",\n  width: 512,\n  height: 512,\n};","export default class Tool {\n  public canvas: HTMLCanvasElement;\n  public ctx: CanvasRenderingContext2D;\n\n  constructor(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d')!;\n  }\n\n  set fillColor(color: string) {\n    this.ctx.fillStyle = color;\n  }\n\n  set strokeColor(color: string) {\n    this.ctx.strokeStyle = color;\n  }\n\n  set lineWidth(width: number) {\n    this.ctx.lineWidth = width;\n  }\n\n  destroyEvent() {\n    this.canvas.onmousemove = null;\n    this.canvas.onmousedown = null;\n    this.canvas.onmouseup = null;\n  }\n}\n","import Tool from '../Tool';\n\nexport default class Brush extends Tool {\n  private isMouseDown = false;\n\n  constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n    this.listen();\n  }\n\n  listen() {\n    this.canvas.onmousemove = this.mouseMoveHandler.bind(this);\n    this.canvas.onmousedown = this.mouseDownHandler.bind(this);\n    this.canvas.onmouseup = this.mouseUpHandler.bind(this);\n  }\n\n  // TODO: типизировать все any\n  mouseUpHandler(_e: any) {\n    this.isMouseDown = false;\n  }\n\n  mouseDownHandler(e: any) {\n    this.isMouseDown = true;\n    this.ctx.beginPath();\n    this.ctx.moveTo(\n      e.pageX - e.target.offsetLeft,\n      e.pageY - e.target.offsetTop\n    );\n  }\n\n  mouseMoveHandler(e: any) {\n    if (this.isMouseDown) {\n      this.draw(e.pageX - e.target.offsetLeft, e.pageY - e.target.offsetTop);\n    }\n  }\n\n  draw(x: number, y: number) {\n    this.ctx.lineTo(x, y);\n    this.ctx.stroke();\n  }\n}\n","import React from 'react';\nimport { useActions, useSelector } from '@tramvai/state';\nimport cn from 'classnames';\nimport { setToolAction } from '../../../../store/actions';\nimport { SketchStore } from '../../../../store/store';\nimport icon from './img/paint-brush.png';\nimport s from '../general.module.css';\nimport BrushTool from './Brush';\nimport type { IsToolActive } from '../../Toolbar';\n\nconst BrushButton = ({\n  setActive,\n  isToolActive,\n}: {\n  setActive: any;\n  isToolActive: IsToolActive;\n}) => {\n  const setBrushAction = useActions(setToolAction);\n  const canvas = useSelector(\n    SketchStore,\n    (state) => state.sketchStore.canvasStore.canvas\n  );\n\n  const setBrush = () => {\n    if (canvas) {\n      setActive({ tool: 'brush' });\n      setBrushAction(new BrushTool(canvas));\n    }\n  };\n\n  return (\n    <button\n      type=\"button\"\n      className={cn(s.tool, isToolActive.tool === 'brush' && s.active)}\n      onClick={setBrush}\n    >\n      <img src={icon} alt=\"brush\" />\n    </button>\n  );\n};\n\nexport default BrushButton;\n","const path = __webpack_public_path__ + \"624be59b866c8cc04e18389992683d8d.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"624be59b866c8cc04e18389992683d8d.png\",\n  width: 512,\n  height: 512,\n};","import React from 'react';\nimport { useActions, useSelector } from '@tramvai/state';\nimport cn from 'classnames';\nimport { setToolAction } from '../../../../store/actions';\nimport icon from './img/cursor.png';\nimport s from '../general.module.css';\nimport { SketchStore } from '../../../../store/store';\nimport type { IsToolActive } from '../../Toolbar';\n\nconst Cursor = ({\n  setActive,\n  isToolActive,\n}: {\n  setActive: any;\n  isToolActive: IsToolActive;\n}) => {\n  const setCursorAction = useActions(setToolAction);\n  const canvas = useSelector(\n    SketchStore,\n    (state) => state.sketchStore.canvasStore.canvas\n  );\n  const tool = useSelector(SketchStore, (state) => state.sketchStore.tool);\n\n  const setCursor = () => {\n    if (canvas) {\n      setActive({ tool: 'cursor' });\n\n      if (tool) {\n        tool.destroyEvent();\n      }\n\n      setCursorAction(null);\n    }\n  };\n\n  return (\n    <button\n      type=\"button\"\n      className={cn(s.tool, isToolActive.tool === 'cursor' && s.active)}\n      onClick={setCursor}\n    >\n      <img src={icon} alt=\"cursor\" />\n    </button>\n  );\n};\n\nexport default Cursor;\n","const path = __webpack_public_path__ + \"4397c2416f2680d8327b01f25f113558.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"4397c2416f2680d8327b01f25f113558.png\",\n  width: 512,\n  height: 512,\n};","import React from 'react';\nimport { useActions, useSelector } from '@tramvai/state';\nimport { SketchStore } from '~/shared/sketch/store/store';\nimport { pushToHistoryAction } from '~/shared/sketch/store/actions';\nimport icon from './img/eraser.png';\n\nimport s from '../general.module.css';\n\nconst EraserButton = () => {\n  const canvas = useSelector(\n    SketchStore,\n    (state) => state.sketchStore.canvasStore.canvas\n  );\n  const pushToHistory = useActions(pushToHistoryAction);\n\n  const ctx = canvas?.getContext('2d');\n\n  const clearAll = () => {\n    if (ctx && canvas) {\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      const dataUrl = canvas.toDataURL();\n\n      const img = new Image();\n\n      img.src = dataUrl;\n      img.onload = () => {\n        ctx?.clearRect(0, 0, canvas.width, canvas.height);\n        ctx?.drawImage(img, 0, 0, canvas.width, canvas.height);\n      };\n\n      pushToHistory(dataUrl);\n    }\n  };\n\n  return (\n    <button type=\"button\" className={s.tool} onClick={clearAll}>\n      <img src={icon} alt=\"eraser\" />\n    </button>\n  );\n};\n\nexport default EraserButton;\n","const path = __webpack_public_path__ + \"aac093baee310feb4c395ed22b8837bf.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"aac093baee310feb4c395ed22b8837bf.png\",\n  width: 512,\n  height: 512,\n};","import Tool from '../Tool';\n\nexport default class Rect extends Tool {\n  private isMouseDown = false;\n  private startX = 0;\n  private startY = 0;\n  private saved = '';\n\n  constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n    this.listen();\n  }\n\n  listen() {\n    this.canvas.onmousemove = this.mouseMoveHandler.bind(this);\n    this.canvas.onmousedown = this.mouseDownHandler.bind(this);\n    this.canvas.onmouseup = this.mouseUpHandler.bind(this);\n  }\n\n  // TODO: типизировать все any\n  mouseUpHandler(_e: any) {\n    this.isMouseDown = false;\n  }\n\n  mouseDownHandler(e: any) {\n    this.isMouseDown = true;\n    this.ctx.beginPath();\n    this.startX = e.pageX - e.target.offsetLeft;\n    this.startY = e.pageY - e.target.offsetTop;\n    this.saved = this.canvas.toDataURL();\n  }\n\n  mouseMoveHandler(e: any) {\n    if (this.isMouseDown) {\n      const currentX = e.pageX - e.target.offsetLeft;\n      const currentY = e.pageY - e.target.offsetTop;\n      const width = currentX - this.startX;\n      const height = currentY - this.startY;\n\n      this.draw(this.startX, this.startY, width, height);\n    }\n  }\n\n  draw(x: number, y: number, w: number, h: number) {\n    const img = new Image();\n    img.src = this.saved;\n    img.onload = () => {\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.ctx.drawImage(img, 0, 0, this.canvas.width, this.canvas.height);\n      this.ctx.beginPath();\n      this.ctx.rect(x, y, w, h);\n      this.ctx.stroke();\n      this.ctx.fill();\n    };\n  }\n}\n","import { useActions, useSelector } from '@tramvai/state';\nimport React from 'react';\nimport { setToolAction } from '~/shared/sketch/store/actions';\nimport { SketchStore } from '~/shared/sketch/store/store';\nimport cn from 'classnames';\nimport type { IsToolActive } from '../../Toolbar';\nimport s from '../general.module.css';\nimport icon from './img/square.png';\nimport RectTool from './Rect';\n\nconst RectButton = ({\n  setActive,\n  isToolActive,\n}: {\n  setActive: any;\n  isToolActive: IsToolActive;\n}) => {\n  const setRectAction = useActions(setToolAction);\n  const canvas = useSelector(\n    SketchStore,\n    ({ sketchStore }) => sketchStore.canvasStore.canvas\n  );\n\n  const setRect = () => {\n    if (canvas) {\n      setActive({ tool: 'rect', isActive: true });\n      setRectAction(new RectTool(canvas));\n    }\n  };\n\n  return (\n    <button\n      type=\"button\"\n      className={cn(s.tool, isToolActive.tool === 'rect' && s.active)}\n      onClick={setRect}\n    >\n      <img src={icon} alt=\"eraser\" />\n    </button>\n  );\n};\n\nexport default RectButton;\n","const path = __webpack_public_path__ + \"63c83c0c7b8a775771e1e0ecd5836d43.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"63c83c0c7b8a775771e1e0ecd5836d43.png\",\n  width: 512,\n  height: 512,\n};","const path = __webpack_public_path__ + \"4857e5082b6e83571364b8c6fec20bca.png\";\n\nexport default path;\n\nexport const image = {\n  src: __webpack_public_path__ + \"4857e5082b6e83571364b8c6fec20bca.png\",\n  width: 512,\n  height: 512,\n};","import React from 'react';\nimport { useUndoRedo } from '~/shared/sketch/hooks/useUndoRedo';\nimport undoIcon from './img/undo.png';\nimport redoIcon from './img/redo.png';\nimport s from '../general.module.css';\nimport style from './undoRedoBar.module.css';\n\nconst UndoRedoBar = () => {\n  const [undo, redo] = useUndoRedo();\n\n  return (\n    <div className={style.undoRedoBar}>\n      <button type=\"button\" onClick={undo} className={s.tool}>\n        <img src={undoIcon} alt=\"undo\" />\n      </button>\n      <button type=\"button\" onClick={redo} className={s.tool}>\n        <img src={redoIcon} alt=\"redo\" />\n      </button>\n    </div>\n  );\n};\n\nexport default UndoRedoBar;\n","import { useSelector, useActions } from '@tramvai/state';\nimport { setIsLastBrowseAction } from '../store/actions';\nimport { setCurrentIndexFrameAction } from '../store/actions';\nimport { SketchStore } from '../store/store';\n\nexport const useUndoRedo = () => {\n  const canvas = useSelector(\n    SketchStore,\n    ({ sketchStore }) => sketchStore.canvasStore.canvas\n  );\n\n  const currentIndexFrame = useSelector(\n    SketchStore,\n    ({ sketchStore }) => sketchStore.canvasStore.browser.currentIndexFrame\n  );\n\n  const history = useSelector(\n    SketchStore,\n    ({ sketchStore }) => sketchStore.canvasStore.browser.history\n  );\n\n  const setCurrentIndexFrame = useActions(setCurrentIndexFrameAction);\n  const setIsLastBrowse = useActions(setIsLastBrowseAction);\n\n  if (!canvas) return [];\n  const ctx = canvas.getContext('2d');\n\n  const undo = async () => {\n    if (currentIndexFrame >= 0) {\n      await setIsLastBrowse(true);\n      localStorage.setItem('isLastBrowse', '1');\n\n      const undoIndex = currentIndexFrame - 1;\n      const dataUrl = history[undoIndex];\n\n      if (!dataUrl) {\n        ctx?.clearRect(0, 0, canvas.width, canvas.height);\n        localStorage.setItem('currentIndexFrame', '-1');\n      }\n\n      await setCurrentIndexFrame(undoIndex);\n\n      const img = new Image();\n\n      img.src = dataUrl;\n      img.onload = () => {\n        ctx?.clearRect(0, 0, canvas.width, canvas.height);\n        ctx?.drawImage(img, 0, 0, canvas.width, canvas.height);\n      };\n\n      localStorage.setItem('currentIndexFrame', `${undoIndex}`);\n    }\n  };\n\n  const redo = async () => {\n    if (history.length > 0) {\n      await setIsLastBrowse(true);\n      localStorage.setItem('isLastBrowse', '1');\n\n      const redoIndex = currentIndexFrame + 1;\n\n      const dataUrl = history[redoIndex] ? history[redoIndex] : null;\n\n      if (!dataUrl) return;\n\n      await setCurrentIndexFrame(redoIndex);\n\n      const img = new Image();\n\n      img.src = dataUrl;\n      img.onload = () => {\n        ctx?.clearRect(0, 0, canvas.width, canvas.height);\n        ctx?.drawImage(img, 0, 0, canvas.width, canvas.height);\n      };\n\n      localStorage.setItem('currentIndexFrame', `${redoIndex}`);\n    }\n  };\n\n  return [undo, redo];\n};\n","import React, { useState } from 'react';\n\nimport Sidebar from '../sidebar/Sidebar';\nimport s from './toolbar.module.css';\nimport BrushButton from './tools/brush/BrushButton';\nimport CursorButton from './tools/cursor/CursorButton';\nimport EraserButton from './tools/eraser/EraserButton';\nimport Rect from './tools/rect/RectButton';\nimport UndoRedoBar from './tools/undoRedoBar/UndoRedoBar';\n\nexport type IsToolActive = { tool: string };\n\nconst Toolbar = () => {\n  const [isToolActive, setIsActiveTool] = useState({\n    tool: '',\n  });\n\n  return (\n    <>\n      <div className={s.toolbar}>\n        <CursorButton setActive={setIsActiveTool} isToolActive={isToolActive} />\n        <BrushButton setActive={setIsActiveTool} isToolActive={isToolActive} />\n        <Rect setActive={setIsActiveTool} isToolActive={isToolActive} />\n        <EraserButton />\n        <UndoRedoBar />\n      </div>\n      <Sidebar isActive={isToolActive} />\n    </>\n  );\n};\n\nexport default Toolbar;\n","import React from 'react';\nimport { useMedia } from '@tramvai/module-client-hints';\nimport Canvas from './canvas/Canvas';\nimport Toolbar from './toolbar/Toolbar';\nimport config from '../config';\nimport s from './sketch.module.css';\n\ntype SketchProps = {\n  widthProp?: number;\n  heightProp?: number;\n};\nexport const Sketch = ({ widthProp, heightProp }: SketchProps) => {\n  const media = useMedia();\n  const { width, height } = media;\n\n  const canvasWidth = widthProp || width || config.canvasWidth;\n  const canvasHeight = heightProp || height || config.canvasHeight;\n\n  return (\n    <div className={s.sketch}>\n      <Toolbar />\n      <Canvas width={canvasWidth} height={canvasHeight} />\n    </div>\n  );\n};\n","export default {\n  canvasWidth: 1000,\n  canvasHeight: 1000,\n};\n","import { ClientHintsModule } from '@tramvai/module-client-hints';\nimport { Module } from '@tramvai/core';\nimport { COMBINE_REDUCERS } from '@tramvai/tokens-common';\nimport { SketchStore } from './store/store';\n\nexport * from './components/Sketch';\n\n// TODO: сохранение в сессию (при перезагрузке остается) travelaviabook -> saveToSessionStorage()\n// TODO: подумать над конфигурацией модуля\n\n// ?: Раз это модуль, возможно, следует создать для него package.json\n\n@Module({\n  imports: [ClientHintsModule],\n  providers: [\n    {\n      provide: COMBINE_REDUCERS,\n      multi: false,\n      useValue: [SketchStore],\n    },\n  ],\n})\nexport class SketchModule {}\n","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\tvar threw = true;\n\ttry {\n\t\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\t\tthrew = false;\n\t} finally {\n\t\tif(threw) delete __webpack_module_cache__[moduleId];\n\t}\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + \"a0e18e7c67023998\" + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + \"4249c7fafdd6d8e1\" + \".chunk.css\";\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = window.ap;","__webpack_require__.S = {};\nvar initPromises = {};\nvar initTokens = {};\n__webpack_require__.I = function(name, initScope) {\n\tif(!initScope) initScope = [];\n\t// handling circular init calls\n\tvar initToken = initTokens[name];\n\tif(!initToken) initToken = initTokens[name] = {};\n\tif(initScope.indexOf(initToken) >= 0) return;\n\tinitScope.push(initToken);\n\t// only runs once\n\tif(initPromises[name]) return initPromises[name];\n\t// creates a new share scope if needed\n\tif(!__webpack_require__.o(__webpack_require__.S, name)) __webpack_require__.S[name] = {};\n\t// runs all init snippets from all modules reachable\n\tvar scope = __webpack_require__.S[name];\n\tvar warn = function(msg) { return typeof console !== \"undefined\" && console.warn && console.warn(msg); };\n\tvar uniqueName = \"@tramvai/cli\";\n\tvar register = function(name, version, factory, eager) {\n\t\tvar versions = scope[name] = scope[name] || {};\n\t\tvar activeVersion = versions[version];\n\t\tif(!activeVersion || (!activeVersion.loaded && (!eager != !activeVersion.eager ? eager : uniqueName > activeVersion.from))) versions[version] = { get: factory, from: uniqueName, eager: !!eager };\n\t};\n\tvar initExternal = function(id) {\n\t\tvar handleError = function(err) { warn(\"Initialization of sharing external failed: \" + err); };\n\t\ttry {\n\t\t\tvar module = __webpack_require__(id);\n\t\t\tif(!module) return;\n\t\t\tvar initFn = function(module) { return module && module.init && module.init(__webpack_require__.S[name], initScope); }\n\t\t\tif(module.then) return promises.push(module.then(initFn, handleError));\n\t\t\tvar initResult = initFn(module);\n\t\t\tif(initResult && initResult.then) return promises.push(initResult['catch'](handleError));\n\t\t} catch(err) { handleError(err); }\n\t}\n\tvar promises = [];\n\tswitch(name) {\n\t\tcase \"default\": {\n\t\t\tregister(\"react-dom\", \"18.2.0\", function() { return function() { return __webpack_require__(5675); }; }, 1);\n\t\t\tregister(\"react/jsx-runtime\", \"18.2.0\", function() { return function() { return __webpack_require__(5500); }; }, 1);\n\t\t\tregister(\"react\", \"18.2.0\", function() { return function() { return __webpack_require__(7077); }; }, 1);\n\t\t}\n\t\tbreak;\n\t}\n\tif(!promises.length) return initPromises[name] = 1;\n\treturn initPromises[name] = Promise.all(promises).then(function() { return initPromises[name] = 1; });\n};","var parseVersion = function(str) {\n\t// see webpack/lib/util/semver.js for original code\n\tvar p=function(p){return p.split(\".\").map((function(p){return+p==p?+p:p}))},n=/^([^-+]+)?(?:-([^+]+))?(?:\\+(.+))?$/.exec(str),r=n[1]?p(n[1]):[];return n[2]&&(r.length++,r.push.apply(r,p(n[2]))),n[3]&&(r.push([]),r.push.apply(r,p(n[3]))),r;\n}\nvar versionLt = function(a, b) {\n\t// see webpack/lib/util/semver.js for original code\n\ta=parseVersion(a),b=parseVersion(b);for(var r=0;;){if(r>=a.length)return r<b.length&&\"u\"!=(typeof b[r])[0];var e=a[r],n=(typeof e)[0];if(r>=b.length)return\"u\"==n;var t=b[r],f=(typeof t)[0];if(n!=f)return\"o\"==n&&\"n\"==f||(\"s\"==f||\"u\"==n);if(\"o\"!=n&&\"u\"!=n&&e!=t)return e<t;r++}\n}\nvar rangeToString = function(range) {\n\t// see webpack/lib/util/semver.js for original code\n\tvar r=range[0],n=\"\";if(1===range.length)return\"*\";if(r+.5){n+=0==r?\">=\":-1==r?\"<\":1==r?\"^\":2==r?\"~\":r>0?\"=\":\"!=\";for(var e=1,a=1;a<range.length;a++){e--,n+=\"u\"==(typeof(t=range[a]))[0]?\"-\":(e>0?\".\":\"\")+(e=2,t)}return n}var g=[];for(a=1;a<range.length;a++){var t=range[a];g.push(0===t?\"not(\"+o()+\")\":1===t?\"(\"+o()+\" || \"+o()+\")\":2===t?g.pop()+\" \"+g.pop():rangeToString(t))}return o();function o(){return g.pop().replace(/^\\((.+)\\)$/,\"$1\")}\n}\nvar satisfy = function(range, version) {\n\t// see webpack/lib/util/semver.js for original code\n\tif(0 in range){version=parseVersion(version);var e=range[0],r=e<0;r&&(e=-e-1);for(var n=0,i=1,a=!0;;i++,n++){var f,s,g=i<range.length?(typeof range[i])[0]:\"\";if(n>=version.length||\"o\"==(s=(typeof(f=version[n]))[0]))return!a||(\"u\"==g?i>e&&!r:\"\"==g!=r);if(\"u\"==s){if(!a||\"u\"!=g)return!1}else if(a)if(g==s)if(i<=e){if(f!=range[i])return!1}else{if(r?f>range[i]:f<range[i])return!1;f!=range[i]&&(a=!1)}else if(\"s\"!=g&&\"n\"!=g){if(r||i<=e)return!1;a=!1,i--}else{if(i<=e||s<g!=r)return!1;a=!1}else\"s\"!=g&&\"n\"!=g&&(a=!1,i--)}}var t=[],o=t.pop.bind(t);for(n=1;n<range.length;n++){var u=range[n];t.push(1==u?o()|o():2==u?o()&o():u?satisfy(u,version):!o())}return!!o();\n}\nvar ensureExistence = function(scopeName, key) {\n\tvar scope = __webpack_require__.S[scopeName];\n\tif(!scope || !__webpack_require__.o(scope, key)) throw new Error(\"Shared module \" + key + \" doesn't exist in shared scope \" + scopeName);\n\treturn scope;\n};\nvar findVersion = function(scope, key) {\n\tvar versions = scope[key];\n\tvar key = Object.keys(versions).reduce(function(a, b) {\n\t\treturn !a || versionLt(a, b) ? b : a;\n\t}, 0);\n\treturn key && versions[key]\n};\nvar findSingletonVersionKey = function(scope, key) {\n\tvar versions = scope[key];\n\treturn Object.keys(versions).reduce(function(a, b) {\n\t\treturn !a || (!versions[a].loaded && versionLt(a, b)) ? b : a;\n\t}, 0);\n};\nvar getInvalidSingletonVersionMessage = function(scope, key, version, requiredVersion) {\n\treturn \"Unsatisfied version \" + version + \" from \" + (version && scope[key][version].from) + \" of shared singleton module \" + key + \" (required \" + rangeToString(requiredVersion) + \")\"\n};\nvar getSingleton = function(scope, scopeName, key, requiredVersion) {\n\tvar version = findSingletonVersionKey(scope, key);\n\treturn get(scope[key][version]);\n};\nvar getSingletonVersion = function(scope, scopeName, key, requiredVersion) {\n\tvar version = findSingletonVersionKey(scope, key);\n\tif (!satisfy(requiredVersion, version)) typeof console !== \"undefined\" && console.warn && console.warn(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\n\treturn get(scope[key][version]);\n};\nvar getStrictSingletonVersion = function(scope, scopeName, key, requiredVersion) {\n\tvar version = findSingletonVersionKey(scope, key);\n\tif (!satisfy(requiredVersion, version)) throw new Error(getInvalidSingletonVersionMessage(scope, key, version, requiredVersion));\n\treturn get(scope[key][version]);\n};\nvar findValidVersion = function(scope, key, requiredVersion) {\n\tvar versions = scope[key];\n\tvar key = Object.keys(versions).reduce(function(a, b) {\n\t\tif (!satisfy(requiredVersion, b)) return a;\n\t\treturn !a || versionLt(a, b) ? b : a;\n\t}, 0);\n\treturn key && versions[key]\n};\nvar getInvalidVersionMessage = function(scope, scopeName, key, requiredVersion) {\n\tvar versions = scope[key];\n\treturn \"No satisfying version (\" + rangeToString(requiredVersion) + \") of shared module \" + key + \" found in shared scope \" + scopeName + \".\\n\" +\n\t\t\"Available versions: \" + Object.keys(versions).map(function(key) {\n\t\treturn key + \" from \" + versions[key].from;\n\t}).join(\", \");\n};\nvar getValidVersion = function(scope, scopeName, key, requiredVersion) {\n\tvar entry = findValidVersion(scope, key, requiredVersion);\n\tif(entry) return get(entry);\n\tthrow new Error(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\n};\nvar warnInvalidVersion = function(scope, scopeName, key, requiredVersion) {\n\ttypeof console !== \"undefined\" && console.warn && console.warn(getInvalidVersionMessage(scope, scopeName, key, requiredVersion));\n};\nvar get = function(entry) {\n\tentry.loaded = 1;\n\treturn entry.get()\n};\nvar init = function(fn) { return function(scopeName, a, b, c) {\n\tvar promise = __webpack_require__.I(scopeName);\n\tif (promise && promise.then) return promise.then(fn.bind(fn, scopeName, __webpack_require__.S[scopeName], a, b, c));\n\treturn fn(scopeName, __webpack_require__.S[scopeName], a, b, c);\n}; };\n\nvar load = /*#__PURE__*/ init(function(scopeName, scope, key) {\n\tensureExistence(scopeName, key);\n\treturn get(findVersion(scope, key));\n});\nvar loadFallback = /*#__PURE__*/ init(function(scopeName, scope, key, fallback) {\n\treturn scope && __webpack_require__.o(scope, key) ? get(findVersion(scope, key)) : fallback();\n});\nvar loadVersionCheck = /*#__PURE__*/ init(function(scopeName, scope, key, version) {\n\tensureExistence(scopeName, key);\n\treturn get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\n});\nvar loadSingleton = /*#__PURE__*/ init(function(scopeName, scope, key) {\n\tensureExistence(scopeName, key);\n\treturn getSingleton(scope, scopeName, key);\n});\nvar loadSingletonVersionCheck = /*#__PURE__*/ init(function(scopeName, scope, key, version) {\n\tensureExistence(scopeName, key);\n\treturn getSingletonVersion(scope, scopeName, key, version);\n});\nvar loadStrictVersionCheck = /*#__PURE__*/ init(function(scopeName, scope, key, version) {\n\tensureExistence(scopeName, key);\n\treturn getValidVersion(scope, scopeName, key, version);\n});\nvar loadStrictSingletonVersionCheck = /*#__PURE__*/ init(function(scopeName, scope, key, version) {\n\tensureExistence(scopeName, key);\n\treturn getStrictSingletonVersion(scope, scopeName, key, version);\n});\nvar loadVersionCheckFallback = /*#__PURE__*/ init(function(scopeName, scope, key, version, fallback) {\n\tif(!scope || !__webpack_require__.o(scope, key)) return fallback();\n\treturn get(findValidVersion(scope, key, version) || warnInvalidVersion(scope, scopeName, key, version) || findVersion(scope, key));\n});\nvar loadSingletonFallback = /*#__PURE__*/ init(function(scopeName, scope, key, fallback) {\n\tif(!scope || !__webpack_require__.o(scope, key)) return fallback();\n\treturn getSingleton(scope, scopeName, key);\n});\nvar loadSingletonVersionCheckFallback = /*#__PURE__*/ init(function(scopeName, scope, key, version, fallback) {\n\tif(!scope || !__webpack_require__.o(scope, key)) return fallback();\n\treturn getSingletonVersion(scope, scopeName, key, version);\n});\nvar loadStrictVersionCheckFallback = /*#__PURE__*/ init(function(scopeName, scope, key, version, fallback) {\n\tvar entry = scope && __webpack_require__.o(scope, key) && findValidVersion(scope, key, version);\n\treturn entry ? get(entry) : fallback();\n});\nvar loadStrictSingletonVersionCheckFallback = /*#__PURE__*/ init(function(scopeName, scope, key, version, fallback) {\n\tif(!scope || !__webpack_require__.o(scope, key)) return fallback();\n\treturn getStrictSingletonVersion(scope, scopeName, key, version);\n});\nvar installedModules = {};\nvar moduleToHandlerMapping = {\n\t130: function() { return loadSingletonFallback(\"default\", \"react/jsx-runtime\", function() { return function() { return __webpack_require__(5500); }; }); },\n\t4121: function() { return loadSingletonFallback(\"default\", \"react\", function() { return function() { return __webpack_require__(7077); }; }); },\n\t776: function() { return loadSingletonFallback(\"default\", \"react-dom\", function() { return function() { return __webpack_require__(5675); }; }); }\n};\nvar initialConsumes = [130,4121,776];\ninitialConsumes.forEach(function(id) {\n\t__webpack_require__.m[id] = function(module) {\n\t\t// Handle case when module is used sync\n\t\tinstalledModules[id] = 0;\n\t\tdelete __webpack_require__.c[id];\n\t\tvar factory = moduleToHandlerMapping[id]();\n\t\tif(typeof factory !== \"function\") throw new Error(\"Shared module is not available for eager consumption: \" + id);\n\t\tmodule.exports = factory();\n\t}\n});\nvar chunkMapping = {};\n__webpack_require__.f.consumes = function(chunkId, promises) {\n\tif(__webpack_require__.o(chunkMapping, chunkId)) {\n\t\tchunkMapping[chunkId].forEach(function(id) {\n\t\t\tif(__webpack_require__.o(installedModules, id)) return promises.push(installedModules[id]);\n\t\t\tvar onFactory = function(factory) {\n\t\t\t\tinstalledModules[id] = 0;\n\t\t\t\t__webpack_require__.m[id] = function(module) {\n\t\t\t\t\tdelete __webpack_require__.c[id];\n\t\t\t\t\tmodule.exports = factory();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar onError = function(error) {\n\t\t\t\tdelete installedModules[id];\n\t\t\t\t__webpack_require__.m[id] = function(module) {\n\t\t\t\t\tdelete __webpack_require__.c[id];\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tvar promise = moduleToHandlerMapping[id]();\n\t\t\t\tif(promise.then) {\n\t\t\t\t\tpromises.push(installedModules[id] = promise.then(onFactory)['catch'](onError));\n\t\t\t\t} else onFactory(promise);\n\t\t\t} catch(e) { onError(e); }\n\t\t});\n\t}\n}","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"platform\": 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"wsp\"] = self[\"wsp\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// module factories are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"react\"], function() { return __webpack_require__(8055); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","inProgress","dataWebpackPrefix","loadStylesheet","installedCssChunks","Symbol","for","hasOwn","hasOwnProperty","classNames","classes","i","arguments","length","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","includes","key","call","join","module","exports","default","reactIs","REACT_STATICS","childContextTypes","contextType","contextTypes","defaultProps","displayName","getDefaultProps","getDerivedStateFromError","getDerivedStateFromProps","mixins","propTypes","type","KNOWN_STATICS","name","caller","callee","arity","MEMO_STATICS","compare","TYPE_STATICS","getStatics","component","isMemo","ForwardRef","render","Memo","defineProperty","getOwnPropertyNames","getOwnPropertySymbols","getOwnPropertyDescriptor","getPrototypeOf","objectPrototype","hoistNonReactStatics","targetComponent","sourceComponent","blacklist","inheritedComponent","keys","concat","targetStatics","sourceStatics","descriptor","e","condition","format","a","b","c","d","f","error","undefined","Error","args","argIndex","replace","framesToPop","_global","self","window","AbortController","g","h","k","l","m","n","p","q","r","t","v","w","x","y","z","u","$$typeof","A","AsyncMode","ConcurrentMode","ContextConsumer","ContextProvider","Element","Fragment","Lazy","Portal","Profiler","StrictMode","Suspense","isAsyncMode","isConcurrentMode","isContextConsumer","isContextProvider","isElement","isForwardRef","isFragment","isLazy","isPortal","isProfiler","isStrictMode","isSuspense","isValidElementType","typeOf","Scope","REQUEST","SINGLETON","Errors","createError","message","additional","err","assign","stack","tokenToString","token","Map","TokenClass","constructor","options","this","isToken","isModernToken","createToken","optional","DI_TOKEN","NOT_YET","CIRCULAR","tokenToKey","makeRecord","factory","resolvedDeps","scope","multi","Container","additionalProviders","fallback","records","recordValues","forEach","provider","register","provide","useValue","get","tokenORObject","_a","_b","record","getRecord","checkFound","hydrate","getOfDeps","deps","result","has","borrowToken","from","tokenKey","set","getValue","tokenOptions","__stack","checkIfProviderMatchToken","processProvider","useFactory","useClass","providerToRecord","value","providerToValue","multiRecord","hydrateDeps","checkCircularDeps","map","rec","__extendedWithStack","proxyHydrationError","test","IS_DI_CHILD_CONTAINER_TOKEN","ChildContainer","root","super","createContainer","providers","MODULE_PARAMETERS$1","Module","imports","target","id","Math","random","isExtendedModule","mainModule","getModuleParameters","moduleParameters","main","importsParam","isValidModule","Boolean","walkOfModules","modules","modulesIdInitialized","Set","modulesNameInitialized","innerWalkOfModules","add","item","mod","createChildContainer","container","childContainer","descr","perf","performance","now","Date","getUintArray","max","pow","Uint8Array","Uint16Array","Uint32Array","Number","MAX_SAFE_INTEGER","ZeroArray","size","fill","Stack","UintArray","heap","pop","ttl","ttlResolution","updateAgeOnGet","allowStale","maxAge","stale","keyMap","keyList","valList","next","prev","head","tail","free","initialFill","initializeTTLTracking","ttls","starts","setItemTTL","index","updateItemAge","cachedNow","getNow","setTimeout","unref","isStale","newIndex","moveToTail","evict","val","delete","peek","connect","deleted","clear","useShallowEqual","params","ref","useRef","shallowEqual","current","useIsomorphicLayoutEffect","useLayoutEffect","curryN","require","isArrayLike","slice","resultArr","indexOf","fn","arr","flatten","nested","j","isString","xs","len","fromIndex","toIndex","list","_len","sources","_key","fns","curried","_len2","newArgs","_key2","wait","timeout","_this","clearTimeout","cancel","onTrue","onFalse","nodeType","String","isNil","isObject","isReactElement","isReactComponent","isComponent","test1","test2","obj","prop","isPlainObject","objectKeys","mergeDeep","src","res","source","props","propsSet","create","_i","paths","path","acc","values","escapeRegExp","htmlEscapes","escape","char","str","pattern","replacement","delim","split","toLowerCase","App","bundles","actions","di","modulesToResolve","walkOfProviders","APP_INFO_TOKEN","appName","BUNDLE_LIST_TOKEN","ACTIONS_LIST_TOKEN","MODULES_LIST_TOKEN","appProviders","async","env","logger","LOGGER_TOKEN","log","commandLineRunner","COMMAND_LINE_RUNNER_TOKEN","warn","event","run","resolveModules","ModuleToResolve","resolveModuleDeps","MODULE_PARAMETERS","createApp","app","appCreationError","initialization","then","mergePlan","mergeWith","mergeOptions","mergePresets","presets","preset","omit","createBundle","declareAction","action","tramvaiActionVersion","isTramvaiAction","USER_AGENT_TOKEN","setMedia","createEvent","MediaStore","createReducer","height","width","isTouch","retina","synchronized","on","state","media","DocumentTouch","document","setUserAgent","UserAgentStore","userAgent","COMBINE_REDUCERS","useMedia","useSelector","ClientHintsChildAppModule","__decorate","CHILD_APP_INTERNAL_ROOT_STATE_ALLOWED_STORE_TOKEN","ClientHintsModule","store","getState","STORE_TOKEN","commandLineListTokens","context","cookieManager","setMediaInfo","innerWidth","innerHeight","matchMedia","matches","JSON","stringify","dispatch","supposed","debouncedSetMediaInfo","debounce","addEventListener","CONTEXT_TOKEN","COOKIE_MANAGER_TOKEN","middleware","__proto__","subscribe","handler","SimpleEmitter","listeners","emit","listener","addListener","removeListener","off","convertAction","actionOrNameEvent","payload","DispatcherContext","dispatcher","initialState","middlewares","applyDispatch","eventHandlers","handlers","applyHandlers","storeInstances","storeUnsubscribeCallbacks","dispatcherInterface","getContext","getStore","bind","rehydratedStoreState","fullState","rehydrate","applyMiddlewares","stores","api","compose","storeSubscribe","storeName","storeInstance","subscribeHandler","newState","storeClass","storeClassPrepared","getStoreName","Store","registerStore","dependencies","dependencyStoreClass","dependency","eventOrType","handlerFns","storeInstanceGet","handlersLength","handlerFn","eventExecutor","dehydrate","dispatcherState","reducer","callback","reducerInstance","setContext","hasStore","unregisterStore","Dispatcher","createContext","registerHandler","unregisterHandler","filter","actionHandlers","createDispatcher","eventName","payloadCreator","identity","eventCreator","getType","reducers","ReducerStore","static","model","eventNames","events","setState","handle","Subscription","handleStateChange","onStateChange","unsubscribe","isSubscribed","setOnStateChange","trySubscribe","tryUnsubscribe","ConnectContext","ServerStateContext","useConsumerContext","useContext","useActions","actionsRef","useMemo","executeAction","useStore","serverState","reducerRef","addedReducerRef","useCallback","reactUpdate","useSyncExternalStore","contextExecution","scheduling","requestAnimationFrame","setImmediate","schedule","storesOrStore","selector","equalityFn","invariant","renderIsScheduled","storesRef","subscription","toArray","latestSubscriptionCallbackError","selectedState","useSyncExternalStoreWithSelector","errorMessage","Provider","children","jsx","Consumer","multiOptions","customerStart","resolveUserDeps","resolvePageDeps","spaTransition","afterSpaTransition","CHILD_APP_INTERNAL_CONFIG_TOKEN","CHILD_APP_INTERNAL_ROOT_DI_BORROW_TOKEN","CHILD_APP_COMMON_INITIAL_STATE_TOKEN","BUNDLE_MANAGER_TOKEN","ADDITIONAL_BUNDLE_TOKEN","ACTION_REGISTRY_TOKEN","ACTION_EXECUTION_TOKEN","ACTION_PAGE_RUNNER_TOKEN","ACTION_CONDITIONALS","HOOK_TOKEN","PUBSUB_FACTORY_TOKEN","PUBSUB_TOKEN","ROOT_PUBSUB_TOKEN","CREATE_CACHE_TOKEN","REGISTER_CLEAR_CACHE_TOKEN","CLEAR_CACHE_TOKEN","COMPONENT_REGISTRY_TOKEN","DISPATCHER_TOKEN","DISPATCHER_CONTEXT_TOKEN","STORE_MIDDLEWARE","INITIAL_APP_STATE_TOKEN","LOGGER_INIT_HOOK","REQUEST_MANAGER_TOKEN","RESPONSE_MANAGER_TOKEN","ENV_MANAGER_TOKEN","EXECUTION_CONTEXT_MANAGER_TOKEN","ROOT_EXECUTION_CONTEXT_TOKEN","COMMAND_LINE_EXECUTION_CONTEXT_TOKEN","COMMAND_LINES_TOKEN","init","listen","generatePage","close","decorators","desc","Reflect","decorate","_objectWithoutPropertiesLoose","excluded","sourceKeys","ACTION_PARAMETERS","EnvironmentManager","parameters","getInt","def","isFinite","getAll","update","clientUsed","updateClientUsed","EnvironmentStore","EnvironmentModule","Cookies","defaults","cookies","cookie","separatorIndex","cookieName","cookieValue","cookieDecodedName","decodeURIComponent","console","domain","expires","secure","httpOnly","sameSite","_c","_d","_e","applyDefaults","expireDate","getTime","getExpireDate","encodeURIComponent","cookieExpires","toUTCString","cookieDomain","cookiePath","cookieSecure","cookieHttpOnly","cookieSameSite","erase","all","cookieDecodedValue","reIpWithDots","reIpv4Embedded","calculateExpires","CookiesFallback","cache","CookieModule","cookieOptions","isSecure","location","protocol","testCookieName","checkCookieEnabled","sameSiteNoneCompatible","defaultHost","secureProtocol","noSubdomains","host","isIpWithDots","trimPort","prepareCookieOptions","hostname","remove","safeStringifyJSON","replacer","space","seen","_","safeStringify","LEVELS","trace","debug","info","fatal","silent","LEVEL_NAMES","createRegexpFromNamespace","namespace","RegExp","Logger","toLower","instances","beforeReporters","reporters","filters","extensions","level","setLevel","enabled","checkEnabled","eachObj","levelName","onChange","enabledName","enabledLevel","newLevel","save","lvl","ns","regexp","instance","splice","reportersArr","child","opts","childKey","addBeforeReporter","reporter","setBeforeReporters","addReporter","setReporters","addFilter","setFilters","addExtension","extension","setExtensions","createLogObj","date","logObj","extend","bindMethods","createLoggerFactory","reduce","method","setGlobalReporters","enable","disable","BrowserReporter","defaultColor","levelColorMap","consoleLogFn","style","badge","NAME","ls","localStorage","parse","getItem","names","parseState","debugGetState","setOnChange","cfg","setItem","load","formatError","body","code","RemoteReporter","requestCount","makeRequest","emitLevels","reqCount","queue","checkQueue","sendRequest","shift","fields","otherArgs","formatJson","catch","noop","remote","pathEq","SERVER_MODULE_PAPI_PUBLIC_URL","SERVER_MODULE_PAPI_PRIVATE_URL","SERVER_MODULE_PAPI_PRIVATE_ROUTE","setLogs","LogStore","logs","DevLogsExtension","loggerInstance","start","reset","flush","flushed","environmentManager","papi","parsedUrl","query","mode","clearCurrentConfig","debugLevel","debugEnable","logger$1","each","ssrLogger","groupCollapsed","groupEnd","flushLogs","LogModule","loggerInitHooks","hookFn","_extends","_setPrototypeOf","o","setPrototypeOf","Context","React","LOADABLE_SHARED","STATUS_PENDING","STATUS_REJECTED","createLoadable","_ref","_ref$defaultResolveCo","defaultResolveComponent","_render","onLoad","loadable","loadableConstructor","ctor","requireAsync","resolve","chunkName","resolveConstructor","_getCacheKey","cacheKey","Loadable","Component","resolveComponent","preload","LoadableWithChunkExtractor","cachedLoad","promise","status","fileName","InnerLoadable","_React$Component","subClass","superClass","loading","__chunkExtractor","requireSync","ssr","loadSync","addChunk","ReferenceError","_assertThisInitialized","isReady","_proto","componentDidMount","mounted","cachedPromise","getCache","setCache","loadAsync","componentDidUpdate","prevProps","prevState","componentWillUnmount","safeSetState","nextState","getCacheKey","triggerOnLoad","_this2","_this3","resolveAsync","loadedModule","_this$props","forwardedRef","_this$props2","propFallback","_this$state","suspense","EnhancedInnerLoadable","extractor","lazy","_createLoadable","__esModule","_createLoadable$1","loadable$1","lazy$1","loadable$2","lib","DIContext","useDi","useDiContainer","mapObj","dep","FallbackError","jsxs","textAlign","marginBottom","paddingTop","fontSize","lineHeight","fontWeight","color","href","onClick","reload","UniversalErrorBoundary","url","componentDidCatch","errorInfo","errorHandlers","Fallback","fallbackFromDi","ERROR_BOUNDARY_TOKEN","ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN","ErrorBoundary","hasError","fallbackComponent","fallbackComponentFromDi","WrappedComponent","hoistStatics","depsInstance","resolveLazyComponent","componentOrLoader","__lazyErrorHandler","failedLinkUrl","request","querySelector","routes","originalImportAsync","importAsync","pages","layouts","errorBoundaries","getAllFileSystemLayouts","fsPagesAndRoutes","getAllFileSystemErrorBoundaries","isFileSystemPageComponent","pageComponent","fileSystemPageToLayoutKey","fileSystemPageToErrorBoundaryKey","fileSystemPageToRoute","staticFileSystemPageToPath","route","config","nestedLayoutComponent","errorBoundaryComponent","FASTIFY_REQUEST","FASTIFY_RESPONSE","getPath","testString","pathname","search","hash","convertRawUrl","searchParams","origin","username","password","port","enumerable","rawParse","baseUrl","getDefaultBaseUrl","URL","isInvalidUrl","pathPattern","fillSearchParamsWithQuery","vs","append","COMMAND_LINE_TIMING_INFO_TOKEN","COMMAND_LINE_EXECUTION_END_TOKEN","SilentError","isSilent","errorName","isSilentError","HttpError","httpStatus","additionalFields","NotFoundError","RedirectFoundError","nextUrl","isRedirectFoundError","ExecutionError","cause","contextName","ExecutionAbortError","ExecutionTimeoutError","ConditionFailError","conditionName","targetName","defaultOptions","resultTransform","PubSub","subscribers","subs","publish","promises","sub","Promise","RENDER_SLOTS","RENDERER_CALLBACK","CUSTOM_RENDER","RESOURCES_REGISTRY","RENDER_MODE","USE_REACT_STRICT_MODE","EXTEND_RENDER","DEFAULT_LAYOUT_COMPONENT","DEFAULT_HEADER_COMPONENT","DEFAULT_FOOTER_COMPONENT","DEFAULT_ERROR_BOUNDARY_COMPONENT","LAYOUT_OPTIONS","TRAMVAI_RENDER_MODE","FS_PAGES_DEFAULT_BUNDLE","BundleManager","bundleList","componentRegistry","actionRegistry","components","getComponentsFor","mapping","getKey","componentsDefaultBundle","loadBundle","bundle","cmp","reject","DEFAULT_GROUP","setRequest","RequestManagerStore","sharedProviders$1","getBody","getUrl","getParsedUrl","getMethod","getHeader","headers","getHeaders","getCookie","getCookies","getClientIp","socket","remoteAddress","getHost","RequestManagerModule","fromServer","navigator","sharedProviders","setBody","isEmpty","setHeader","setCookie","setStatus","getStatus","ResponseManagerModule","ConsumerContext","dispatcherContext","pubsub","dispatchWith","createActionOrType","command$1","customer","spa","afterSpa","lines$1","server","client","CommandModule","provide$1","Scope$1","lines","rootDi","executionContextManager","executionEndHandlers","executionContextByDi","WeakMap","abortControllerByDi","customDi","diContainer","resolveDi","rootExecutionContext","timingInfo","chain","line","lineName","withContext","executionContext","abortController","createLineChain","finally","end","executionEndHandler","resolveExecutionContextFromDi","lineInstance","throwError","instanceExecute","Function","TypeError","command","abort","PubSubModule","createPubsub","providers$2","getElementById","textContent","actionServerStateEvent","actionTramvaiReducer","actionType","DEFAULT_CONDITIONS","ActionChecker","globalConditionals","executionState","forbiddenMarker","conditions","check","forbid","forbiddenBy","allow","EMPTY_DEPS","DEFAULT_PAYLOAD","GLOBAL_PARAMETER","pageServer","checker","LIMIT_ACTION_GLOBAL_TIME_RUN","ActionModule","actionsList","normalized","uniq","addingActions","getGlobal","difference","actionConditionals","transformAction","execution","objectMap","pageActions","getParameters","getExecutionState","canExecuteAction","executionActionContext","createActionContext","data","conditionsFailResult","runInContext","parentExecutionContext","actionExecutionContext","abortSignal","runActions","stopRunAtError","commandLineExecutionContext","actionExecution","limitTime","always","onlyServer","onlyBrowser","pageBrowser","StateModule","devTools","cacheFactory","LRU","cachesToken","createToken$1","CacheModule","caches","isChildDi","cachesClear","EMPTY_VALUES","CommonModule","hooks","registerHooks","runHooks","plugins","runAsyncHooks","plugin","runPromiseHooks","currentId","resolver","componentList","group","groupComponents","getComponentParam","param","defaultValue","pathOr","additionalBundleList","bundleManagerDeps","parentContext","nameOrOptions","cb","normalizeOptions","selfValues","aborted","abortListener","signal","executionContextName","removeEventListener","commonState","stateProviders","commandLineListTokens$1","commandProviders","actionsProviders","CommonChildAppModule","WILDCARD_REGEXP","HISTORY_FALLBACK_REGEXP","PARAM_PARSER_REGEXP","normalizeTrailingSlash","trailingSlash","hasTrailingSlash","endsWith","isFilePath","isSameHost","makeNavigateOptions","registerHook","hooksSet","hook","getParts","startsWith","Infinity","isHistoryFallback","part","isWildcard","isParameterized","prefix","postfix","match","exec","paramName","parseParameter","makePath","parts","AbstractRouter","mergeSlashes","beforeResolve","beforeNavigate","afterNavigate","beforeUpdateCurrent","afterUpdateCurrent","guards","onRedirect","onNotFound","onBlock","started","strictTrailingSlash","syncHooks","getCurrentRoute","currentNavigation","to","lastNavigation","getCurrentUrl","getLastRoute","getLastUrl","commitNavigation","navigation","history","runSyncHooks","updateRouteOptions","internalUpdateCurrentRoute","prevNavigation","navigateState","fromUrl","resolveRoute","wildcard","resolveUrl","navigateOptions","internalNavigate","redirect","resolvedUrl","redirectFrom","notfound","runGuards","runNavigate","runUpdateCurrentRoute","resolveOptions","parse$1","back","go","forward","isNavigating","addRoute","tree","normalizePathname","hrefOrPath","normalizeManySlashes","preserveQuery","currentRoute","currentUrl","resultUrl","absoluteBaseUrl","rawResolveUrl","rest","parsedPath","fromPath","URLSearchParams","rawAssignUrl","getRoute","getWildcard","results","guard","block","registerGuard","hookName","registerSyncHook","History","setTree","supportsHtml5History","pushState","isHistoryState","generateState","currentState","generateKey","ClientHistory","currentIndex","historyWrapper","onNavigate","navigate","title","replaceState","browserHistory","__originalHistory","delta","browserNavigate","wrapHistory","navigationType","prevKey","prevType","goPromiseResolve","goPromiseReject","historyFallback","historyFallbackRoute","getHistoryFallback","actualPath","ClientRouter","isSameUrlNavigation","alias","prevUrl","createTree","createNavigationRoute","RouteTree","currentTree","parsed","wildcardRoute","found","find","par","parameter","findIndex","findRoute","propertyName","exactMatch","optionalOnly","paramValue","RouterContext","RouteContext","UrlContext","router","ROUTER_TOKEN","ROUTES_TOKEN","ROUTER_GUARD_TOKEN","PAGE_SERVICE_TOKEN","ROUTE_RESOLVE_TOKEN","ROUTE_TRANSFORM_TOKEN","ROUTER_SPA_ACTIONS_RUN_MODE_TOKEN","LINK_PREFETCH_MANAGER_TOKEN","setCurrentNavigation","setUrlOnRehydrate","RouterStore","previousRoute","previousUrl","routerClassToken","additionalRouterParameters","onChangeHooksToken","beforeResolveHooksToken","beforeNavigateHooksToken","afterNavigateHooksToken","beforeUpdateCurrentHooksToken","afterUpdateCurrentHooksToken","routeTransformToken","commonGuards","bundleManager","responseManager","pageService","resolveComponentFromConfig","resolvedBundle","resolvedLayout","commonHooks","provideRouter","commonTokens","transformers","providers$1","RouterClass","routeTransform","routeResolve","additionalParameters","newLogger","getConfig","getContent","content","getMeta","meta","updateCurrentRoute","addComponent","getComponentsGroupName","getComponent","property","configName","defaultComponent","componentName","PREFETCHED_LINKS_CACHE_TOKEN","PREFETCHED_LINKS_QUEUE_TOKEN","prefetchProviders","prefetchedLinksCache","prefetchedLinksQueue","prefetch","prefetchRoute","addQuery","clientTokens","runActionsFactory","actionPageRunner","renderMode","generateForRoot","spaActionsMode","_a$1","forRoot","spaHooks","spaMode","SpaRouterModule","resolveIfDelayFound","delayedNavigation","flattenDelayedNavigation","delayNavigation","delayedPromise","delayedResolve","delayedReject","cancelled","task","delayResolve","timer","setInterval","race","clearInterval","nav","RouterChildAppModule","requestIdleCallback","cancelIdleCallback","usePageService","composeComponent","wrappers","Wrapped","wrapper","RenderChildren","RenderProp","setPageErrorEvent","PageErrorStore","serializeError","PageErrorBoundary","serializedError","deserializeError","LayoutRenderComponent","LayoutComponent","HeaderComponent","FooterComponent","Header","Footer","NestedLayoutRenderComponent","NestedLayoutComponent","PageRenderComponent","PageComponent","Root","pageRenderComponent","nestedLayoutRenderComponent","hydrateRoot","startTransition","ExecuteRenderCallback","RenderChildrenComponent","LayoutModule","layoutOptions","header","BaseHeader","footer","BaseFooter","layout","BaseLayout","BaseContent","page","BasePage","globalComponents","LayoutWrapper","ContentWrapper","PageWrapper","HeaderWrapper","FooterWrapper","componentsList","Layout","createLayout","nestedLayoutDefault","layoutDefault","footerDefault","headerDefault","errorBoundaryDefault","RenderModule_1","RenderModule","useStrictMode","getPageResources","contextExternal","consumerContext","customRender","extendRender","rendererCallback","renderResult","renderReact","createElement","executeRendererCallbacks","renderErr","cbError","element","classList","wrappedElement","allErrors","logHydrateRecoverableError","otherErrors","onRecoverableError","componentStack","renderer","rendering","deprecatedMode","METRICS_MODULE_TOKEN","toSecond","timeStamp","round","text","isJs","isCSS","isImg","isFont","resourceType","getEntriesByType","getPaintMetric","paint","startTime","getTimingResourceValue","tr","calculateMetric","duration","transferSize","encodedBodySize","Counter","configurator","inc","labels","Gauge","dec","setToCurrentTime","startTimer","endLabels","Histogram","observe","Summary","PAPI_SERVICE","setInstantMetrics","MetricsStore","instantMetricsMap","_prevState","InstantMetricsModule","papiService","validMetricsMap","instantMetricsReporter","logObject","mark","clearMarks","measure","clearMeasures","MetricsModule","counter","opt","gauge","histogram","summary","timings","timing","loadEventEnd","requestStart","responseStart","responseEnd","domComplete","domInteractive","navigationStart","timingCandidates","el","time","download","entries","countByType","entry","css","js","img","font","other","count","pageNav","html","getResourceMetrics","browserTimings","deviceType","urlMask","appInfo","BrowserPapiModule","ServerModule","ErrorInterceptorModule","MetaWalk","eachMeta","func","updateMeta","priority","metaObj","stateMeta","defaultConverter","Meta","transformValue","converters","metaWalk","listSources","dataCollection","META_DATA_ATTR","reduceObj","tag","attributes","innerHtml","newElement","innerHTML","setAttribute","Update","addTags","removeTags","querySelectorAll","fragment","createDocumentFragment","removeChild","appendChild","insertBefore","firstChild","escapeMeta","ifElse","META_DEFAULT_TOKEN","META_WALK_TOKEN","META_UPDATER_TOKEN","convertWithPrefix","charAt","toUpperCase","defaultMeta","metaDefaultPack","walker","routeSeo","seo","pageComponentSeo","shareSchema","metaTags","twitterCard","openGraph","metaList","metaInnerHtml","metaName","metaProperty","metaLink","rel","robotsNoIndex","robotsNoFollow","robotsNone","metaRobotsContent","noindex","nofollow","none","description","keywords","canonical","viewport","ogTitle","ogDescription","ogSiteName","ogUrl","ogType","ogImage","ogImageSecure","ogImageType","ogImageAlt","ogImageWidth","ogImageHeight","ogLocale","twitterTitle","twitterDescription","twitterSite","twitterCreator","twitterImage","twitterImageAlt","robots","SeoModule_1","SeoModule","metaUpdaters","metaDefault","ignore","debounced","Descriptions","StorageRecord","dynamic","iconLink","inlineScript","script","asIs","preconnectLink","preloadLink","inlineStyle","VOID_TAGS","formatAttr","attrs","defer","charset","crossorigin","converter","attr","SketchModule","ResourceType","slot","undo","redo","pushToHistory","setCanvas","setTool","incrementCurrentIndexFrame","decrementCurrentIndexFrame","setCurrentIndexFrame","setHistory","sliceStory","setIsLastBrowse","setLineWidth","setFillColor","setStrokeColor","SketchStore","canvasStore","canvas","browser","currentIndexFrame","isLastBrowse","tool","dataUrl","newHistory","lineWidth","fillColor","strokeColor","setCanvasAction","setToolAction","setLineWidthAction","setFillColorAction","setStrokeColorAction","pushToHistoryAction","setCurrentIndexFrameAction","setHistoryAction","sliceStoryAction","setIsLastBrowseAction","canvasRef","setCurrentINdexFrame","sketchStore","useEffect","historyStorage","currentIndexFrameStorage","isLastBrowseStorage","historyStorageParsed","ctx","Image","onload","clearRect","drawImage","className","s","onMouseUp","toDataURL","mouseUpHandler","sidebar","icon","alt","changeColor","isActive","cn","min","Tool","fillStyle","strokeStyle","destroyEvent","onmousemove","onmousedown","onmouseup","Brush","isMouseDown","mouseMoveHandler","mouseDownHandler","beginPath","moveTo","pageX","offsetLeft","pageY","offsetTop","draw","lineTo","stroke","setActive","isToolActive","setBrushAction","BrushTool","setCursorAction","Rect","startX","startY","saved","currentX","currentY","rect","setRectAction","RectTool","undoIndex","redoIndex","useUndoRedo","undoIcon","redoIcon","setIsActiveTool","useState","CursorButton","Sketch","widthProp","heightProp","canvasWidth","canvasHeight","is","useDebugValue","getSnapshot","inst","hasValue","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","threw","__webpack_modules__","O","chunkIds","notFulfilled","fulfilled","every","getter","definition","chunkId","miniCssF","done","needAttach","scripts","getElementsByTagName","getAttribute","nc","crossOrigin","onScriptComplete","onerror","doneFns","parentNode","toStringTag","ap","S","initPromises","initTokens","I","initScope","initToken","uniqueName","version","eager","versions","activeVersion","loaded","parseVersion","findSingletonVersionKey","versionLt","loadSingletonFallback","scopeName","requiredVersion","getSingleton","installedModules","moduleToHandlerMapping","chunkMapping","consumes","onFactory","onError","fullhref","existingLinkTags","dataHref","existingStyleTags","findStylesheet","linkTag","errorType","realHref","createStylesheet","miniCss","installedChunks","installedChunkData","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}